<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Home of mubix, the infosec treehugger">
  <meta name="generator" content="Hugo 0.15" />

  <title>Room362</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <link rel="alternate" type="application/rss+xml" title="Room362" href="//room362.com/index.xml" />

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="//room362.com/img/favicon.ico" type="image/x-icon" />

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  

  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/brandon/"><i class='fa fa-users fa-fw'></i>Brandon</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    <li class="pure-menu-item">
      <a class="pure-menu-link" href="//room362.com/index.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
    </li>

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/mubix" target="_blank"><i class="fa fa-twitter fa-fw"></i>Twitter</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://facebook.com/mubix" target="_blank"><i class="fa fa-facebook fa-fw"></i>Facebook</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://plus.google.com/+mubix" target="_blank"><i class="fa fa-google-plus-square fa-fw"></i>Google+</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://instagram.com/mubix" target="_blank"><i class="fa fa-instagram fa-fw"></i>Instagram</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://flickr.com/photos/mubix" target="_blank"><i class="fa fa-flickr fa-fw"></i>Flickr</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://youtube.com/user/hak5" target="_blank"><i class="fa fa-youtube fa-fw"></i>YouTube</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://vimeo.com/mubix" target="_blank"><i class="fa fa-vimeo fa-fw"></i>Vimeo</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="http://slideshare.net/mubix" target="_blank"><i class="fa fa-slideshare fa-fw"></i>SlideShare</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/mubix" target="_blank"><i class="fa fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://reddit.com/user/mubix" target="_blank"><i class="fa fa-reddit fa-fw"></i>Reddit</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/mubix" target="_blank"><i class="fa fa-github-alt fa-fw"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https:////bitbucket.org/mubix" target="_blank"><i class="fa fa-bitbucket fa-fw"></i>Bitbucket</a>
    </li>
    

    

  </ul>
</div>

  <div class="pure-g">
  <div class="small-print pure-u-1 pure-u-md-1-1">
    <small>&copy; 2016. All rights reserved.</small>
  </div>
  <div class="small-print pure-u-1 pure-u-md-1-1">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Room362</h1>
  <h2>Blatherings of a security addict</h2>
</div>

<div class="content">
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-05-24-sticky-keys-and-utilman-against-nla/">Sticky Keys and Utilman against NLA</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>24 May 2012, 17:10</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  At CCDC, Sticky Keys via RDP was a very successful re-entry point for the Red Team. You can read more about how this works here: http://carnal0wnage.attackresearch.com/2012/04/privilege-escalation-via-sticky-keys.html So if you can get physical access or SYSTEM/Admin access at some point and enable + reach RDP, you can very easily follow those instructions and gain a level of persistance without the need of a pesky password :-) However, this doesn&rsquo;t work so well with the advent of NLA or Network-Level-Authentication, which was enabled for Vista systems and beyond.
  </p>

  
  <footer>
    <a href="/post/2012/2012-05-24-sticky-keys-and-utilman-against-nla/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-05-22-derbycon-training-sep-27-28-2012/">DerbyCon Training (Sep 27-28 2012)</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>22 May 2012, 19:44</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  @egypt and I have teamed up this year to teach at DerbyCon at the end of September. Here is the very basic outline of the class and subject to change: (Sign up here: https://www.derbycon.com/training-courses/ ) THURSDAY Intro to the Framework The history of the Framework Ninja Demo Usage Recon Exploitation Pillaging Post modules Intro to Ruby Getting your environment set up Ruby Basics Strings, Arrays, and Methods oh my IRB, Pry - The No-Spoon Portion Navigating Documentation Module Writing Auxiliary Modules Exploit Modules Post Modules Railgun (Windows and ?Linux?) Meterpreter(s) The Dread Pirate Reporting LAB, LABs and more LABS FRIDAY CTF + open LAB time definitely open to requests for content, if you, as a student, would like a particular topic included.
  </p>

  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-04-26-phdays-in-moscow/">phDays in Moscow</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>26 Apr 2012, 21:33</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  A friend of mine is presenting at phDays in Moscow at the end of May. If you are in the area, or can be, I would highly recommend you attend, and in particularly his talk. His blog is here: http://blog.gentilkiwi.com/ And since a picture is worth a thousand words: You should really go check out what he is going to present&hellip; just sayin&rsquo;
  </p>

  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-03-19-how-to-win-ccdc-slides/">How to Win CCDC - Slides</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>19 Mar 2012, 05:20</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  Since this is a constantly updating slide deck I figured I&rsquo;d post it here so I didn&rsquo;t have to keep emailing it out. ;-) If you have comments or if something is wrong grammatically, technically or in any other way I&rsquo;d love input. Suggestions also welcome. Here is a link straight to the doc if you want to comment or add it to your google docs list: https://docs.google.com/presentation/d/1pPXLg3KqwSMLRCNRfows5QnVI2mLjSmll5vN2WHMFJg/edit
  </p>

  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-03-04-who-is-on-your-dream-team-red-team/">Who is on your dream team red team?</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>04 Mar 2012, 10:21</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  This was an honest idea to help identify people that might not get the media attention of other &ldquo;Top X in Infosec&rdquo; lists. But I should have known better than to put a poll on the internet&hellip;
  </p>

  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-02-19-developing-the-lnk-metasploit-post-module-with-mona/">Developing the LNK Metasploit post module with Mona</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>19 Feb 2012, 05:57</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  I have been using the LNK trick I talked about in my last post for a while, but always needing a Windows machine to create the LNK file. When I decided to write a post about it, I wanted to put the stipulation for myself that I would finally develop a way to get it done with out having to lug around a VM or spin one up every time I needed to change it&rsquo;s target.
  </p>

  
  <footer>
    <a href="/post/2012/2012-02-19-developing-the-lnk-metasploit-post-module-with-mona/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-02-11-ms08_068-ms10_046-fun-until-2018/">MS08_068 &#43; MS10_046 = FUN UNTIL 2018</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>11 Feb 2012, 08:29</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  *TL;DR:* SMB Relay + LNK UNC icons = internal pentest pwnage I need to touch on the highlights of two vulnerabilities before we talk about the fun stuff, but I highly encourage you to read the references at the bottom of this post and understand the vulnerabilities after you are done with my little trick, as you might find one of your own. MS08_068: http://www.cvedetails.com/cve/CVE-2008-4037/ In 2008, Microsoft released MS08_068 which patched the &ldquo;SMB Relay&rdquo; attack.
  </p>

  
  <footer>
    <a href="/post/2012/2012-02-11-ms08_068-ms10_046-fun-until-2018/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-02-03-a-textfiles-approach-at-gathering-the-worlds-dns-slides/">A @textfiles approach at gathering the world&#39;s DNS - Slides</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>03 Feb 2012, 17:24</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  This is my talk that I gave at ShmooCon 2012. It was a great honor to be given the chance to speak at ShmooCon as it has been my second home since 2006 (missed the first one&hellip; havent missed one since) A @textfiles approach to gathering the world&#x27;s DNS from Rob Fuller
  </p>

  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-01-03-uac-user-assisted-compromise/">(UAC) User Assisted Compromise</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>03 Jan 2012, 06:56</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  A number of times during tests I&rsquo;ve actually run into those mythical creatures called &ldquo;patched windows machines&rdquo;. At DerbyCon Chris Gates and I released the &ldquo;Ask&rdquo; post module (which I had failed to publish). This module very simply uses the ShellExecute windows function.aspx&rdquo;) via Railgun with the undocumented (but very well known) operator of &lsquo;runas&rsquo;. These two lines accomplished that: client.railgun.add_function( 'shell32', 'ShellExecuteA', 'DWORD',[[&quot;DWORD&quot;,&quot;hwnd&quot;,&quot;in&quot;],[&quot;PCHAR&quot;,&quot;lpOperation&quot;,&quot;in&quot;],[&quot;PCHAR&quot;,&quot;lpFile&quot;,&quot;in&quot;],[&quot;PCHAR&quot;,&quot;lpParameters&quot;,&quot;in&quot;],[&quot;PCHAR&quot;,&quot;lpDirectory&quot;,&quot;in&quot;],[&quot;DWORD&quot;,&quot;nShowCmd&quot;,&quot;in&quot;],]) client.railgun.shell32.ShellExecuteA(nil,&quot;runas&quot;,&quot;evil.exe&quot;,nil,nil,5) This would quite simply prompt the user with that annoying UAC prompt asking the user to run &lsquo;evil.exe&rsquo; with Administrative privs.
  </p>

  
  <footer>
    <a href="/post/2012/2012-01-03-uac-user-assisted-compromise/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2011/2011-12-26-hak5-segment-sneak-peak/">Hak5 Segment Sneak Peak</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>26 Dec 2011, 06:06</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  Since it&rsquo;s Christmas and all, I thought I&rsquo;d post the code snippet from my Hak5 segment a bit early: #include &lt;Clipboard.au3&gt; #include &lt;File.au3&gt; $oldclip = &quot;&quot; While 1 $clip = _ClipBoard_GetData() If $clip &lt;&gt; &quot;0&quot; Then If $clip &lt;&gt; $oldclip Then _FileWriteLog(@UserProfileDir &amp; &quot;clip.log&quot;, $clip) $oldclip = $clip EndIf EndIf Sleep(100) WEnd It&rsquo;s pretty straight forward, and I welcome everyone to install AutoIt3 and compile/run the above script to see what it does (although most of you I&rsquo;m sure can figure it out just by reading it).
  </p>

  
  <footer>
    <a href="/post/2011/2011-12-26-hak5-segment-sneak-peak/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  

  
<nav class="pagination" role="pagination">
  
  <a href="/page/9/"><i class="fa fa-angle-double-left"></i></a>
  
  <span>10 / 45</span>
  
  <a href="/page/11/"><i class="fa fa-angle-double-right"></i></a>
  
</nav>



</div>

</div>
</div>
<script src="//room362.com/js/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-198967-1', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>

