<!DOCTYPE html>
<html lang="en-us">

	<head>
		<title> Railgun &middot;  </title>

		<meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="generator" content="Hugo 0.31.1" />


<script   src="https://code.jquery.com/jquery-3.1.1.min.js"   integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="   crossorigin="anonymous"></script>


<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>


<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">


<link rel="stylesheet" href="https://malicious.link/css/nix.css">


<link href="https://fonts.googleapis.com/css?family=Inconsolata|Open+Sans|Roboto|Montserrat|Concert+One" rel="stylesheet">



<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
				  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-198967-1', 'auto');
	  ga('send', 'pageview');

</script>


	</head>

	<body>
		<header>
<nav class="navbar navbar-default navbar-fixed-top navbar-inverse font-header">
	<div class="container-fluid">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse-1" aria-expanded="false">
				<span class="sr-only">Toggle navigation</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" id="green-terminal" href=https://malicious.link/>mubix@malicious.link ~ $</a>
		</div>

		
		<div class="collapse navbar-collapse" id="navbar-collapse-1">
			<ul class="nav navbar-nav navbar-right">
				<li>
					<a href="https://malicious.link/">/home/mubix</a>
				</li>
				
				
				<li >
					<a href="/brandon">~/brandon</a>
				</li>
				
				
				<li >
					<a href="/about">~/about</a>
				</li>
				
				
				<li >
					<a href="/post">~/posts</a>
				</li>
				

			</ul>
		</div>
	</div>
</nav>
</header>

		<div class="container wrapper">
			<div class="row">
				<div class="col-xs-12 text-center">
					<h1 id=>Railgun</h1>
				</div>
			</div>
			<ul id="post-list">
                	
				<li>
					<div class="post-list-item">
						<div class="post-header">
							<h4 class="post-link"><a href="https://malicious.link/post/2012/2012-07-31-raising-zombies-in-windows-part-1-passwords/">Raising Zombies in Windows: Part 1 - Passwords</a></h4>
							<h4 class="post-date">Jul 31, 2012</h4>
						</div>
						<div class="post-summary"><p>With the use of Mimikatz and WCE, clear text passwords are much more common. What isn&rsquo;t always there is the user. They take lunches, go home at a reasonable time and generally aren&rsquo;t really appreciative of our (pentester/red teamer)&rsquo;s schedule.
A straight forward way, and provided by Microsoft to create a process as a user (whereby having their token readily available is using &lsquo;runas.exe&rsquo;:
w00t, we the user is present, we can migrate our meterepreter session into that notepad and we&rsquo;re good right?</p></div>
						<div class="post-list-footer text-center">
							<a href="https://malicious.link/post/2012/2012-07-31-raising-zombies-in-windows-part-1-passwords/">Read More</a>
						</div>
					</div>
				</li>
			
				<li>
					<div class="post-list-item">
						<div class="post-header">
							<h4 class="post-link"><a href="https://malicious.link/post/2012/2012-06-15-integration-of-mimikatz-into-metasploit-stage1/">Integration of Mimikatz into Metasploit Stage1</a></h4>
							<h4 class="post-date">Jun 15, 2012</h4>
						</div>
						<div class="post-summary"><p>One of the powers of Metasploit is it&rsquo;s ability to stay memory resident. Through the use of reflective DLL injection even keeping new functionality the attack loads from ever touching disk. Well, the first thing I wanted to do with Mimikatz is get to that same level.
Here is my first step to that end; a railgun based Meterpreter script. Now before going all reflective with it I needed to understand how the DLL worked.</p></div>
						<div class="post-list-footer text-center">
							<a href="https://malicious.link/post/2012/2012-06-15-integration-of-mimikatz-into-metasploit-stage1/">Read More</a>
						</div>
					</div>
				</li>
			
				<li>
					<div class="post-list-item">
						<div class="post-header">
							<h4 class="post-link"><a href="https://malicious.link/post/2012/2012-01-03-uac-user-assisted-compromise/">(UAC) User Assisted Compromise</a></h4>
							<h4 class="post-date">Jan 3, 2012</h4>
						</div>
						<div class="post-summary"><p>A number of times during tests I&rsquo;ve actually run into those mythical creatures called &ldquo;patched windows machines&rdquo;. At DerbyCon Chris Gates and I released the &ldquo;Ask&rdquo; post module (which I had failed to publish). This module very simply uses the ShellExecute windows function.aspx&rdquo;) via Railgun with the undocumented (but very well known) operator of &lsquo;runas&rsquo;. These two lines accomplished that:
client.railgun.add_function( 'shell32', 'ShellExecuteA', 'DWORD',[[&quot;DWORD&quot;,&quot;hwnd&quot;,&quot;in&quot;],[&quot;PCHAR&quot;,&quot;lpOperation&quot;,&quot;in&quot;],[&quot;PCHAR&quot;,&quot;lpFile&quot;,&quot;in&quot;],[&quot;PCHAR&quot;,&quot;lpParameters&quot;,&quot;in&quot;],[&quot;PCHAR&quot;,&quot;lpDirectory&quot;,&quot;in&quot;],[&quot;DWORD&quot;,&quot;nShowCmd&quot;,&quot;in&quot;],]) client.railgun.shell32.ShellExecuteA(nil,&quot;runas&quot;,&quot;evil.exe&quot;,nil,nil,5)  This would quite simply prompt the user with that annoying UAC prompt asking the user to run &lsquo;evil.</p></div>
						<div class="post-list-footer text-center">
							<a href="https://malicious.link/post/2012/2012-01-03-uac-user-assisted-compromise/">Read More</a>
						</div>
					</div>
				</li>
			
				<li>
					<div class="post-list-item">
						<div class="post-header">
							<h4 class="post-link"><a href="https://malicious.link/post/2011/2011-08-19-ip-resolution-using-meterpreters-railgun/">IP Resolution Using Meterpreterâ€™s Railgun</a></h4>
							<h4 class="post-date">Aug 19, 2011</h4>
						</div>
						<div class="post-summary"><p>I saw a post back in June and it just recently came up again:
http://www.securityartwork.es/2011/06/01/dns-port-forwarding-con-meterpreter/
It looked like a lot of hard work to set that up and I&rsquo;m really lazy. I didn&rsquo;t want to have to go through all that every time I got onto a new network. So, I made a very simple meterpreter post module to just call a Windows API key called &lsquo;gethostbyaddr&rsquo; using Railgun.
TL:DR; You can download the post module here: ipresolver.</p></div>
						<div class="post-list-footer text-center">
							<a href="https://malicious.link/post/2011/2011-08-19-ip-resolution-using-meterpreters-railgun/">Read More</a>
						</div>
					</div>
				</li>
			
				<li>
					<div class="post-list-item">
						<div class="post-header">
							<h4 class="post-link"><a href="https://malicious.link/post/2011/2011-08-19-railgun-error-checking/">Railgun Error Checking</a></h4>
							<h4 class="post-date">Aug 19, 2011</h4>
						</div>
						<div class="post-summary"><p>One important thing to note about Railgun is that you are querying the API and just as if you were using C++ the API you are calling just might not be there on the system you are trying to call it on. So here is a quick trick to find out if a the function (API) that you are trying to call is available to you:
For my example I&rsquo;m using &lsquo;getaddrinfo&rsquo; since it&rsquo;s life in Windows is somewhat odd.</p></div>
						<div class="post-list-footer text-center">
							<a href="https://malicious.link/post/2011/2011-08-19-railgun-error-checking/">Read More</a>
						</div>
					</div>
				</li>
			
				<li>
					<div class="post-list-item">
						<div class="post-header">
							<h4 class="post-link"><a href="https://malicious.link/post/2011/2011-05-30-remote-dll-injection-with-meterpreter/">Remote DLL Injection with Meterpreter</a></h4>
							<h4 class="post-date">May 30, 2011</h4>
						</div>
						<div class="post-summary"><p>Recently Didier Stevens wrote &lsquo;Suspender.dll&rsquo; which is a DLL that will suspend a process and all of it&rsquo;s child processes after a delay. 60 seconds is it&rsquo;s default but you can rename the DLL to add a number (as such &lsquo;Suspender10.dll&rsquo; for 10 seconds) to make the delay whatever you wish. You can find the blog post and download here: http://blog.didierstevens.com/2011/04/27/suspender-dll/
Jonathan Cran and I had the same idea, as I&rsquo;m sure many others did as well.</p></div>
						<div class="post-list-footer text-center">
							<a href="https://malicious.link/post/2011/2011-05-30-remote-dll-injection-with-meterpreter/">Read More</a>
						</div>
					</div>
				</li>
			
				<li>
					<div class="post-list-item">
						<div class="post-header">
							<h4 class="post-link"><a href="https://malicious.link/post/2010/2010-09-13-am-i-an-admin-railgun-script/">Am I an Admin? Railgun Script</a></h4>
							<h4 class="post-date">Sep 13, 2010</h4>
						</div>
						<div class="post-summary"><p>When you first step on a machine, you want to determine quickly if you are just a user or an administrator. Meterpreter doesn&rsquo;t have a way to quickly check this. You could drop to a shell, check the local users group &ldquo;Adminitrators&rdquo;, and check your user, and correlate any groups that are shared between the outputs. You could do &lsquo;getsystem&rsquo; and if one works other than Kitrap0d. You could also just do a &lsquo;ps&rsquo; and notice that you can see &lsquo;SYSTEM&rsquo; processes.</p></div>
						<div class="post-list-footer text-center">
							<a href="https://malicious.link/post/2010/2010-09-13-am-i-an-admin-railgun-script/">Read More</a>
						</div>
					</div>
				</li>
			
				<li>
					<div class="post-list-item">
						<div class="post-header">
							<h4 class="post-link"><a href="https://malicious.link/post/2010/2010-08-03-resources-for-railgun-development/">Resources for railgun development</a></h4>
							<h4 class="post-date">Aug 3, 2010</h4>
						</div>
						<div class="post-summary"><p>Metasploit&rsquo;s Railgun is awesome, but getting things to work correctly can be a pain. Here are some of the resources that have helped me out:
 System Error Codes.aspx&rdquo;) - This is hands down the best resource you have, it will tell you what that stupid &ldquo;5&rdquo; or &ldquo;1314&rdquo; means in your return value. Keep this tab open to circumvent crazed bovine attacks.
 theForger&rsquo;s Win32 API Programming Tutorial - A really good place to start when you are getting to know the Windows API and the frustrations that come along with it.</p></div>
						<div class="post-list-footer text-center">
							<a href="https://malicious.link/post/2010/2010-08-03-resources-for-railgun-development/">Read More</a>
						</div>
					</div>
				</li>
			
				<li>
					<div class="post-list-item">
						<div class="post-header">
							<h4 class="post-link"><a href="https://malicious.link/post/2010/2010-07-08-intro-to-railgun-win-api-for-meterpreter/">Intro to RailGun: WIN API for Meterpreter</a></h4>
							<h4 class="post-date">Jul 8, 2010</h4>
						</div>
						<div class="post-summary"><p>Back on June 13th, &ldquo;Patrick HVE&rdquo; released RAILGUN:
http://mail.metasploit.com/pipermail/framework/2010-June/006382.html
And it was merged into the the Metasploit trunk with 9709, 9710, 9711 and 9712: http://www.metasploit.com/redmine/projects/framework/repository/revisions/9712
Basically what this allows you to do is make Windows API calls from Meterpreter without compiling your own DLL. It currently supports a number of Windows API dlls:
 iphlpapi ws2_32 kernel32 ntdll user32 advapi32  (You can find out exactly what functions are available by default in the api.</p></div>
						<div class="post-list-footer text-center">
							<a href="https://malicious.link/post/2010/2010-07-08-intro-to-railgun-win-api-for-meterpreter/">Read More</a>
						</div>
					</div>
				</li>
			
			</ul>
            



			<div class="push"></div>
		</div>
		<footer class="footer text-center">
<p>Copyright &copy; 2018 Malicious.Link -
<span class="credit">
	Powered by
	<a target="_blank" href="https://gohugo.io">Hugo</a>
	and
	<a target="_blank" href="https://github.com/LordMathis/hugo-theme-nix/">Nix</a> theme.
</span>
</p>
</footer>

	</body>
</html>
