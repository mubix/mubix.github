<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Uac on Room362</title>
    <link>http://localhost:1313/tags/uac/</link>
    <description>Recent content in Uac on Room362</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2016. All rights reserved.</copyright>
    <lastBuildDate>Tue, 30 Oct 2012 20:05:21 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/uac/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>BypassUAC got a facelift</title>
      <link>http://localhost:1313/post/2012/20121030bypassuac-got-a-facelift-html/</link>
      <pubDate>Tue, 30 Oct 2012 20:05:21 +0000</pubDate>
      
      <guid>http://localhost:1313/post/2012/20121030bypassuac-got-a-facelift-html/</guid>
      <description>&lt;p&gt;Dave Kennedy and Kevin Mitnick submitted the &amp;ldquo;bypassuac&amp;rdquo; post module to Metasploit a while back (last DerbyCon?). Which is awesome and they did some fantastic work, but I had a few complaints as probably anyone did who used the module on a somewhat modern network.&lt;/p&gt;

&lt;p&gt;&amp;ldquo;Old&amp;rdquo; module (post/windows/escalate/bypassuac):&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://mubix.files.wordpress.com/2012/10/screen20shot202012-10-3020at203-03-1020pm.png.10%20PM.png&#34; alt=&#34;Screen Shot 2012 10 30 at 3 03 10 PM&#34; /&gt;&lt;/p&gt;

&lt;p&gt;I decided to give it a bit of a face lift:&lt;/p&gt;

&lt;p&gt;&amp;ldquo;New&amp;rdquo; local exploit module (exploit/windows/local/bypassuac):&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://mubix.files.wordpress.com/2012/10/screen20shot202012-10-3020at203-07-1020pm.png.10%20PM.png&#34; alt=&#34;Screen Shot 2012 10 30 at 3 07 10 PM&#34; /&gt;&lt;/p&gt;

&lt;p&gt;All of the credit for the availability of this module goes to &lt;a href=&#34;https://twitter.com/egyp7&#34;&gt;@egyp7&lt;/a&gt; though, without his epic addition of local exploits to Metasploit the majority of the updates to this module wouldn&amp;rsquo;t be possible.&lt;/p&gt;

&lt;p&gt;Anywho, on to the new features:&lt;/p&gt;

&lt;p&gt;1) You can set any windows payload you want to use now:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://mubix.files.wordpress.com/2012/10/screen20shot202012-10-3020at203-38-1920pm.png.19%20PM.png&#34; alt=&#34;Screen Shot 2012 10 30 at 3 38 19 PM&#34; /&gt;&lt;/p&gt;

&lt;p&gt;and yes it supports EXE::Custom.&lt;/p&gt;

&lt;p&gt;2) It lets you know if it will be able to bypass the current setting of UAC or not:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://mubix.files.wordpress.com/2012/10/screen20shot202012-10-3020at203-40-1520pm.png.15%20PM.png&#34; alt=&#34;Screen Shot 2012 10 30 at 3 40 15 PM&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Even when you&amp;rsquo;re going overkill with it:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://mubix.files.wordpress.com/2012/10/screen20shot202012-10-3020at203-41-3120pm.png.31%20PM.png&#34; alt=&#34;Screen Shot 2012 10 30 at 3 41 31 PM&#34; /&gt;&lt;/p&gt;

&lt;p&gt;(ASK module if UAC is disabled will just elevate without any kind of user prompt)&lt;/p&gt;

&lt;p&gt;And of course it works as expected if UAC needs bypassing:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://mubix.files.wordpress.com/2012/10/capture_47.png&#34; alt=&#34;Capture 47&#34; /&gt;&lt;/p&gt;

&lt;p&gt;One thing I have yet to update is a simple check to make sure you are an admin that can actually bypass UAC. If you aren&amp;rsquo;t, then you&amp;rsquo;ll be leaving this lovely calling card behind for the user:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://mubix.files.wordpress.com/2012/10/capture_48.png&#34; alt=&#34;Capture 48&#34; /&gt;&lt;/p&gt;

&lt;p&gt; &lt;/p&gt;

&lt;p&gt; &lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>UAC AlwaysNotify Bypass-ish</title>
      <link>http://localhost:1313/post/2012/20121016uac-alwaysnotify-bypass-ish-html/</link>
      <pubDate>Tue, 16 Oct 2012 03:15:19 +0000</pubDate>
      
      <guid>http://localhost:1313/post/2012/20121016uac-alwaysnotify-bypass-ish-html/</guid>
      <description>&lt;p&gt;&lt;strong&gt;UPDATE: THIS IS ONLY WORKS WITH THE LOCAL ADMIN (ID 500) ACCOUNT AND PASSWORD&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;(MY MISTAKE FOR NOT TESTING MORE)&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;So the &amp;ldquo;-ish&amp;rdquo; is you need to have the username and pass of &lt;del&gt;another account that has administrator rights&lt;/del&gt; the local administrator account on that box. But other than that, the following image should speak for itself. (no UAC prompt occurred during the following actions)&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://mubix.files.wordpress.com/2012/10/screen20shot202012-10-1520at2010-52-3320pm.png.33%20PM.png&#34; alt=&#34;Screen Shot 2012 10 15 at 10 52 33 PM&#34; /&gt;&lt;/p&gt;

&lt;p&gt;I plan on writing a Metasploit module to do this as all it really does is starts a process as a different user and that process executes ShellExecute&amp;rsquo;s &amp;lsquo;RunAs&amp;rsquo; verb. But until then, get CPAU here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.joeware.net/freetools/tools/cpau/&#34;&gt;http://www.joeware.net/freetools/tools/cpau/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;and Elevate here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://jpassing.com/2007/12/08/launch-elevated-processes-from-the-command-line/&#34;&gt;http://jpassing.com/2007/12/08/launch-elevated-processes-from-the-command-line/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt; and doing it manually with built in Windows Kung-Fu:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://mubix.files.wordpress.com/2012/10/screen20shot202012-10-1520at2011-52-4520pm.png.45%20PM.png&#34; alt=&#34;Screen Shot 2012 10 15 at 11 52 45 PM&#34; /&gt;&lt;/p&gt;

&lt;p&gt; &lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>