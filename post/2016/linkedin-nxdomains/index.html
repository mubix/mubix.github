<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <title>
    Linkedin NXDOMAINs - Purchased Pwnage // Room362
  </title>

  <link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="content-type" content="text/html; charset=utf-8">


<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="">
<meta name="generator" content="Hugo 0.16" />

  <meta property="og:title" content="Linkedin NXDOMAINs - Purchased Pwnage" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="https://room362.com/post/2016/linkedin-nxdomains/" />


  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/base-min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/pure-min.css">
  
  
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/grids-responsive-min.css">
  
  

  <link rel="stylesheet" href="https://room362.com//css/redlounge.css">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
  <link href='//fonts.googleapis.com/css?family=Raleway:400,200,100,700,300,500,600,800' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Libre+Baskerville:400,700,400italic' rel='stylesheet' type='text/css'>

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="Room362" />

    
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/styles/tomorrow-night-bright.min.css">
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>


  

  

  

  
</head>

<body>
	

	<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
  <div class="header">
    

	
	  <img src="/images/headshot_small.png" class="sidebarphoto">
	

    <h1 class="brand-title">Room362</h1>
    <h2 class="brand-tagline">Blatherings of a security addict</h2>

    <nav class="nav">
      <ul class="nav-list">
        <li class="nav-item"><span class="nav-item-separator">//</span><a href="https://room362.com/">Home</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="/brandon/">Brandon</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="/about/">About</a></li>
        
      </ul>
    </nav>

    
    <div class="social-buttons">
      
        
        <a href="/index.xml" target="_blank"><i class='fa fa-rss'></i></a>
        
      
        
        <a href="https://linkedin.com/in/mubix" target="_blank"><i class='fa fa-linkedin'></i></a>
        
      
        
        <a href="https://twitter.com/mubix" target="_blank"><i class='fa fa-twitter'></i></a>
        
      
      
    </div>
    

  </div>
</div>

	
	

    <div class="content pure-u-1 pure-u-md-3-4">
		<a name="top"></a>
		

		
			
	    
  		<section class="post">
            <h1 class="post-title">
              <a href="/post/2016/linkedin-nxdomains/">Linkedin NXDOMAINs - Purchased Pwnage</a>
            </h1>
            <h3 class="post-subtitle">
            	
            </h3>
            
            	<span class="post-date">
                	<span class="post-date-day"><sup>17</sup></span><span class="post-date-separator">/</span><span class="post-date-month">Jun</span> <span class="post-date-year">2016</span>
            	</span>
            	
            
            	
            

			
			

			

			

            <p>I recently asked a friend if I could have just a list of the domains in the LinkedIn dump, no passwords, not full emails, just domains. I run a program that I lovingly call &ldquo;DeepMagic&rdquo; and I feed it domains whenever I can. Well, this time when I tossed the list of domains into the engine it started spitting out tons of errors. There was a total of <strong>9,436,804</strong> unique domains names in the list, and for anyone who works with DNS that isn&rsquo;t a very big number, so I didn&rsquo;t think very much of it and didn&rsquo;t know why it would choke on a list that small.</p>

<p>When I looked at the logs I noticed that there was a very large percentage of the domains that were coming up with NXDOMAIN. Most of the time this means that the domain isn&rsquo;t registered, but can also mean that no name servers are registered for the domain (this usually happens when a corporation doesn&rsquo;t want to maintain the domain but still wants to hold onto it for brand management).</p>

<p>I let the resolution keep going and just parsed out all of the NXDOMAINs, but when I saw the list of NXDOMAINs go over 90,000 and I wasn&rsquo;t even out of the &lsquo;A&rsquo;s yet, I took a different approach. I sorted the list by count to find the most used domains (using of course my favorite <code>sort | uniq -c | sort -n</code> that I think everyone who&rsquo;s ever done text parsing on Linux knows).</p>

<p>It lead to a few surprises, first, people still use AOL and earthlink?</p>

<p>Second&hellip; well just look for yourself:</p>

<pre><code>32952409 gmail.com
24071552 hotmail.com
20421035 yahoo.com
4283225 aol.com
1983431 comcast.net
1431727 yahoo.co.in
1337019 msn.com
1041953 sbcglobal.net
1039635 rediffmail.com
995709 yahoo.fr
916458 yahoo.co.uk
845570 live.com
841415 yahoo.com.br
750175 hotmail.co.uk
742597 verizon.net
575381 hotmail.fr
530308 ymail.com
529548 cox.net
510463 bellsouth.net
504339 libero.it
480006 att.net
429760 yahoo.es
407687 btinternet.com
396313 mail.ru
376970 googlemail.com
307292 earthlink.net
304012 mac.com
266076 yahoo.in
262010 yahoo.ca
</code></pre>

<p>I&rsquo;ve never heard of rediffmail, you?</p>

<p>Anyways, I pushed the list in this order into a simple script:</p>

<pre><code class="language-bash">cat domains_count.txt | xargs -P 100 -n 2 sh -c './findnx2.sh $1 $2' argv0 | tee nxdomains.txt
</code></pre>

<p>This is what is in <code>findnx2.sh</code>:</p>

<pre><code class="language-bash">#!/bin/bash
lines=$(nslookup ${2} | grep NXDOMAIN | wc -l)
if [ $lines -eq &quot;1&quot; ]
then
	echo &quot;$2 is open with count $1&quot;
fi
</code></pre>

<p>And out popped a pretty interesting list (top 50):</p>

<p>domain -&gt; number of email accounts registered under that domain (based on number of occurrences of the domain in the unfiltered list):</p>

<pre><code>XXXXXXXXXXX is open with count 7606
hotmail.con is open with count 4367
c2i.net is open with count 3966
yahoo.con is open with count 3487
gmail.con is open with count 3249
90wewhelp.ru is open with count 3218
csupomona.edu is open with count 2844
us.ing.com is open with count 2622
test.linkedin.com is open with count 2583
wowhackgold.com is open with count 2515
yahoo.om is open with count 2461
alltel.net is open with count 6565
w.cn is open with count 2451
uolsinectis.com.ar is open with count 2315
gmail.fr is open with count 2830
gmail.om is open with count 2122
hotmail.cm is open with count 2044
alltel.com is open with count 2046
hotmail.om is open with count 1901
memo.ikea.com is open with count 1809
chicagogsb.edu is open with count 1758
gawab.com is open with count 2141
mscd.edu is open with count 1740
mayalasr.com is open with count 1626
yavvaram.com is open with count 1424
twtelecom.com is open with count 1448
asbada5m.com is open with count 1371
eunet.yu is open with count 1272
camerabuy.info is open with count 1156
mywdo.com is open with count 1275
g.mail.com is open with count 1089
nortelnetworks.com is open with count 1815
infotechsw.com is open with count 1040
saugov.sa.gov.au is open with count 1033
hoyllmail.com is open with count 1028
mn.rr.com is open with count 1029
apollogrp.edu is open with count 980
gemail.com is open with count 1086
v4q.info is open with count 928
hoylmail.com is open with count 915
yahoo.coom is open with count 890
ifrance.com is open with count 917
justafou.com is open with count 886
2008radiochat.info is open with count 879
myclearwave.net is open with count 967
tconl.com is open with count 939
gmail.cim is open with count 849
flykingfisher.com is open with count 866
lycos.co.uk is open with count 1092
pichosti.info is open with count 813
</code></pre>

<p>Basic analysis of this list:</p>

<ol>
<li>I thought that LinkedIn validated sign ups with an email, kinda hard to do with all these domains that are obviously mistyped, unless of course they just keep the database record around indefinitely</li>
<li>XXXXXXXXX is an ISP that went out of business in 2011, their domain is available for register and would probably mean 7606 accounts up for grabs, if not more that&rsquo;s why I redacted it, but I wanted to mention it just to demonstrate how powerful this type of analysis of a hacked site&rsquo;s dump can be. $10 to purchase a domain is much cheaper and more wide spread than cracking time passwords just for LinkedIn (well, one can dream that everyone uses unique passwords).</li>
<li>WoWHackGold was also up for grabs, I picked it up just to see what kind of traffic is still going to it, these guys sold hacked WoW accounts so I don&rsquo;t particularly feel inclined protect their info.</li>
</ol>

<p>What can someone do with this knowledge? Well, all they have to do to reset any of the accounts registered with one of these domains is simply purchase it, set up a catch-all email address and watch the account information roll in. The &ldquo;accounts&rdquo; they would have access to isn&rsquo;t limited to LinkedIn either, could be anything that people use email addresses to sign up for.</p>

<p>/mubix</p>

<p>P.S. I have seen account take-overs of GMail accounts using &ldquo;backup&rdquo; accounts in this way. I assume Google has too since they ask me every so often now to make sure my backup email is correct.</p>

	
			

			
				<div class="tags-list">
					<span class="dark-red">Tags</span><span class="decorative-marker">//</span>
					
	                <a class="post-tag post-tag-linkedin" href="https://room362.com//tags/linkedin">linkedin</a>,
	                
	                <a class="post-tag post-tag-dns" href="https://room362.com//tags/dns">dns</a>,
	                
				</div>
			

			
				<div class="paging">
					<span class="paging-label">More Reading</span>
					
					<div class="paging-newer">
						<span class="dark-red">Newer</span><span class="decorative-marker">//</span>
						<a class="paging-link" href="/post/2016/blackhat-defcon-bsides-talk-picks-2016/">BlackHat/Def Con/BSides Talk Picks for 2016</a>
		            </div>
		            

					
					<div class="paging-older">
						<span class="dark-red">Older</span><span class="decorative-marker">//</span>
			            <a class="paging-link" href="/post/2016/smb-http-auth-capture-via-scf/">SMB/HTTP Auth Capture via SCF File</a>
		            </div>
		            
	            </div>
            
          </section>
          
          	<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;
    if (window.location.hostname == "127.0.0.1")
        return;
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'room362';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
          
        
      <div class="footer">
	<hr class="thin" />
	<div class="pure-menu pure-menu-horizontal pure-menu-open">
		<ul class="footer-menu">
		
			<li><a href="/about">About</a></li>
		
			<li><a href="/post">Blog</a></li>
		
		</ul>
	</div>

	<p>&copy; 2016. All rights reserved.</p>
</div>
    </div>
  </div>
	

	

  
</body>
</html>
