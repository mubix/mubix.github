<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="">
<meta name="description"
    content="If you&#39;ve ever used proxychains to push things through Meterpreter, one of the most annoying things is its &amp;ldquo;hardcoded&amp;rdquo; DNS setting for 4.2.2.2, if the org that you are going after doesn&#39;t allow this out of their network, or if you are trying to resolve an internal asset, you&#39;re SOL. After a ton of googling and annoyed head slams into walls every time I forget where this is I&#39;ve finally decided to make a note of it." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://malicious.link/post/2013/2013-09-10-changing-proxychains-hardcoded-dns-server/" />


<title>
    
    Changing proxychains hardcoded DNS server :: malicious.link  â€” welcome
    
</title>



<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,700|Source+Code+Pro" rel="stylesheet"
    type="text/css">
<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">


<link rel="stylesheet" href="https://malicious.link/scss/main.min.48be1f41dc1d94d27b5663b2b359c895efd7696597f656e57d8f6c0e126c0563.css">



<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="/favicon.ico">
<meta name="theme-color" content="#252627"><meta itemprop="name" content="Changing proxychains hardcoded DNS server">
<meta itemprop="description" content="If you&#39;ve ever used proxychains to push things through Meterpreter, one of the most annoying things is its &ldquo;hardcoded&rdquo; DNS setting for 4.2.2.2, if the org that you are going after doesn&#39;t allow this out of their network, or if you are trying to resolve an internal asset, you&#39;re SOL. After a ton of googling and annoyed head slams into walls every time I forget where this is I&#39;ve finally decided to make a note of it.">
<meta itemprop="datePublished" content="2013-09-10T13:16:39-05:00" />
<meta itemprop="dateModified" content="2013-09-10T13:16:39-05:00" />
<meta itemprop="wordCount" content="234">



<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Changing proxychains hardcoded DNS server"/>
<meta name="twitter:description" content="If you&#39;ve ever used proxychains to push things through Meterpreter, one of the most annoying things is its &ldquo;hardcoded&rdquo; DNS setting for 4.2.2.2, if the org that you are going after doesn&#39;t allow this out of their network, or if you are trying to resolve an internal asset, you&#39;re SOL. After a ton of googling and annoyed head slams into walls every time I forget where this is I&#39;ve finally decided to make a note of it."/>



<meta property="article:section" content="proxychains" />
<meta property="article:section" content="proxy" />
<meta property="article:section" content="dns" />

<meta property="article:published_time" content="2013-09-10 13:16:39 -0500 -0500" />








    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/post/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">boot mubix.kernel</span>
            <span class="logo__cursor"></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://malicious.link/about">About</a></li><li><a href="https://malicious.link/brandon">Brandon</a></li><li><a href="https://malicious.link/post">Posts</a></li><li><a href="https://malicious.link/start">Start</a></li><li><a href="https://malicious.link/tags">Tags</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://malicious.link/post/2013/2013-09-10-changing-proxychains-hardcoded-dns-server/">Changing proxychains hardcoded DNS server</a></h2>

            

            <div class="post-content">
                <p>If you've ever used proxychains to push things through Meterpreter, one of the most annoying things is its &ldquo;hardcoded&rdquo; DNS setting for 4.2.2.2, if the org that you are going after doesn't allow this out of their network, or if you are trying to resolve an internal asset, you're SOL. After a ton of googling and annoyed head slams into walls every time I forget where this is I've finally decided to make a note of it.</p>
<p>There isn't much magic here other than knowing that this file exists, but /bin/proxyresolv is a bash script that calls &ldquo;dig&rdquo; using TCP and the DNS server specified so it goes through the proxychains. Here is what it looks like:
(on Kali linux its found here: /usr/lib/proxychains3/proxyresolv)</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#!/bin/sh
</span><span style="color:#75715e"></span><span style="color:#75715e"># This script is called by proxychains to resolve DNS names</span>
<span style="color:#75715e"># DNS server used to resolve names</span>
DNS_SERVER<span style="color:#f92672">=</span>4.2.2.2

<span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> $# <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span> ; <span style="color:#66d9ef">then</span>
echo <span style="color:#e6db74">&#34; usage:&#34;</span>
echo <span style="color:#e6db74">&#34; proxyresolv &lt;hostname&gt; &#34;</span>
exit
<span style="color:#66d9ef">fi</span>

export LD_PRELOAD<span style="color:#f92672">=</span>libproxychains.so.3
dig $1 @$DNS_SERVER +tcp | awk <span style="color:#e6db74">&#39;/A.+[0-9]+\.[0-9]+\.[0-9]/{print $5;}&#39;</span>
</code></pre></div><p>Now you could just make the dig request yourself through proxychains then throw whatever you originally attended directly at an IP, or you can make the DNS_SERVER change and hardcode your engagement's internal IP, up to you, but now its documented and I'll never have to go searching like crazy again&hellip; as long as I remember that its on someone else's blog.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
  			</div>

        
          <div id="comments" class="thin">
</div>
        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
            <span></span>
            <span> <a href="https://malicious.link/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">

        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
</footer>

            
        </div>

        





<script type="text/javascript" src="https://malicious.link/js/bundle.8a9ebda303dd50ff1cb0c1564c31e4da9d58924b7eef99f4694d22e8f690b6beb7bb0a08dad3bbe459354ed1aaa0d9bed9566c6e5b1b5b0c3e473adcc311cd89.js" integrity="sha512-ip69owPdUP8csMFWTDHk2p1Ykkt&#43;75n0aU0i6PaQtr63uwoI2tO75Fk1TtGqoNm&#43;2VZsblsbWww&#43;RzrcwxHNiQ=="></script>



    </body>
</html>
