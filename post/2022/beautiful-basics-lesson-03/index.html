<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Lessons Learned Lesson 1 Lesson 2 Lesson 3 Lesson 4 Lesson 5 Lesson 6 Lesson 7 Lesson 8 Lesson 9 Lesson 10 Lesson 11 Lesson 3 - Detection Reality People and Honey tokens are THE BEST detective tool you have.
Go buy a Thinkst Canary, they detect me more than any multi-million dollar EDR. Period.
Let me clarify something quickly before I get roasted. I am not saying that EDR (Endpoint Detection and Response) agents don&amp;rsquo;t have a place, it&amp;rsquo;s just that they have taken over for Anti-Virus for being mostly preventative and response oriented." />
<meta name="keywords" content=", beautifulbasics, series" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://malicious.link/post/2022/beautiful-basics-lesson-03/" />


    <title>
        
            Beautiful Basics: Lesson 3 :: malicious.link  â€” welcome
        
    </title>


<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.a6537515292628f292bc89dc1bb6a3480b72f307b458bdd65364ae5b8b20399d.css">






<meta itemprop="name" content="Beautiful Basics: Lesson 3">
<meta itemprop="description" content="Lessons Learned Lesson 1 Lesson 2 Lesson 3 Lesson 4 Lesson 5 Lesson 6 Lesson 7 Lesson 8 Lesson 9 Lesson 10 Lesson 11 Lesson 3 - Detection Reality People and Honey tokens are THE BEST detective tool you have.
Go buy a Thinkst Canary, they detect me more than any multi-million dollar EDR. Period.
Let me clarify something quickly before I get roasted. I am not saying that EDR (Endpoint Detection and Response) agents don&rsquo;t have a place, it&rsquo;s just that they have taken over for Anti-Virus for being mostly preventative and response oriented."><meta itemprop="datePublished" content="2022-05-28T03:00:00-05:00" />
<meta itemprop="dateModified" content="2022-05-28T03:00:00-05:00" />
<meta itemprop="wordCount" content="708">
<meta itemprop="keywords" content="beautifulbasics,series," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Beautiful Basics: Lesson 3"/>
<meta name="twitter:description" content="Lessons Learned Lesson 1 Lesson 2 Lesson 3 Lesson 4 Lesson 5 Lesson 6 Lesson 7 Lesson 8 Lesson 9 Lesson 10 Lesson 11 Lesson 3 - Detection Reality People and Honey tokens are THE BEST detective tool you have.
Go buy a Thinkst Canary, they detect me more than any multi-million dollar EDR. Period.
Let me clarify something quickly before I get roasted. I am not saying that EDR (Endpoint Detection and Response) agents don&rsquo;t have a place, it&rsquo;s just that they have taken over for Anti-Virus for being mostly preventative and response oriented."/>







    <meta property="article:published_time" content="2022-05-28 03:00:00 -0500 -0500" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/post/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">boot mubix.kernel</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://malicious.link/about">About</a></li><li><a href="https://malicious.link/brandon">Brandon</a></li><li><a href="https://malicious.link/post">Posts</a></li><li><a href="https://malicious.link/start">Start</a></li><li><a href="https://malicious.link/tags">Tags</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://malicious.link/post/2022/beautiful-basics-lesson-03/">Beautiful Basics: Lesson 3</a></h2>
            <p>Published: 28 May 2022 - 03:00 -0500</p>

            

            

            <div class="post-content">
                
<h3 id="lessons-learned">Lessons Learned</h3>
<ul>
<li><a href="/post/2022/beautiful-basics-lesson-01">Lesson 1</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-02">Lesson 2</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-03">Lesson 3</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-04">Lesson 4</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-05">Lesson 5</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-06">Lesson 6</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-07">Lesson 7</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-08">Lesson 8</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-09">Lesson 9</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-10">Lesson 10</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-11">Lesson 11</a></li>
</ul>


<h2 id="lesson-3---detection-reality">Lesson 3 - Detection Reality</h2>
<blockquote>
<p>People and Honey tokens are THE BEST detective tool you have.</p>
</blockquote>
<p><em>Go buy a <a href="https://thinkst.com/">Thinkst Canary</a>, they detect me more than any multi-million dollar EDR. Period.</em></p>
<hr>
<p><img src="/images/2022/beautifulbasics_lesson3.png" alt=""></p>
<hr>
<p>Let me clarify something quickly before I get roasted. I am not saying that EDR (Endpoint Detection and Response) agents don&rsquo;t have a place, it&rsquo;s just that they have taken over for Anti-Virus for being mostly preventative and response oriented. Do EDRs detect things? Sure, but in my pentesting and red teaming experience they rarely catch any of the actions I do outside of touching LSASS. Which to be fair, is what a lot of malware and APT actors do. But it won&rsquo;t stay that way, and Sysmon is free :P</p>
<p>One more clarifying statement. I have no affiliation to <a href="https://twitter.com/ThinkstCanary">Thinkst</a> other than knowing <a href="https://twitter.com/haroonmeer">Haroon Meer</a> through Twitter and meeting him once or twice in person, super amazing dude, I think the world of him. I truly think the Canary as a concept is one of the best detective tools we have. If you don&rsquo;t have fake accounts, computers, and configurations that look vulnerable mixed in with your population of systems you are missing out.</p>
<p>Finally lets get to the meat of this lesson. Back in 2018 I made this statement:</p>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Dear %Companies%, A single security minded Sys Admin is worth more than a handful of pentesters. Please start investing in the admins you already have. I say this as a pentester who has seen the impact that an empowered admin can have.</p>&mdash; Rob Fuller (@mubix) <a href="https://twitter.com/mubix/status/1007296914742759424?ref_src=twsrc%5Etfw">June 14, 2018</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>System administrators usually know their systems very well. With the move to DevOps, I&rsquo;m not sure if that is decreasing because systems are more transitory or the monitoring systems have kept pace or improved because of it. But, as a pentester / red teamer I have been caught more times by system administrators than any tool security operations has put in place. I did a talk back in 2014 called <a href="https://www.youtube.com/watch?v=VqcDjPUXPIw">&ldquo;Attacker Ghost Stories&rdquo;</a> [<a href="https://www.slideshare.net/hashdays/attacker-ghost-stories-v8">slides</a>] about exactly this and all of the ways system administrators put tricks and traps in place to catch attackers like me.</p>
<p>What are these tricks? Just to name a few:</p>
<ul>
<li><strong>Trap</strong>: Create a domain administrator that has logon hours all turned off with alerting on any attempt to logon with that user not just sent to an alert or a log server but to PagerDuty. This user had the current, real password in the description. No one should EVER use this account.
<ul>
<li><strong>Benefit</strong>: It&rsquo;s too hard to pass up and logon hours aren&rsquo;t commonly looked at by attackers in the attributes for a user, so not only will the attack fail, you&rsquo;ll have a near instant, high fidelity alert of malicious actions on your network.</li>
<li><strong>Alternatives</strong>: Have an account that is Kerberoastable with a very weak password that doesn&rsquo;t have permission to logon anywhere (you can do this by assigning the user to a computer account that no longer exists). Less risk an attacker will find a way to use the account and still a high fidelity alert (just not as juicy of bait)</li>
</ul>
</li>
<li><strong>Trap</strong>: A fake login portal that looks like it is a corporate VPN or OWA server, this is a very easy way to identify credentials that had already been stolen some other way from your organization.
<ul>
<li><strong>Benefit</strong>: An attacker will attempt to validate credentials they have stolen other ways.</li>
</ul>
</li>
</ul>
<p>This is just two ideas. Go look at the slides for more, or check out OpenCanary - <a href="https://github.com/thinkst/opencanary">https://github.com/thinkst/opencanary</a> - it&rsquo;s an open source version that you can start to play with along with Canary Tokens if you want even less setup - <a href="https://canarytokens.org/generate">https://canarytokens.org/generate</a></p>
<p>You don&rsquo;t have to use any of the Thinkst tools, for that matter you don&rsquo;t need any of the new &ldquo;Deception&rdquo; vendors (** **barf** **) out there. Just sprinkle your network with bait of all kinds (ask your pentester, or look at what your last pentest report &ldquo;found&rdquo; as their steps) and make fake things. It&rsquo;s set-it-and-forget-it. Way easier than implementing 500 security vendors to catch bad in every way possible.</p>

<h4 id="slides">Slides</h4>
<iframe src="https://docs.google.com/presentation/d/e/2PACX-1vQWsIcPGnJ60ROVu3K32uI7Gtg7zciUle7hfZnN5HPrJ1mD38LZWT5x5DQOyd5CpLXt0hL125fKqOQL/embed?start=false&loop=true&delayms=15000" frameborder="0" width="960" height="569" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>
<h4 id="video">Video</h4>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/9yv6SdDtU-Q" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>




            </div>
        </article>

        <hr />

        <div class="post-info">
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://malicious.link/tags/beautifulbasics/">beautifulbasics</a></span>
        <span class="tag"><a href="https://malicious.link/tags/series/">series</a></span>
        
    </p>

            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2023</span>
            
            <span><a href="https://malicious.link/post/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/mubix">mubix</a> - Theme by <a href="https://github.com/rhazdon/">Djordje Atlialp</a></span>
          </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.8cc3758efe48ef82e2eb9a5f317b44c0805353a43762207be6fe8ffb05815cce7a19d37f6bf387c378a3bdfc3029981668d645374a33db4ee3480e15a4bfdc7c.js" integrity="sha512-jMN1jv5I74Li65pfMXtEwIBTU6Q3YiB75v6P&#43;wWBXM56GdN/a/OHw3ijvfwwKZgWaNZFN0oz207jSA4VpL/cfA=="></script>



    </body>
</html>
