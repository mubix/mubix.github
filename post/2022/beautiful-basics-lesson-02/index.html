<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Lessons Learned Lesson 1 Lesson 2 Lesson 3 Lesson 4 Lesson 5 Lesson 6 Lesson 7 Lesson 8 Lesson 9 Lesson 10 Lesson 11 Lesson 2 - Least Privilege No one should have administrative access. All elevated access should be checked out when you need it and checked back in (automatically if possible). Just like UAC. MFA should be required, proximity or push based. And every use of a break glass account should be highly monitored" />
<meta name="keywords" content=", beautifulbasics, series" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://malicious.link/post/2022/beautiful-basics-lesson-02/" />


    <title>
        
            Beautiful Basics: Lesson 2 :: malicious.link  â€” welcome
        
    </title>


<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.a6537515292628f292bc89dc1bb6a3480b72f307b458bdd65364ae5b8b20399d.css">






<meta itemprop="name" content="Beautiful Basics: Lesson 2">
<meta itemprop="description" content="Lessons Learned Lesson 1 Lesson 2 Lesson 3 Lesson 4 Lesson 5 Lesson 6 Lesson 7 Lesson 8 Lesson 9 Lesson 10 Lesson 11 Lesson 2 - Least Privilege No one should have administrative access. All elevated access should be checked out when you need it and checked back in (automatically if possible). Just like UAC. MFA should be required, proximity or push based. And every use of a break glass account should be highly monitored"><meta itemprop="datePublished" content="2022-05-08T02:00:00-05:00" />
<meta itemprop="dateModified" content="2022-05-08T02:00:00-05:00" />
<meta itemprop="wordCount" content="836">
<meta itemprop="keywords" content="beautifulbasics,series," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Beautiful Basics: Lesson 2"/>
<meta name="twitter:description" content="Lessons Learned Lesson 1 Lesson 2 Lesson 3 Lesson 4 Lesson 5 Lesson 6 Lesson 7 Lesson 8 Lesson 9 Lesson 10 Lesson 11 Lesson 2 - Least Privilege No one should have administrative access. All elevated access should be checked out when you need it and checked back in (automatically if possible). Just like UAC. MFA should be required, proximity or push based. And every use of a break glass account should be highly monitored"/>







    <meta property="article:published_time" content="2022-05-08 02:00:00 -0500 -0500" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/post/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">boot mubix.kernel</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://malicious.link/about">About</a></li><li><a href="https://malicious.link/brandon">Brandon</a></li><li><a href="https://malicious.link/post">Posts</a></li><li><a href="https://malicious.link/start">Start</a></li><li><a href="https://malicious.link/tags">Tags</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://malicious.link/post/2022/beautiful-basics-lesson-02/">Beautiful Basics: Lesson 2</a></h2>
            <p>Published: 08 May 2022 - 02:00 -0500</p>

            

            

            <div class="post-content">
                
<h3 id="lessons-learned">Lessons Learned</h3>
<ul>
<li><a href="/post/2022/beautiful-basics-lesson-01">Lesson 1</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-02">Lesson 2</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-03">Lesson 3</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-04">Lesson 4</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-05">Lesson 5</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-06">Lesson 6</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-07">Lesson 7</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-08">Lesson 8</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-09">Lesson 9</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-10">Lesson 10</a></li>
<li><a href="/post/2022/beautiful-basics-lesson-11">Lesson 11</a></li>
</ul>


<h2 id="lesson-2---least-privilege">Lesson 2 - Least Privilege</h2>
<blockquote>
<p><strong>No one</strong> should have administrative access. All elevated access should be <strong>checked out</strong> when you need it and checked back in (automatically if possible). Just like UAC. MFA should be required, proximity or push based. And every use of a break glass account should be highly monitored</p>
</blockquote>
<hr>
<p><img src="/images/2022/beautifulbasics_lesson2.png" alt=""></p>
<hr>
<p>I think &ldquo;Least Privilege&rdquo; has been harped on at least &hellip; you know what, let me wager that you can&rsquo;t find a single infosec or hacking conference from 2000 until now (2022) that doesn&rsquo;t have 4 talks with the words &ldquo;least privilege&rdquo; in the talk. But maybe a handful out of all of those talks tell you how to accomplish such a feat.</p>
<h3 id="the-goal">The Goal</h3>
<p>Lets talk about the goal first though, just-in-time administration. Identity and Access Management (IAM) has tried very hard to steal the &ldquo;Just-In-Time&rdquo; (JIT) terminology from the software development and reverse engineering world but I don&rsquo;t think it has ever stuck. I do however completely agree with it&rsquo;s concepts. JIT Privilege Access Management (JIT PAM, try to say that acronym in a meeting, probably won&rsquo;t end well), is the concept where you get rid of all of the administrative accounts across your entire organization, replacing them with temporary (you only have access to the account for a short amount of time) and even sometimes transitory (the admin account gets deleted after use) administrative accounts. That&rsquo;s the goal, where if you business closes down at 8 PM on a Friday, by 9 PM (for example), there isn&rsquo;t a single administrative account left on your company network.</p>
<h3 id="why-is-this-needed">Why is this needed?</h3>
<p>Right now, in the organization that you work in, can an IT admin use their own administrative account to make a change to your systems or network? Of course, that&rsquo;s their job. We definitely don&rsquo;t want to hinder them from doing their job right?</p>
<p>Here are the problems that this scenario faces:</p>
<ol>
<li>The password for administrative accounts should be much more secure but many times it&rsquo;s not, since it&rsquo;s up to a human to select. They also have to type it in a large number of times a day so we don&rsquo;t want to make it difficult to do so.</li>
<li>The time an administrative user&rsquo;s password is valid for can be weeks, months, years.</li>
<li>An administrative user can forget or simply not know the correct way to log out of sessions with administrative access (this is super common both on web applications and RDP)</li>
<li>Very rarely have I seen a network completely devoid of &ldquo;old&rdquo; or &ldquo;forgotten&rdquo; administrative users. This could be a lack of off-boarding process or just laziness but it&rsquo;s pretty universal.</li>
<li>Where does the administrator write down which systems they are going to access or which actions they are going to perform?</li>
<li>Admins leave all kinds of scripts and saved passwords lying around on systems they only access for short periods of time. We all do this, if we didn&rsquo;t then kiosks in hotels wouldn&rsquo;t need to be wiped between use&hellip; oh yea, they aren&rsquo;t&hellip; you get the point.</li>
</ol>
<p>I can use a vaulting product to take care of #1, #2, and possibly help with #4. I can use Active Directory GPOs to work on #2 and #3 possibly. But there is still no accountability around what actions are being performed or on what systems.</p>
<h3 id="how-do-we-get-there">How do we get there?</h3>
<ol>
<li>Start with pairing down and auditing the list of administrators. Starting with Domain Admins is easy. Narrow it down to just the people who actually truly need that much access.</li>
<li>Now make a generic Domain Admin accounts instead of the personalized ones and vault them. It&rsquo;s ok if the admins each still use just one of those accounts. This is getting them used to the idea that these aren&rsquo;t &ldquo;their&rdquo; accounts and they can&rsquo;t just leave stuff on the desktop or saved passwords.</li>
<li>Make MFA required to check out these generic accounts.</li>
<li>Enable &ldquo;reason&rdquo; fields in your vaulting software (like Hashicorp Vault, CyberArk or Thycotic) and push those logs to your SEIM / logging platform (or better yet, into and admins chat channel that the IR team has access to as well)</li>
<li>Make all profile customization (files on desktops, custom terminal sessions, etc) get deleted once the account is checked back in. (this will require roaming profiles or a way to manage it remotely)</li>
<li>Now start doing that for each and every administrative group / accounts, cloud, network infrastructure, virtualization platforms, databases, etc.</li>
</ol>
<p>Eventually you&rsquo;ll get to a place where it&rsquo;s normal for people to check out accounts and have it log why they are doing so, then <strong>everything access privilege that account has is revoked</strong> and the password is automatically rotated and randomized. You can even get to the point where they have to specify the servers they need to access and it only gives them access to just those servers.</p>

<h4 id="slides">Slides</h4>
<iframe src="https://docs.google.com/presentation/d/e/2PACX-1vQWsIcPGnJ60ROVu3K32uI7Gtg7zciUle7hfZnN5HPrJ1mD38LZWT5x5DQOyd5CpLXt0hL125fKqOQL/embed?start=false&loop=true&delayms=15000" frameborder="0" width="960" height="569" allowfullscreen="true" mozallowfullscreen="true" webkitallowfullscreen="true"></iframe>
<h4 id="video">Video</h4>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/9yv6SdDtU-Q" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>




            </div>
        </article>

        <hr />

        <div class="post-info">
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://malicious.link/tags/beautifulbasics/">beautifulbasics</a></span>
        <span class="tag"><a href="https://malicious.link/tags/series/">series</a></span>
        
    </p>

            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2023</span>
            
            <span><a href="https://malicious.link/post/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/mubix">mubix</a> - Theme by <a href="https://github.com/rhazdon/">Djordje Atlialp</a></span>
          </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.8cc3758efe48ef82e2eb9a5f317b44c0805353a43762207be6fe8ffb05815cce7a19d37f6bf387c378a3bdfc3029981668d645374a33db4ee3480e15a4bfdc7c.js" integrity="sha512-jMN1jv5I74Li65pfMXtEwIBTU6Q3YiB75v6P&#43;wWBXM56GdN/a/OHw3ijvfwwKZgWaNZFN0oz207jSA4VpL/cfA=="></script>



    </body>
</html>
