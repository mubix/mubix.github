<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <title>
    Post Exploitation with PhantomJS // Room362
  </title>

  <link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="content-type" content="text/html; charset=utf-8">


<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="mubix">
<meta name="generator" content="Hugo 0.17" />

  <meta property="og:title" content="Post Exploitation with PhantomJS" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="https://room362.com/post/2012/2012-05-25-post-exploitation-with-phantomjs/" />


  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/base-min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/pure-min.css">
  
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/grids-responsive-min.css">
  
  

  <link rel="stylesheet" href="https://room362.com//css/redlounge.css">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
  <link href='//fonts.googleapis.com/css?family=Raleway:400,200,100,700,300,500,600,800' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Libre+Baskerville:400,700,400italic' rel='stylesheet' type='text/css'>

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="" rel="alternate" type="application/rss+xml" title="Room362" />

    
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/styles/tomorrow-night-bright.min.css">
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>


  

  

  
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', "UA-198967-1", 'auto');
  ga('send', 'pageview');
</script>

</head>

<body>
	

	<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
  <div class="header">
    

	
	  <img src="/images/headshot_small.png" class="sidebarphoto">
	

    <h1 class="brand-title">Room362</h1>
    <h2 class="brand-tagline">Blatherings of a security addict</h2>

    <nav class="nav">
      <ul class="nav-list">
        <li class="nav-item"><span class="nav-item-separator">//</span><a href="https://room362.com/">Home</a></li><br>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="/brandon/">Brandon</a></li><br>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="/about/">About</a></li><br>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="/start/">Start in Infosec</a></li><br>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="/projects/">Projects</a></li><br>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="http://pwnwiki.io">PwnWiki</a></li><br>
        
      </ul>
    </nav>

    
    <div class="social-buttons">
      
        
        <a href="/index.xml" target="_blank"><i class='fa fa-rss'></i></a>
        
      
        
        <a href="https://linkedin.com/in/mubix" target="_blank"><i class='fa fa-linkedin'></i></a>
        
      
        
        <a href="https://twitter.com/mubix" target="_blank"><i class='fa fa-twitter'></i></a>
        
      
      
    </div>
    
    <br>
    <h2 class="brand-tagline">Support Me</h2>
    <nav class="nav">
      <ul class="nav-list">
        <li class="nav-item"><span class="nav-item-separator">//</span><a href="https://paypal.me/mubix/10">Paypal Donation</a></li><br>
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="https://patreon.com/mubix">Patreon Subscription</a></li>
      </ul>
    </nav>

  </div>
</div>

	
	

    <div class="content pure-u-1 pure-u-md-3-4">
		<a name="top"></a>
		

		
			
	    
  		<section class="post">
            <h1 class="post-title">
              <a href="/post/2012/2012-05-25-post-exploitation-with-phantomjs/">Post Exploitation with PhantomJS</a>
            </h1>
            <h3 class="post-subtitle">
            	
            </h3>
            
            	<span class="post-date">
                	<span class="post-date-day"><sup>25</sup></span><span class="post-date-separator">/</span><span class="post-date-month">May</span> <span class="post-date-year">2012</span>
            	</span>
            	
            
            	
            		<span class="post-author-single">By <a class="post-author"  target="">mubix</a></span>
            		




            	
            

			
			
				<div class="post-categories">
				
					<a class="post-category post-category-post-exploitation" href="https://room362.com//categories/post-exploitation">post exploitation</a>
				
					<a class="post-category post-category-phantomjs" href="https://room362.com//categories/phantomjs">phantomjs</a>
				
					<a class="post-category post-category-web" href="https://room362.com//categories/web">web</a>
				
				</div>
			

			

			

            <p>If you have never heard of PhantomJS ( <a href="http://phantomjs.org/">http://phantomjs.org/</a> ) before, it&rsquo;s a &ldquo;Full Web Stack with No Browser Required&rdquo;, basically it a GUI-less browser. One of the magical &ldquo;example&rdquo; files that it has is called &ldquo;rasterize.js&rdquo;</p>

<p>Rasterize.JS essentially renders a URL, screen shots it and give it to you in a number of different formats, here&rsquo;s it&rsquo;s usage:</p>

<pre><code>Usage: rasterize.js URL filename [paperwidth*paperheight|paperformat]
 paper (pdf output) examples: &quot;5in*7.5in&quot;, &quot;10cm*20cm&quot;, &quot;A4&quot;, &quot;Letter&quot;
</code></pre>

<p>PhantomJS is sweet for sweeping a ton of IPs and suspected HTTP/S sites, and look through a gallery of them to start figuring out which looks the most interestingâ€¦ and we are going to essentially just that, except from a Victim machine.</p>

<p>First, download the Win32 static bins for PhantomJS from: <a href="http://code.google.com/p/phantomjs/downloads/list">http://code.google.com/p/phantomjs/downloads/list</a></p>

<p>Pull out phantomJS.exe and rasterize.js from the zip, and upload it to your victim.</p>

<p>Make a special directory for your renderings (I use imgs), this also makes it easy for meterpreter to download it since meterpreter supports directories and download targets.</p>

<p>Now make a BAT file with the following in it:</p>

<pre><code>FOR /F &quot;skip=3 delims= &quot; %%A IN ('NET VIEW') DO start /b phantomjs.exe examplesrasterize.js http://%%A imgshttp_%%A.png
FOR /F &quot;skip=3 delims= &quot; %%A IN ('NET VIEW') DO start /b phantomjs.exe --ignore-ssl-errors=yes examplesrasterize.js https://%%A imgshttps_%%A.png
</code></pre>

<p>There are some cool tricks in here. First we are using &lsquo;net view&rsquo; as our target list, we are using the &lsquo;start /b&rsquo; command to throw everything into the background to run so we don&rsquo;t have to wait for each to finish (a crude way to thread actions in BAT files). And finally we are checking for both HTTP and HTTPS. We we are not doing however is doing any logging, so if you want to catch errors it&rsquo;s all you, just remember that when trying to pipe output from a command started with &lsquo;start&rsquo; you have to prefix the &gt; with a ^ so it looks like:</p>

<p><code>start echo blah ^&gt; blah.txt</code></p>

<p>You are ALMOST ready to rock. There is a slight bug in Rasterize.js, if it can&rsquo;t resolve the address or otherwise can&rsquo;t contact the web server (which is going to be the majority of the case for us) it hangs in an open state. This is bad, we don&rsquo;t want to have a thousand phantomjs.exe processes running hanged. Simply make a new line after LINE 20, and add &lsquo;phantom.exit();&rsquo; so it knows to exit if it encounters a failed connection.</p>

<p>Thats it, happy hunting from both inside and outside.</p>

<p>P.S. PhantomJS supports SOCKS and HTTP proxies, so if you use them (Tor) or run into them internally, support is there. A quick mod to your batch file and you&rsquo;re golden:</p>

<pre><code>--proxy=address:port Sets the network proxy (e.g. &quot;--proxy=192.168.1.42:8080&quot;)  
--proxy-auth=username:password Sets authentication details for the proxy (basic auth)  
--proxy-type=[http|socks5] Sets the proxy type, either &quot;http&quot; (default) or &quot;socks5&quot;
</code></pre>

	
			

			

			
				<div class="paging">
					<span class="paging-label">More Reading</span>
					
					<div class="paging-newer">
						<span class="dark-red">Newer</span><span class="decorative-marker">//</span>
						<a class="paging-link" href="/post/2012/2012-05-26-sudoers-commented-includes-used-for-evil/">SUDOERS Commented Includes used for Evil</a>
		            </div>
		            

					
					<div class="paging-older">
						<span class="dark-red">Older</span><span class="decorative-marker">//</span>
			            <a class="paging-link" href="/post/2012/2012-05-24-sticky-keys-and-utilman-against-nla/">Sticky Keys and Utilman against NLA</a>
		            </div>
		            
	            </div>
            
          </section>
          
          	<div id="disqus_thread"></div>
<script type="text/javascript">

(function() {
    
    
    if (window.location.hostname == "localhost")
        return;
    if (window.location.hostname == "127.0.0.1")
        return;
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    var disqus_shortname = 'room362';
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
          
        
      <div class="footer">
	<hr class="thin" />
	<div class="pure-menu pure-menu-horizontal pure-menu-open">
		<ul class="footer-menu">
		
			<li><a href="/about">About</a></li>
		
			<li><a href="/post">Blog</a></li>
		
		</ul>
	</div>

	<p>&copy; 2017. All rights reserved.</p>
</div>
    </div>
  </div>
	

	

  
</body>
</html>
