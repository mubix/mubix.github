<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>Sessiondump Meterpreter Extension - Malicious Link - Blog by mubix - Rob Fuller</title><meta name="Description" content="This is a cool blog"><meta property="og:title" content="Sessiondump Meterpreter Extension" />
<meta property="og:description" content="Mimikatz is awesome right, so is WCE. But both have one fatal flaw, even though you can execute them in memory {link} - you still have to have the binaries, remember the command to execute it in memory, and ultimately transfer the entire binary over so that metasploit can do its thing.
Then along came SessionDump. I only noticed this because someone was tweeting congratulations to someone on writing it:" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://malicious.link/posts/2013/2013-04-08-sessiondump-meterpreter-extension/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2013-04-08T09:58:20+00:00" />
<meta property="article:modified_time" content="2013-04-08T09:58:20+00:00" /><meta property="og:site_name" content="My cool site" />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Sessiondump Meterpreter Extension"/>
<meta name="twitter:description" content="Mimikatz is awesome right, so is WCE. But both have one fatal flaw, even though you can execute them in memory {link} - you still have to have the binaries, remember the command to execute it in memory, and ultimately transfer the entire binary over so that metasploit can do its thing.
Then along came SessionDump. I only noticed this because someone was tweeting congratulations to someone on writing it:"/>
<meta name="application-name" content="malicious.link">
<meta name="apple-mobile-web-app-title" content="malicious.link"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://malicious.link/posts/2013/2013-04-08-sessiondump-meterpreter-extension/" /><link rel="prev" href="https://malicious.link/posts/2013/2013-03-19-metasploit-mastery-blackhatevents-usa-2013/" /><link rel="next" href="https://malicious.link/posts/2013/2013-05-30-query-all-windows-services-config-from-the-command-line-html/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Sessiondump Meterpreter Extension",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/malicious.link\/posts\/2013\/2013-04-08-sessiondump-meterpreter-extension\/"
        },"genre": "posts","wordcount":  588 ,
        "url": "https:\/\/malicious.link\/posts\/2013\/2013-04-08-sessiondump-meterpreter-extension\/","datePublished": "2013-04-08T09:58:20+00:00","dateModified": "2013-04-08T09:58:20+00:00","publisher": {
            "@type": "Organization",
            "name": ""},"author": {
                "@type": "Person",
                "name": "mubix"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('dark' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'dark' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Malicious Link - Blog by mubix - Rob Fuller"># malicious.link</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/about"> About </a><a class="menu-item" href="/brandon"> Brandon </a><a class="menu-item" href="/categories"> Categories </a><a class="menu-item" href="/posts"> Posts </a><a class="menu-item" href="/start"> Start </a><a class="menu-item" href="/tags"> Tags </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a></div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Malicious Link - Blog by mubix - Rob Fuller"># malicious.link</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/about" title="">About</a><a class="menu-item" href="/brandon" title="">Brandon</a><a class="menu-item" href="/categories" title="">Categories</a><a class="menu-item" href="/posts" title="">Posts</a><a class="menu-item" href="/start" title="">Start</a><a class="menu-item" href="/tags" title="">Tags</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Sessiondump Meterpreter Extension</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://twitter.com/mubix" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>mubix</a></span>&nbsp;<span class="post-category">included in <a href="/categories/metasploit/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>metasploit</a>&nbsp;<a href="/categories/meterpreter/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>meterpreter</a>&nbsp;<a href="/categories/mimikatz/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>mimikatz</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2013-04-08">2013-04-08</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;588 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;3 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents"></nav></div>
            </div><div class="content" id="content"><p>Mimikatz is awesome right, so is WCE. But both have one fatal flaw, even though you can execute them in memory <a href="/blog/2012/9/6/completely-in-memory-mimikatz-with-metasploit.html" rel="">{link}</a> - you still have to have the binaries, remember the command to execute it in memory, and ultimately transfer the entire binary over so that metasploit can do its thing.</p>
<p>Then along came SessionDump. I only noticed this because someone was tweeting congratulations to someone on writing it:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/postimages/201304_sessiondump_1.png"
        data-srcset="/images/postimages/201304_sessiondump_1.png, /images/postimages/201304_sessiondump_1.png 1.5x, /images/postimages/201304_sessiondump_1.png 2x"
        data-sizes="auto"
        alt="/images/postimages/201304_sessiondump_1.png"
        title="/images/postimages/201304_sessiondump_1.png" /></p>
<p>No blog post or huge Vegas lights talk on it at DefCon or Blackhat. Just posted online in a corner of the Internet:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/postimages/201304_sessiondump_2.png"
        data-srcset="/images/postimages/201304_sessiondump_2.png, /images/postimages/201304_sessiondump_2.png 1.5x, /images/postimages/201304_sessiondump_2.png 2x"
        data-sizes="auto"
        alt="/images/postimages/201304_sessiondump_2.png"
        title="/images/postimages/201304_sessiondump_2.png" /></p>
<p><a href="http://www.hsc.fr/ressources/outils/sessiondump/" target="_blank" rel="noopener noreffer ">http://www.hsc.fr/ressources/outils/sessiondump/</a></p>
<p>Before we get started lets be clear about one thing. Sessiondump while awesome doesn&rsquo;t do everything that Mimikatz does. However, it does do the feature of mimikatz that I do use the most, the logged on user hash dumping as well as the wdigest clear text password dumping. It does this as a Meterpreter extension that operates using reflective DLL injection. Does that solve our minor issues we had with mimikatz, as of right now, only partially. This code was simply posted online, not in a pull request or submitted to Metasploit in any way. So you still have to have the binary + code. What about the remembering, surely it makes it so I can just tab complete my way to passwords right? Yup, it does, but until/if it is in the Metasploit trunk you will still have to remember how to get it installed (which we will go over in a bit). The final question is yes it does still transfer a complete DLL over to the host same as any of the other extensions (not to disk mind you, just memory),.</p>
<p>Without further ado lets go ahead and get the file and do a bunch of extracting. </p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/postimages/201304_sessiondump_3.png"
        data-srcset="/images/postimages/201304_sessiondump_3.png, /images/postimages/201304_sessiondump_3.png 1.5x, /images/postimages/201304_sessiondump_3.png 2x"
        data-sizes="auto"
        alt="/images/postimages/201304_sessiondump_3.png"
        title="/images/postimages/201304_sessiondump_3.png" /></p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/postimages/201304_sessiondump_4.png"
        data-srcset="/images/postimages/201304_sessiondump_4.png, /images/postimages/201304_sessiondump_4.png 1.5x, /images/postimages/201304_sessiondump_4.png 2x"
        data-sizes="auto"
        alt="/images/postimages/201304_sessiondump_4.png"
        title="/images/postimages/201304_sessiondump_4.png" /></p>
<p>And finally placing everything in it&rsquo;s correct place, which was nice of the author to make easy by making the archive the same as the Metasploit directory structure:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/postimages/201304_sessiondump_5.png"
        data-srcset="/images/postimages/201304_sessiondump_5.png, /images/postimages/201304_sessiondump_5.png 1.5x, /images/postimages/201304_sessiondump_5.png 2x"
        data-sizes="auto"
        alt="/images/postimages/201304_sessiondump_5.png"
        title="/images/postimages/201304_sessiondump_5.png" /></p>
<p>Cool, everything should be good to go. Lets use this thing. I&rsquo;m using psexec to get a shell but any way you get a windows native meterpreter fine, with one caveat, and its the same as with any of the other aforementioned tools. You need to be Admin (past UAC, w/ SeDebug privilege) or NT\AUTHORITY SYSTEM.  After that it&rsquo;s cake, load the extension:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/postimages/201304_sessiondump_6.png"
        data-srcset="/images/postimages/201304_sessiondump_6.png, /images/postimages/201304_sessiondump_6.png 1.5x, /images/postimages/201304_sessiondump_6.png 2x"
        data-sizes="auto"
        alt="/images/postimages/201304_sessiondump_6.png"
        title="/images/postimages/201304_sessiondump_6.png" /></p>
<p>Here is the available commands:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/postimages/201304_sessiondump_7.png"
        data-srcset="/images/postimages/201304_sessiondump_7.png, /images/postimages/201304_sessiondump_7.png 1.5x, /images/postimages/201304_sessiondump_7.png 2x"
        data-sizes="auto"
        alt="/images/postimages/201304_sessiondump_7.png"
        title="/images/postimages/201304_sessiondump_7.png" /></p>
<p>And run getHashes:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/postimages/201304_sessiondump_8.png"
        data-srcset="/images/postimages/201304_sessiondump_8.png, /images/postimages/201304_sessiondump_8.png 1.5x, /images/postimages/201304_sessiondump_8.png 2x"
        data-sizes="auto"
        alt="/images/postimages/201304_sessiondump_8.png"
        title="/images/postimages/201304_sessiondump_8.png" /></p>
<p>or getwDigestPasswords:</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/postimages/201304_sessiondump_9.png"
        data-srcset="/images/postimages/201304_sessiondump_9.png, /images/postimages/201304_sessiondump_9.png 1.5x, /images/postimages/201304_sessiondump_9.png 2x"
        data-sizes="auto"
        alt="/images/postimages/201304_sessiondump_9.png"
        title="/images/postimages/201304_sessiondump_9.png" /></p>
<p>Thats is, you free passwords, YAY&hellip;</p>
<p>Possible issues you may run into:</p>
<ul>
<li>If you are on a x64 box and meterpreter isn&rsquo;t running in a x64 process it will fail saying that it doesn&rsquo;t have the correct version offsets, here is how you can check:</li>
</ul>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/postimages/201304_sessiondump_10.png"
        data-srcset="/images/postimages/201304_sessiondump_10.png, /images/postimages/201304_sessiondump_10.png 1.5x, /images/postimages/201304_sessiondump_10.png 2x"
        data-sizes="auto"
        alt="/images/postimages/201304_sessiondump_10.png"
        title="/images/postimages/201304_sessiondump_10.png" /></p>
<p>x64 system and Meterpreter is x86/win32. Lets find a good process to migrate into and kick it from there. Winlogon isn&rsquo;t the greatest choices since if meterpreter decides to crash it during migration then the system will go down, whereas a service running as SYSTEM will probably just restart if something fails.</p>
<p><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/images/postimages/201304_sessiondump_11.png"
        data-srcset="/images/postimages/201304_sessiondump_11.png, /images/postimages/201304_sessiondump_11.png 1.5x, /images/postimages/201304_sessiondump_11.png 2x"
        data-sizes="auto"
        alt="/images/postimages/201304_sessiondump_11.png"
        title="/images/postimages/201304_sessiondump_11.png" /></p>
<ul>
<li>If by any chance you are running it against a system the author hasn&rsquo;t gotten the offsets for. I don&rsquo;t&rsquo; have a screenshot for this one because he covers all the languages I have CMs for, but the author was awesome enough to include a few python scripts that can help you generate the correct offsets. I&rsquo;ll show you by running it on my lsass and widgets.dll files even though he already has this data included in the CSV file that comes with session dump.</li>
</ul>
<p>Thats all for now folks, may the shells be with you.</p>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2013-04-08</span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://malicious.link/posts/2013/2013-04-08-sessiondump-meterpreter-extension/" data-title="Sessiondump Meterpreter Extension" data-via="mubix"><i class="fab fa-twitter fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://malicious.link/posts/2013/2013-04-08-sessiondump-meterpreter-extension/"><i class="fab fa-facebook-square fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://malicious.link/posts/2013/2013-04-08-sessiondump-meterpreter-extension/"><i class="fab fa-linkedin fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Hacker News" data-sharer="hackernews" data-url="https://malicious.link/posts/2013/2013-04-08-sessiondump-meterpreter-extension/" data-title="Sessiondump Meterpreter Extension"><i class="fab fa-hacker-news fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Reddit" data-sharer="reddit" data-url="https://malicious.link/posts/2013/2013-04-08-sessiondump-meterpreter-extension/"><i class="fab fa-reddit fa-fw" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Line" data-sharer="line" data-url="https://malicious.link/posts/2013/2013-04-08-sessiondump-meterpreter-extension/" data-title="Sessiondump Meterpreter Extension"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg" aria-hidden="true"></i></a><a href="javascript:void(0);" title="Share on Evernote" data-sharer="evernote" data-url="https://malicious.link/posts/2013/2013-04-08-sessiondump-meterpreter-extension/" data-title="Sessiondump Meterpreter Extension"><i class="fab fa-evernote fa-fw" aria-hidden="true"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/posts/2013/2013-03-19-metasploit-mastery-blackhatevents-usa-2013/" class="prev" rel="prev" title="Metasploit Mastery @BlackHatEvents USA 2013"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>Metasploit Mastery @BlackHatEvents USA 2013</a>
            <a href="/posts/2013/2013-05-30-query-all-windows-services-config-from-the-command-line-html/" class="next" rel="next" title="Query all windows services config from the command line">Query all windows services config from the command line<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
</article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2005 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://twitter.com/mubix" target="_blank">Rob Fuller</a></span>&nbsp;|&nbsp;<span class="license">All Rights Reserved</span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lunr@2.3.9/lunr.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":100},"comment":{},"search":{"highlightTag":"em","lunrIndexURL":"/index.json","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"lunr"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
