<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="mubix">
<meta name="description" content="Certainly nothing to fuss over, but I&#39;ve had a fascination with setting my target&#39;s wallpaper as sort of a calling card for years now. I&#39;ve been able to set the registry key (HKCUControl PanelDesktopWallpaper), but until recently I didn&#39;t know how to get it to refresh so that it displayed without forcing the user to log out&amp;hellip;
First, is the most important part, selection of the wallpaper. This is my first selection:" />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://malicious.link/post/2010/2010-06-28-set-wallpaper-meterpreter-script/" />


    <title>
        
            Set Wallpaper Meterpreter Script :: malicious.link  â€” welcome
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.5dcefbf8102eb536dd3e2de53ffebfa58599ab2435c241a0db81728a5e015f2e.css">




<meta itemprop="name" content="Set Wallpaper Meterpreter Script">
<meta itemprop="description" content="Certainly nothing to fuss over, but I&#39;ve had a fascination with setting my target&#39;s wallpaper as sort of a calling card for years now. I&#39;ve been able to set the registry key (HKCUControl PanelDesktopWallpaper), but until recently I didn&#39;t know how to get it to refresh so that it displayed without forcing the user to log out&hellip;
First, is the most important part, selection of the wallpaper. This is my first selection:">
<meta itemprop="datePublished" content="2010-06-28T20:34:43&#43;00:00" />
<meta itemprop="dateModified" content="2010-06-28T20:34:43&#43;00:00" />
<meta itemprop="wordCount" content="212">



<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Set Wallpaper Meterpreter Script"/>
<meta name="twitter:description" content="Certainly nothing to fuss over, but I&#39;ve had a fascination with setting my target&#39;s wallpaper as sort of a calling card for years now. I&#39;ve been able to set the registry key (HKCUControl PanelDesktopWallpaper), but until recently I didn&#39;t know how to get it to refresh so that it displayed without forcing the user to log out&hellip;
First, is the most important part, selection of the wallpaper. This is my first selection:"/>



    <meta property="article:section" content="metasploit" />

    <meta property="article:section" content="meterpreter" />

    <meta property="article:section" content="script" />



    <meta property="article:published_time" content="2010-06-28 20:34:43 &#43;0000 &#43;0000" />








    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/post/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">boot mubix.kernel</span>
            <span class="logo__cursor" style=""></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://malicious.link/about">About</a></li><li><a href="https://malicious.link/brandon">Brandon</a></li><li><a href="https://malicious.link/post">Posts</a></li><li><a href="https://malicious.link/start">Start</a></li><li><a href="https://malicious.link/tags">Tags</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://malicious.link/post/2010/2010-06-28-set-wallpaper-meterpreter-script/">Set Wallpaper Meterpreter Script</a></h2>

            

            <div class="post-content">
                <p>Certainly nothing to fuss over, but I've had a fascination with setting my target's wallpaper as sort of a calling card for years now. I've been able to set the registry key (HKCUControl PanelDesktopWallpaper), but until recently I didn't know how to get it to refresh so that it displayed without forcing the user to log out&hellip;</p>
<p>First, is the most important part, selection of the wallpaper. This is my first selection:</p>
<p><img src="/images/postimages/201006_wallpaper_1.jpg" alt=""></p>
<p>But, it has to be a BMP. So, I created:</p>
<p><a href="/images/metasploit_1024.bmp">metasploit_1024.bmp</a> (2.3 MB)</p>
<p>next run:</p>
<pre><code>reg add &quot;HKCU\Control Panel\Desktop&quot; /v Wallpaper /t REG_MULTI_SZ /d &quot;C:\metasploit_1024.bmp&quot;
</code></pre><p>and finally the magic:</p>
<p><code>rundll32.exe user32.dll,UpdatePerUserSystemParameters</code></p>
<p>thats it, run that, and it'll refresh the settings and display the wallpaper in all of it's glory. But I wouldn't be a metasploit dog if I didn't make it into a meterpreter script:</p>
<p>download: <a href="https://github.com/mubix/stuff/blob/master/metasploit/wallpaper.rb">wallpaper.rb</a></p>
<p>it's definitely not ready to be in the trunk, but it works, just edit each of the options in the file to point at the bmp you want on the victim's wallpaper and it'll be there.</p>
<p>Todo:</p>
<ol>
<li>Make each parameter an option so there is no text editing involved</li>
<li>Add the ability to convert other image types on the fly</li>
<li>Figure out how to get the desktop color to refresh with the wallpaper</li>
</ol>

            </div>
        </article>

        <hr />

        <div class="post-info">
  			</div>

        
          <div id="comments" class="thin">
</div>
        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
            <span></span>
            <span> <a href="https://malicious.link/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">rhazdon</a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.2d5469329143160ae2456a69c3c76dc2d0a3b212b46afe291a51bd68650ed6f8697e001dab54f1c272c77ce08092a8c55e5bb4314e0ee334aab4b927ec896638.js" integrity="sha512-LVRpMpFDFgriRWppw8dtwtCjshK0av4pGlG9aGUO1vhpfgAdq1TxwnLHfOCAkqjFXlu0MU4O4zSqtLkn7IlmOA=="></script>



    </body>
</html>
