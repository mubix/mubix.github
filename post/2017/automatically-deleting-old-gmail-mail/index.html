<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="">
<meta name="description" content="Like many of you I&amp;rsquo;m a gmail hoarder. I never deleting anything, just &amp;ldquo;archive&amp;rdquo; everything. I &amp;ldquo;might&amp;rdquo; need it later, or &amp;ldquo;I&amp;rsquo;ll get to it when I have time&amp;rdquo;. If we get really honest with ourselves, we never will actually get to it, and because we have this buffer, this procrastination opportunity, we grab it. We use words like &amp;ldquo;but I may need proof of X&amp;rdquo;, or &amp;ldquo;I could need to reference this&amp;rdquo;, or &amp;ldquo;I don&amp;rsquo;t really want to put this person in my contacts so I&amp;rsquo;ll just save the email&amp;rdquo;." />
<meta name="keywords" content=", gmail, scripting, cleanup" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://malicious.link/post/2017/automatically-deleting-old-gmail-mail/" />


    <title>
        
            Automatically deleting old Gmail email :: malicious.link  â€” welcome
        
    </title>


<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.a6537515292628f292bc89dc1bb6a3480b72f307b458bdd65364ae5b8b20399d.css">






<meta itemprop="name" content="Automatically deleting old Gmail email">
<meta itemprop="description" content="Like many of you I&rsquo;m a gmail hoarder. I never deleting anything, just &ldquo;archive&rdquo; everything. I &ldquo;might&rdquo; need it later, or &ldquo;I&rsquo;ll get to it when I have time&rdquo;. If we get really honest with ourselves, we never will actually get to it, and because we have this buffer, this procrastination opportunity, we grab it. We use words like &ldquo;but I may need proof of X&rdquo;, or &ldquo;I could need to reference this&rdquo;, or &ldquo;I don&rsquo;t really want to put this person in my contacts so I&rsquo;ll just save the email&rdquo;."><meta itemprop="datePublished" content="2017-10-12T11:30:44-05:00" />
<meta itemprop="dateModified" content="2017-10-12T11:30:44-05:00" />
<meta itemprop="wordCount" content="709">
<meta itemprop="keywords" content="gmail,scripting,cleanup," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Automatically deleting old Gmail email"/>
<meta name="twitter:description" content="Like many of you I&rsquo;m a gmail hoarder. I never deleting anything, just &ldquo;archive&rdquo; everything. I &ldquo;might&rdquo; need it later, or &ldquo;I&rsquo;ll get to it when I have time&rdquo;. If we get really honest with ourselves, we never will actually get to it, and because we have this buffer, this procrastination opportunity, we grab it. We use words like &ldquo;but I may need proof of X&rdquo;, or &ldquo;I could need to reference this&rdquo;, or &ldquo;I don&rsquo;t really want to put this person in my contacts so I&rsquo;ll just save the email&rdquo;."/>







    <meta property="article:published_time" content="2017-10-12 11:30:44 -0500 -0500" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/post/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">boot mubix.kernel</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://malicious.link/about">About</a></li><li><a href="https://malicious.link/brandon">Brandon</a></li><li><a href="https://malicious.link/post">Posts</a></li><li><a href="https://malicious.link/start">Start</a></li><li><a href="https://malicious.link/tags">Tags</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://malicious.link/post/2017/automatically-deleting-old-gmail-mail/">Automatically deleting old Gmail email</a></h2>
            <p>Published: 12 Oct 2017 - 11:30 -0500</p>

            

            

            <div class="post-content">
                <p>Like many of you I&rsquo;m a gmail hoarder. I never deleting anything, just &ldquo;archive&rdquo; everything. I &ldquo;might&rdquo; need it later, or &ldquo;I&rsquo;ll get to it when I have time&rdquo;. If we get really honest with ourselves, we never will actually get to it, and because we have this buffer, this procrastination opportunity, we grab it. We use words like &ldquo;but I may need proof of X&rdquo;, or &ldquo;I could need to reference this&rdquo;, or &ldquo;I don&rsquo;t really want to put this person in my contacts so I&rsquo;ll just save the email&rdquo;.</p>
<p>Personally I have made a choice to force myself to be more engaged in my email going forward. I have set a Google Script to run through all of my email every day and if it is older than 90 days, and doesn&rsquo;t have the specail label &ldquo;keep&rdquo; on it, it&rsquo;s gone. I obviously didn&rsquo;t care enough about whatever was going on in that email to take the time to respond to it.</p>
<p>Whatever your reason for finding this post, here is how I got it done:</p>
<p>At first I started with just searching for a way to make a simple filter to do this. There are plenty of blog posts that show you this is possible, but it turns out that at some point Gmail switched to only applying filters to incoming messages (makes sense, lots less overhead, no need to load EVERYONEs email every hour). This makes deleting messages older than X impossible with simple filters however. I did however learn of a search query term you can use to find messages/threads older than X. Imaginatively called <code>older_than:</code>. So a search in Gmail for <code>older_than:90d</code> resulted in exactly the emails I wanted to find.</p>
<p>That&rsquo;s when I started looking into Google Scripting. The language is pretty easy and straight forward if you have ever programmed in anything like Javascript or C++.</p>
<p>Using the API reference here: <a href="https://developers.google.com/apps-script/reference/gmail/">https://developers.google.com/apps-script/reference/gmail/</a> I was able to cobble together the following in about 20 minutes:</p>
<pre><code>function DeleteOldEmail () {
	var threads;
	var thread;

	threads = GmailApp.search(&quot;older_than:90d&quot;);
	for(var i = 0; i &lt; threads.length; i++)
	{
		var thread = threads[i];
		GmailApp.moveThreadToTrash(thread);
	}
}
</code></pre><p>Now, that script leaves a lot to be desired. It doesn&rsquo;t have any case where a label like &ldquo;save&rdquo; or &ldquo;keep&rdquo; might come into play, it just hauls off and deletes everything old. But before we start improving lets show you how it looks when you&rsquo;re actually doing it (I&rsquo;ll comment out the &ldquo;moveThreadToTrash in the screenshots)</p>
<p>Go to <a href="https://script.google.com/">https://script.google.com/</a> and you&rsquo;ll be presented with a new project if you haven&rsquo;t been here before:</p>
<p><img src="/images/2017/gmail_delete_1.png" alt=""></p>
<p>Then, copy and past the code in and save it. It&rsquo;ll ask you to name the project. I just named it DeleteOldEmail. Feel free to name it anything you wish. It is what is going to show up in your Google Security &ldquo;Approve Apps&rdquo; list.</p>
<p><img src="/images/2017/gmail_delete_2.png" alt=""></p>
<p>The first time I ran this I commented out the lines for deleting and added in a &ldquo;Logger&rdquo; line just so I knew what would be deleted:</p>
<pre><code>function DeleteOldEmail () {
	var threads;
	var thread;

	threads = GmailApp.search(&quot;older_than:90d&quot;);
	for(var i = 0; i &lt; threads.length; i++)
	{
      var thread = threads[i];
      Logger.log(thread.getFirstMessageSubject())
		//GmailApp.moveThreadToTrash(thread);
	}
}
</code></pre><p>Then run it, the first time you run it, it will ask for permissions:</p>
<p><img src="/images/2017/gmail_delete_3.png" alt=""></p>
<p>If you try this out and decide you don&rsquo;t like it you can revoke the permissions here: <a href="https://myaccount.google.com/permissions">https://myaccount.google.com/permissions</a></p>
<p><img src="/images/2017/gmail_delete_4.png" alt=""></p>
<p>If you went with the logging you&rsquo;ll see something like this if you go to <strong>View-&gt;Logs</strong>:</p>
<p><img src="/images/2017/gmail_delete_5.png" alt=""></p>
<p>Last step is to set this up so it automatically runs, I mean that&rsquo;s the whole point. For that, we go to <strong>Edit-&gt;Current Project&rsquo;s Triggers</strong>. And we are greeted with the following (once we click to add a new trigger):</p>
<p><img src="/images/2017/gmail_delete_6.png" alt=""></p>
<p>I chose to set up mine to run every 12 hours, but you can set it to run once a day, once a week, whatever.</p>
<p>Again, this script leaves a lot to be desired, You can totally mess with the query search string any way you wish. I&rsquo;ve created a Github repository that I&rsquo;ll put improvements on the script: <a href="https://github.com/mubix/GScriptOldEmal">https://github.com/mubix/GScriptOldEmal</a></p>
<p>Have fun with it. The two improvments I&rsquo;ll be adding are the label exclusion for &ldquo;keep&rdquo; and notifications (a list of email subjects deleted)</p>
<p>Thanks for your time.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg>

        <span class="tag"><a href="https://malicious.link/tags/gmail/">gmail</a></span>
        <span class="tag"><a href="https://malicious.link/tags/scripting/">scripting</a></span>
        <span class="tag"><a href="https://malicious.link/tags/cleanup/">cleanup</a></span>
        
    </p>

            
  		</div>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2021</span>
            
            <span><a href="https://malicious.link/post/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">Djordje Atlialp</a></span>
          </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.a0f363fdf81cdc5cfacc447a79c33189eb000d090336cd04aac8ee256f423b3133b836c281944c19c75e38d0b0b449f01ce5807e37798b7ac94ac1db51983fc4.js" integrity="sha512-oPNj/fgc3Fz6zER6ecMxiesADQkDNs0EqsjuJW9COzEzuDbCgZRMGcdeONCwtEnwHOWAfjd5i3rJSsHbUZg/xA=="></script>



    </body>
</html>
