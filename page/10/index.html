<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Home of mubix, the infosec treehugger">
  <meta name="generator" content="Hugo 0.16" />

  <title>Room362</title>

  
  
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/pure-min.css">

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-old-ie-min.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/pure/0.6.0/grids-responsive-min.css">
  <!--<![endif]-->

  <!--[if lte IE 8]>
  <link rel="stylesheet" href="/css/side-menu-old-ie.css">
  <![endif]-->
  <!--[if gt IE 8]><!-->
  <link rel="stylesheet" href="/css/side-menu.css">
  <!--<![endif]-->

  <link rel="stylesheet" href="/css/blackburn.css">

  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

  
  <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">

  
  <link rel="alternate" type="application/rss+xml" title="Room362" href="//room362.com/index.xml" />

  
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/styles/androidstudio.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.1.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  

  <link rel="shortcut icon" href="//room362.com/img/favicon.ico" type="image/x-icon" />

</head>


<body>
<div id="layout">

  
<a href="#menu" id="menuLink" class="menu-link">
  
  <span></span>
</a>
<div id="menu">

  

  <div class="pure-menu">
    <ul class="pure-menu-list">
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/"><i class='fa fa-home fa-fw'></i>Home</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/brandon/"><i class='fa fa-users fa-fw'></i>Brandon</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/post/"><i class='fa fa-list fa-fw'></i>Posts</a>
      
        </li>
      
      
        <li class="pure-menu-item">
          <a class="pure-menu-link" href="/about/"><i class='fa fa-user fa-fw'></i>About</a>
      
        </li>
      
    </ul>
  </div>

  <div class="pure-menu social">
  <ul class="pure-menu-list">

    <li class="pure-menu-item">
      <a class="pure-menu-link" href="//room362.com/index.xml"><i class="fa fa-rss fa-fw"></i>RSS</a>
    </li>

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://twitter.com/mubix" target="_blank"><i class="fa fa-twitter fa-fw"></i>Twitter</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://facebook.com/mubix" target="_blank"><i class="fa fa-facebook fa-fw"></i>Facebook</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://plus.google.com/+mubix" target="_blank"><i class="fa fa-google-plus-square fa-fw"></i>Google+</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://instagram.com/mubix" target="_blank"><i class="fa fa-instagram fa-fw"></i>Instagram</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://flickr.com/photos/mubix" target="_blank"><i class="fa fa-flickr fa-fw"></i>Flickr</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://youtube.com/user/hak5" target="_blank"><i class="fa fa-youtube fa-fw"></i>YouTube</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://vimeo.com/mubix" target="_blank"><i class="fa fa-vimeo fa-fw"></i>Vimeo</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="http://slideshare.net/mubix" target="_blank"><i class="fa fa-slideshare fa-fw"></i>SlideShare</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://linkedin.com/in/mubix" target="_blank"><i class="fa fa-linkedin fa-fw"></i>LinkedIn</a>
    </li>
    

    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://reddit.com/user/mubix" target="_blank"><i class="fa fa-reddit fa-fw"></i>Reddit</a>
    </li>
    

    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https://github.com/mubix" target="_blank"><i class="fa fa-github-alt fa-fw"></i>GitHub</a>
    </li>
    

    
    <li class="pure-menu-item">
      <a class="pure-menu-link" href="https:////bitbucket.org/mubix" target="_blank"><i class="fa fa-bitbucket fa-fw"></i>Bitbucket</a>
    </li>
    

    

  </ul>
</div>

  <div class="pure-g">
  <div class="small-print pure-u-1 pure-u-md-1-1">
    <small>&copy; 2016. All rights reserved.</small>
  </div>
  <div class="small-print pure-u-1 pure-u-md-1-1">
    <small>Built with&nbsp;<a href="https://gohugo.io/" target="_blank">Hugo</a></small>
    <small>Theme&nbsp;<a href="https://github.com/yoshiharuyamashita/blackburn" target="_blank">Blackburn</a></small>
  </div>
</div>

</div>


  <div id="main">


<div class="header">
  <h1>Room362</h1>
  <h2>Blatherings of a security addict</h2>
</div>

<div class="content">
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-06-28-netstat-post-module-for-meterpreter/">Netstat Post Module for Meterpreter</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>28 Jun 2012, 13:18</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  Submitted it to MSF via pull request here: https://github.com/rapid7/metasploit-framework/pull/538 Added to trunk: https://github.com/rapid7/metasploit-framework/blob/master/modules/post/windows/gather/tcpnetstat.rb I promised this one a while ago, sorry for the delay. This only does TCP, it&rsquo;d be trivial to do UDP as well but never really found anything interesting and actively going on on the UDP side. It&rsquo;s real simple, first we&rsquo;ve gotta add the GetTcpTable function to railgun: session.railgun.add_function('iphlpapi', 'GetTcpTable', 'DWORD', [ ['PBLOB', 'pTcpTable', 'out'], ['PDWORD', 'pdwSize', 'inout'], ['BOOL', 'bOrder', 'in'] ]) Then gauge the size of the table: getsize = session.railgun.iphlpapi.GetTcpTable(4,4,true) buffersize = getsize['pdwSize'] Run the call again with the correct buffer size: tcptable = session.railgun.iphlpapi.GetTcpTable(buffersize,buffersize,true) Then it&rsquo;s all just parsing the result.
  </p>

  
  <footer>
    <a href="/post/2012/2012-06-28-netstat-post-module-for-meterpreter/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-06-25-evidence-of-compromise-metasploits-psexec/">Evidence of Compromise - Metasploit&#39;s PSEXEC</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>25 Jun 2012, 18:27</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  Was messing with the Windows service binaries in Metasploit today and I noticed something unique I hadn&rsquo;t noticed before. For the PSEXEC module, the service name (actually just the display name, &lsquo;service name&rsquo; is random) always started with an uppercase &rsquo;M&rsquo;. Curious to why that was I looked and found Line 246 of the PSEXEC module to be the culprit: I can guess why the M is there. Might be just a quirk with old Windows versions that didn&rsquo;t allow lowercase service names, not sure.
  </p>

  
  <footer>
    <a href="/post/2012/2012-06-25-evidence-of-compromise-metasploits-psexec/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-06-20-companies-that-give-back-with-free-tools/">Companies that give back with free tools</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>20 Jun 2012, 18:34</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  Penetration Testing / Red Teaming requires the use of a lot of tools. I don&rsquo;t mind getting called a &ldquo;script kiddie&rdquo; because I can accomplish more and faster when I don&rsquo;t have to code every single task I need to do. This post is to point out companies that make this possible and give a small bit of thanks. (If you&rsquo;ve ever tried to convince a company to give something away for free, you can understand how big this really is) Some give a lot, some only one tool, but even one is more than some.
  </p>

  
  <footer>
    <a href="/post/2012/2012-06-20-companies-that-give-back-with-free-tools/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-06-15-integration-of-mimikatz-into-metasploit-stage1/">Integration of Mimikatz into Metasploit Stage1</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>15 Jun 2012, 14:55</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  One of the powers of Metasploit is it&rsquo;s ability to stay memory resident. Through the use of reflective DLL injection even keeping new functionality the attack loads from ever touching disk. Well, the first thing I wanted to do with Mimikatz is get to that same level. Here is my first step to that end; a railgun based Meterpreter script. Now before going all reflective with it I needed to understand how the DLL worked.
  </p>

  
  <footer>
    <a href="/post/2012/2012-06-15-integration-of-mimikatz-into-metasploit-stage1/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-05-26-sudoers-commented-includes-used-for-evil/">SUDOERS Commented Includes used for Evil</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>26 May 2012, 05:33</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  I found a number of things interesting when reading the following post: http://www.offensive-security.com/vulndev/freepbx-exploit-phone-home/ Too bad that nmap&rsquo;s interactive mode was taken out, but there are a great number of other such methods, most notably VI&rsquo;s shell mode. But when I started looking into appending or inserting lines into /etc/sudoers for CCDC, I happened upon an interesting function of that file. Near the end of the file there are two lines: # See sudoers(5) for more information on &quot;#include&quot; directives: #includedir /etc/sudoers.d Both look commented out, but in actuality, exactly as-is the #includedir line is interpreted and acted upon.
  </p>

  
  <footer>
    <a href="/post/2012/2012-05-26-sudoers-commented-includes-used-for-evil/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-05-25-post-exploitation-with-phantomjs/">Post Exploitation with PhantomJS</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>25 May 2012, 05:36</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  If you have never heard of PhantomJS ( http://phantomjs.org/ ) before, it&rsquo;s a &ldquo;Full Web Stack with No Browser Required&rdquo;, basically it a GUI-less browser. One of the magical &ldquo;example&rdquo; files that it has is called &ldquo;rasterize.js&rdquo; Rasterize.JS essentially renders a URL, screen shots it and give it to you in a number of different formats, here&rsquo;s it&rsquo;s usage: Usage: rasterize.js URL filename [paperwidth*paperheight|paperformat] paper (pdf output) examples: &quot;5in*7.5in&quot;, &quot;10cm*20cm&quot;, &quot;A4&quot;, &quot;Letter&quot; PhantomJS is sweet for sweeping a ton of IPs and suspected HTTP/S sites, and look through a gallery of them to start figuring out which looks the most interestingâ€¦ and we are going to essentially just that, except from a Victim machine.
  </p>

  
  <footer>
    <a href="/post/2012/2012-05-25-post-exploitation-with-phantomjs/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-05-24-sticky-keys-and-utilman-against-nla/">Sticky Keys and Utilman against NLA</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>24 May 2012, 17:10</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  At CCDC, Sticky Keys via RDP was a very successful re-entry point for the Red Team. You can read more about how this works here: http://carnal0wnage.attackresearch.com/2012/04/privilege-escalation-via-sticky-keys.html So if you can get physical access or SYSTEM/Admin access at some point and enable + reach RDP, you can very easily follow those instructions and gain a level of persistance without the need of a pesky password :-) However, this doesn&rsquo;t work so well with the advent of NLA or Network-Level-Authentication, which was enabled for Vista systems and beyond.
  </p>

  
  <footer>
    <a href="/post/2012/2012-05-24-sticky-keys-and-utilman-against-nla/">Read more<i class="fa fa-angle-double-right fa-fw"></i></a>
  </footer>
  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-05-22-derbycon-training-sep-27-28-2012/">DerbyCon Training (Sep 27-28 2012)</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>22 May 2012, 19:44</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  @egypt and I have teamed up this year to teach at DerbyCon at the end of September. Here is the very basic outline of the class and subject to change: (Sign up here: https://www.derbycon.com/training-courses/ ) THURSDAY Intro to the Framework The history of the Framework Ninja Demo Usage Recon Exploitation Pillaging Post modules Intro to Ruby Getting your environment set up Ruby Basics Strings, Arrays, and Methods oh my IRB, Pry - The No-Spoon Portion Navigating Documentation Module Writing Auxiliary Modules Exploit Modules Post Modules Railgun (Windows and ?Linux?) Meterpreter(s) The Dread Pirate Reporting LAB, LABs and more LABS FRIDAY CTF + open LAB time definitely open to requests for content, if you, as a student, would like a particular topic included.
  </p>

  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-04-26-phdays-in-moscow/">phDays in Moscow</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>26 Apr 2012, 21:33</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  A friend of mine is presenting at phDays in Moscow at the end of May. If you are in the area, or can be, I would highly recommend you attend, and in particularly his talk. His blog is here: http://blog.gentilkiwi.com/ And since a picture is worth a thousand words: You should really go check out what he is going to present&hellip; just sayin&rsquo;
  </p>

  
</article>

    
  
    
      <article>
  <header>
    <h2><a href="//room362.com/post/2012/2012-03-19-how-to-win-ccdc-slides/">How to Win CCDC - Slides</a></h2>

    <div class="post-meta">

  <div>
    <i class="fa fa-calendar fa-fw"></i>
    <time>19 Mar 2012, 05:20</time>
  </div>

  

  

  

</div>

  </header>

  <p>
  Since this is a constantly updating slide deck I figured I&rsquo;d post it here so I didn&rsquo;t have to keep emailing it out. ;-) If you have comments or if something is wrong grammatically, technically or in any other way I&rsquo;d love input. Suggestions also welcome. Here is a link straight to the doc if you want to comment or add it to your google docs list: https://docs.google.com/presentation/d/1pPXLg3KqwSMLRCNRfows5QnVI2mLjSmll5vN2WHMFJg/edit
  </p>

  
</article>

    
  

  
<nav class="pagination" role="pagination">
  
  <a href="/page/9/"><i class="fa fa-angle-double-left"></i></a>
  
  <span>10 / 46</span>
  
  <a href="/page/11/"><i class="fa fa-angle-double-right"></i></a>
  
</nav>



</div>

</div>
</div>
<script src="//room362.com/js/ui.js"></script>


<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-198967-1', 'auto');
  ga('send', 'pageview');

</script>



</body>
</html>

